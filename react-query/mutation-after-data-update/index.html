<!DOCTYPE html><html lang="ko"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><meta name="generator" content="Gatsby 5.5.0"/><meta data-react-helmet="true" name="description" content="React Query의 mutation 실행 이후 클라이언트의 서버 데이터는 변경 되지 않은 상태이다. 화면을 업데이트 하는 여러 가지 방법을 알아보면서, 어떤 상황에서 어떤 방법을 사용해야 하는지 알아보자."/><meta data-react-helmet="true" property="og:site_name" content="Pozafly Blog"/><meta data-react-helmet="true" property="og:type" content="article"/><meta data-react-helmet="true" property="og:title" content="React Query에서 mutation 이후 데이터를 업데이트하는 4가지 방법"/><meta data-react-helmet="true" property="og:description" content="React Query의 mutation 실행 이후 클라이언트의 서버 데이터는 변경 되지 않은 상태이다. 화면을 업데이트 하는 여러 가지 방법을 알아보면서, 어떤 상황에서 어떤 방법을 사용해야 하는지 알아보자."/><meta data-react-helmet="true" property="og:url" content="https://pozafly.github.io/react-query/mutation-after-data-update/"/><meta data-react-helmet="true" property="og:image" content="https://pozafly.github.io/static/848a29a42bca253c5a3a44c252c3720f/81547/main.webp"/><meta data-react-helmet="true" property="article:published_time" content="2023-07-02"/><meta data-react-helmet="true" property="article:tag" content="React-Query"/><meta data-react-helmet="true" property="article:publisher" content="https://www.instagram.com/pozafly_/"/><meta data-react-helmet="true" property="article:author" content="https://www.instagram.com/pozafly_/"/><meta data-react-helmet="true" name="github:card" content="summary_large_image"/><meta data-react-helmet="true" name="github:title" content="React Query에서 mutation 이후 데이터를 업데이트하는 4가지 방법"/><meta data-react-helmet="true" name="github:description" content="React Query의 mutation 실행 이후 클라이언트의 서버 데이터는 변경 되지 않은 상태이다. 화면을 업데이트 하는 여러 가지 방법을 알아보면서, 어떤 상황에서 어떤 방법을 사용해야 하는지 알아보자."/><meta data-react-helmet="true" name="github:url" content="https://pozafly.github.io/react-query/mutation-after-data-update/"/><meta data-react-helmet="true" name="github:image" content="https://pozafly.github.io/static/848a29a42bca253c5a3a44c252c3720f/81547/main.webp"/><meta data-react-helmet="true" name="github:label1" content="Written by"/><meta data-react-helmet="true" name="github:data1" content="Pozafly"/><meta data-react-helmet="true" name="github:label2" content="Filed under"/><meta data-react-helmet="true" name="github:data2" content="React-Query"/><meta data-react-helmet="true" name="github:site" content="@pozafly"/><meta data-react-helmet="true" name="github:creator" content="@pozafly"/><meta data-react-helmet="true" property="og:image:width" content="1"/><meta data-react-helmet="true" property="og:image:height" content="0.525"/><link rel="sitemap" type="application/xml" href="/sitemap-index.xml"/><style>.gatsby-image-wrapper{position:relative;overflow:hidden}.gatsby-image-wrapper picture.object-fit-polyfill{position:static!important}.gatsby-image-wrapper img{bottom:0;height:100%;left:0;margin:0;max-width:none;padding:0;position:absolute;right:0;top:0;width:100%;object-fit:cover}.gatsby-image-wrapper [data-main-image]{opacity:0;transform:translateZ(0);transition:opacity .25s linear;will-change:opacity}.gatsby-image-wrapper-constrained{display:inline-block;vertical-align:top}</style><noscript><style>.gatsby-image-wrapper noscript [data-main-image]{opacity:1!important}.gatsby-image-wrapper [data-placeholder-image]{opacity:0!important}</style></noscript><script type="module">const e="undefined"!=typeof HTMLImageElement&&"loading"in HTMLImageElement.prototype;e&&document.body.addEventListener("load",(function(e){const t=e.target;if(void 0===t.dataset.mainImage)return;if(void 0===t.dataset.gatsbyImageSsr)return;let a=null,n=t;for(;null===a&&n;)void 0!==n.parentNode.dataset.gatsbyImageWrapper&&(a=n.parentNode),n=n.parentNode;const o=a.querySelector("[data-placeholder-image]"),r=new Image;r.src=t.currentSrc,r.decode().catch((()=>{})).then((()=>{t.style.opacity=1,o&&(o.style.opacity=0,o.style.transition="opacity 500ms linear")}))}),!0);</script><style type="text/css">
    .auto-link.before {
      position: absolute;
      top: 0;
      left: 0;
      transform: translateX(-100%);
      padding-right: 4px;
    }
    .auto-link.after {
      display: inline-block;
      padding-left: 4px;
    }
    h1 .auto-link svg,
    h2 .auto-link svg,
    h3 .auto-link svg,
    h4 .auto-link svg,
    h5 .auto-link svg,
    h6 .auto-link svg {
      visibility: hidden;
    }
    h1:hover .auto-link svg,
    h2:hover .auto-link svg,
    h3:hover .auto-link svg,
    h4:hover .auto-link svg,
    h5:hover .auto-link svg,
    h6:hover .auto-link svg,
    h1 .auto-link:focus svg,
    h2 .auto-link:focus svg,
    h3 .auto-link:focus svg,
    h4 .auto-link:focus svg,
    h5 .auto-link:focus svg,
    h6 .auto-link:focus svg {
      visibility: visible;
    }
  </style><script>
    document.addEventListener("DOMContentLoaded", function(event) {
      var hash = window.decodeURI(location.hash.replace('#', ''))
      if (hash !== '') {
        var element = document.getElementById(hash)
        if (element) {
          var scrollTop = window.pageYOffset || document.documentElement.scrollTop || document.body.scrollTop
          var clientTop = document.documentElement.clientTop || document.body.clientTop || 0
          var offset = element.getBoundingClientRect().top + scrollTop - clientTop
          // Wait for the browser to finish rendering before scrolling.
          setTimeout((function() {
            window.scrollTo(0, offset - 100)
          }), 0)
        }
      }
    })
  </script><link rel="canonical" href="https://pozafly.github.io/react-query/mutation-after-data-update/" data-baseprotocol="https:" data-basehost="pozafly.github.io"/><title data-react-helmet="true">React Query에서 mutation 이후 데이터를 업데이트하는 4가지 방법</title><link data-react-helmet="true" rel="icon" href="/static/alien-652bde6f766dc3e52bdf32391ba54a09.png" type="image/x-icon"/><link rel="preconnect" href="https://www.googletagmanager.com"/><link rel="dns-prefetch" href="https://www.googletagmanager.com"/><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-SLQNH3ND3J"></script><script>
      
      function gaOptout(){document.cookie=disableStr+'=true; expires=Thu, 31 Dec 2099 23:59:59 UTC;path=/',window[disableStr]=!0}var gaProperty='G-SLQNH3ND3J',disableStr='ga-disable-'+gaProperty;document.cookie.indexOf(disableStr+'=true')>-1&&(window[disableStr]=!0);
      if(!(navigator.doNotTrack == "1" || window.doNotTrack == "1")) {
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-SLQNH3ND3J', {"anonymize_ip":true,"cookie_expires":0,"send_page_view":false});
      }
      </script></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><div class="post-template"><style data-emotion="css-global 106ipco">html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,dl,dt,dd,ol,fieldset,form,label,legend,article,aside,canvas,details,embed,figure,figcaption,footer,header,hgroup,menu,nav,output,ruby,section,summary,time,mark,audio,video{margin:0;padding:0;border:0;font:inherit;font-size:93%;vertical-align:baseline;}html .copyright,body .copyright,div .copyright,span .copyright,applet .copyright,object .copyright,iframe .copyright,h1 .copyright,h2 .copyright,h3 .copyright,h4 .copyright,h5 .copyright,h6 .copyright,p .copyright,blockquote .copyright,pre .copyright,a .copyright,abbr .copyright,acronym .copyright,address .copyright,big .copyright,cite .copyright,code .copyright,del .copyright,dfn .copyright,em .copyright,img .copyright,ins .copyright,kbd .copyright,q .copyright,s .copyright,samp .copyright,small .copyright,strike .copyright,strong .copyright,sub .copyright,sup .copyright,tt .copyright,var .copyright,dl .copyright,dt .copyright,dd .copyright,ol .copyright,fieldset .copyright,form .copyright,label .copyright,legend .copyright,article .copyright,aside .copyright,canvas .copyright,details .copyright,embed .copyright,figure .copyright,figcaption .copyright,footer .copyright,header .copyright,hgroup .copyright,menu .copyright,nav .copyright,output .copyright,ruby .copyright,section .copyright,summary .copyright,time .copyright,mark .copyright,audio .copyright,video .copyright{font-size:1.4rem;}html .error-front-page,body .error-front-page,div .error-front-page,span .error-front-page,applet .error-front-page,object .error-front-page,iframe .error-front-page,h1 .error-front-page,h2 .error-front-page,h3 .error-front-page,h4 .error-front-page,h5 .error-front-page,h6 .error-front-page,p .error-front-page,blockquote .error-front-page,pre .error-front-page,a .error-front-page,abbr .error-front-page,acronym .error-front-page,address .error-front-page,big .error-front-page,cite .error-front-page,code .error-front-page,del .error-front-page,dfn .error-front-page,em .error-front-page,img .error-front-page,ins .error-front-page,kbd .error-front-page,q .error-front-page,s .error-front-page,samp .error-front-page,small .error-front-page,strike .error-front-page,strong .error-front-page,sub .error-front-page,sup .error-front-page,tt .error-front-page,var .error-front-page,dl .error-front-page,dt .error-front-page,dd .error-front-page,ol .error-front-page,fieldset .error-front-page,form .error-front-page,label .error-front-page,legend .error-front-page,article .error-front-page,aside .error-front-page,canvas .error-front-page,details .error-front-page,embed .error-front-page,figure .error-front-page,figcaption .error-front-page,footer .error-front-page,header .error-front-page,hgroup .error-front-page,menu .error-front-page,nav .error-front-page,output .error-front-page,ruby .error-front-page,section .error-front-page,summary .error-front-page,time .error-front-page,mark .error-front-page,audio .error-front-page,video .error-front-page{font-size:1.6rem;}body{line-height:1;word-break:keep-all;}ol,ul{list-style:none;}blockquote,q{quotes:none;}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none;}table{border-spacing:0;border-collapse:collapse;}img{max-width:100%;}html{box-sizing:border-box;font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%;}*,*:before,*:after{box-sizing:inherit;}a{background-color:transparent;}a:active,a:hover{outline:0;}b,strong{font-weight:bold;}i,em,dfn{font-style:italic;}h1{margin:0.67em 0;font-size:2em;}small{font-size:80%;}sub,sup{position:relative;font-size:75%;line-height:0;vertical-align:baseline;}sup{top:-0.5em;}sub{bottom:-0.25em;}img{border:0;}svg:not(:root){overflow:hidden;}mark{background-color:#fdffb6;}code,kbd,pre,samp{font-family:monospace,monospace;font-size:1em;}button,input,optgroup,select,textarea{margin:0;color:inherit;font:inherit;}button{overflow:visible;border:none;}button,select{text-transform:none;}button,html input[type='button'],input[type='reset'],input[type='submit']{cursor:pointer;-webkit-appearance:button;}button[disabled],html input[disabled]{cursor:default;}button::-moz-focus-inner,input::-moz-focus-inner{padding:0;border:0;}input{line-height:normal;}input:focus{outline:none;}input[type='checkbox'],input[type='radio']{box-sizing:border-box;padding:0;}input[type='number']::-webkit-inner-spin-button,input[type='number']::-webkit-outer-spin-button{height:auto;}input[type='search']{box-sizing:content-box;-webkit-appearance:textfield;}input[type='search']::-webkit-search-cancel-button,input[type='search']::-webkit-search-decoration{-webkit-appearance:none;}legend{padding:0;border:0;}textarea{overflow:auto;}table{border-spacing:0;border-collapse:collapse;}td,th{padding:0;}html{overflow-x:hidden;overflow-y:scroll;font-size:62.5%;-webkit-tap-highlight-color:rgba(0, 0, 0, 0);}body{overflow-x:hidden;color:#303a3e;font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,'Noto Sans','Ubuntu','Droid Sans','Helvetica Neue',sans-serif;font-size:1.6rem;line-height:1.6em;font-weight:400;font-style:normal;letter-spacing:0;text-rendering:optimizeLegibility;background:#fff;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;-moz-font-feature-settings:'liga' on;}body::-webkit-scrollbar{background-color:transparent;width:6px;}body::-webkit-scrollbar-thumb{border-radius:8px;background-color:hsla(230, 5%, 35%, 1);}::selection{text-shadow:none;background:#3498db;}hr{position:relative;display:block;width:100%;margin:2.5em 0 3.5em;padding:0;height:1px;border:0;border-top:1px solid #e4eaed;}audio,canvas,iframe,img,svg,video{vertical-align:middle;}fieldset{margin:0;padding:0;border:0;}textarea{resize:vertical;}p,ul,ol,dl,blockquote{margin:0 0 1.5em 0;}ol,ul{padding-left:1.3em;}ol ol,ul ul,ul ol,ol ul{margin:0.5em 0 1em;}ul{list-style:disc;}ol{list-style:decimal;}ul,ol{max-width:100%;}li{margin:0.5em 0;padding-left:0.3em;line-height:1.6em;}dt{float:left;margin:0 20px 0 0;width:120px;color:#15171A;font-weight:500;text-align:right;}dd{margin:0 0 5px 0;text-align:left;}blockquote{margin:1.5em 0;padding:0 1.6em 0 1.6em;border-left:#e5eff5 0.5em solid;}blockquote p{margin:0.8em 0;font-size:1.2em;font-weight:400;}blockquote small{display:inline-block;margin:0.8em 0 0.8em 1.5em;font-size:0.9em;opacity:0.8;}blockquote cite{font-weight:bold;}blockquote cite a{font-weight:normal;}a{color:#768086;-webkit-text-decoration:none;text-decoration:none;}@media (prefers-color-scheme: dark){a{color:#90a2aa;}}a:hover{-webkit-text-decoration:underline;text-decoration:underline;}h1,h2,h3,h4,h5,h6{margin-top:0;line-height:1.15;font-weight:600;text-rendering:optimizeLegibility;}h1{margin:0 0 0.5em 0;font-size:5.5rem;font-weight:600;}@media (max-width: 500px){h1{font-size:2.2rem;}}h2{margin:1.5em 0 0.5em 0;font-size:2.2rem;}@media (max-width: 500px){h2{font-size:1.8rem;}}h3{margin:1.5em 0 0.5em 0;font-size:1.8rem;font-weight:500;}@media (max-width: 500px){h3{font-size:1.7rem;}}h4{margin:1.5em 0 0.5em 0;font-size:1.6rem;font-weight:500;}h5{margin:1.5em 0 0.5em 0;font-size:1.4rem;font-weight:500;}h6{margin:1.5em 0 0.5em 0;font-size:1.4rem;font-weight:500;}body{background:#fff;}h1 a.auto-link svg,h2 a.auto-link svg,h3 a.auto-link svg,h4 a.auto-link svg,h5 a.auto-link svg,h6 a.auto-link svg{opacity:0;-webkit-transition:0.25s ease;transition:0.25s ease;}h1:hover a.auto-link svg,h2:hover a.auto-link svg,h3:hover a.auto-link svg,h4:hover a.auto-link svg,h5:hover a.auto-link svg,h6:hover a.auto-link svg{opacity:1;}a.auto-link{box-shadow:none!important;}a.auto-link svg{fill:#0a0b0c!important;}a.auto-link:hover{box-shadow:none!important;}@media (prefers-color-scheme: dark){body{color:rgba(255, 255, 255, 0.75);background:#191b1f;}img{opacity:0.9;}a.auto-link svg{fill:rgba(255, 255, 255, 0.9)!important;}}</style><style data-emotion="css wv5on3">.css-wv5on3 .site-main{margin-top:64px;background:#fff;padding-bottom:4vw;}@media (prefers-color-scheme: dark){.css-wv5on3 .site-main{background:#191b1f;}}</style><style data-emotion="css 1qvd43r">.css-1qvd43r{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;min-height:100vh;}.css-1qvd43r .site-main{margin-top:64px;background:#fff;padding-bottom:4vw;}@media (prefers-color-scheme: dark){.css-1qvd43r .site-main{background:#191b1f;}}</style><div class="css-1qvd43r esvym2d0"><header class="site-header"><style data-emotion="css wuurd5">.css-wuurd5{position:relative;padding:0 5vw;position:fixed;top:0;right:0;left:0;z-index:1000;-webkit-backdrop-filter:blur(8px);backdrop-filter:blur(8px);background:transparent;}</style><div class="css-wuurd5"><style data-emotion="css y521qa">.css-y521qa{margin:0 auto;max-width:1040px;width:100%;}</style><div class="css-y521qa"><style data-emotion="css lcmrfl">.css-lcmrfl{position:relative;z-index:100;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between;-webkit-align-items:flex-start;-webkit-box-align:flex-start;-ms-flex-align:flex-start;align-items:flex-start;overflow-y:hidden;height:64px;font-size:1.3rem;}</style><nav class="css-lcmrfl"><style data-emotion="css axoi21">.css-axoi21{-webkit-flex:1 0 auto;-ms-flex:1 0 auto;flex:1 0 auto;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;overflow-x:auto;overflow-y:hidden;-webkit-overflow-scrolling:touch;margin-right:10px;padding:10px 0 80px;font-weight:500;letter-spacing:0.2px;text-transform:uppercase;white-space:nowrap;-ms-overflow-scrolling:touch;}@media (max-width: 700px){.css-axoi21{margin-right:0;}}</style><div class="site-nav-left  css-axoi21 e1sju8vj5"><style data-emotion="css vdmvgr">.css-vdmvgr{position:relative;z-index:100;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;display:inline-block;margin-right:32px;padding:12px 0;color:#fff;font-size:1.7rem;line-height:1.8rem;font-weight:bold;letter-spacing:-0.5px;text-transform:none;}@media (max-width: 700px){.css-vdmvgr{margin-right:18px;}}.css-vdmvgr:hover{-webkit-text-decoration:none;text-decoration:none;}.css-vdmvgr img{display:block;width:auto;height:21px;}</style><a class="site-nav-logo css-vdmvgr" href="/"><img src="/static/a62d45ddbe29cf42da820a576d9375e1/aef42/alien.png" alt="Pozafly Blog"/></a><style data-emotion="css 1xdepn">.css-1xdepn{position:relative;-webkit-align-self:flex-start;-ms-flex-item-align:flex-start;align-self:flex-start;}</style><div class="css-1xdepn e1sju8vj4"><style data-emotion="css 17u0f19">.css-17u0f19{position:absolute;z-index:1000;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;margin:0 0 0 -12px;padding:0;list-style:none;-webkit-transition:all 1s cubic-bezier(0.19, 1, 0.22, 1);transition:all 1s cubic-bezier(0.19, 1, 0.22, 1);}.css-17u0f19 li{display:block;margin:0;padding:0;}.css-17u0f19 li a{font-size:1.2rem;position:relative;display:block;padding:14px 12px;color:#000;opacity:0.8;-webkit-transition:opacity 0.35s ease-in-out;transition:opacity 0.35s ease-in-out;}@media (prefers-color-scheme: dark){.css-17u0f19 li a{color:#fff;}}@media (max-width: 700px){.css-17u0f19 li a{padding:14px 8px;}}.css-17u0f19 li a:hover{-webkit-text-decoration:none;text-decoration:none;opacity:1;}.css-17u0f19 li a:before{content:'';position:absolute;right:100%;bottom:8px;left:12px;height:1px;background:#000;opacity:0.25;-webkit-transition:all 0.35s ease-in-out;transition:all 0.35s ease-in-out;}@media (prefers-color-scheme: dark){.css-17u0f19 li a:before{background:#fff;}}.css-17u0f19 li a:hover:before{right:12px;opacity:0.5;}.css-17u0f19 li a.is-home{color:#fff;}.css-17u0f19 li a.is-home:before{background:#fff;}.css-17u0f19 .nav-current{opacity:1;}</style><ul role="menu" class="css-17u0f19"><li role="menuitem"><a class="" href="/">Home</a></li><li role="menuitem"><a class="" href="/about/">About</a></li><li role="menuitem"><a class="" href="/tags/">Tags</a></li><li role="menuitem"><a class="" href="/tags/diary/">Diary</a></li></ul><style data-emotion="css pfwux1">.css-pfwux1{visibility:hidden;position:absolute;top:9px;color:#000;font-size:1.7rem;font-weight:400;text-transform:none;opacity:0;-webkit-transition:all 1s cubic-bezier(0.19, 1, 0.22, 1);transition:all 1s cubic-bezier(0.19, 1, 0.22, 1);-webkit-transform:translateY(175%);-moz-transform:translateY(175%);-ms-transform:translateY(175%);transform:translateY(175%);}@media (prefers-color-scheme: dark){.css-pfwux1{color:#fff;}}@media (max-width: 700px){.css-pfwux1{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;max-width:calc(100vw - 172px);}}.css-pfwux1 .dash{left:-25px;}.css-pfwux1 .dash:before{content:'– ';opacity:0.5;}</style><span class="nav-post-title css-pfwux1 e1sju8vj0">React Query에서 mutation 이후 데이터를 업데이트하는 4가지 방법</span></div></div><style data-emotion="css 3i3mo1">.css-3i3mo1{-webkit-flex:0 1 auto;-ms-flex:0 1 auto;flex:0 1 auto;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:end;-ms-flex-pack:end;-webkit-justify-content:flex-end;justify-content:flex-end;padding:10px 0;height:64px;}</style><div class="css-3i3mo1 e1sju8vj3"><style data-emotion="css 1z0rm8f">.css-1z0rm8f{-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}</style><div class="css-1z0rm8f e1sju8vj2"><style data-emotion="css yvx7r3">.css-yvx7r3{display:inline-block;margin:0;padding:10px;opacity:0.8;}.css-yvx7r3:hover{opacity:1;}.css-yvx7r3 svg{height:1.8rem;fill:#000;}@media (prefers-color-scheme: dark){.css-yvx7r3 svg{fill:#fff;}}.css-yvx7r3.is-home svg{fill:#fff;}.css-yvx7r3 svg{height:1.6rem;}</style><a class=" css-yvx7r3" href="https://www.instagram.com/pozafly_/" target="_blank" title="Instagram" rel="noopener noreferrer"><svg height="511pt" viewBox="0 0 511 511.9" width="13pt" xmlns="http://www.w3.org/2000/svg"><path d="m510.949219 150.5c-1.199219-27.199219-5.597657-45.898438-11.898438-62.101562-6.5-17.199219-16.5-32.597657-29.601562-45.398438-12.800781-13-28.300781-23.101562-45.300781-29.5-16.296876-6.300781-34.898438-10.699219-62.097657-11.898438-27.402343-1.300781-36.101562-1.601562-105.601562-1.601562s-78.199219.300781-105.5 1.5c-27.199219 1.199219-45.898438 5.601562-62.097657 11.898438-17.203124 6.5-32.601562 16.5-45.402343 29.601562-13 12.800781-23.097657 28.300781-29.5 45.300781-6.300781 16.300781-10.699219 34.898438-11.898438 62.097657-1.300781 27.402343-1.601562 36.101562-1.601562 105.601562s.300781 78.199219 1.5 105.5c1.199219 27.199219 5.601562 45.898438 11.902343 62.101562 6.5 17.199219 16.597657 32.597657 29.597657 45.398438 12.800781 13 28.300781 23.101562 45.300781 29.5 16.300781 6.300781 34.898438 10.699219 62.101562 11.898438 27.296876 1.203124 36 1.5 105.5 1.5s78.199219-.296876 105.5-1.5c27.199219-1.199219 45.898438-5.597657 62.097657-11.898438 34.402343-13.300781 61.601562-40.5 74.902343-74.898438 6.296876-16.300781 10.699219-34.902343 11.898438-62.101562 1.199219-27.300781 1.5-36 1.5-105.5s-.101562-78.199219-1.300781-105.5zm-46.097657 209c-1.101562 25-5.300781 38.5-8.800781 47.5-8.601562 22.300781-26.300781 40-48.601562 48.601562-9 3.5-22.597657 7.699219-47.5 8.796876-27 1.203124-35.097657 1.5-103.398438 1.5s-76.5-.296876-103.402343-1.5c-25-1.097657-38.5-5.296876-47.5-8.796876-11.097657-4.101562-21.199219-10.601562-29.398438-19.101562-8.5-8.300781-15-18.300781-19.101562-29.398438-3.5-9-7.699219-22.601562-8.796876-47.5-1.203124-27-1.5-35.101562-1.5-103.402343s.296876-76.5 1.5-103.398438c1.097657-25 5.296876-38.5 8.796876-47.5 4.101562-11.101562 10.601562-21.199219 19.203124-29.402343 8.296876-8.5 18.296876-15 29.398438-19.097657 9-3.5 22.601562-7.699219 47.5-8.800781 27-1.199219 35.101562-1.5 103.398438-1.5 68.402343 0 76.5.300781 103.402343 1.5 25 1.101562 38.5 5.300781 47.5 8.800781 11.097657 4.097657 21.199219 10.597657 29.398438 19.097657 8.5 8.300781 15 18.300781 19.101562 29.402343 3.5 9 7.699219 22.597657 8.800781 47.5 1.199219 27 1.5 35.097657 1.5 103.398438s-.300781 76.300781-1.5 103.300781zm0 0"></path><path d="m256.449219 124.5c-72.597657 0-131.5 58.898438-131.5 131.5s58.902343 131.5 131.5 131.5c72.601562 0 131.5-58.898438 131.5-131.5s-58.898438-131.5-131.5-131.5zm0 216.800781c-47.097657 0-85.300781-38.199219-85.300781-85.300781s38.203124-85.300781 85.300781-85.300781c47.101562 0 85.300781 38.199219 85.300781 85.300781s-38.199219 85.300781-85.300781 85.300781zm0 0"></path><path d="m423.851562 119.300781c0 16.953125-13.746093 30.699219-30.703124 30.699219-16.953126 0-30.699219-13.746094-30.699219-30.699219 0-16.957031 13.746093-30.699219 30.699219-30.699219 16.957031 0 30.703124 13.742188 30.703124 30.699219zm0 0"></path></svg></a><style data-emotion="css 1rnjd3v">.css-1rnjd3v{display:inline-block;margin:0;padding:10px;opacity:0.8;}.css-1rnjd3v:hover{opacity:1;}.css-1rnjd3v svg{height:1.8rem;fill:#000;}@media (prefers-color-scheme: dark){.css-1rnjd3v svg{fill:#fff;}}.css-1rnjd3v.is-home svg{fill:#fff;}</style><a class=" css-1rnjd3v" href="https://github.com/pozafly" title="Github" target="_blank" rel="noopener noreferrer"><svg width="21px" height="21px" viewBox="0 0 1024 1024" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M8 0C3.58 0 0 3.58 0 8C0 11.54 2.29 14.53 5.47 15.59C5.87 15.66 6.02 15.42 6.02 15.21C6.02 15.02 6.01 14.39 6.01 13.72C4 14.09 3.48 13.23 3.32 12.78C3.23 12.55 2.84 11.84 2.5 11.65C2.22 11.5 1.82 11.13 2.49 11.12C3.12 11.11 3.57 11.7 3.72 11.94C4.44 13.15 5.59 12.81 6.05 12.6C6.12 12.08 6.33 11.73 6.56 11.53C4.78 11.33 2.92 10.64 2.92 7.58C2.92 6.71 3.23 5.99 3.74 5.43C3.66 5.23 3.38 4.41 3.82 3.31C3.82 3.31 4.49 3.1 6.02 4.13C6.66 3.95 7.34 3.86 8.02 3.86C8.7 3.86 9.38 3.95 10.02 4.13C11.55 3.09 12.22 3.31 12.22 3.31C12.66 4.41 12.38 5.23 12.3 5.43C12.81 5.99 13.12 6.7 13.12 7.58C13.12 10.65 11.25 11.33 9.47 11.53C9.76 11.78 10.01 12.26 10.01 13.01C10.01 14.08 10 14.94 10 15.21C10 15.42 10.15 15.67 10.55 15.59C13.71 14.53 16 11.53 16 8C16 3.58 12.42 0 8 0Z" transform="scale(64)"></path></svg></a></div></div></nav></div></div></header><style data-emotion="css 12lzzeq">.css-12lzzeq{-webkit-box-flex:1;-webkit-flex-grow:1;-ms-flex-positive:1;flex-grow:1;position:relative;padding:0 5vw;}@media (prefers-color-scheme: dark){.css-12lzzeq{background:#191b1f;}}</style><main id="site-main" class="site-main css-12lzzeq"><div class="css-y521qa"><style data-emotion="css 1wcdnkk">.css-1wcdnkk{position:relative;z-index:50;}</style><article class="css-1wcdnkk"><style data-emotion="css 7tju5o">.css-7tju5o{position:relative;margin:0 auto;padding:70px 100px 50px;border-top-left-radius:3px;border-top-right-radius:3px;}@media (max-width: 1170px){.css-7tju5o{padding:60px 11vw 50px;}}@media (max-width: 800px){.css-7tju5o{padding-right:5vw;padding-left:5vw;}}@media (max-width: 500px){.css-7tju5o{padding:20px 0 35px;}}</style><header class="post-full-header css-7tju5o ewnyor55"><style data-emotion="css 1dark36">.css-1dark36{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:start;-ms-flex-pack:start;-webkit-justify-content:flex-start;justify-content:flex-start;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;color:#738a94;font-size:1.3rem;line-height:1.4em;font-weight:600;}</style><section class="post-full-tags css-1dark36 ewnyor54"><a href="/tags/react-query/">React-Query</a>,  <a href="/tags/react/">React</a></section><style data-emotion="css qia1z6">.css-qia1z6{margin:0 0 0.2em;color:#0b0c0e;}@media (max-width: 500px){.css-qia1z6{margin-top:0.2em;font-size:3.3rem;}}@media (prefers-color-scheme: dark){.css-qia1z6{color:rgba(255, 255, 255, 0.9);}}</style><h1 class="post-full-title css-qia1z6 ewnyor51">React Query에서 mutation 이후 데이터를 업데이트하는 4가지 방법</h1><style data-emotion="css ai4oyg">.css-ai4oyg{margin:20px 0 0;color:var(--midgrey);font-size:2rem;line-height:1.4em;font-weight:360;}@media (max-width: 500px){.css-ai4oyg{font-size:1.9rem;line-height:1.5em;}}@media (prefers-color-scheme: dark){.css-ai4oyg{color:#768086;}}</style><p class="post-full-custom-excerpt css-ai4oyg ewnyor53">React Query의 mutation 실행 이후 클라이언트의 서버 데이터는 변경 되지 않은 상태이다. 화면을 업데이트 하는 여러 가지 방법을 알아보면서, 어떤 상황에서 어떤 방법을 사용해야 하는지 알아보자.</p><style data-emotion="css 7rkhl5">.css-7rkhl5{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between;margin:35px 0 0;padding-top:15px;border-top:1px solid #e4eaed;}.css-7rkhl5 .post-full-byline-content{-webkit-box-flex:1;-webkit-flex-grow:1;-ms-flex-positive:1;flex-grow:1;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:flex-start;-webkit-box-align:flex-start;-ms-flex-align:flex-start;align-items:flex-start;}.css-7rkhl5 .post-full-byline-content .author-list{-webkit-box-pack:start;-ms-flex-pack:start;-webkit-justify-content:flex-start;justify-content:flex-start;padding:0 12px 0 0;}.css-7rkhl5 .post-full-byline-meta{margin:2px 0 0;color:#768086;font-size:1.4rem;line-height:1.2em;letter-spacing:0.2px;}.css-7rkhl5 .post-full-byline-meta h4{margin:0 0 3px;font-size:1.4rem;line-height:1.3em;font-weight:500;}.css-7rkhl5 .post-full-byline-meta h4 a{color:#2c3036;}.css-7rkhl5 .post-full-byline-meta h4 a:hover{color:#15171A;}.css-7rkhl5 .post-full-byline-meta .bull{display:inline-block;margin:0 4px;opacity:0.6;}@media (prefers-color-scheme: dark){.css-7rkhl5{border-top-color:#3b4049;}.css-7rkhl5 .post-full-byline-meta h4 a{color:rgba(255, 255, 255, 0.75);}.css-7rkhl5 .post-full-byline-meta h4 a:hover{color:#fff;}}</style><div class="post-full-byline css-7rkhl5 ewnyor52"><section class="post-full-byline-content"><style data-emotion="css 12fmpzj">.css-12fmpzj{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-flex-wrap:wrap;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;margin:0 0 0 4px;padding:0;list-style:none;}</style><ul class="author-list css-12fmpzj e1vx1kx20"><style data-emotion="css 1g82peq">.css-1g82peq{position:relative;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;margin:0;padding:0;}.css-1g82peq:hover .author-name-tooltip{opacity:1;-webkit-transform:translate(-10px, -2px);-moz-transform:translate(-10px, -2px);-ms-transform:translate(-10px, -2px);transform:translate(-10px, -2px);}</style><li class="author-list-item css-1g82peq e1jay2161"><style data-emotion="css nqg22v">.css-nqg22v{position:absolute;bottom:130%;left:50%;z-index:600;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between;margin-left:-200px;width:400px;font-size:1.4rem;line-height:1.5em;background:white;border-radius:3px;box-shadow:rgba(39, 44, 49, 0.08) 0 12px 26px,rgba(39, 44, 49, 0.06) 1px 3px 8px;opacity:0;-webkit-transition:all 0.35s cubic-bezier(0.4, 0.01, 0.165, 0.99);transition:all 0.35s cubic-bezier(0.4, 0.01, 0.165, 0.99);-webkit-transform:scale(0.98) translateY(15px);-moz-transform:scale(0.98) translateY(15px);-ms-transform:scale(0.98) translateY(15px);transform:scale(0.98) translateY(15px);pointer-events:none;padding:20px 20px 22px;}.css-nqg22v:before{content:'';position:absolute;top:100%;left:50%;display:block;margin-left:-8px;width:0;height:0;border-top:8px solid #fff;border-right:8px solid transparent;border-left:8px solid transparent;}.css-nqg22v .author-info{-webkit-flex:1 1 auto;-ms-flex:1 1 auto;flex:1 1 auto;padding:0 0 0 20px;}.css-nqg22v .author-info h2{margin:8px 0 0;font-size:1.6rem;}.css-nqg22v .author-info p{margin:4px 0 0;color:color(var(--midgrey) l(-10%));}.css-nqg22v .author-info .bio h2{margin-top:0;}.css-nqg22v .author-info .bio p{margin-top:0.8em;}.css-nqg22v .author-profile-image{-webkit-flex:0 0 60px;-ms-flex:0 0 60px;flex:0 0 60px;margin:0;width:60px;height:60px;border:none;}@media (max-width: 1170px){.css-nqg22v{margin-left:-50px;width:430px;}.css-nqg22v:before{left:50px;}}@media (max-width: 650px){.css-nqg22v{display:none;}}@media (prefers-color-scheme: dark){.css-nqg22v{background:#22252a;box-shadow:0 12px 26px rgba(0, 0, 0, 0.4);}.css-nqg22v:before{border-top-color:#22252a;}}</style><div class="author-card css-nqg22v"><style data-emotion="css 12febhg">.css-12febhg{display:block;width:100%;height:100%;background:#e4eaed;border-radius:100%;object-fit:cover;}@media (prefers-color-scheme: dark){.css-12febhg{background:#191b1f;}}.css-12febhg img{border-radius:100%;}</style><div data-gatsby-image-wrapper="" class="gatsby-image-wrapper author-profile-image css-12febhg"><div aria-hidden="true" style="padding-top:100%"></div><div aria-hidden="true" data-placeholder-image="" style="opacity:1;transition:opacity 500ms linear;background-color:#6808f8;position:absolute;top:0;left:0;bottom:0;right:0"></div><picture><source type="image/webp" data-srcset="/static/8c061761f263c344f2c0416607c8adf1/e73fe/pozafly.webp 40w,/static/8c061761f263c344f2c0416607c8adf1/61ca6/pozafly.webp 80w,/static/8c061761f263c344f2c0416607c8adf1/507b0/pozafly.webp 120w" sizes="100vw"/><img data-gatsby-image-ssr="" data-main-image="" style="opacity:0" sizes="100vw" decoding="async" loading="lazy" data-src="/static/8c061761f263c344f2c0416607c8adf1/73bb6/pozafly.jpg" data-srcset="/static/8c061761f263c344f2c0416607c8adf1/2f28c/pozafly.jpg 40w,/static/8c061761f263c344f2c0416607c8adf1/499f6/pozafly.jpg 80w,/static/8c061761f263c344f2c0416607c8adf1/73bb6/pozafly.jpg 120w" alt="Pozafly"/></picture><noscript><picture><source type="image/webp" srcSet="/static/8c061761f263c344f2c0416607c8adf1/e73fe/pozafly.webp 40w,/static/8c061761f263c344f2c0416607c8adf1/61ca6/pozafly.webp 80w,/static/8c061761f263c344f2c0416607c8adf1/507b0/pozafly.webp 120w" sizes="100vw"/><img data-gatsby-image-ssr="" data-main-image="" style="opacity:0" sizes="100vw" decoding="async" loading="lazy" src="/static/8c061761f263c344f2c0416607c8adf1/73bb6/pozafly.jpg" srcSet="/static/8c061761f263c344f2c0416607c8adf1/2f28c/pozafly.jpg 40w,/static/8c061761f263c344f2c0416607c8adf1/499f6/pozafly.jpg 80w,/static/8c061761f263c344f2c0416607c8adf1/73bb6/pozafly.jpg 120w" alt="Pozafly"/></picture></noscript><script type="module">const t="undefined"!=typeof HTMLImageElement&&"loading"in HTMLImageElement.prototype;if(t){const t=document.querySelectorAll("img[data-main-image]");for(let e of t){e.dataset.src&&(e.setAttribute("src",e.dataset.src),e.removeAttribute("data-src")),e.dataset.srcset&&(e.setAttribute("srcset",e.dataset.srcset),e.removeAttribute("data-srcset"));const t=e.parentNode.querySelectorAll("source[data-srcset]");for(let e of t)e.setAttribute("srcset",e.dataset.srcset),e.removeAttribute("data-srcset");e.complete&&(e.style.opacity=1,e.parentNode.parentNode.querySelector("[data-placeholder-image]").style.opacity=0)}}</script></div><div class="author-info"><div class="bio"><h2>Pozafly</h2><p>Frontend Developer</p><p><a href="/author/pozafly/">More posts</a> by<!-- --> <!-- -->Pozafly<!-- -->.</p></div></div></div><style data-emotion="css 1smzq71">.css-1smzq71{display:block;overflow:hidden;margin:0 -4px;width:40px;height:40px;border:#fff 2px solid;border-radius:100%;-webkit-transition:all 0.5s cubic-bezier(0.4, 0.01, 0.165, 0.99) 700ms;transition:all 0.5s cubic-bezier(0.4, 0.01, 0.165, 0.99) 700ms;}@media (max-width: 500px){.css-1smzq71{width:36px;height:36px;}}@media (prefers-color-scheme: dark){.css-1smzq71{border-color:#1a1c20;}}</style><a class="author-avatar css-1smzq71" href="/author/pozafly/"><div data-gatsby-image-wrapper="" class="gatsby-image-wrapper author-profile-image css-12febhg"><div aria-hidden="true" style="padding-top:100%"></div><div aria-hidden="true" data-placeholder-image="" style="opacity:1;transition:opacity 500ms linear;background-color:#6808f8;position:absolute;top:0;left:0;bottom:0;right:0"></div><picture><source type="image/webp" data-srcset="/static/8c061761f263c344f2c0416607c8adf1/e73fe/pozafly.webp 40w,/static/8c061761f263c344f2c0416607c8adf1/61ca6/pozafly.webp 80w,/static/8c061761f263c344f2c0416607c8adf1/507b0/pozafly.webp 120w" sizes="100vw"/><img data-gatsby-image-ssr="" data-main-image="" style="opacity:0" sizes="100vw" decoding="async" loading="lazy" data-src="/static/8c061761f263c344f2c0416607c8adf1/73bb6/pozafly.jpg" data-srcset="/static/8c061761f263c344f2c0416607c8adf1/2f28c/pozafly.jpg 40w,/static/8c061761f263c344f2c0416607c8adf1/499f6/pozafly.jpg 80w,/static/8c061761f263c344f2c0416607c8adf1/73bb6/pozafly.jpg 120w" alt="Pozafly"/></picture><noscript><picture><source type="image/webp" srcSet="/static/8c061761f263c344f2c0416607c8adf1/e73fe/pozafly.webp 40w,/static/8c061761f263c344f2c0416607c8adf1/61ca6/pozafly.webp 80w,/static/8c061761f263c344f2c0416607c8adf1/507b0/pozafly.webp 120w" sizes="100vw"/><img data-gatsby-image-ssr="" data-main-image="" style="opacity:0" sizes="100vw" decoding="async" loading="lazy" src="/static/8c061761f263c344f2c0416607c8adf1/73bb6/pozafly.jpg" srcSet="/static/8c061761f263c344f2c0416607c8adf1/2f28c/pozafly.jpg 40w,/static/8c061761f263c344f2c0416607c8adf1/499f6/pozafly.jpg 80w,/static/8c061761f263c344f2c0416607c8adf1/73bb6/pozafly.jpg 120w" alt="Pozafly"/></picture></noscript><script type="module">const t="undefined"!=typeof HTMLImageElement&&"loading"in HTMLImageElement.prototype;if(t){const t=document.querySelectorAll("img[data-main-image]");for(let e of t){e.dataset.src&&(e.setAttribute("src",e.dataset.src),e.removeAttribute("data-src")),e.dataset.srcset&&(e.setAttribute("srcset",e.dataset.srcset),e.removeAttribute("data-srcset"));const t=e.parentNode.querySelectorAll("source[data-srcset]");for(let e of t)e.setAttribute("srcset",e.dataset.srcset),e.removeAttribute("data-srcset");e.complete&&(e.style.opacity=1,e.parentNode.parentNode.querySelector("[data-placeholder-image]").style.opacity=0)}}</script></div></a></li></ul><section class="post-full-byline-meta"><h4 class="author-name"><a href="/author/pozafly/">Pozafly</a></h4><div class="byline-meta-content"><time class="byline-meta-date" dateTime="2023-07-02">2023 07 02</time><span class="byline-reading-time"><span class="bull">•</span>25 min read</span></div></section></section></div></header><style data-emotion="css 2f6woi">.css-2f6woi{margin:25px auto 50px;max-height:800px;-webkit-background-size:cover;background-size:cover;width:80%;border-radius:8px;border:1px solid hsl(230deg 25% 94%);}.css-2f6woi img{border-radius:8px;}@media (max-width: 1170px){.css-2f6woi img{max-width:1170px;}}@media (max-width: 800px){.css-2f6woi{width:100%;}}@media (max-width: 500px){.css-2f6woi{margin-bottom:4vw;}}@media (prefers-color-scheme: dark){.css-2f6woi{border:1px solid hsl(230deg 6% 23%);}}</style><figure class="css-2f6woi ewnyor50"><div data-gatsby-image-wrapper="" style="height:100%" class="gatsby-image-wrapper"><div aria-hidden="true" style="padding-top:52.5%"></div><img aria-hidden="true" data-placeholder-image="" style="opacity:1;transition:opacity 500ms linear" decoding="async" src="data:image/webp;base64,UklGRgoBAABXRUJQVlA4IP4AAABwBQCdASoUAAsAAAAAJZACdLcA/QBsgFQLeUqiUmPP/FX1K/7b+WXGAfpWYGrQH48nJYXAAP75Cef4pKYwXWaObmj6uNb89cRstuX4oguTI/Ltf2477JAiP5FcA5Tr9O5n03ruT+hCFEwnvbQf/BHc/uRzjYa2s/8HBWpoTqXuNry0nN2zBDiF4JKFyMGG9jBPudMl/UEj/9A9E9V8kEV9HbR8TPpZ8PjBDRgmL//WUX/9Jdyf/h8/0tv5zn9dUvP2bq/zO9JfbQv/fIzX9/LxVAn65Vaj3P/7mf+ZIZJg7Y5yEOa4AftMEfMZvKFetXih4WkIv3/k5M/oAAAAAA==" alt=""/><picture><source type="image/avif" data-srcset="/static/848a29a42bca253c5a3a44c252c3720f/4814e/main.avif 750w,/static/848a29a42bca253c5a3a44c252c3720f/acf79/main.avif 1080w,/static/848a29a42bca253c5a3a44c252c3720f/30577/main.avif 1200w" sizes="100vw"/><img data-gatsby-image-ssr="" data-main-image="" style="opacity:0" sizes="100vw" decoding="async" loading="lazy" data-src="/static/848a29a42bca253c5a3a44c252c3720f/81547/main.webp" data-srcset="/static/848a29a42bca253c5a3a44c252c3720f/73e0d/main.webp 750w,/static/848a29a42bca253c5a3a44c252c3720f/9fede/main.webp 1080w,/static/848a29a42bca253c5a3a44c252c3720f/81547/main.webp 1200w" alt="React Query에서 mutation 이후 데이터를 업데이트하는 4가지 방법"/></picture><noscript><picture><source type="image/avif" srcSet="/static/848a29a42bca253c5a3a44c252c3720f/4814e/main.avif 750w,/static/848a29a42bca253c5a3a44c252c3720f/acf79/main.avif 1080w,/static/848a29a42bca253c5a3a44c252c3720f/30577/main.avif 1200w" sizes="100vw"/><img data-gatsby-image-ssr="" data-main-image="" style="opacity:0" sizes="100vw" decoding="async" loading="lazy" src="/static/848a29a42bca253c5a3a44c252c3720f/81547/main.webp" srcSet="/static/848a29a42bca253c5a3a44c252c3720f/73e0d/main.webp 750w,/static/848a29a42bca253c5a3a44c252c3720f/9fede/main.webp 1080w,/static/848a29a42bca253c5a3a44c252c3720f/81547/main.webp 1200w" alt="React Query에서 mutation 이후 데이터를 업데이트하는 4가지 방법"/></picture></noscript><script type="module">const t="undefined"!=typeof HTMLImageElement&&"loading"in HTMLImageElement.prototype;if(t){const t=document.querySelectorAll("img[data-main-image]");for(let e of t){e.dataset.src&&(e.setAttribute("src",e.dataset.src),e.removeAttribute("data-src")),e.dataset.srcset&&(e.setAttribute("srcset",e.dataset.srcset),e.removeAttribute("data-srcset"));const t=e.parentNode.querySelectorAll("source[data-srcset]");for(let e of t)e.setAttribute("srcset",e.dataset.srcset),e.removeAttribute("data-srcset");e.complete&&(e.style.opacity=1,e.parentNode.parentNode.querySelector("[data-placeholder-image]").style.opacity=0)}}</script></div></figure><style data-emotion="css 144v97n">.css-144v97n code[class*='language-'],.css-144v97n pre[class*='language-']{color:white;background:none;font-family:Consolas,Menlo,Monaco,source-code-pro,Courier New,monospace;font-feature-settings:normal;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;margin-bottom:0;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;}.css-144v97n code[class*='language-']::-webkit-scrollbar,.css-144v97n pre[class*='language-']::-webkit-scrollbar{background-color:transparent;height:4px;}.css-144v97n code[class*='language-']::-webkit-scrollbar-thumb,.css-144v97n pre[class*='language-']::-webkit-scrollbar-thumb{border-radius:8px;background-color:hsla(230, 5%, 35%, 1);}@media (max-width: 800px){.css-144v97n code[class*='language-'],.css-144v97n pre[class*='language-']{display:inline-block;}}.css-144v97n pre[class*='language-']{overflow:auto;}.css-144v97n pre[class*='language-']::-moz-selection{background:hsl(207, 4%, 16%);}.css-144v97n pre[class*='language-']::selection{background:hsl(207, 4%, 16%);}.css-144v97n pre[class*='language-']::-moz-selection,.css-144v97n pre[class*='language-'] ::-moz-selection{text-shadow:none;background:hsla(0, 0%, 100%, 0.15);}.css-144v97n pre[class*='language-']::selection,.css-144v97n pre[class*='language-'] ::selection{text-shadow:none;background:hsla(0, 0%, 100%, 0.15);}.css-144v97n *:not(pre)>code[class*='language-']{border-radius:0.3em;background:rgb(235, 235, 235);border:1px solid rgb(236, 237, 244);color:#000;padding:0.15em 0.5em;white-space:normal;}@media (max-width: 800px){.css-144v97n *:not(pre)>code[class*='language-']{display:inline;}}@media (prefers-color-scheme: dark){.css-144v97n *:not(pre)>code[class*='language-']{background:#3c4148;color:white;border:none;font-weight:500!important;}}.css-144v97n .token{font-size:1.4rem;}.css-144v97n .token.attr-name{color:rgb(173, 219, 103);font-style:italic;}.css-144v97n .token.comment{color:rgb(128, 147, 147);}.css-144v97n .token.string,.css-144v97n .token.url{color:rgb(173, 219, 103);}.css-144v97n .token.variable{color:rgb(214, 222, 235);}.css-144v97n .token.number{color:rgb(247, 140, 108);}.css-144v97n .token.builtin,.css-144v97n .token.char,.css-144v97n .token.constant,.css-144v97n .token.function{color:rgb(130, 170, 255);}.css-144v97n .token.punctuation{color:rgb(199, 146, 234);}.css-144v97n .token.selector,.css-144v97n .token.doctype{color:rgb(199, 146, 234);font-style:'italic';}.css-144v97n .token.class-name{color:rgb(255, 203, 139);}.css-144v97n .token.tag,.css-144v97n .token.operator,.css-144v97n .token.keyword{color:#ffa7c4;}.css-144v97n .token.boolean{color:rgb(255, 88, 116);}.css-144v97n .token.property{color:rgb(128, 203, 196);}.css-144v97n .token.namespace{color:rgb(178, 204, 214);}.css-144v97n pre[data-line]{padding:1em 0 1em 3em;position:relative;}.css-144v97n .gatsby-highlight-code-line{background-color:hsla(207, 95%, 15%, 1);display:block;margin-right:-1.3125rem;margin-left:-1.3125rem;padding-right:1em;padding-left:1.25em;border-left:0.25em solid #ffa7c4;}.css-144v97n .gatsby-highlight{margin-bottom:1.75rem;margin-left:-1.3125rem;margin-right:-1.3125rem;border-radius:10px;background:rgb(32 36 39);-webkit-overflow-scrolling:touch;overflow:auto;}.css-144v97n .gatsby-highlight pre[class*='language-']{float:left;min-width:100%;font-size:1.5rem;}</style><style data-emotion="css v8o2xb">.css-v8o2xb{position:relative;margin:0 auto;padding:0 100px 6vw;min-height:230px;font-size:2rem;line-height:1.6em;background:#fff;}@media (max-width: 1170px){.css-v8o2xb{padding:0 11vw;}}@media (max-width: 800px){.css-v8o2xb{padding:0 5vw;font-size:1.8rem;}}@media (max-width: 500px){.css-v8o2xb{padding:0;}}@media (max-width: 500px){.css-v8o2xb .post-full-custom-excerpt{font-size:1.9rem;line-height:1.5em;}}.css-v8o2xb .no-image{padding-top:0;}.css-v8o2xb h1,.css-v8o2xb h2,.css-v8o2xb h3,.css-v8o2xb h4,.css-v8o2xb h5,.css-v8o2xb h6,.css-v8o2xb p,.css-v8o2xb ul,.css-v8o2xb ol,.css-v8o2xb dl,.css-v8o2xb pre,.css-v8o2xb blockquote,.css-v8o2xb .post-full-comments,.css-v8o2xb .footnotes{margin:0 0 1.5em 0;min-width:100%;}@media (max-width: 500px){.css-v8o2xb p,.css-v8o2xb ul,.css-v8o2xb ol,.css-v8o2xb dl,.css-v8o2xb pre,.css-v8o2xb .post-full-comments,.css-v8o2xb .footnotes{margin-bottom:1.28em;}}.css-v8o2xb li{word-break:break-word;}.css-v8o2xb li p{margin:0;}.css-v8o2xb a{color:#3eb0ef;word-break:break-word;box-shadow:#3eb0ef 0 -1px 0 inset;-webkit-transition:all 0.2s ease-in-out;transition:all 0.2s ease-in-out;}.css-v8o2xb a:hover{color:#15171A;-webkit-text-decoration:none;text-decoration:none;box-shadow:#15171A 0 -1px 0 inset;}.css-v8o2xb a[class*='image'],.css-v8o2xb a[class*='image']:hover{box-shadow:none;}.css-v8o2xb a[class*='image'] span[class*='image'],.css-v8o2xb a[class*='image']:hover span[class*='image']{border-radius:6px;}.css-v8o2xb strong,.css-v8o2xb em{color:#0a0b0c;}.css-v8o2xb small{display:inline-block;line-height:1.6em;}.css-v8o2xb img,.css-v8o2xb video{display:block;margin:2em auto;max-width:840px;height:auto;border-radius:6px;border:1px solid hsl(230deg 25% 94%);}@media (prefers-color-scheme: dark){.css-v8o2xb img,.css-v8o2xb video{border:1px solid hsl(230, 6%, 23%);}}@media (max-width: 1040px){.css-v8o2xb img,.css-v8o2xb video{width:100%;}}.css-v8o2xb img[src$='#full']{max-width:none;width:100vw;}.css-v8o2xb img+br+small{display:block;margin-top:-3em;margin-bottom:1.5em;text-align:center;}.css-v8o2xb iframe{margin:10px auto 20px;}.css-v8o2xb blockquote{margin:0 0 1.5em;padding:0 1.5em;border-left:#3eb0ef 3px solid;}@media (max-width: 500px){.css-v8o2xb blockquote{padding:0 1.3em;}}.css-v8o2xb blockquote p{margin:0 0 1em 0;color:inherit;font-size:inherit;line-height:inherit;font-style:italic;}.css-v8o2xb blockquote p:last-child{margin-bottom:0;}.css-v8o2xb code{padding:0 5px 2px;font-size:0.8em;line-height:1em;font-weight:400!important;background:#e5eff5;border-radius:3px;font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,'Noto Sans','Ubuntu','Droid Sans','Helvetica Neue',sans-serif;}.css-v8o2xb p code{word-break:keep-all;}.css-v8o2xb pre{overflow-x:auto;padding:20px;max-width:100%;color:#e5eff5;font-size:1.4rem;line-height:1.5em;border-radius:5px;}.css-v8o2xb pre ::selection{color:#3b474d;}.css-v8o2xb pre code{padding:0;font-size:inherit;line-height:inherit;background:transparent;}.css-v8o2xb pre code :not(span){color:inherit;}.css-v8o2xb .fluid-width-video-wrapper{margin:1.5em 0 3em;}.css-v8o2xb hr{margin:2em 0;}.css-v8o2xb hr:after{content:'';position:absolute;top:-15px;left:50%;display:block;margin-left:-10px;width:1px;height:30px;background:#e4eaed;box-shadow:#fff 0 0 0 5px;-webkit-transform:rotate(45deg);-moz-transform:rotate(45deg);-ms-transform:rotate(45deg);transform:rotate(45deg);}.css-v8o2xb hr+p{margin-top:1.2em;}.css-v8o2xb h1,.css-v8o2xb h2,.css-v8o2xb h3,.css-v8o2xb h4,.css-v8o2xb h5,.css-v8o2xb h6{color:#0a0b0c;font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,'Noto Sans','Ubuntu','Droid Sans','Helvetica Neue',sans-serif;}.css-v8o2xb h1{margin:0.5em 0 0.4em;font-size:4.2rem;line-height:1.25em;font-weight:600;}.css-v8o2xb p+h1{margin-top:0.8em;}@media (max-width: 800px){.css-v8o2xb h1{font-size:3.2rem;line-height:1.25em;}}.css-v8o2xb h2{margin:0.5em 0 0.4em;font-size:3.2rem;line-height:1.25em;font-weight:600;}.css-v8o2xb p+h2{margin-top:0.8em;}@media (max-width: 800px){.css-v8o2xb h2{margin-bottom:0.3em;font-size:2.8rem;line-height:1.25em;}}.css-v8o2xb h3{margin:0.5em 0 0.2em;font-size:2.5rem;line-height:1.3em;font-weight:600;}.css-v8o2xb h2+h3{margin-top:0.7em;}@media (max-width: 800px){.css-v8o2xb h3{margin-bottom:0.3em;font-size:2.4rem;line-height:1.3em;}}.css-v8o2xb h4{margin:0.5em 0 0.2em;font-size:1.8rem;font-weight:600;}.css-v8o2xb h2+h4{margin-top:0.7em;}.css-v8o2xb h3+h4{margin-top:0;}@media (max-width: 800px){.css-v8o2xb h4{margin-bottom:0.3em;font-size:1.8rem;line-height:1.3em;}}.css-v8o2xb h5{display:block;margin:0.5em 0;padding:0.4em 1em 0.9em;border:0;color:#3eb0ef;font-size:3.2rem;line-height:1.35em;text-align:center;}@media (min-width: 1180px){.css-v8o2xb h5{max-width:1060px;}}@media (max-width: 800px){.css-v8o2xb h5{margin-bottom:1em;margin-left:1.3em;padding:0 0 0.5em;font-size:2.4rem;text-align:initial;}}.css-v8o2xb h6{margin:0.5em 0 0.2em 0;font-size:2rem;font-weight:700;}@media (max-width: 800px){.css-v8o2xb h6{font-size:1.8rem;line-height:1.4em;}}.css-v8o2xb table{display:inline-block;overflow-x:auto;margin:0.5em 0 2.5em;max-width:100%;width:auto;border-spacing:0;border-collapse:collapse;font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,'Noto Sans','Ubuntu','Droid Sans','Helvetica Neue',sans-serif;font-size:1.6rem;white-space:nowrap;vertical-align:top;}.css-v8o2xb table{-webkit-overflow-scrolling:touch;background:radial-gradient(
          ellipse at left,
          rgba(0, 0, 0, 0.2) 0%,
          rgba(0, 0, 0, 0) 75%
        ) 0 center,radial-gradient(
          ellipse at right,
          rgba(0, 0, 0, 0.2) 0%,
          rgba(0, 0, 0, 0) 75%
        ) 100% center;background-attachment:scroll,scroll;-webkit-background-size:10px 100%,10px 100%;background-size:10px 100%,10px 100%;background-repeat:no-repeat;}.css-v8o2xb table td:first-of-type{background-image:linear-gradient(
      to right,
      rgba(255, 255, 255, 1) 50%,
      rgba(255, 255, 255, 0) 100%
    );-webkit-background-size:20px 100%;background-size:20px 100%;background-repeat:no-repeat;}.css-v8o2xb table td:last-child{background-image:linear-gradient(
      to left,
      rgba(255, 255, 255, 1) 50%,
      rgba(255, 255, 255, 0) 100%
    );-webkit-background-position:100% 0;background-position:100% 0;-webkit-background-size:20px 100%;background-size:20px 100%;background-repeat:no-repeat;}.css-v8o2xb table th{color:#15171A;font-size:1.2rem;font-weight:700;letter-spacing:0.2px;text-align:left;text-transform:uppercase;background-color:#f4f8fb;}.css-v8o2xb table th,.css-v8o2xb table td{padding:6px 12px;border:#e1edf4 1px solid;}@media (prefers-color-scheme: dark){.css-v8o2xb{background:#191b1f;}.css-v8o2xb h1,.css-v8o2xb h2,.css-v8o2xb h3,.css-v8o2xb h4,.css-v8o2xb h6{color:rgba(255, 255, 255, 0.9);}.css-v8o2xb a{color:#26a6ed;box-shadow:inset 0 -1px 0 #26a6ed;}.css-v8o2xb a:hover{color:#fff;box-shadow:inset 0 -1px 0 #fff;}.css-v8o2xb a[class*='image'],.css-v8o2xb a[class*='image']:hover{box-shadow:none;}.css-v8o2xb strong{color:#fff;}.css-v8o2xb em{color:#fff;}.css-v8o2xb code{color:#fff;background:#000;}.css-v8o2xb hr{border-top-color:#2b2f36;}.css-v8o2xb hr:after{background:#17191c;box-shadow:#191b1f 0 0 0 5px;}.css-v8o2xb figcaption{color:rgba(255, 255, 255, 0.6);}.css-v8o2xb table td:first-of-type{background-image:linear-gradient(
        to right,
        #191b1f 50%,
        #191b1f 100%
      );}.css-v8o2xb table td:last-child{background-image:linear-gradient(
        270deg,
        #191b1f 50%,
        rgba(25, 27, 31, 0)
      );}.css-v8o2xb table th{color:rgba(255, 255, 255, 0.85);background-color:#2b2f36;}.css-v8o2xb table th,.css-v8o2xb table td{border:#2b2f36 1px solid;}.css-v8o2xb .kg-bookmark-container,.css-v8o2xb .kg-bookmark-container:hover{color:rgba(255, 255, 255, 0.75);box-shadow:0 0 1px rgba(255, 255, 255, 0.9);}}.css-v8o2xb code[class*='language-'],.css-v8o2xb pre[class*='language-']{color:white;background:none;font-family:Consolas,Menlo,Monaco,source-code-pro,Courier New,monospace;font-feature-settings:normal;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;margin-bottom:0;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;}.css-v8o2xb code[class*='language-']::-webkit-scrollbar,.css-v8o2xb pre[class*='language-']::-webkit-scrollbar{background-color:transparent;height:4px;}.css-v8o2xb code[class*='language-']::-webkit-scrollbar-thumb,.css-v8o2xb pre[class*='language-']::-webkit-scrollbar-thumb{border-radius:8px;background-color:hsla(230, 5%, 35%, 1);}@media (max-width: 800px){.css-v8o2xb code[class*='language-'],.css-v8o2xb pre[class*='language-']{display:inline-block;}}.css-v8o2xb pre[class*='language-']{overflow:auto;}.css-v8o2xb pre[class*='language-']::-moz-selection{background:hsl(207, 4%, 16%);}.css-v8o2xb pre[class*='language-']::selection{background:hsl(207, 4%, 16%);}.css-v8o2xb pre[class*='language-']::-moz-selection,.css-v8o2xb pre[class*='language-'] ::-moz-selection{text-shadow:none;background:hsla(0, 0%, 100%, 0.15);}.css-v8o2xb pre[class*='language-']::selection,.css-v8o2xb pre[class*='language-'] ::selection{text-shadow:none;background:hsla(0, 0%, 100%, 0.15);}.css-v8o2xb *:not(pre)>code[class*='language-']{border-radius:0.3em;background:rgb(235, 235, 235);border:1px solid rgb(236, 237, 244);color:#000;padding:0.15em 0.5em;white-space:normal;}@media (max-width: 800px){.css-v8o2xb *:not(pre)>code[class*='language-']{display:inline;}}@media (prefers-color-scheme: dark){.css-v8o2xb *:not(pre)>code[class*='language-']{background:#3c4148;color:white;border:none;font-weight:500!important;}}.css-v8o2xb .token{font-size:1.4rem;}.css-v8o2xb .token.attr-name{color:rgb(173, 219, 103);font-style:italic;}.css-v8o2xb .token.comment{color:rgb(128, 147, 147);}.css-v8o2xb .token.string,.css-v8o2xb .token.url{color:rgb(173, 219, 103);}.css-v8o2xb .token.variable{color:rgb(214, 222, 235);}.css-v8o2xb .token.number{color:rgb(247, 140, 108);}.css-v8o2xb .token.builtin,.css-v8o2xb .token.char,.css-v8o2xb .token.constant,.css-v8o2xb .token.function{color:rgb(130, 170, 255);}.css-v8o2xb .token.punctuation{color:rgb(199, 146, 234);}.css-v8o2xb .token.selector,.css-v8o2xb .token.doctype{color:rgb(199, 146, 234);font-style:'italic';}.css-v8o2xb .token.class-name{color:rgb(255, 203, 139);}.css-v8o2xb .token.tag,.css-v8o2xb .token.operator,.css-v8o2xb .token.keyword{color:#ffa7c4;}.css-v8o2xb .token.boolean{color:rgb(255, 88, 116);}.css-v8o2xb .token.property{color:rgb(128, 203, 196);}.css-v8o2xb .token.namespace{color:rgb(178, 204, 214);}.css-v8o2xb pre[data-line]{padding:1em 0 1em 3em;position:relative;}.css-v8o2xb .gatsby-highlight-code-line{background-color:hsla(207, 95%, 15%, 1);display:block;margin-right:-1.3125rem;margin-left:-1.3125rem;padding-right:1em;padding-left:1.25em;border-left:0.25em solid #ffa7c4;}.css-v8o2xb .gatsby-highlight{margin-bottom:1.75rem;margin-left:-1.3125rem;margin-right:-1.3125rem;border-radius:10px;background:rgb(32 36 39);-webkit-overflow-scrolling:touch;overflow:auto;}.css-v8o2xb .gatsby-highlight pre[class*='language-']{float:left;min-width:100%;font-size:1.5rem;}</style><section class="post-full-content css-v8o2xb e14ijd7g0"><div><p>React Query는 데이터 fetching 라이브러리로 소개되지만, <strong>서버 상태 가져오기, 캐싱, 동기화 및 업데이트</strong>를 쉽게할 수 있는 라이브러리다. 즉, React Query를 사용하더라도 실제 API 요청을 보내는 것은 Axios 라이브러리 혹은 fetch 함수를 사용해야한다.</p>
<p>대부분의 상태 관리 라이브러리는 클라이언트 상태 작업에는 적합하지만, 비동기 또는 서버 상태 작업에는 적합하지 않다. 서버 상태가 완전히 다르기 때문이다.</p>
<p>React Query의 사용 목적은, 테마나 UI 등의 어플리케이션에서만 필요한 데이터를 Client State로 규정짓고, 서버에서 받아오는 데이터를 Server State로 규정지어 클라이언트 상태와, 서버 상태를 나누어서 생각할 수 있도록 도와주기 때문에 사용한다. React Query는 서버 데이터를 잘 다룰 수 있도록, 받아온 서버 데이터를 캐싱해주기도 하며 브라우저 창을 다시 포커스를 맞추었을 때 또는 요청 시 오류가 발생했을 때 이후에, API를 재조회 할 수 있는 좋은 옵션을 가지고 있다.</p>
<br/>
<h2 id="mutation" style="position:relative">mutation<a href="#mutation" aria-label="mutation permalink" class="auto-link after"><svg viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a></h2>
<p>React Query의 서버 데이터 관련 중요 컨셉 중 하나는, 서버 데이터를 조회하고 서버 데이터를 가공하는 개념을 나누어 사용하도록 한다는 것이다. <code class="language-text">query</code> 는 서버 데이터를 <strong>조회</strong>(GET)할 수 있다. <code class="language-text">useQuery</code> 훅을 사용한다. <code class="language-text">mutation</code> 은 query와 다르게 <strong>생성</strong>(POST), <strong>수정</strong>(PUT or PATCH), <strong>삭제</strong>(DELETE)와 같은 데이터를 변경하는 작업을 할 수 있도록 하는 함수다. <code class="language-text">useMutation</code> 훅을 사용한다.</p>
<h3 id="왜-query와-mutation을-따로-나누어놨을까" style="position:relative">왜 query와 mutation을 따로 나누어놨을까?<a href="#%EC%99%9C-query%EC%99%80-mutation%EC%9D%84-%EB%94%B0%EB%A1%9C-%EB%82%98%EB%88%84%EC%96%B4%EB%86%A8%EC%9D%84%EA%B9%8C" aria-label="왜 query와 mutation을 따로 나누어놨을까 permalink" class="auto-link after"><svg viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a></h3>
<p>우선 용어부터 알아보자. mutation이란, ‘돌연변이’ 혹은 ‘변형’이라는 뜻을 가지고 있다. ‘가변’이라고 불리기도 한다. 프로그래밍 세계에서 mutation은 사이드 이펙트를 일으키는 방법이다. (<a href="https://en.wikibooks.org/wiki/Scheme_Programming/Mutability" target="_blank" rel="nofollow">링크</a>) 데이터를 변경시키는 것은 사이드 이펙트를 일으키며 데이터의 추적을 어렵게 만든다. 하지만 사이드 이펙트가 일어난다고 해서 데이터를 변경시켜서는 안된다는 말은 아니다. 클라이언트 및 서버에서 다루는 데이터는 변경이 일어나야하고, 변경이 일어나야 의미있는 데이터가 완성된다.</p>
<p>반면, 데이터를 조회하는 것은 사이드 이펙트를 발생시키지 않는다. React Query는 이 둘의 개념을 나누고, 사용하는 방법도 다르게 구성해두었다. query는 선언적으로 사용할 수 있으며, mutation은 명령형으로 밖에 사용하지 않도록 말이다.</p>
<div class="gatsby-highlight" data-language="tsx"><pre class="language-tsx"><code class="language-tsx"><span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">App</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 마운트 즉시 서버와 통신 후 데이터를 받아옴. 선언적.</span>
  <span class="token keyword">const</span> <span class="token punctuation">{</span> data <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">useQuery</span><span class="token punctuation">(</span><span class="token punctuation">{</span> queryKey<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&#x27;todos&#x27;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> queryFn<span class="token operator">:</span> getTodos <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// 뮤테이션 객체를 먼저 생성 후 이벤트가 일어났을 때 사용함. 명령적.</span>
  <span class="token keyword">const</span> mutation <span class="token operator">=</span> <span class="token function">useMutation</span><span class="token punctuation">(</span><span class="token punctuation">{</span> mutationFn<span class="token operator">:</span> updateTodos <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token punctuation">{</span>data<span class="token punctuation">.</span>something<span class="token punctuation">}</span><span class="token plain-text">
      </span><span class="token punctuation">{</span><span class="token comment">/* 이벤트 발생 시 사용 */</span><span class="token punctuation">}</span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> mutation<span class="token punctuation">.</span><span class="token function">mutate</span><span class="token punctuation">(</span><span class="token punctuation">{</span> something<span class="token operator">:</span> <span class="token string">&#x27;some&#x27;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre></div>
<p>query는 컴포넌트가 마운트 될 때 즉시 실행되어 서 버에서 데이터를 가져온다. 훅으로 선언만 해두면 알아서 데이터를 조회한다.</p>
<p>하지만 mutation은 서버 데이터를 변형시키는 것이기 때문에, 일반적으로 컴포넌트가 마운트 될 때 실행되면 안된다. 컴포넌트가 마운트 되자마자 물건이 결제가 되면 이상하듯이 말이다. 대신, useMutation 훅을 사용해 mutation 객체를 가져오고, 명령적으로 필요할 때 호출하도록 하고 있다.</p>
<p>따라서 query는 사이드 이펙트를 발생시키지 않으며, 선언적으로 사용할 수 있고, mutation은 사이드 이펙트를 발생시킬 수 있으며, 명령형으로 사용할 수 있다. React Query는 이런 차이점 때문에 둘을 나누어 사용하도록 했다.</p>
<br/>
<h2 id="mutation-이후-동작" style="position:relative">mutation 이후 동작<a href="#mutation-%EC%9D%B4%ED%9B%84-%EB%8F%99%EC%9E%91" aria-label="mutation 이후 동작 permalink" class="auto-link after"><svg viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a></h2>
<p>mutation이 실행된 이후 서버의 데이터는 변경되었지만(예. 서버의 DB 데이터 변경), React Query의 mutation 실행 이후 클라이언트의 서버 데이터는 변경 되지 않은 상태이다. 화면을 업데이트 하는 여러 가지 방법을 알아보면서, 어떤 상황에서 어떤 방법을 사용해야 하는지 알아보자. 클라이언트의 서버 데이터라함은, query로 조회해온 서버 데이터가 클라이언트의 상태로 넘어온 것을 말한다. 클라이언트로 넘어온 서버 데이터 기준으로 화면을 그려줄 수 있다.</p>
<blockquote>
<p>📌 클라이언트의 서버 데이터는 처음 말했던 클라이언트 데이터(ui 혹은 theme와 같은)와는 다르다. 이제 아래에서 말하는 클라이언트 데이터란, 서버에서 클라이언트로 받아온 서버 데이터를 말한다.</p>
</blockquote>
<p>아래의 예시들은 delete 기준으로 mutation 이후 어떻게 화면에 데이터가 업데이트 되는지를 설명한다. React Query가 제공하는 useMutation 훅을 통해 mutation을 할 수 있다.</p>
<div class="gatsby-highlight" data-language="ts"><pre class="language-ts"><code class="language-ts"><span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">useDeleteDoc</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token generic-function"><span class="token function">useMutation</span><span class="token generic class-name"><span class="token operator">&lt;</span>DriveFile <span class="token operator">|</span> <span class="token builtin">string</span><span class="token punctuation">,</span> AxiosError<span class="token punctuation">,</span> <span class="token builtin">string</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    mutationKey<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token constant">DIARY_KEY</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token function-variable function">mutationFn</span><span class="token operator">:</span> <span class="token punctuation">(</span>fileId<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">deleteDoc</span><span class="token punctuation">(</span>fileId<span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre></div>
<ul>
<li><code class="language-text">mutationKey</code> : mutation을 식별할 수 있고, 후에 <code class="language-text">useIsMutating</code> 훅을 통해 mutation 중인 작업을 로딩 스피너로 사용자에게 데이터를 처리하고 있다는 표시를 줄 수있다.</li>
<li><code class="language-text">mutationFn</code> : axios나 fetch 함수를 사용해 서버에 API 요청을 보내는 함수가 실행된다.</li>
</ul>
<p>※ useMutation 훅의 type은 <a href="https://gusrb3164.github.io/web/2022/01/23/react-query-typescript/" target="_blank" rel="nofollow">react-query에 typescript 적용하기</a>를 참고했다.</p>
<p>하지만, 위 작업은 단지 서버에 API를 보내고 서버에 존재하는 데이터를 변경할 뿐, 클라이언트의 데이터를 변경시켜주지 않는다. 물론 클라이언트의 데이터가 변하지 않았기 때문에 화면이 변경되지도 않는다. 변경된 데이터를 다시 화면에 표시하려면 추가적인 작업이 필요하다.</p>
<ol>
<li><strong>서버에서</strong> 조회한 데이터로 클라이언트 데이터 업데이트</li>
<li><strong>클라이언트에서</strong> 요청 데이터로 적용</li>
</ol>
<br/>
<h2 id="1-서버에서-조회한-데이터로-클라이언트-데이터-업데이트" style="position:relative">1. 서버에서 조회한 데이터로 클라이언트 데이터 업데이트<a href="#1-%EC%84%9C%EB%B2%84%EC%97%90%EC%84%9C-%EC%A1%B0%ED%9A%8C%ED%95%9C-%EB%8D%B0%EC%9D%B4%ED%84%B0%EB%A1%9C-%ED%81%B4%EB%9D%BC%EC%9D%B4%EC%96%B8%ED%8A%B8-%EB%8D%B0%EC%9D%B4%ED%84%B0-%EC%97%85%EB%8D%B0%EC%9D%B4%ED%8A%B8" aria-label="1 서버에서 조회한 데이터로 클라이언트 데이터 업데이트 permalink" class="auto-link after"><svg viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a></h2>
<p>클라이언트가 서버에 데이터를 요청한 후 변경된 데이터를 받아와서 클라이언트 데이터를 업데이트 하는 방법이다.</p>
<ul>
<li>response에 변경된 데이터를 받는 방법 (setQueryData)</li>
<li>요청 성공 후 재조회를 통해 데이터를 받는 방법 (invalidateQueries)</li>
</ul>
<h3 id="11-response에-변경된-데이터-받기-setQueryData" style="position:relative">1.1 response에 변경된 데이터 받기 (setQueryData)<a href="#11-response%EC%97%90-%EB%B3%80%EA%B2%BD%EB%90%9C-%EB%8D%B0%EC%9D%B4%ED%84%B0-%EB%B0%9B%EA%B8%B0-setQueryData" aria-label="11 response에 변경된 데이터 받기 setQueryData permalink" class="auto-link after"><svg viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a></h3>
<p><code class="language-text">setQueryData</code> 는 useQuery로 조회된 데이터가 캐시에 들어있을 경우, 캐시의 조회 데이터를 업데이트 해줄 수 있는 메서드다. redux로 생각해봤을 때, store에 있는 상태 값을 변경시켜줄 수 있는 함 수다. mutation에서는 아래와 같이 사용할 수 있다.</p>
<div class="gatsby-highlight has-highlighted-lines" data-language="ts"><pre class="language-ts"><code class="language-ts"><span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">useDeleteDoc</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token generic-function"><span class="token function">useMutation</span><span class="token generic class-name"><span class="token operator">&lt;</span>DriveFile <span class="token operator">|</span> <span class="token builtin">string</span><span class="token punctuation">,</span> AxiosError<span class="token punctuation">,</span> <span class="token builtin">string</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    mutationKey<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token constant">DIARY_KEY</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token function-variable function">mutationFn</span><span class="token operator">:</span> <span class="token punctuation">(</span>fileId<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">deleteDoc</span><span class="token punctuation">(</span>fileId<span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="gatsby-highlight-code-line">    <span class="token function">onSuccess</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span> <span class="token punctuation">{</span></span><span class="gatsby-highlight-code-line">      queryClient<span class="token punctuation">.</span><span class="token generic-function"><span class="token function">setQueryData</span><span class="token generic class-name"><span class="token operator">&lt;</span>DriveFile<span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token constant">DIARY_KEY</span><span class="token punctuation">,</span> <span class="token string">&#x27;docList&#x27;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> data<span class="token punctuation">)</span><span class="token punctuation">;</span></span><span class="gatsby-highlight-code-line">    <span class="token punctuation">}</span><span class="token punctuation">,</span></span>  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre></div>
<p><code class="language-text">onSuccess</code> 메서드의 경우 mutation이 성공적으로 완료되면 호출되는 메서드다. 총 3개의 인자를 받을 수 있는데, 그 중 첫 번째는 서버에서 반환된 data를 인자로 받아올 수 있다.</p>
<p>이 방법을 사용하기 위해서는, 서버가 클라이언트 요청에 따라 자신의 데이터를 업데이트 한 후, <strong>업데이트 된 데이터를 반드시 클라이언트에게 수정된 데이터를 내려</strong>주어야만 한다. 수정된 데이터가 클라이언트의 캐시 데이터에 새롭게 들어가게 되고, 이는 반드시 서버 측이 데이터 처리 작업 후 처리된 데이터를 response에 담아 클라이언트에 전송해야 한다.</p>
<p>데이터 흐름은 아래와 같다.</p>
<ul>
<li><code class="language-text">클라이언트 -&gt; 서버</code> : 데이터 변경 요청</li>
<li><code class="language-text">서버</code> : DB 인스턴스에 데이 터 변경</li>
<li><code class="language-text">서버 -&gt; 클라이언트</code> : 변경된 데이터 반환</li>
</ul>
<h3 id="12-재조회-invalidateQueries" style="position:relative">1.2 재조회 (invalidateQueries)<a href="#12-%EC%9E%AC%EC%A1%B0%ED%9A%8C-invalidateQueries" aria-label="12 재조회 invalidateQueries permalink" class="auto-link after"><svg viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a></h3>
<p>하지만, 서버에서 변경된 데이터를 내려주지 않을 수도 있다. 그러면, 클라이언트에서는 서버에 변경된 데이터를 다시 조회해서 문제를 해결할 수 있다. 즉, 클라이언트는 순서에 맞게 서버에 데이터 변경 요청을 하고, 재조회 요청을 해서 원하는 결과를 얻는 것이다.</p>
<p>서버에서 재조회 하는 방법은, <code class="language-text">queryClient.invalidateQueries</code> 메서드를 통해 할 수 있다.</p>
<div class="gatsby-highlight has-highlighted-lines" data-language="ts"><pre class="language-ts"><code class="language-ts"><span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">useDeleteDoc</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> queryClient <span class="token operator">=</span> <span class="token function">useQueryClient</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// queryClient를 가져와야 함</span>

  <span class="token keyword">return</span> <span class="token generic-function"><span class="token function">useMutation</span><span class="token generic class-name"><span class="token operator">&lt;</span>DriveFile <span class="token operator">|</span> <span class="token builtin">string</span><span class="token punctuation">,</span> AxiosError<span class="token punctuation">,</span> <span class="token builtin">string</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    mutationKey<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token constant">DIARY_KEY</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token function-variable function">mutationFn</span><span class="token operator">:</span> <span class="token punctuation">(</span>fileId<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">deleteDoc</span><span class="token punctuation">(</span>fileId<span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token function">onSuccess</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="gatsby-highlight-code-line">      queryClient<span class="token punctuation">.</span><span class="token function">invalidateQueries</span><span class="token punctuation">(</span><span class="token punctuation">{</span> queryKey<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token constant">DIARY_KEY</span><span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre></div>
<p><code class="language-text">onSuccess</code> 메서드를 생성하고, 불러온 queryClient를 통해 <code class="language-text">invlidateQueries</code> 메서드를 쿼리키와 함께 호출하면, 기존에 useQuery로 조회해온 데이터가 다시 조회가 되면서 기존 데이터가 변경된다.</p>
<p>데이터 흐름은 아래와 같다.</p>
<ul>
<li><code class="language-text">클라이언트 -&gt; 서버</code> : 데이터 변경 요청</li>
<li><code class="language-text">서버 -&gt; DB</code> : DB에 데이터 변경</li>
<li><code class="language-text">서버 -&gt; 클라이언트</code> : <strong>성공 message</strong> 반환</li>
<li><code class="language-text">클라이언트 -&gt; 서버</code> : 변경된 데이터 조회 요청</li>
<li><code class="language-text">서버 -&gt; DB</code> : DB에 데이터 조회</li>
<li><code class="language-text">서버 -&gt; 클라이언트</code> : <strong>변경된 데이터</strong> 반환</li>
</ul>
<p><span class="gatsby-resp-image-wrapper" style="position:relative;display:block;margin-left:auto;margin-right:auto;max-width:1150px">
      <a class="gatsby-resp-image-link" href="/static/9ceee71599b575d6aa9812980bf61059/26e62/invalidate-queries.png" style="display:block" target="_blank" rel="noopener">
    <span class="gatsby-resp-image-background-image" style="padding-bottom:7.8%;position:relative;bottom:0;left:0;background-image:url(&#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAACCAYAAABYBvyLAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAdElEQVQI1zWNuQ6DMABD+f/fawmQg5KrZWBABIUOiFclFYNly4fcWOcZXxOiGxikQirNU3RVt6Ln0Yqa91KhzchkXc2dD6SUWJaVVRsOo/huG81kPT5ErAu1fHPxnf/7ZVyOC994f2Zyzuz7QQ6Rc45wXvwAwhKSTlKjtb4AAAAASUVORK5CYII=&#x27;);background-size:cover;display:block"></span>
  <img class="gatsby-resp-image-image" alt="invalidate-queries" title="invalidate-queries" src="/static/9ceee71599b575d6aa9812980bf61059/26e62/invalidate-queries.png" srcSet="/static/9ceee71599b575d6aa9812980bf61059/0eb09/invalidate-queries.png 500w /static/9ceee71599b575d6aa9812980bf61059/1263b/invalidate-queries.png 1000w /static/9ceee71599b575d6aa9812980bf61059/26e62/invalidate-queries.png 1150w" sizes="(max-width: 1150px) 100vw, 1150px" style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0" loading="lazy" decoding="async"/>
  </a>
    </span></p>
<p>네트워크 탭을 보면, 삭제 요청이 완료된 즉시 조회 요청이 간 것을 볼 수 있다. 이 방식을 사용할 경우, 서버 데이터가 새롭게 조회되어 클라이언트의 데이터가 변경되고 화면이 새롭게 그려진다.</p>
<p>하지만, 만약 서버에 여러 시스템이 연동되어 있을 경우 혹은 서버에서 데이터 변경에 딜레이가 걸린 경우에, 변경 내용이 반영되지 않은 채 변경 전 데이터가 조회될 가능성이 있다. 서버가 비동기로 동작하거나 적용 되는데 시간이 걸리는 경우이다.</p>
<p>가령, Google API에서 Drive File API에 삭제 요청을 했고, Drive File과 연동되어 있는 Doc File을 재조회 한다면 1초 미만의 텀을 주어야 정상적으로 파일이 삭제된 list를 받아올 수 있다. 이런 경우, 딜레이를 주어 재조회 해줄 수 있다.</p>
<div class="gatsby-highlight has-highlighted-lines" data-language="ts"><pre class="language-ts"><code class="language-ts"><span class="token function">onSuccess</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="gatsby-highlight-code-line">  <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></span>    queryClient<span class="token punctuation">.</span><span class="token function">invalidateQueries</span><span class="token punctuation">(</span><span class="token punctuation">{</span> queryKey<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token constant">DIARY_KEY</span><span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="gatsby-highlight-code-line">  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">800</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><span class="token punctuation">}</span></code></pre></div>
<p>하지만, 이 작업을 할 경우 mutation시 동작했던, loading spinner가 한 번 나타나고, 다시 query할 때 나타나는 loading spinner가 이어서 나타난다.</p>
<p><img src="/1b45c2793985f54d371a5d996d5d4320/loading-spinner-twice.gif" alt="loading-spinner-twice"/></p>
<p>loading spinner를 띄우는 조건을 다르게 주면 해결되겠지만, 따로 처리를 해주어야 하는 번거로움이 생긴다. 또 다른 문제도 있다. <code class="language-text">800ms</code> 이 정확한 수치가 아니다. 서버의 상태에 따라 시간을 더 많이 줘야할 수도 있다. 서버의 데이터가 정합성을 맞추는데 시간이 걸리는 상태라면, 다시 변경되지 않은 데이터가 조회될 확률이 높기 때문이다.</p>
<hr/>
<p>2가지 중 서버 데이터로 클라이언트 데이터를 변경하는 방법을 알아봤다. Best Case는 서버에서 변경된 데이터를 정확하게 response에 담아 내려준다면 클라이언트에서 받아 화면을 새롭게 그려주는 <code class="language-text">setQueryData</code> 메서드를 사용한 방법이다. 하지만 서버에서 데이터를 내려주지 못하는 상황이라면, 클라이언트에서 요청을 보낸 데이터를 기반으로 화면을 그려주는 방법도 존재한다.</p>
<br/>
<h2 id="2-요청-데이터로-클라이언트-데이터-변경" style="position:relative">2. 요청 데이터로 클라이언트 데이터 변경<a href="#2-%EC%9A%94%EC%B2%AD-%EB%8D%B0%EC%9D%B4%ED%84%B0%EB%A1%9C-%ED%81%B4%EB%9D%BC%EC%9D%B4%EC%96%B8%ED%8A%B8-%EB%8D%B0%EC%9D%B4%ED%84%B0-%EB%B3%80%EA%B2%BD" aria-label="2 요청 데이터로 클라이언트 데이터 변경 permalink" class="auto-link after"><svg viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a></h2>
<p>요청 할 때 보내는 클라이언트의 데이터 기반으로 스스로의 데이터를 변경할 수 있다.</p>
<ol>
<li>직접 가공 (getQueryData &amp; setQueryData 또는 setQueryData &amp; Updater 메서드)</li>
<li>낙관적 업데이트 - Optimistic Update(onMutate 메서드)</li>
</ol>
<h3 id="21-직접-가공" style="position:relative">2.1 직접 가공<a href="#21-%EC%A7%81%EC%A0%91-%EA%B0%80%EA%B3%B5" aria-label="21 직접 가공 permalink" class="auto-link after"><svg viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a></h3>
<h4 id="getQueryData--setQueryData-메서드-조합" style="position:relative">getQueryData &amp; setQueryData 메서드 조합<a href="#getQueryData--setQueryData-%EB%A9%94%EC%84%9C%EB%93%9C-%EC%A1%B0%ED%95%A9" aria-label="getQueryData  setQueryData 메서드 조합 permalink" class="auto-link after"><svg viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a></h4>
<p>react-query의 <code class="language-text">getQueryData</code>는 조회한 데이터 캐시의 데이터를 가져오는 작업이다. onSucess의 두 번째 인자로, 요청 시 보냈던 값을 받아올 수 있다.</p>
<div class="gatsby-highlight has-highlighted-lines" data-language="ts"><pre class="language-ts"><code class="language-ts"><span class="token function">onSuccess</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span> variables<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// variables는 mutate함수가 받는 변수다.</span>
<span class="gatsby-highlight-code-line">  <span class="token keyword">const</span> oldData <span class="token operator">=</span> queryClient<span class="token punctuation">.</span><span class="token generic-function"><span class="token function">getQueryData</span><span class="token generic class-name"><span class="token operator">&lt;</span>DriveFile<span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token constant">DIARY_KEY</span><span class="token punctuation">,</span> <span class="token string">&#x27;docList&#x27;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>  queryClient<span class="token punctuation">.</span><span class="token generic-function"><span class="token function">setQueryData</span><span class="token generic class-name"><span class="token operator">&lt;</span>DriveFile<span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token constant">DIARY_KEY</span><span class="token punctuation">,</span> <span class="token string">&#x27;docList&#x27;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    <span class="token operator">...</span>oldData<span class="token punctuation">,</span>
<span class="gatsby-highlight-code-line">    files<span class="token operator">:</span> oldData<span class="token operator">?.</span>files<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span>file <span class="token operator">=&gt;</span> file<span class="token punctuation">.</span>id <span class="token operator">!==</span> variables<span class="token punctuation">)</span> <span class="token keyword">as</span> File<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span></span>  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre></div>
<p><code class="language-text">getQueryData</code>를 통해 변경되기 전 데이터를 캐시에서 조회한다. 그리고, <code class="language-text">filter</code>와 같은 메서드로 캐시 데이터를 가공한다. 이후에, 가공한 데이터를 불변성을 지켜서 <code class="language-text">setQueryData</code> 메서드의 인자로 넣어준다. 그러면, 클라이언트의 데이터가 변경되며, query를 선언한 컴포넌트가 리렌더링 되면서 화면이 새롭게  그려진다.</p>
<p>📌 주의점은 반드시 불변성을 지켜서 넣어주어야 한다. 불변성을 지켜주지 않으면 화면이 변경되지 않는다.</p>
<p>데이터 흐름은 아래와 같다.</p>
<ul>
<li><code class="language-text">클라이언트 -&gt; 서버</code> : 데이터 변경 요청</li>
<li><code class="language-text">서버 -&gt; 클라이언트</code> : 성공 message 반환</li>
<li>클라이언트 데이터 스스로 가공 후 변경</li>
</ul>
<h4 id="setQueryData--Updater-메서드-조합" style="position:relative">setQueryData &amp; Updater 메서드 조합<a href="#setQueryData--Updater-%EB%A9%94%EC%84%9C%EB%93%9C-%EC%A1%B0%ED%95%A9" aria-label="setQueryData  Updater 메서드 조합 permalink" class="auto-link after"><svg viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a></h4>
<p>getQueryData를 사용하지 않고 <code class="language-text">setQueryData</code> 만 사용하는 방법이다. 이 방법은 캐시에서 다시 조회하는 로직이 없어도 useMutation 자체에서 제공하는 방법이다. 업데이터 함수를 선언하면 알아서 클라이언트 데이터를 변경시켜준다.</p>
<div class="gatsby-highlight has-highlighted-lines" data-language="ts"><pre class="language-ts"><code class="language-ts"><span class="token function">onSuccess</span><span class="token punctuation">(</span>_<span class="token punctuation">,</span> variables<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  queryClient<span class="token punctuation">.</span><span class="token generic-function"><span class="token function">setQueryData</span><span class="token generic class-name"><span class="token operator">&lt;</span>DriveFile<span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token constant">DIARY_KEY</span><span class="token punctuation">,</span> <span class="token string">&#x27;docList&#x27;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="gatsby-highlight-code-line">    <span class="token punctuation">(</span>oldData<span class="token punctuation">)</span><span class="token operator">:</span> DriveFile <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{</span></span><span class="gatsby-highlight-code-line">      <span class="token operator">...</span>oldData<span class="token punctuation">,</span></span><span class="gatsby-highlight-code-line">      files<span class="token operator">:</span> oldData<span class="token operator">?.</span>files<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span>file <span class="token operator">=&gt;</span> file<span class="token punctuation">.</span>id <span class="token operator">!==</span> variables<span class="token punctuation">)</span> <span class="token keyword">as</span> File<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span></span><span class="gatsby-highlight-code-line">    <span class="token punctuation">}</span><span class="token punctuation">)</span></span>  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span></code></pre></div>
<p><code class="language-text">setQueryData</code>의 두번째 인자로 함수를 넣어줄 수 있는데, 이것이 업데이터 함수이다. 업데이터 함수는 react의 setState 함수와 사용법이 동일하다. 인자로 기존 쿼리한 데이터를 가지고 오며, 쿼리한 데이터를 기반으로 가공한 값을 불변성을 지켜 반환하면, 캐시된 데이터가 업데이트 되고 화면이 리렌더링 된다.</p>
<p>첫번째 방법처럼, 조회 한 후 업데이트 하기보다는 업데이터 함수를 사용하는 방법이 좀 더 간편하다고 느껴진다. 데이터의 흐름은 동일하다.</p>
<h3 id="22-낙관적-업데이트---Optimistic-UpdateonMutate-메서드" style="position:relative">2.2 낙관적 업데이트 - Optimistic Update(onMutate 메서드)<a href="#22-%EB%82%99%EA%B4%80%EC%A0%81-%EC%97%85%EB%8D%B0%EC%9D%B4%ED%8A%B8---Optimistic-UpdateonMutate-%EB%A9%94%EC%84%9C%EB%93%9C" aria-label="22 낙관적 업데이트   Optimistic UpdateonMutate 메서드 permalink" class="auto-link after"><svg viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a></h3>
<p>낙관적 업데이트(Optimistic Update)란 단어가 어색하게 느껴질 수 있지만, 낙관적이라는 말은 서버로 보낸 요청이 정상적일 것을 예상하고, 클라이언트의 데이터를 변경시켜 요청 response가 오기 전에 클라이언트의 데이터를 미리 변경시키는 작업을 말한다. 이는 useMutateion 훅에서 <code class="language-text">onSuccess</code> 대신 <code class="language-text">onMutate</code> 메서드와 <code class="language-text">onError</code> 메서드를 조합하여 구현할 수 있다.</p>
<div class="gatsby-highlight" data-language="ts"><pre class="language-ts"><code class="language-ts"><span class="token function-variable function">onMutate</span><span class="token operator">:</span> <span class="token keyword">async</span> variables <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// refetch 메서드가 사용되지 않도록 미리 막아둠.</span>
  <span class="token keyword">await</span> queryClient<span class="token punctuation">.</span><span class="token function">cancelQueries</span><span class="token punctuation">(</span><span class="token punctuation">{</span> queryKey<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token constant">DIARY_KEY</span><span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">const</span> oldData <span class="token operator">=</span> queryClient<span class="token punctuation">.</span><span class="token generic-function"><span class="token function">getQueryData</span><span class="token generic class-name"><span class="token operator">&lt;</span>DriveFile<span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token constant">DIARY_KEY</span><span class="token punctuation">,</span> <span class="token string">&#x27;docList&#x27;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  queryClient<span class="token punctuation">.</span><span class="token generic-function"><span class="token function">setQueryData</span><span class="token generic class-name"><span class="token operator">&lt;</span>DriveFile<span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token constant">DIARY_KEY</span><span class="token punctuation">,</span> <span class="token string">&#x27;docList&#x27;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    <span class="token operator">...</span>oldData<span class="token punctuation">,</span>
    files<span class="token operator">:</span> oldData<span class="token operator">?.</span>files<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span>file <span class="token operator">=&gt;</span> file<span class="token punctuation">.</span>id <span class="token operator">!==</span> variables<span class="token punctuation">)</span> <span class="token keyword">as</span> File<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> <span class="token punctuation">{</span> oldData <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token function-variable function">onError</span><span class="token operator">:</span> <span class="token punctuation">(</span>err<span class="token punctuation">,</span> newTodo<span class="token punctuation">,</span> context<span class="token operator">:</span> <span class="token punctuation">{</span> oldData<span class="token operator">:</span> DriveFile <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// 에러가 발생하면, 기존 데이터 폴백</span>
  queryClient<span class="token punctuation">.</span><span class="token function">setQueryData</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token constant">DIARY_KEY</span><span class="token punctuation">,</span> <span class="token string">&#x27;docList&#x27;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token operator">...</span>context<span class="token punctuation">.</span>oldData <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span></code></pre></div>
<p>onMutate 메서드 안에는 API 요청이 성공했을 경우를 가정하고, 데이터를 가공해 화면을 업데이트 한다. 특이한 부분은 <code class="language-text">cancelQueries</code> 를 사용한다는 점인데, cancelQueries는 API 요청 이후에 발생하는 요청을 취소하는 메서드이므로 요청이 Error가 발생했다면 refetch가 일어나지 않도록 방지하는 역할을 해준다.</p>
<p>onMutate 메서드의 아래 부분은 <strong>캐시 데이터를 직접 가공</strong>하는 부분과 동일하다.</p>
<p>onError 메서드는 API 요청을 보내 성공을 가정하고 화면은 업데이트 했지만, 실패한 사례에 대한 처리 로직이 들어간다. 만약 서버에서 에러를 반환했다면 기존 데이터로 폴백한다. <code class="language-text">context</code> 에는 요청을 보냈을 당시의 데이터가 담겨있다.</p>
<p><img src="/c05676c16b087e534d2580f23fbd2990/optimistic-updates.gif" alt="optimistic-updates"/></p>
<p>데이터 흐름은 아래와 같다.</p>
<ul>
<li><code class="language-text">클라이언트 -&gt; 서버</code> : 데이터 변경 요청</li>
<li>성공 response가 돌아오지 않아도, 클라이언트 데이터 스스로 가공 후 변경
<ul>
<li>만약 실패 시 기존 데이터로 폴백</li>
</ul>
</li>
</ul>
<hr/>
<br/>
<h2 id="정리" style="position:relative">정리<a href="#%EC%A0%95%EB%A6%AC" aria-label="정리 permalink" class="auto-link after"><svg viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a></h2>
<p>React Query에서 mutation 이후 데이터를 통해 화면을 업데이트 하는 방법은 아래와 같다.</p>
<ul>
<li><strong>서버에서</strong> 조회한 데이터로 클라이언트 데이터 업데이트
<ul>
<li>response에 변경된 데이터 받기</li>
<li>재조회</li>
</ul>
</li>
<li><strong>클라이언트에서</strong> 요청 데이터로 적용
<ul>
<li>직접 가공</li>
<li>낙관적 업데이트</li>
</ul>
</li>
</ul>
<p>각 방법에 따라 장단점이 있기 때문에 데이터의 중요도에 따라, 서버 개발자와의 커뮤니케이션을 통해 적절한 방법을 선택할 수 있다. 내가 생각하기에 어떤 상황에서 사용하면 좋을지 예상해보았다.</p>
<ul>
<li>response에 변경된 데이터 받기 : 가장 정확하고 신뢰할만한 업데이트. 따라서 중요한 데이터를 표시해주어야 한다면 이 방법을 선택할 것이다. 예를 들어 로그인 처리 혹은 결제 처리.</li>
<li>재조회, 직접 가공 : 서버의 상황이 좋지 않거나, response가 확실하다고 보장하지 못할 때.</li>
<li>낙관적 업데이트 : 데이터가 크게 중요하지 않지만, 사용자에게 빠른 피드백을 보여주고 싶을 때. 예를 들어 SNS의 좋아요 기능.</li>
</ul>
<br/>
<h2 id="마치며" style="position:relative">마치며<a href="#%EB%A7%88%EC%B9%98%EB%A9%B0" aria-label="마치며 permalink" class="auto-link after"><svg viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a></h2>
<p>React Query의 mutation 이후 데이터 처리 방법에 대해서 알아봤다.</p>
<p>React Query를 사용하지 않고 이전에 개발할 때는, 데이터를 페칭할 때 무조건 로딩 표시를 통해 사용자에게 기다리게 했다. 하지만 중요도에 따라, 또 서버의 상태에 따라 여러 UX를 구현할 수 있다는 점을 알게 되었다.</p>
<p>서버 데이터와 클라이언트 데이터를 서로 격리 시켜 다룬다는 개념도 신선했지만 데이터 페칭과 관련된 라이브러리로 특화되어 있기 때문에 UX와 관련된 다양한 기능이 개발되지 않았나 생각한다. 특히 사용자의 디바이스 성능이 올라감에 따라 여러 UX를 표현할 수 있게 되었고, 데이터를 캐싱하거나 서버와의 데이터를 ‘연동’ 한다는 개념이 생긴 것 같다. (엄밀히 말하면 연동은 아님. React Query에서는 request와 response가 지속적으로 일어나는 매커니즘을 갖고 있기 때문이며 커넥션을 계속 가지고 있지 않기 때문이다.)</p>
<blockquote>
<p>참고</p>
<ul>
<li><a href="https://tkdodo.eu/blog/mastering-mutations-in-react-query" target="_blank" rel="nofollow">https://tkdodo.eu/blog/mastering-mutations-in-react-query</a></li>
<li><a href="https://tanstack.com/query/latest/docs/react/guides/optimistic-updates" target="_blank" rel="nofollow">https://tanstack.com/query/latest/docs/react/guides/optimistic-updates</a></li>
</ul>
</blockquote></div></section></article><style data-emotion="css 17876f4">.css-17876f4{position:relative;box-sizing:border-box;width:100%;max-width:760px;margin-left:auto;margin-right:auto;}</style><div class="css-17876f4"><div></div></div></div></main><style data-emotion="css dcfhc9">.css-dcfhc9{position:relative;padding:0 5vw;}</style><style data-emotion="css 1aa7tg3">.css-1aa7tg3{border-bottom:1px solid rgba(255, 255, 255, 0.1);background:#0a0b0c;position:relative;padding:0 5vw;}.css-1aa7tg3 .post-card{padding-bottom:0;border-bottom:none;}.css-1aa7tg3 .post-card:after{display:none;}.css-1aa7tg3 .post-card-primary-tag{color:#fff;opacity:0.6;}.css-1aa7tg3 .post-card-title{color:#fff;opacity:0.8;-webkit-transition:all 0.2s ease-in-out;transition:all 0.2s ease-in-out;}.css-1aa7tg3 .post-card:hover .post-card-image{opacity:1;}.css-1aa7tg3 .post-card-excerpt{color:rgba(255, 255, 255, 0.6);}.css-1aa7tg3 .static-avatar{border-color:#000;}.css-1aa7tg3 .post-card-byline-content{color:rgba(255, 255, 255, 0.6);}.css-1aa7tg3 .post-card-byline-content a{color:rgba(255, 255, 255, 0.8);}.css-1aa7tg3 .author-avatar{border-color:#0a0b0c;}.css-1aa7tg3 .author-profile-image{background:#0a0b0c;}@media (max-width: 650px){.css-1aa7tg3 .post-card{-webkit-flex:1 1 auto;-ms-flex:1 1 auto;flex:1 1 auto;margin:25px;padding:25px 0 0;border-bottom:1px solid rgba(255, 255, 255, 0.1);}}</style><aside class="read-next css-1aa7tg3 eu5ixib1"><div class="css-y521qa"><style data-emotion="css 1ehfk3g">.css-1ehfk3g{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-flex-wrap:wrap;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;margin:0 -25px;padding:60px 0 0 0;}</style><div class="read-next-feed css-1ehfk3g eu5ixib0"><style data-emotion="css vxrpic">.css-vxrpic{position:relative;-webkit-flex:1 1 301px;-ms-flex:1 1 301px;flex:1 1 301px;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;overflow:hidden;margin:0 20px 60px;min-height:220px;-webkit-background-size:cover;background-size:cover;-webkit-transition:0.4s ease;transition:0.4s ease;}.css-vxrpic:hover{-webkit-transform:translateY(-2px);-moz-transform:translateY(-2px);-ms-transform:translateY(-2px);transform:translateY(-2px);}</style><article class="post-card   css-vxrpic"><style data-emotion="css 16xcmry">.css-16xcmry{position:relative;display:block;overflow:hidden;border-radius:12px;}</style><a class="post-card-image-link css-16xcmry" href="/diary/geultto-8-retrospect/"><style data-emotion="css 16etra8">.css-16etra8{width:auto;height:200px;background:#fff no-repeat center center;-webkit-background-size:cover;background-size:cover;border-radius:12px;border:1px solid hsl(230deg 25% 94%);}.css-16etra8 img{border-radius:12px;}@media (prefers-color-scheme: dark){.css-16etra8{background:#191b1f;border:1px solid hsl(230deg 6% 23%);}}.css-16etra8.is-next{border:1px solid hsl(230deg 6% 23%);}</style><div class="post-card-image is-next css-16etra8 e1qfhan17"><div data-gatsby-image-wrapper="" style="height:100%" class="gatsby-image-wrapper"><div aria-hidden="true" style="padding-top:56.97329376854599%"></div><img aria-hidden="true" data-placeholder-image="" style="opacity:1;transition:opacity 500ms linear" decoding="async" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAACE3AAAhNwEzWJ96AAABSklEQVQoz6WTu6rCQBCGfSZ9A5/AImCTTiI2ghokJLhRMAYsxcYyTTrFp5BcwEvjWwhCCBKS2ZnDLgSC6DnKGVh2io+P3Z1/a1QpRCx3pD+qZJ7R2gtOEo/HIzufz3kcxxCGIQRBAFEUwel0ytM0zSpSfCsUAOdctsvlMqnX64WqqlzTNOj1etDpdHij0QDGWCIYwT7f5q3QNE2Yz+cUBAExxuh2u0lmsVjQYDCA8oAfCxljhW3bst/v93i9XhEA0HVd0nW9+Fo4mUyK6XQq+zAMqdls0m63w9VqJU74vXA2mxWGYdD9fsfD4YDdbhe32y06jkPj8fh7oWEYoCgKrddr8jyPfN+nzWZD7Xab+v3+528IALK1bTtptVqFZVl8OByCGIRpmlxRFBiNRnLKgv1VWM1hlmXZ5XLJj8cjVJfIpsjopzn890/5AT9vF1I4Ou42AAAAAElFTkSuQmCC" alt=""/><picture><source type="image/webp" data-srcset="/static/53fe681b532753855e5826673a894e9a/15c6e/main.webp 674w" sizes="100vw"/><img data-gatsby-image-ssr="" data-main-image="" style="opacity:0" sizes="100vw" decoding="async" loading="lazy" data-src="/static/53fe681b532753855e5826673a894e9a/44f99/main.png" data-srcset="/static/53fe681b532753855e5826673a894e9a/44f99/main.png 674w" alt="글또 8기 회고 cover image"/></picture><noscript><picture><source type="image/webp" srcSet="/static/53fe681b532753855e5826673a894e9a/15c6e/main.webp 674w" sizes="100vw"/><img data-gatsby-image-ssr="" data-main-image="" style="opacity:0" sizes="100vw" decoding="async" loading="lazy" src="/static/53fe681b532753855e5826673a894e9a/44f99/main.png" srcSet="/static/53fe681b532753855e5826673a894e9a/44f99/main.png 674w" alt="글또 8기 회고 cover image"/></picture></noscript><script type="module">const t="undefined"!=typeof HTMLImageElement&&"loading"in HTMLImageElement.prototype;if(t){const t=document.querySelectorAll("img[data-main-image]");for(let e of t){e.dataset.src&&(e.setAttribute("src",e.dataset.src),e.removeAttribute("data-src")),e.dataset.srcset&&(e.setAttribute("srcset",e.dataset.srcset),e.removeAttribute("data-srcset"));const t=e.parentNode.querySelectorAll("source[data-srcset]");for(let e of t)e.setAttribute("srcset",e.dataset.srcset),e.removeAttribute("data-srcset");e.complete&&(e.style.opacity=1,e.parentNode.parentNode.querySelector("[data-placeholder-image]").style.opacity=0)}}</script></div></div></a><style data-emotion="css 1lh7kdz">.css-1lh7kdz{-webkit-box-flex:1;-webkit-flex-grow:1;-ms-flex-positive:1;flex-grow:1;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;}</style><div class="post-card-content css-1lh7kdz e1qfhan16"><style data-emotion="css 18bk8u1">.css-18bk8u1{margin:15px 0 0.2em;color:#90a2aa;font-size:1.3rem;font-weight:500;letter-spacing:0.2px;}</style><div class="post-card-primary-tag css-18bk8u1 e1qfhan15"><a href="/tags/diary/">Diary</a></div><style data-emotion="css 1fjrpmt">.css-1fjrpmt{position:relative;display:block;color:#15171A;}.css-1fjrpmt:hover{-webkit-text-decoration:none;text-decoration:none;}</style><a class="post-card-content-link css-1fjrpmt" href="/diary/geultto-8-retrospect/"><header class="post-card-header css-0 e1qfhan10"><style data-emotion="css 3lgx4i">.css-3lgx4i{margin:0 0 0.4em;line-height:1.15em;-webkit-transition:color 0.2s ease-in-out;transition:color 0.2s ease-in-out;}@media (prefers-color-scheme: dark){.css-3lgx4i{color:rgba(255, 255, 255, 0.85);}}</style><h2 class="post-card-title css-3lgx4i e1qfhan14">글또 8기 회고</h2></header><style data-emotion="css 1hvq4qv">.css-1hvq4qv{font-size:1.6rem;}@media (prefers-color-scheme: dark){.css-1hvq4qv{color:#768086;}}.css-1hvq4qv p{width:100%;overflow:hidden;text-overflow:ellipsis;display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;margin-bottom:0.8em;}</style><section class="post-card-excerpt css-1hvq4qv e1qfhan13"><p>6개월 간 참여한 글또 활동 회고. 글쓰기에 대해서.</p></section></a><style data-emotion="css 143c7df">.css-143c7df{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:flex-start;-webkit-box-align:flex-start;-ms-flex-align:flex-start;align-items:flex-start;padding:0;}</style><footer class="post-card-meta css-143c7df e1qfhan12"><style data-emotion="css 1ja96fr">.css-1ja96fr{-webkit-flex:1 1 50%;-ms-flex:1 1 50%;flex:1 1 50%;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;color:#90a2aa;line-height:1.4em;font-weight:400;letter-spacing:0.2px;}.css-1ja96fr time{font-size:1.3rem;}.css-1ja96fr span{margin:0;font-size:1.3rem;}.css-1ja96fr a{color:#434952;font-weight:600;}@media (prefers-color-scheme: dark){.css-1ja96fr a{color:rgba(255, 255, 255, 0.75);}}</style><div class="post-card-byline-content css-1ja96fr e1qfhan11"><span class="post-card-byline-date"><time dateTime="2023-07-16">2023 07 16</time> <span class="bull">•</span> <span>16 min read</span></span></div></footer></div></article><article class="post-card   css-vxrpic"><a class="post-card-image-link css-16xcmry" href="/tools/alfred-korean-english-converter/"><div class="post-card-image is-next css-16etra8 e1qfhan17"><div data-gatsby-image-wrapper="" style="height:100%" class="gatsby-image-wrapper"><div aria-hidden="true" style="padding-top:47.17223650385604%"></div><img aria-hidden="true" data-placeholder-image="" style="opacity:1;transition:opacity 500ms linear" decoding="async" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAABYlAAAWJQFJUiTwAAABqUlEQVQoz12R227aQBRF/d6qCRdje65nbIPBEGiqJmpICRen/f8/WtUMUZr2Ycmj8Whpn7Oz3DfYRY9pV8xcQ+5qCmkZW0HPV4R+m/6rtkP6O/xyw0xabpRjZITxf2S67ui33+nW97h6iQkdtllRhTkzV5ObQG5rZrZmakLCzXuk26DCIoUoPpDFi4StKX2D8i1GWioTKIxQmMAsUaNkQSVzmn5H2+8wzZLCtZT+L1mMObFC7gKlE4wXtHU8Pu15OQ887A/cPz2z+vbI50LzRbn0/VToNHZczT8jJ5kNVC5gvRBCYLfZMJzODJeB0/HM8Xjmx/5Au9owX29ZrHd06x2mXTLSMVB4J5taoXQB5wPee5qm4fcw8Osy8PP5wMvhyOXyyun8yt3XB5rlhnm/TZi24zphYGwCk5iwsIJxAS+CiMd7QRlLqR0z7ciVY6ock8oxKj23leemctwqR248hQvEUBN7FWfKCs5LEkZZTGp9QLtAZWMxdSKWkuvY+vUcV2TiOy9JGteWWyH7KLuK5E10bTdJdM1UB3IVmOo63au0JknSKC/fevgD85v42YDwquYAAAAASUVORK5CYII=" alt=""/><picture><source type="image/webp" data-srcset="/static/24a1413e882f06cfbb3af834a3ff3897/b665d/main.webp 750w,/static/24a1413e882f06cfbb3af834a3ff3897/71b9a/main.webp 1080w,/static/24a1413e882f06cfbb3af834a3ff3897/9aed2/main.webp 1366w,/static/24a1413e882f06cfbb3af834a3ff3897/cf8f0/main.webp 1556w" sizes="100vw"/><img data-gatsby-image-ssr="" data-main-image="" style="opacity:0" sizes="100vw" decoding="async" loading="lazy" data-src="/static/24a1413e882f06cfbb3af834a3ff3897/252b8/main.png" data-srcset="/static/24a1413e882f06cfbb3af834a3ff3897/13110/main.png 750w,/static/24a1413e882f06cfbb3af834a3ff3897/6f9ad/main.png 1080w,/static/24a1413e882f06cfbb3af834a3ff3897/bf69c/main.png 1366w,/static/24a1413e882f06cfbb3af834a3ff3897/252b8/main.png 1556w" alt="한영타변환기 Alfred Workflow 개발기 cover image"/></picture><noscript><picture><source type="image/webp" srcSet="/static/24a1413e882f06cfbb3af834a3ff3897/b665d/main.webp 750w,/static/24a1413e882f06cfbb3af834a3ff3897/71b9a/main.webp 1080w,/static/24a1413e882f06cfbb3af834a3ff3897/9aed2/main.webp 1366w,/static/24a1413e882f06cfbb3af834a3ff3897/cf8f0/main.webp 1556w" sizes="100vw"/><img data-gatsby-image-ssr="" data-main-image="" style="opacity:0" sizes="100vw" decoding="async" loading="lazy" src="/static/24a1413e882f06cfbb3af834a3ff3897/252b8/main.png" srcSet="/static/24a1413e882f06cfbb3af834a3ff3897/13110/main.png 750w,/static/24a1413e882f06cfbb3af834a3ff3897/6f9ad/main.png 1080w,/static/24a1413e882f06cfbb3af834a3ff3897/bf69c/main.png 1366w,/static/24a1413e882f06cfbb3af834a3ff3897/252b8/main.png 1556w" alt="한영타변환기 Alfred Workflow 개발기 cover image"/></picture></noscript><script type="module">const t="undefined"!=typeof HTMLImageElement&&"loading"in HTMLImageElement.prototype;if(t){const t=document.querySelectorAll("img[data-main-image]");for(let e of t){e.dataset.src&&(e.setAttribute("src",e.dataset.src),e.removeAttribute("data-src")),e.dataset.srcset&&(e.setAttribute("srcset",e.dataset.srcset),e.removeAttribute("data-srcset"));const t=e.parentNode.querySelectorAll("source[data-srcset]");for(let e of t)e.setAttribute("srcset",e.dataset.srcset),e.removeAttribute("data-srcset");e.complete&&(e.style.opacity=1,e.parentNode.parentNode.querySelector("[data-placeholder-image]").style.opacity=0)}}</script></div></div></a><div class="post-card-content css-1lh7kdz e1qfhan16"><div class="post-card-primary-tag css-18bk8u1 e1qfhan15"><a href="/tags/tool/">Tool</a>,  <a href="/tags/alfred/">Alfred</a>,  <a href="/tags/automation/">Automation</a></div><a class="post-card-content-link css-1fjrpmt" href="/tools/alfred-korean-english-converter/"><header class="post-card-header css-0 e1qfhan10"><h2 class="post-card-title css-3lgx4i e1qfhan14">한영타변환기 Alfred Workflow 개발기</h2></header><section class="post-card-excerpt css-1hvq4qv e1qfhan13"><p>dlfjgrp Tjwlseks akfdlek. dlrp sjan Qkrclseks akfdlek. zzzz...</p></section></a><footer class="post-card-meta css-143c7df e1qfhan12"><div class="post-card-byline-content css-1ja96fr e1qfhan11"><span class="post-card-byline-date"><time dateTime="2023-06-10">2023 06 10</time> <span class="bull">•</span> <span>16 min read</span></span></div></footer></div></article></div></div></aside><style data-emotion="css d4eprp">.css-d4eprp{position:relative;padding:0 5vw;position:relative;padding-top:20px;padding-bottom:22px;color:#fff;background:#000;}</style><footer class="css-d4eprp"><style data-emotion="css 1d3gyi8">.css-1d3gyi8{margin:0 auto;max-width:1040px;width:100%;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-flex-wrap:wrap;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;color:rgba(255, 255, 255, 0.7);font-size:1.3rem;}.css-1d3gyi8 a{color:rgba(255, 255, 255, 0.7);}.css-1d3gyi8 a:hover{color:rgba(255, 255, 255, 1);-webkit-text-decoration:none;text-decoration:none;}@media (max-width: 650px){.css-1d3gyi8{-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;}}</style><div class="css-1d3gyi8"><section class="copyright">© <!-- -->2023<!-- --> <span>|  </span><a href="https://www.gatsbyjs.com/" target="_blank" rel="nofollow">Pozafly Blog<!-- --> <!-- -->is based on Gatsby Casper</a></section><style data-emotion="css 13qgqyf">.css-13qgqyf{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;}.css-13qgqyf a{position:relative;margin-left:20px;font-size:1.3rem;}.css-13qgqyf a:before{content:'';position:absolute;top:11px;left:-11px;display:block;width:2px;height:2px;background:#fff;border-radius:100%;}.css-13qgqyf a:first-of-type:before{display:none;}@media (max-width: 650px){.css-13qgqyf a:first-of-type{margin-left:0;}}</style><nav class="css-13qgqyf e1me3zb40"><a href="/">Latest Posts</a><a href="https://www.instagram.com/pozafly_/" target="_blank" rel="noopener noreferrer">Instagram</a><a href="https://github.com/pozafly" target="_blank" rel="noopener noreferrer">Github</a><a href="/rss.xml">RSS</a></nav></div></footer></div></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/react-query/mutation-after-data-update/";/*]]>*/</script><!-- slice-start id="_gatsby-scripts-1" -->
          <script
            id="gatsby-chunk-mapping"
          >
            window.___chunkMapping="{\"app\":[\"/app-2b844a9ac23d00adf972.js\"],\"component---src-pages-404-tsx\":[\"/component---src-pages-404-tsx-7e56e5f698fc1b8ecad4.js\"],\"component---src-pages-about-tsx\":[\"/component---src-pages-about-tsx-537864e8821dcd6ae890.js\"],\"component---src-pages-tags-tsx\":[\"/component---src-pages-tags-tsx-c5a6a097c880bb175278.js\"],\"component---src-templates-author-tsx\":[],\"component---src-templates-index-tsx\":[\"/component---src-templates-index-tsx-b5c37eca4d84495d41dd.js\"],\"component---src-templates-post-tsx\":[],\"component---src-templates-tags-tsx\":[\"/component---src-templates-tags-tsx-115dcf3868904aa97209.js\"]}";
          </script>
        <script>window.___webpackCompilationHash="75d2121c37a871c18e24";</script><script src="/webpack-runtime-5528c5ccf41e149d05ff.js" async></script><script src="/framework-5332a90d114fef29dbe7.js" async></script><script src="/app-2b844a9ac23d00adf972.js" async></script><!-- slice-end id="_gatsby-scripts-1" --></body></html>