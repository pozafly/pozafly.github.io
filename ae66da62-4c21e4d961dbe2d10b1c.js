"use strict";(self.webpackChunkrecord_journey=self.webpackChunkrecord_journey||[]).push([[9164],{9636:function(t,e,a){a.d(e,{DA:function(){return w},IU:function(){return C},U:function(){return B},U7:function(){return Se},U_:function(){return ke},Zk:function(){return h},aP:function(){return xe},gh:function(){return $e},lC:function(){return g},on:function(){return we}});var n=a(267),s=a(9951),l=a(5855),r=a(9420),i=a(7155),o=a(4991),c=a(726),h=(0,i.K2)(async(t,e,a)=>{let n;const s=e.useHtmlLabels||(0,i._3)((0,i.D7)()?.htmlLabels);n=a||"node default";const c=t.insert("g").attr("class",n).attr("id",e.domId||e.id),h=c.insert("g").attr("class","label").attr("style",(0,r.KL)(e.labelStyle));let d;d=void 0===e.label?"":"string"==typeof e.label?e.label:e.label[0];const g=await(0,l.GZ)(h,(0,i.jZ)((0,r.Sm)(d),(0,i.D7)()),{useHtmlLabels:s,width:e.width||(0,i.D7)().flowchart?.wrappingWidth,cssClasses:"markdown-node-label",style:e.labelStyle,addSvgBackground:!!e.icon||!!e.img});let y=g.getBBox();const p=(e?.padding??0)/2;if(s){const t=g.children[0],e=(0,o.Ltv)(g),a=t.getElementsByTagName("img");if(a){const t=""===d.replace(/<img[^>]*>/g,"").trim();await Promise.all([...a].map(e=>new Promise(a=>{function n(){if(e.style.display="flex",e.style.flexDirection="column",t){const t=(0,i.D7)().fontSize?(0,i.D7)().fontSize:window.getComputedStyle(document.body).fontSize,a=5,[n=i.UI.fontSize]=(0,r.I5)(t),s=n*a+"px";e.style.minWidth=s,e.style.maxWidth=s}else e.style.width="100%";a(e)}(0,i.K2)(n,"setupImage"),setTimeout(()=>{e.complete&&n()}),e.addEventListener("error",n),e.addEventListener("load",n)})))}y=t.getBoundingClientRect(),e.attr("width",y.width),e.attr("height",y.height)}return s?h.attr("transform","translate("+-y.width/2+", "+-y.height/2+")"):h.attr("transform","translate(0, "+-y.height/2+")"),e.centerLabel&&h.attr("transform","translate("+-y.width/2+", "+-y.height/2+")"),h.insert("rect",":first-child"),{shapeSvg:c,bbox:y,halfPadding:p,label:h}},"labelHelper"),d=(0,i.K2)(async(t,e,a)=>{const n=a.useHtmlLabels||(0,i._3)((0,i.D7)()?.flowchart?.htmlLabels),s=t.insert("g").attr("class","label").attr("style",a.labelStyle||""),c=await(0,l.GZ)(s,(0,i.jZ)((0,r.Sm)(e),(0,i.D7)()),{useHtmlLabels:n,width:a.width||(0,i.D7)()?.flowchart?.wrappingWidth,style:a.labelStyle,addSvgBackground:!!a.icon||!!a.img});let h=c.getBBox();const d=a.padding/2;if((0,i._3)((0,i.D7)()?.flowchart?.htmlLabels)){const t=c.children[0],e=(0,o.Ltv)(c);h=t.getBoundingClientRect(),e.attr("width",h.width),e.attr("height",h.height)}return n?s.attr("transform","translate("+-h.width/2+", "+-h.height/2+")"):s.attr("transform","translate(0, "+-h.height/2+")"),a.centerLabel&&s.attr("transform","translate("+-h.width/2+", "+-h.height/2+")"),s.insert("rect",":first-child"),{shapeSvg:t,bbox:h,halfPadding:d,label:s}},"insertLabel"),g=(0,i.K2)((t,e)=>{const a=e.node().getBBox();t.width=a.width,t.height=a.height},"updateNodeBounds"),y=(0,i.K2)((t,e)=>("handDrawn"===t.look?"rough-node":"node")+" "+t.cssClasses+" "+(e||""),"getNodeClasses");function p(t){const e=t.map((t,e)=>`${0===e?"M":"L"}${t.x},${t.y}`);return e.push("Z"),e.join(" ")}function f(t,e,a,n,s,l){const r=[],i=a-t,o=n-e,c=i/l,h=2*Math.PI/c,d=e+o/2;for(let g=0;g<=50;g++){const e=t+g/50*i,a=d+s*Math.sin(h*(e-t));r.push({x:e,y:a})}return r}function u(t,e,a,n,s,l){const r=[],i=s*Math.PI/180,o=(l*Math.PI/180-i)/(n-1);for(let c=0;c<n;c++){const n=i+c*o,s=t+a*Math.cos(n),l=e+a*Math.sin(n);r.push({x:-s,y:-l})}return r}(0,i.K2)(p,"createPathFromPoints"),(0,i.K2)(f,"generateFullSineWavePoints"),(0,i.K2)(u,"generateCirclePoints");var m=(0,i.K2)((t,e)=>{var a,n,s=t.x,l=t.y,r=e.x-s,i=e.y-l,o=t.width/2,c=t.height/2;return Math.abs(i)*o>Math.abs(r)*c?(i<0&&(c=-c),a=0===i?0:c*r/i,n=c):(r<0&&(o=-o),a=o,n=0===r?0:o*i/r),{x:s+a,y:l+n}},"intersectRect");function x(t,e){e&&t.attr("style",e)}async function b(t){const e=(0,o.Ltv)(document.createElementNS("http://www.w3.org/2000/svg","foreignObject")),a=e.append("xhtml:div");let n=t.label;t.label&&(0,i.Wi)(t.label)&&(n=await(0,i.VJ)(t.label.replace(i.Y2.lineBreakRegex,"\n"),(0,i.D7)()));const s=t.isNode?"nodeLabel":"edgeLabel";return a.html('<span class="'+s+'" '+(t.labelStyle?'style="'+t.labelStyle+'"':"")+">"+n+"</span>"),x(a,t.labelStyle),a.style("display","inline-block"),a.style("padding-right","1px"),a.style("white-space","nowrap"),a.attr("xmlns","http://www.w3.org/1999/xhtml"),e.node()}(0,i.K2)(x,"applyStyle"),(0,i.K2)(b,"addHtmlLabel");var w=(0,i.K2)(async(t,e,a,n)=>{let s=t||"";if("object"==typeof s&&(s=s[0]),(0,i._3)((0,i.D7)().flowchart.htmlLabels)){s=s.replace(/\\n|\n/g,"<br />"),i.Rm.info("vertexText"+s);const t={isNode:n,label:(0,r.Sm)(s).replace(/fa[blrs]?:fa-[\w-]+/g,t=>`<i class='${t.replace(":"," ")}'></i>`),labelStyle:e?e.replace("fill:","color:"):e};return await b(t)}{const t=document.createElementNS("http://www.w3.org/2000/svg","text");t.setAttribute("style",e.replace("color:","fill:"));let n=[];n="string"==typeof s?s.split(/\\n|\n|<br\s*\/?>/gi):Array.isArray(s)?s:[];for(const e of n){const n=document.createElementNS("http://www.w3.org/2000/svg","tspan");n.setAttributeNS("http://www.w3.org/XML/1998/namespace","xml:space","preserve"),n.setAttribute("dy","1em"),n.setAttribute("x","0"),a?n.setAttribute("class","title-row"):n.setAttribute("class","row"),n.textContent=e.trim(),t.appendChild(n)}return t}},"createLabel"),S=(0,i.K2)((t,e,a,n,s)=>["M",t+s,e,"H",t+a-s,"A",s,s,0,0,1,t+a,e+s,"V",e+n-s,"A",s,s,0,0,1,t+a-s,e+n,"H",t+s,"A",s,s,0,0,1,t,e+n-s,"V",e+s,"A",s,s,0,0,1,t+s,e,"Z"].join(" "),"createRoundedRectPathD"),$=(0,i.K2)(async(t,e)=>{i.Rm.info("Creating subgraph rect for ",e.id,e);const a=(0,i.D7)(),{themeVariables:r,handDrawnSeed:h}=a,{clusterBkg:d,clusterBorder:g}=r,{labelStyles:y,nodeStyles:p,borderStyles:f,backgroundStyles:u}=(0,s.GX)(e),x=t.insert("g").attr("class","cluster "+e.cssClasses).attr("id",e.id).attr("data-look",e.look),b=(0,i._3)(a.flowchart.htmlLabels),w=x.insert("g").attr("class","cluster-label "),$=await(0,l.GZ)(w,e.label,{style:e.labelStyle,useHtmlLabels:b,isNode:!0});let k=$.getBBox();if((0,i._3)(a.flowchart.htmlLabels)){const t=$.children[0],e=(0,o.Ltv)($);k=t.getBoundingClientRect(),e.attr("width",k.width),e.attr("height",k.height)}const v=e.width<=k.width+e.padding?k.width+e.padding:e.width;e.width<=k.width+e.padding?e.diff=(v-e.width)/2-e.padding:e.diff=-e.padding;const M=e.height,D=e.x-v/2,A=e.y-M/2;let B;if(i.Rm.trace("Data ",e,JSON.stringify(e)),"handDrawn"===e.look){const t=c.A.svg(x),a=(0,s.Fr)(e,{roughness:.7,fill:d,stroke:g,fillWeight:3,seed:h}),n=t.path(S(D,A,v,M,0),a);B=x.insert(()=>(i.Rm.debug("Rough node insert CXC",n),n),":first-child"),B.select("path:nth-child(2)").attr("style",f.join(";")),B.select("path").attr("style",u.join(";").replace("fill","stroke"))}else B=x.insert("rect",":first-child"),B.attr("style",p).attr("rx",e.rx).attr("ry",e.ry).attr("x",D).attr("y",A).attr("width",v).attr("height",M);const{subGraphTitleTopMargin:C}=(0,n.O)(a);if(w.attr("transform",`translate(${e.x-k.width/2}, ${e.y-e.height/2+C})`),y){const t=w.select("span");t&&t.attr("style",y)}const K=B.node().getBBox();return e.offsetX=0,e.width=K.width,e.height=K.height,e.offsetY=k.height-e.padding/2,e.intersect=function(t){return m(e,t)},{cluster:x,labelBBox:k}},"rect"),k=(0,i.K2)((t,e)=>{const a=t.insert("g").attr("class","note-cluster").attr("id",e.id),n=a.insert("rect",":first-child"),s=0*e.padding,l=s/2;n.attr("rx",e.rx).attr("ry",e.ry).attr("x",e.x-e.width/2-l).attr("y",e.y-e.height/2-l).attr("width",e.width+s).attr("height",e.height+s).attr("fill","none");const r=n.node().getBBox();return e.width=r.width,e.height=r.height,e.intersect=function(t){return m(e,t)},{cluster:a,labelBBox:{width:0,height:0}}},"noteGroup"),v=(0,i.K2)(async(t,e)=>{const a=(0,i.D7)(),{themeVariables:n,handDrawnSeed:s}=a,{altBackground:l,compositeBackground:r,compositeTitleBackground:h,nodeBorder:d}=n,g=t.insert("g").attr("class",e.cssClasses).attr("id",e.id).attr("data-id",e.id).attr("data-look",e.look),y=g.insert("g",":first-child"),p=g.insert("g").attr("class","cluster-label");let f=g.append("rect");const u=p.node().appendChild(await w(e.label,e.labelStyle,void 0,!0));let x=u.getBBox();if((0,i._3)(a.flowchart.htmlLabels)){const t=u.children[0],e=(0,o.Ltv)(u);x=t.getBoundingClientRect(),e.attr("width",x.width),e.attr("height",x.height)}const b=0*e.padding,$=b/2,k=(e.width<=x.width+e.padding?x.width+e.padding:e.width)+b;e.width<=x.width+e.padding?e.diff=(k-e.width)/2-e.padding:e.diff=-e.padding;const v=e.height+b,M=e.height+b-x.height-6,D=e.x-k/2,A=e.y-v/2;e.width=k;const B=e.y-e.height/2-$+x.height+2;let C;if("handDrawn"===e.look){const t=e.cssClasses.includes("statediagram-cluster-alt"),a=c.A.svg(g),n=e.rx||e.ry?a.path(S(D,A,k,v,10),{roughness:.7,fill:h,fillStyle:"solid",stroke:d,seed:s}):a.rectangle(D,A,k,v,{seed:s});C=g.insert(()=>n,":first-child");const i=a.rectangle(D,B,k,M,{fill:t?l:r,fillStyle:t?"hachure":"solid",stroke:d,seed:s});C=g.insert(()=>n,":first-child"),f=g.insert(()=>i)}else{C=y.insert("rect",":first-child");const t="outer";C.attr("class",t).attr("x",D).attr("y",A).attr("width",k).attr("height",v).attr("data-look",e.look),f.attr("class","inner").attr("x",D).attr("y",B).attr("width",k).attr("height",M)}p.attr("transform",`translate(${e.x-x.width/2}, ${A+1-((0,i._3)(a.flowchart.htmlLabels)?0:3)})`);const K=C.node().getBBox();return e.height=K.height,e.offsetX=0,e.offsetY=x.height-e.padding/2,e.labelBBox=x,e.intersect=function(t){return m(e,t)},{cluster:g,labelBBox:x}},"roundedWithTitle"),M=(0,i.K2)(async(t,e)=>{i.Rm.info("Creating subgraph rect for ",e.id,e);const a=(0,i.D7)(),{themeVariables:r,handDrawnSeed:h}=a,{clusterBkg:d,clusterBorder:g}=r,{labelStyles:y,nodeStyles:p,borderStyles:f,backgroundStyles:u}=(0,s.GX)(e),x=t.insert("g").attr("class","cluster "+e.cssClasses).attr("id",e.id).attr("data-look",e.look),b=(0,i._3)(a.flowchart.htmlLabels),w=x.insert("g").attr("class","cluster-label "),$=await(0,l.GZ)(w,e.label,{style:e.labelStyle,useHtmlLabels:b,isNode:!0,width:e.width});let k=$.getBBox();if((0,i._3)(a.flowchart.htmlLabels)){const t=$.children[0],e=(0,o.Ltv)($);k=t.getBoundingClientRect(),e.attr("width",k.width),e.attr("height",k.height)}const v=e.width<=k.width+e.padding?k.width+e.padding:e.width;e.width<=k.width+e.padding?e.diff=(v-e.width)/2-e.padding:e.diff=-e.padding;const M=e.height,D=e.x-v/2,A=e.y-M/2;let B;if(i.Rm.trace("Data ",e,JSON.stringify(e)),"handDrawn"===e.look){const t=c.A.svg(x),a=(0,s.Fr)(e,{roughness:.7,fill:d,stroke:g,fillWeight:4,seed:h}),n=t.path(S(D,A,v,M,e.rx),a);B=x.insert(()=>(i.Rm.debug("Rough node insert CXC",n),n),":first-child"),B.select("path:nth-child(2)").attr("style",f.join(";")),B.select("path").attr("style",u.join(";").replace("fill","stroke"))}else B=x.insert("rect",":first-child"),B.attr("style",p).attr("rx",e.rx).attr("ry",e.ry).attr("x",D).attr("y",A).attr("width",v).attr("height",M);const{subGraphTitleTopMargin:C}=(0,n.O)(a);if(w.attr("transform",`translate(${e.x-k.width/2}, ${e.y-e.height/2+C})`),y){const t=w.select("span");t&&t.attr("style",y)}const K=B.node().getBBox();return e.offsetX=0,e.width=K.width,e.height=K.height,e.offsetY=k.height-e.padding/2,e.intersect=function(t){return m(e,t)},{cluster:x,labelBBox:k}},"kanbanSection"),D={rect:$,squareRect:$,roundedWithTitle:v,noteGroup:k,divider:(0,i.K2)((t,e)=>{const a=(0,i.D7)(),{themeVariables:n,handDrawnSeed:s}=a,{nodeBorder:l}=n,r=t.insert("g").attr("class",e.cssClasses).attr("id",e.id).attr("data-look",e.look),o=r.insert("g",":first-child"),h=0*e.padding,d=e.width+h;e.diff=-e.padding;const g=e.height+h,y=e.x-d/2,p=e.y-g/2;let f;if(e.width=d,"handDrawn"===e.look){const t=c.A.svg(r).rectangle(y,p,d,g,{fill:"lightgrey",roughness:.5,strokeLineDash:[5],stroke:l,seed:s});f=r.insert(()=>t,":first-child")}else{f=o.insert("rect",":first-child");const t="divider";f.attr("class",t).attr("x",y).attr("y",p).attr("width",d).attr("height",g).attr("data-look",e.look)}const u=f.node().getBBox();return e.height=u.height,e.offsetX=0,e.offsetY=0,e.intersect=function(t){return m(e,t)},{cluster:r,labelBBox:{}}},"divider"),kanbanSection:M},A=new Map,B=(0,i.K2)(async(t,e)=>{const a=e.shape||"rect",n=await D[a](t,e);return A.set(e.id,n),n},"insertCluster"),C=(0,i.K2)(()=>{A=new Map},"clear");function K(t,e){return t.intersect(e)}(0,i.K2)(K,"intersectNode");var L=K;function N(t,e,a,n){var s=t.x,l=t.y,r=s-n.x,i=l-n.y,o=Math.sqrt(e*e*i*i+a*a*r*r),c=Math.abs(e*a*r/o);n.x<s&&(c=-c);var h=Math.abs(e*a*i/o);return n.y<l&&(h=-h),{x:s+c,y:l+h}}(0,i.K2)(N,"intersectEllipse");var R=N;function P(t,e,a){return R(t,e,e,a)}(0,i.K2)(P,"intersectCircle");var F=P;function X(t,e,a,n){var s,l,r,i,o,c,h,d,g,y,p,f,u;if(s=e.y-t.y,r=t.x-e.x,o=e.x*t.y-t.x*e.y,g=s*a.x+r*a.y+o,y=s*n.x+r*n.y+o,!(0!==g&&0!==y&&G(g,y)||(l=n.y-a.y,i=a.x-n.x,c=n.x*a.y-a.x*n.y,h=l*t.x+i*t.y+c,d=l*e.x+i*e.y+c,0!==h&&0!==d&&G(h,d)||0===(p=s*i-l*r))))return f=Math.abs(p/2),{x:(u=r*c-i*o)<0?(u-f)/p:(u+f)/p,y:(u=l*o-s*c)<0?(u-f)/p:(u+f)/p}}function G(t,e){return t*e>0}(0,i.K2)(X,"intersectLine"),(0,i.K2)(G,"sameSign");var T=X;function I(t,e,a){let n=t.x,s=t.y,l=[],r=Number.POSITIVE_INFINITY,i=Number.POSITIVE_INFINITY;"function"==typeof e.forEach?e.forEach(function(t){r=Math.min(r,t.x),i=Math.min(i,t.y)}):(r=Math.min(r,e.x),i=Math.min(i,e.y));let o=n-t.width/2-r,c=s-t.height/2-i;for(let h=0;h<e.length;h++){let n=e[h],s=e[h<e.length-1?h+1:0],r=T(t,a,{x:o+n.x,y:c+n.y},{x:o+s.x,y:c+s.y});r&&l.push(r)}return l.length?(l.length>1&&l.sort(function(t,e){let n=t.x-a.x,s=t.y-a.y,l=Math.sqrt(n*n+s*s),r=e.x-a.x,i=e.y-a.y,o=Math.sqrt(r*r+i*i);return l<o?-1:l===o?0:1}),l[0]):t}(0,i.K2)(I,"intersectPolygon");var W={node:L,circle:F,ellipse:R,polygon:I,rect:m};function j(t,e){const{labelStyles:a}=(0,s.GX)(e);e.labelStyle=a;const n=y(e);let l=n;n||(l="anchor");const o=t.insert("g").attr("class",l).attr("id",e.domId||e.id),{cssStyles:h}=e,d=c.A.svg(o),p=(0,s.Fr)(e,{fill:"black",stroke:"none",fillStyle:"solid"});"handDrawn"!==e.look&&(p.roughness=0);const f=d.circle(0,0,2,p),u=o.insert(()=>f,":first-child");return u.attr("class","anchor").attr("style",(0,r.KL)(h)),g(e,u),e.intersect=function(t){return i.Rm.info("Circle intersect",e,1,t),W.circle(e,1,t)},o}function H(t,e,a,n,s,l,r){const i=(t+a)/2,o=(e+n)/2,c=Math.atan2(n-e,a-t),h=(a-t)/2/s,d=(n-e)/2/l,g=Math.sqrt(h**2+d**2);if(g>1)throw new Error("The given radii are too small to create an arc between the points.");const y=Math.sqrt(1-g**2),p=i+y*l*Math.sin(c)*(r?-1:1),f=o-y*s*Math.cos(c)*(r?-1:1),u=Math.atan2((e-f)/l,(t-p)/s);let m=Math.atan2((n-f)/l,(a-p)/s)-u;r&&m<0&&(m+=2*Math.PI),!r&&m>0&&(m-=2*Math.PI);const x=[];for(let b=0;b<20;b++){const t=u+b/19*m,e=p+s*Math.cos(t),a=f+l*Math.sin(t);x.push({x:e,y:a})}return x}async function _(t,e){const{labelStyles:a,nodeStyles:n}=(0,s.GX)(e);e.labelStyle=a;const{shapeSvg:l,bbox:r}=await h(t,e,y(e)),i=r.width+e.padding+20,o=r.height+e.padding,d=o/2,f=d/(2.5+o/50),{cssStyles:u}=e,m=[{x:i/2,y:-o/2},{x:-i/2,y:-o/2},...H(-i/2,-o/2,-i/2,o/2,f,d,!1),{x:i/2,y:o/2},...H(i/2,o/2,i/2,-o/2,f,d,!0)],x=c.A.svg(l),b=(0,s.Fr)(e,{});"handDrawn"!==e.look&&(b.roughness=0,b.fillStyle="solid");const w=p(m),S=x.path(w,b),$=l.insert(()=>S,":first-child");return $.attr("class","basic label-container"),u&&"handDrawn"!==e.look&&$.selectAll("path").attr("style",u),n&&"handDrawn"!==e.look&&$.selectAll("path").attr("style",n),$.attr("transform",`translate(${f/2}, 0)`),g(e,$),e.intersect=function(t){return W.polygon(e,m,t)},l}function E(t,e,a,n){return t.insert("polygon",":first-child").attr("points",n.map(function(t){return t.x+","+t.y}).join(" ")).attr("class","label-container").attr("transform","translate("+-e/2+","+a/2+")")}async function q(t,e){const{labelStyles:a,nodeStyles:n}=(0,s.GX)(e);e.labelStyle=a;const{shapeSvg:l,bbox:r}=await h(t,e,y(e)),i=r.height+e.padding,o=r.width+e.padding+12,d=-i,f=[{x:12,y:d},{x:o,y:d},{x:o,y:0},{x:0,y:0},{x:0,y:d+12},{x:12,y:d}];let u;const{cssStyles:m}=e;if("handDrawn"===e.look){const t=c.A.svg(l),a=(0,s.Fr)(e,{}),n=p(f),r=t.path(n,a);u=l.insert(()=>r,":first-child").attr("transform",`translate(${-o/2}, ${i/2})`),m&&u.attr("style",m)}else u=E(l,o,i,f);return n&&u.attr("style",n),g(e,u),e.intersect=function(t){return W.polygon(e,f,t)},l}function z(t,e){const{nodeStyles:a}=(0,s.GX)(e);e.label="";const n=t.insert("g").attr("class",y(e)).attr("id",e.domId??e.id),{cssStyles:l}=e,r=Math.max(28,e.width??0),i=[{x:0,y:r/2},{x:r/2,y:0},{x:0,y:-r/2},{x:-r/2,y:0}],o=c.A.svg(n),h=(0,s.Fr)(e,{});"handDrawn"!==e.look&&(h.roughness=0,h.fillStyle="solid");const d=p(i),g=o.path(d,h),f=n.insert(()=>g,":first-child");return l&&"handDrawn"!==e.look&&f.selectAll("path").attr("style",l),a&&"handDrawn"!==e.look&&f.selectAll("path").attr("style",a),e.width=28,e.height=28,e.intersect=function(t){return W.polygon(e,i,t)},n}async function O(t,e){const{labelStyles:a,nodeStyles:n}=(0,s.GX)(e);e.labelStyle=a;const{shapeSvg:l,bbox:o,halfPadding:d}=await h(t,e,y(e)),p=o.width/2+d;let f;const{cssStyles:u}=e;if("handDrawn"===e.look){const t=c.A.svg(l),a=(0,s.Fr)(e,{}),n=t.circle(0,0,2*p,a);f=l.insert(()=>n,":first-child"),f.attr("class","basic label-container").attr("style",(0,r.KL)(u))}else f=l.insert("circle",":first-child").attr("class","basic label-container").attr("style",n).attr("r",p).attr("cx",0).attr("cy",0);return g(e,f),e.intersect=function(t){return i.Rm.info("Circle intersect",e,p,t),W.circle(e,p,t)},l}function V(t){const e=Math.cos(Math.PI/4),a=Math.sin(Math.PI/4),n=2*t;return`M ${-n/2*e},${n/2*a} L ${n/2*e},${-n/2*a}\n                   M ${n/2*e},${n/2*a} L ${-n/2*e},${-n/2*a}`}function Z(t,e){const{labelStyles:a,nodeStyles:n}=(0,s.GX)(e);e.labelStyle=a,e.label="";const l=t.insert("g").attr("class",y(e)).attr("id",e.domId??e.id),r=Math.max(30,e?.width??0),{cssStyles:o}=e,h=c.A.svg(l),d=(0,s.Fr)(e,{});"handDrawn"!==e.look&&(d.roughness=0,d.fillStyle="solid");const p=h.circle(0,0,2*r,d),f=V(r),u=h.path(f,d),m=l.insert(()=>p,":first-child");return m.insert(()=>u),o&&"handDrawn"!==e.look&&m.selectAll("path").attr("style",o),n&&"handDrawn"!==e.look&&m.selectAll("path").attr("style",n),g(e,m),e.intersect=function(t){i.Rm.info("crossedCircle intersect",e,{radius:r,point:t});return W.circle(e,r,t)},l}function Y(t,e,a,n=100,s=0,l=180){const r=[],i=s*Math.PI/180,o=(l*Math.PI/180-i)/(n-1);for(let c=0;c<n;c++){const n=i+c*o,s=t+a*Math.cos(n),l=e+a*Math.sin(n);r.push({x:-s,y:-l})}return r}async function U(t,e){const{labelStyles:a,nodeStyles:n}=(0,s.GX)(e);e.labelStyle=a;const{shapeSvg:l,bbox:r,label:i}=await h(t,e,y(e)),o=r.width+(e.padding??0),d=r.height+(e.padding??0),f=Math.max(5,.1*d),{cssStyles:u}=e,m=[...Y(o/2,-d/2,f,30,-90,0),{x:-o/2-f,y:f},...Y(o/2+2*f,-f,f,20,-180,-270),...Y(o/2+2*f,f,f,20,-90,-180),{x:-o/2-f,y:-d/2},...Y(o/2,d/2,f,20,0,90)],x=[{x:o/2,y:-d/2-f},{x:-o/2,y:-d/2-f},...Y(o/2,-d/2,f,20,-90,0),{x:-o/2-f,y:-f},...Y(o/2+.1*o,-f,f,20,-180,-270),...Y(o/2+.1*o,f,f,20,-90,-180),{x:-o/2-f,y:d/2},...Y(o/2,d/2,f,20,0,90),{x:-o/2,y:d/2+f},{x:o/2,y:d/2+f}],b=c.A.svg(l),w=(0,s.Fr)(e,{fill:"none"});"handDrawn"!==e.look&&(w.roughness=0,w.fillStyle="solid");const S=p(m).replace("Z",""),$=b.path(S,w),k=p(x),v=b.path(k,{...w}),M=l.insert("g",":first-child");return M.insert(()=>v,":first-child").attr("stroke-opacity",0),M.insert(()=>$,":first-child"),M.attr("class","text"),u&&"handDrawn"!==e.look&&M.selectAll("path").attr("style",u),n&&"handDrawn"!==e.look&&M.selectAll("path").attr("style",n),M.attr("transform",`translate(${f}, 0)`),i.attr("transform",`translate(${-o/2+f-(r.x-(r.left??0))},${-d/2+(e.padding??0)/2-(r.y-(r.top??0))})`),g(e,M),e.intersect=function(t){return W.polygon(e,x,t)},l}function J(t,e,a,n=100,s=0,l=180){const r=[],i=s*Math.PI/180,o=(l*Math.PI/180-i)/(n-1);for(let c=0;c<n;c++){const n=i+c*o,s=t+a*Math.cos(n),l=e+a*Math.sin(n);r.push({x:s,y:l})}return r}async function Q(t,e){const{labelStyles:a,nodeStyles:n}=(0,s.GX)(e);e.labelStyle=a;const{shapeSvg:l,bbox:r,label:i}=await h(t,e,y(e)),o=r.width+(e.padding??0),d=r.height+(e.padding??0),f=Math.max(5,.1*d),{cssStyles:u}=e,m=[...J(o/2,-d/2,f,20,-90,0),{x:o/2+f,y:-f},...J(o/2+2*f,-f,f,20,-180,-270),...J(o/2+2*f,f,f,20,-90,-180),{x:o/2+f,y:d/2},...J(o/2,d/2,f,20,0,90)],x=[{x:-o/2,y:-d/2-f},{x:o/2,y:-d/2-f},...J(o/2,-d/2,f,20,-90,0),{x:o/2+f,y:-f},...J(o/2+2*f,-f,f,20,-180,-270),...J(o/2+2*f,f,f,20,-90,-180),{x:o/2+f,y:d/2},...J(o/2,d/2,f,20,0,90),{x:o/2,y:d/2+f},{x:-o/2,y:d/2+f}],b=c.A.svg(l),w=(0,s.Fr)(e,{fill:"none"});"handDrawn"!==e.look&&(w.roughness=0,w.fillStyle="solid");const S=p(m).replace("Z",""),$=b.path(S,w),k=p(x),v=b.path(k,{...w}),M=l.insert("g",":first-child");return M.insert(()=>v,":first-child").attr("stroke-opacity",0),M.insert(()=>$,":first-child"),M.attr("class","text"),u&&"handDrawn"!==e.look&&M.selectAll("path").attr("style",u),n&&"handDrawn"!==e.look&&M.selectAll("path").attr("style",n),M.attr("transform",`translate(${-f}, 0)`),i.attr("transform",`translate(${-o/2+(e.padding??0)/2-(r.x-(r.left??0))},${-d/2+(e.padding??0)/2-(r.y-(r.top??0))})`),g(e,M),e.intersect=function(t){return W.polygon(e,x,t)},l}function tt(t,e,a,n=100,s=0,l=180){const r=[],i=s*Math.PI/180,o=(l*Math.PI/180-i)/(n-1);for(let c=0;c<n;c++){const n=i+c*o,s=t+a*Math.cos(n),l=e+a*Math.sin(n);r.push({x:-s,y:-l})}return r}async function et(t,e){const{labelStyles:a,nodeStyles:n}=(0,s.GX)(e);e.labelStyle=a;const{shapeSvg:l,bbox:r,label:i}=await h(t,e,y(e)),o=r.width+(e.padding??0),d=r.height+(e.padding??0),f=Math.max(5,.1*d),{cssStyles:u}=e,m=[...tt(o/2,-d/2,f,30,-90,0),{x:-o/2-f,y:f},...tt(o/2+2*f,-f,f,20,-180,-270),...tt(o/2+2*f,f,f,20,-90,-180),{x:-o/2-f,y:-d/2},...tt(o/2,d/2,f,20,0,90)],x=[...tt(-o/2+f+f/2,-d/2,f,20,-90,-180),{x:o/2-f/2,y:f},...tt(-o/2-f/2,-f,f,20,0,90),...tt(-o/2-f/2,f,f,20,-90,0),{x:o/2-f/2,y:-f},...tt(-o/2+f+f/2,d/2,f,30,-180,-270)],b=[{x:o/2,y:-d/2-f},{x:-o/2,y:-d/2-f},...tt(o/2,-d/2,f,20,-90,0),{x:-o/2-f,y:-f},...tt(o/2+2*f,-f,f,20,-180,-270),...tt(o/2+2*f,f,f,20,-90,-180),{x:-o/2-f,y:d/2},...tt(o/2,d/2,f,20,0,90),{x:-o/2,y:d/2+f},{x:o/2-f-f/2,y:d/2+f},...tt(-o/2+f+f/2,-d/2,f,20,-90,-180),{x:o/2-f/2,y:f},...tt(-o/2-f/2,-f,f,20,0,90),...tt(-o/2-f/2,f,f,20,-90,0),{x:o/2-f/2,y:-f},...tt(-o/2+f+f/2,d/2,f,30,-180,-270)],w=c.A.svg(l),S=(0,s.Fr)(e,{fill:"none"});"handDrawn"!==e.look&&(S.roughness=0,S.fillStyle="solid");const $=p(m).replace("Z",""),k=w.path($,S),v=p(x).replace("Z",""),M=w.path(v,S),D=p(b),A=w.path(D,{...S}),B=l.insert("g",":first-child");return B.insert(()=>A,":first-child").attr("stroke-opacity",0),B.insert(()=>k,":first-child"),B.insert(()=>M,":first-child"),B.attr("class","text"),u&&"handDrawn"!==e.look&&B.selectAll("path").attr("style",u),n&&"handDrawn"!==e.look&&B.selectAll("path").attr("style",n),B.attr("transform",`translate(${f-f/4}, 0)`),i.attr("transform",`translate(${-o/2+(e.padding??0)/2-(r.x-(r.left??0))},${-d/2+(e.padding??0)/2-(r.y-(r.top??0))})`),g(e,B),e.intersect=function(t){return W.polygon(e,b,t)},l}async function at(t,e){const{labelStyles:a,nodeStyles:n}=(0,s.GX)(e);e.labelStyle=a;const{shapeSvg:l,bbox:r}=await h(t,e,y(e)),i=Math.max(80,1.25*(r.width+2*(e.padding??0)),e?.width??0),o=Math.max(20,r.height+2*(e.padding??0),e?.height??0),d=o/2,{cssStyles:f}=e,m=c.A.svg(l),x=(0,s.Fr)(e,{});"handDrawn"!==e.look&&(x.roughness=0,x.fillStyle="solid");const b=i-d,w=o/4,S=[{x:b,y:0},{x:w,y:0},{x:0,y:o/2},{x:w,y:o},{x:b,y:o},...u(-b,-o/2,d,50,270,90)],$=p(S),k=m.path($,x),v=l.insert(()=>k,":first-child");return v.attr("class","basic label-container"),f&&"handDrawn"!==e.look&&v.selectChildren("path").attr("style",f),n&&"handDrawn"!==e.look&&v.selectChildren("path").attr("style",n),v.attr("transform",`translate(${-i/2}, ${-o/2})`),g(e,v),e.intersect=function(t){return W.polygon(e,S,t)},l}(0,i.K2)(j,"anchor"),(0,i.K2)(H,"generateArcPoints"),(0,i.K2)(_,"bowTieRect"),(0,i.K2)(E,"insertPolygonShape"),(0,i.K2)(q,"card"),(0,i.K2)(z,"choice"),(0,i.K2)(O,"circle"),(0,i.K2)(V,"createLine"),(0,i.K2)(Z,"crossedCircle"),(0,i.K2)(Y,"generateCirclePoints"),(0,i.K2)(U,"curlyBraceLeft"),(0,i.K2)(J,"generateCirclePoints"),(0,i.K2)(Q,"curlyBraceRight"),(0,i.K2)(tt,"generateCirclePoints"),(0,i.K2)(et,"curlyBraces"),(0,i.K2)(at,"curvedTrapezoid");var nt=(0,i.K2)((t,e,a,n,s,l)=>[`M${t},${e+l}`,`a${s},${l} 0,0,0 ${a},0`,`a${s},${l} 0,0,0 ${-a},0`,`l0,${n}`,`a${s},${l} 0,0,0 ${a},0`,"l0,"+-n].join(" "),"createCylinderPathD"),st=(0,i.K2)((t,e,a,n,s,l)=>[`M${t},${e+l}`,`M${t+a},${e+l}`,`a${s},${l} 0,0,0 ${-a},0`,`l0,${n}`,`a${s},${l} 0,0,0 ${a},0`,"l0,"+-n].join(" "),"createOuterCylinderPathD"),lt=(0,i.K2)((t,e,a,n,s,l)=>[`M${t-a/2},${-n/2}`,`a${s},${l} 0,0,0 ${a},0`].join(" "),"createInnerCylinderPathD");async function rt(t,e){const{labelStyles:a,nodeStyles:n}=(0,s.GX)(e);e.labelStyle=a;const{shapeSvg:l,bbox:i,label:o}=await h(t,e,y(e)),d=Math.max(i.width+e.padding,e.width??0),p=d/2,f=p/(2.5+d/50),u=Math.max(i.height+f+e.padding,e.height??0);let m;const{cssStyles:x}=e;if("handDrawn"===e.look){const t=c.A.svg(l),a=st(0,0,d,u,p,f),n=lt(0,f,d,u,p,f),r=t.path(a,(0,s.Fr)(e,{})),i=t.path(n,(0,s.Fr)(e,{fill:"none"}));m=l.insert(()=>i,":first-child"),m=l.insert(()=>r,":first-child"),m.attr("class","basic label-container"),x&&m.attr("style",x)}else{const t=nt(0,0,d,u,p,f);m=l.insert("path",":first-child").attr("d",t).attr("class","basic label-container").attr("style",(0,r.KL)(x)).attr("style",n)}return m.attr("label-offset-y",f),m.attr("transform",`translate(${-d/2}, ${-(u/2+f)})`),g(e,m),o.attr("transform",`translate(${-i.width/2-(i.x-(i.left??0))}, ${-i.height/2+(e.padding??0)/1.5-(i.y-(i.top??0))})`),e.intersect=function(t){const a=W.rect(e,t),n=a.x-(e.x??0);if(0!=p&&(Math.abs(n)<(e.width??0)/2||Math.abs(n)==(e.width??0)/2&&Math.abs(a.y-(e.y??0))>(e.height??0)/2-f)){let s=f*f*(1-n*n/(p*p));s>0&&(s=Math.sqrt(s)),s=f-s,t.y-(e.y??0)>0&&(s=-s),a.y+=s}return a},l}async function it(t,e){const{labelStyles:a,nodeStyles:n}=(0,s.GX)(e);e.labelStyle=a;const{shapeSvg:l,bbox:r,label:i}=await h(t,e,y(e)),o=r.width+e.padding,d=r.height+e.padding,p=.2*d,f=-o/2,u=-d/2-p/2,{cssStyles:m}=e,x=c.A.svg(l),b=(0,s.Fr)(e,{});"handDrawn"!==e.look&&(b.roughness=0,b.fillStyle="solid");const w=[{x:f,y:u+p},{x:-f,y:u+p},{x:-f,y:-u},{x:f,y:-u},{x:f,y:u},{x:-f,y:u},{x:-f,y:u+p}],S=x.polygon(w.map(t=>[t.x,t.y]),b),$=l.insert(()=>S,":first-child");return $.attr("class","basic label-container"),m&&"handDrawn"!==e.look&&$.selectAll("path").attr("style",m),n&&"handDrawn"!==e.look&&$.selectAll("path").attr("style",n),i.attr("transform",`translate(${f+(e.padding??0)/2-(r.x-(r.left??0))}, ${u+p+(e.padding??0)/2-(r.y-(r.top??0))})`),g(e,$),e.intersect=function(t){return W.rect(e,t)},l}async function ot(t,e){const{labelStyles:a,nodeStyles:n}=(0,s.GX)(e);e.labelStyle=a;const{shapeSvg:l,bbox:o,halfPadding:d}=await h(t,e,y(e)),p=o.width/2+d+5,f=o.width/2+d;let u;const{cssStyles:m}=e;if("handDrawn"===e.look){const t=c.A.svg(l),a=(0,s.Fr)(e,{roughness:.2,strokeWidth:2.5}),n=(0,s.Fr)(e,{roughness:.2,strokeWidth:1.5}),i=t.circle(0,0,2*p,a),o=t.circle(0,0,2*f,n);u=l.insert("g",":first-child"),u.attr("class",(0,r.KL)(e.cssClasses)).attr("style",(0,r.KL)(m)),u.node()?.appendChild(i),u.node()?.appendChild(o)}else{u=l.insert("g",":first-child");const t=u.insert("circle",":first-child"),e=u.insert("circle");u.attr("class","basic label-container").attr("style",n),t.attr("class","outer-circle").attr("style",n).attr("r",p).attr("cx",0).attr("cy",0),e.attr("class","inner-circle").attr("style",n).attr("r",f).attr("cx",0).attr("cy",0)}return g(e,u),e.intersect=function(t){return i.Rm.info("DoubleCircle intersect",e,p,t),W.circle(e,p,t)},l}function ct(t,e,{config:{themeVariables:a}}){const{labelStyles:n,nodeStyles:l}=(0,s.GX)(e);e.label="",e.labelStyle=n;const r=t.insert("g").attr("class",y(e)).attr("id",e.domId??e.id),{cssStyles:o}=e,h=c.A.svg(r),{nodeBorder:d}=a,p=(0,s.Fr)(e,{fillStyle:"solid"});"handDrawn"!==e.look&&(p.roughness=0);const f=h.circle(0,0,14,p),u=r.insert(()=>f,":first-child");return u.selectAll("path").attr("style",`fill: ${d} !important;`),o&&o.length>0&&"handDrawn"!==e.look&&u.selectAll("path").attr("style",o),l&&"handDrawn"!==e.look&&u.selectAll("path").attr("style",l),g(e,u),e.intersect=function(t){i.Rm.info("filledCircle intersect",e,{radius:7,point:t});return W.circle(e,7,t)},r}async function ht(t,e){const{labelStyles:a,nodeStyles:n}=(0,s.GX)(e);e.labelStyle=a;const{shapeSvg:l,bbox:r,label:o}=await h(t,e,y(e)),d=r.width+(e.padding??0),f=d+r.height,u=d+r.height,m=[{x:0,y:-f},{x:u,y:-f},{x:u/2,y:0}],{cssStyles:x}=e,b=c.A.svg(l),w=(0,s.Fr)(e,{});"handDrawn"!==e.look&&(w.roughness=0,w.fillStyle="solid");const S=p(m),$=b.path(S,w),k=l.insert(()=>$,":first-child").attr("transform",`translate(${-f/2}, ${f/2})`);return x&&"handDrawn"!==e.look&&k.selectChildren("path").attr("style",x),n&&"handDrawn"!==e.look&&k.selectChildren("path").attr("style",n),e.width=d,e.height=f,g(e,k),o.attr("transform",`translate(${-r.width/2-(r.x-(r.left??0))}, ${-f/2+(e.padding??0)/2+(r.y-(r.top??0))})`),e.intersect=function(t){return i.Rm.info("Triangle intersect",e,m,t),W.polygon(e,m,t)},l}function dt(t,e,{dir:a,config:{state:n,themeVariables:l}}){const{nodeStyles:r}=(0,s.GX)(e);e.label="";const i=t.insert("g").attr("class",y(e)).attr("id",e.domId??e.id),{cssStyles:o}=e;let h=Math.max(70,e?.width??0),d=Math.max(10,e?.height??0);"LR"===a&&(h=Math.max(10,e?.width??0),d=Math.max(70,e?.height??0));const p=-1*h/2,f=-1*d/2,u=c.A.svg(i),m=(0,s.Fr)(e,{stroke:l.lineColor,fill:l.lineColor});"handDrawn"!==e.look&&(m.roughness=0,m.fillStyle="solid");const x=u.rectangle(p,f,h,d,m),b=i.insert(()=>x,":first-child");o&&"handDrawn"!==e.look&&b.selectAll("path").attr("style",o),r&&"handDrawn"!==e.look&&b.selectAll("path").attr("style",r),g(e,b);const w=n?.padding??0;return e.width&&e.height&&(e.width+=w/2||0,e.height+=w/2||0),e.intersect=function(t){return W.rect(e,t)},i}async function gt(t,e){const{labelStyles:a,nodeStyles:n}=(0,s.GX)(e);e.labelStyle=a;const{shapeSvg:l,bbox:r}=await h(t,e,y(e)),o=Math.max(80,r.width+2*(e.padding??0),e?.width??0),d=Math.max(50,r.height+2*(e.padding??0),e?.height??0),f=d/2,{cssStyles:m}=e,x=c.A.svg(l),b=(0,s.Fr)(e,{});"handDrawn"!==e.look&&(b.roughness=0,b.fillStyle="solid");const w=[{x:-o/2,y:-d/2},{x:o/2-f,y:-d/2},...u(-o/2+f,0,f,50,90,270),{x:o/2-f,y:d/2},{x:-o/2,y:d/2}],S=p(w),$=x.path(S,b),k=l.insert(()=>$,":first-child");return k.attr("class","basic label-container"),m&&"handDrawn"!==e.look&&k.selectChildren("path").attr("style",m),n&&"handDrawn"!==e.look&&k.selectChildren("path").attr("style",n),g(e,k),e.intersect=function(t){i.Rm.info("Pill intersect",e,{radius:f,point:t});return W.polygon(e,w,t)},l}(0,i.K2)(rt,"cylinder"),(0,i.K2)(it,"dividedRectangle"),(0,i.K2)(ot,"doublecircle"),(0,i.K2)(ct,"filledCircle"),(0,i.K2)(ht,"flippedTriangle"),(0,i.K2)(dt,"forkJoin"),(0,i.K2)(gt,"halfRoundedRectangle");var yt=(0,i.K2)((t,e,a,n,s)=>[`M${t+s},${e}`,`L${t+a-s},${e}`,`L${t+a},${e-n/2}`,`L${t+a-s},${e-n}`,`L${t+s},${e-n}`,`L${t},${e-n/2}`,"Z"].join(" "),"createHexagonPathD");async function pt(t,e){const{labelStyles:a,nodeStyles:n}=(0,s.GX)(e);e.labelStyle=a;const{shapeSvg:l,bbox:r}=await h(t,e,y(e)),i=r.height+e.padding,o=i/4,d=r.width+2*o+e.padding,p=[{x:o,y:0},{x:d-o,y:0},{x:d,y:-i/2},{x:d-o,y:-i},{x:o,y:-i},{x:0,y:-i/2}];let f;const{cssStyles:u}=e;if("handDrawn"===e.look){const t=c.A.svg(l),a=(0,s.Fr)(e,{}),n=yt(0,0,d,i,o),r=t.path(n,a);f=l.insert(()=>r,":first-child").attr("transform",`translate(${-d/2}, ${i/2})`),u&&f.attr("style",u)}else f=E(l,d,i,p);return n&&f.attr("style",n),e.width=d,e.height=i,g(e,f),e.intersect=function(t){return W.polygon(e,p,t)},l}async function ft(t,e){const{labelStyles:a,nodeStyles:n}=(0,s.GX)(e);e.label="",e.labelStyle=a;const{shapeSvg:l}=await h(t,e,y(e)),r=Math.max(30,e?.width??0),o=Math.max(30,e?.height??0),{cssStyles:d}=e,f=c.A.svg(l),u=(0,s.Fr)(e,{});"handDrawn"!==e.look&&(u.roughness=0,u.fillStyle="solid");const m=[{x:0,y:0},{x:r,y:0},{x:0,y:o},{x:r,y:o}],x=p(m),b=f.path(x,u),w=l.insert(()=>b,":first-child");return w.attr("class","basic label-container"),d&&"handDrawn"!==e.look&&w.selectChildren("path").attr("style",d),n&&"handDrawn"!==e.look&&w.selectChildren("path").attr("style",n),w.attr("transform",`translate(${-r/2}, ${-o/2})`),g(e,w),e.intersect=function(t){i.Rm.info("Pill intersect",e,{points:m});return W.polygon(e,m,t)},l}async function ut(t,e,{config:{themeVariables:a,flowchart:n}}){const{labelStyles:r}=(0,s.GX)(e);e.labelStyle=r;const o=e.assetHeight??48,d=e.assetWidth??48,y=Math.max(o,d),p=n?.wrappingWidth;e.width=Math.max(y,p??0);const{shapeSvg:f,bbox:u,label:m}=await h(t,e,"icon-shape default"),x="t"===e.pos,b=y,w=y,{nodeBorder:S}=a,{stylesMap:$}=(0,s.WW)(e),k=-w/2,v=-b/2,M=e.label?8:0,D=c.A.svg(f),A=(0,s.Fr)(e,{stroke:"none",fill:"none"});"handDrawn"!==e.look&&(A.roughness=0,A.fillStyle="solid");const B=D.rectangle(k,v,w,b,A),C=Math.max(w,u.width),K=b+u.height+M,L=D.rectangle(-C/2,-K/2,C,K,{...A,fill:"transparent",stroke:"none"}),N=f.insert(()=>B,":first-child"),R=f.insert(()=>L);if(e.icon){const t=f.append("g");t.html(`<g>${await(0,l.WY)(e.icon,{height:y,width:y,fallbackPrefix:""})}</g>`);const a=t.node().getBBox(),n=a.width,s=a.height,r=a.x,i=a.y;t.attr("transform",`translate(${-n/2-r},${x?u.height/2+M/2-s/2-i:-u.height/2-M/2-s/2-i})`),t.attr("style",`color: ${$.get("stroke")??S};`)}return m.attr("transform",`translate(${-u.width/2-(u.x-(u.left??0))},${x?-K/2:K/2-u.height})`),N.attr("transform",`translate(0,${x?u.height/2+M/2:-u.height/2-M/2})`),g(e,R),e.intersect=function(t){if(i.Rm.info("iconSquare intersect",e,t),!e.label)return W.rect(e,t);const a=e.x??0,n=e.y??0,s=e.height??0;let l=[];l=x?[{x:a-u.width/2,y:n-s/2},{x:a+u.width/2,y:n-s/2},{x:a+u.width/2,y:n-s/2+u.height+M},{x:a+w/2,y:n-s/2+u.height+M},{x:a+w/2,y:n+s/2},{x:a-w/2,y:n+s/2},{x:a-w/2,y:n-s/2+u.height+M},{x:a-u.width/2,y:n-s/2+u.height+M}]:[{x:a-w/2,y:n-s/2},{x:a+w/2,y:n-s/2},{x:a+w/2,y:n-s/2+b},{x:a+u.width/2,y:n-s/2+b},{x:a+u.width/2/2,y:n+s/2},{x:a-u.width/2,y:n+s/2},{x:a-u.width/2,y:n-s/2+b},{x:a-w/2,y:n-s/2+b}];return W.polygon(e,l,t)},f}async function mt(t,e,{config:{themeVariables:a,flowchart:n}}){const{labelStyles:r}=(0,s.GX)(e);e.labelStyle=r;const o=e.assetHeight??48,d=e.assetWidth??48,y=Math.max(o,d),p=n?.wrappingWidth;e.width=Math.max(y,p??0);const{shapeSvg:f,bbox:u,label:m}=await h(t,e,"icon-shape default"),x=e.label?8:0,b="t"===e.pos,{nodeBorder:w,mainBkg:S}=a,{stylesMap:$}=(0,s.WW)(e),k=c.A.svg(f),v=(0,s.Fr)(e,{});"handDrawn"!==e.look&&(v.roughness=0,v.fillStyle="solid");const M=$.get("fill");v.stroke=M??S;const D=f.append("g");e.icon&&D.html(`<g>${await(0,l.WY)(e.icon,{height:y,width:y,fallbackPrefix:""})}</g>`);const A=D.node().getBBox(),B=A.width,C=A.height,K=A.x,L=A.y,N=Math.max(B,C)*Math.SQRT2+40,R=k.circle(0,0,N,v),P=Math.max(N,u.width),F=N+u.height+x,X=k.rectangle(-P/2,-F/2,P,F,{...v,fill:"transparent",stroke:"none"}),G=f.insert(()=>R,":first-child"),T=f.insert(()=>X);return D.attr("transform",`translate(${-B/2-K},${b?u.height/2+x/2-C/2-L:-u.height/2-x/2-C/2-L})`),D.attr("style",`color: ${$.get("stroke")??w};`),m.attr("transform",`translate(${-u.width/2-(u.x-(u.left??0))},${b?-F/2:F/2-u.height})`),G.attr("transform",`translate(0,${b?u.height/2+x/2:-u.height/2-x/2})`),g(e,T),e.intersect=function(t){i.Rm.info("iconSquare intersect",e,t);return W.rect(e,t)},f}async function xt(t,e,{config:{themeVariables:a,flowchart:n}}){const{labelStyles:r}=(0,s.GX)(e);e.labelStyle=r;const o=e.assetHeight??48,d=e.assetWidth??48,y=Math.max(o,d),p=n?.wrappingWidth;e.width=Math.max(y,p??0);const{shapeSvg:f,bbox:u,halfPadding:m,label:x}=await h(t,e,"icon-shape default"),b="t"===e.pos,w=y+2*m,$=y+2*m,{nodeBorder:k,mainBkg:v}=a,{stylesMap:M}=(0,s.WW)(e),D=-$/2,A=-w/2,B=e.label?8:0,C=c.A.svg(f),K=(0,s.Fr)(e,{});"handDrawn"!==e.look&&(K.roughness=0,K.fillStyle="solid");const L=M.get("fill");K.stroke=L??v;const N=C.path(S(D,A,$,w,5),K),R=Math.max($,u.width),P=w+u.height+B,F=C.rectangle(-R/2,-P/2,R,P,{...K,fill:"transparent",stroke:"none"}),X=f.insert(()=>N,":first-child").attr("class","icon-shape2"),G=f.insert(()=>F);if(e.icon){const t=f.append("g");t.html(`<g>${await(0,l.WY)(e.icon,{height:y,width:y,fallbackPrefix:""})}</g>`);const a=t.node().getBBox(),n=a.width,s=a.height,r=a.x,i=a.y;t.attr("transform",`translate(${-n/2-r},${b?u.height/2+B/2-s/2-i:-u.height/2-B/2-s/2-i})`),t.attr("style",`color: ${M.get("stroke")??k};`)}return x.attr("transform",`translate(${-u.width/2-(u.x-(u.left??0))},${b?-P/2:P/2-u.height})`),X.attr("transform",`translate(0,${b?u.height/2+B/2:-u.height/2-B/2})`),g(e,G),e.intersect=function(t){if(i.Rm.info("iconSquare intersect",e,t),!e.label)return W.rect(e,t);const a=e.x??0,n=e.y??0,s=e.height??0;let l=[];l=b?[{x:a-u.width/2,y:n-s/2},{x:a+u.width/2,y:n-s/2},{x:a+u.width/2,y:n-s/2+u.height+B},{x:a+$/2,y:n-s/2+u.height+B},{x:a+$/2,y:n+s/2},{x:a-$/2,y:n+s/2},{x:a-$/2,y:n-s/2+u.height+B},{x:a-u.width/2,y:n-s/2+u.height+B}]:[{x:a-$/2,y:n-s/2},{x:a+$/2,y:n-s/2},{x:a+$/2,y:n-s/2+w},{x:a+u.width/2,y:n-s/2+w},{x:a+u.width/2/2,y:n+s/2},{x:a-u.width/2,y:n+s/2},{x:a-u.width/2,y:n-s/2+w},{x:a-$/2,y:n-s/2+w}];return W.polygon(e,l,t)},f}async function bt(t,e,{config:{themeVariables:a,flowchart:n}}){const{labelStyles:r}=(0,s.GX)(e);e.labelStyle=r;const o=e.assetHeight??48,d=e.assetWidth??48,y=Math.max(o,d),p=n?.wrappingWidth;e.width=Math.max(y,p??0);const{shapeSvg:f,bbox:u,halfPadding:m,label:x}=await h(t,e,"icon-shape default"),b="t"===e.pos,w=y+2*m,$=y+2*m,{nodeBorder:k,mainBkg:v}=a,{stylesMap:M}=(0,s.WW)(e),D=-$/2,A=-w/2,B=e.label?8:0,C=c.A.svg(f),K=(0,s.Fr)(e,{});"handDrawn"!==e.look&&(K.roughness=0,K.fillStyle="solid");const L=M.get("fill");K.stroke=L??v;const N=C.path(S(D,A,$,w,.1),K),R=Math.max($,u.width),P=w+u.height+B,F=C.rectangle(-R/2,-P/2,R,P,{...K,fill:"transparent",stroke:"none"}),X=f.insert(()=>N,":first-child"),G=f.insert(()=>F);if(e.icon){const t=f.append("g");t.html(`<g>${await(0,l.WY)(e.icon,{height:y,width:y,fallbackPrefix:""})}</g>`);const a=t.node().getBBox(),n=a.width,s=a.height,r=a.x,i=a.y;t.attr("transform",`translate(${-n/2-r},${b?u.height/2+B/2-s/2-i:-u.height/2-B/2-s/2-i})`),t.attr("style",`color: ${M.get("stroke")??k};`)}return x.attr("transform",`translate(${-u.width/2-(u.x-(u.left??0))},${b?-P/2:P/2-u.height})`),X.attr("transform",`translate(0,${b?u.height/2+B/2:-u.height/2-B/2})`),g(e,G),e.intersect=function(t){if(i.Rm.info("iconSquare intersect",e,t),!e.label)return W.rect(e,t);const a=e.x??0,n=e.y??0,s=e.height??0;let l=[];l=b?[{x:a-u.width/2,y:n-s/2},{x:a+u.width/2,y:n-s/2},{x:a+u.width/2,y:n-s/2+u.height+B},{x:a+$/2,y:n-s/2+u.height+B},{x:a+$/2,y:n+s/2},{x:a-$/2,y:n+s/2},{x:a-$/2,y:n-s/2+u.height+B},{x:a-u.width/2,y:n-s/2+u.height+B}]:[{x:a-$/2,y:n-s/2},{x:a+$/2,y:n-s/2},{x:a+$/2,y:n-s/2+w},{x:a+u.width/2,y:n-s/2+w},{x:a+u.width/2/2,y:n+s/2},{x:a-u.width/2,y:n+s/2},{x:a-u.width/2,y:n-s/2+w},{x:a-$/2,y:n-s/2+w}];return W.polygon(e,l,t)},f}async function wt(t,e,{config:{flowchart:a}}){const n=new Image;n.src=e?.img??"",await n.decode();const l=Number(n.naturalWidth.toString().replace("px","")),r=Number(n.naturalHeight.toString().replace("px",""));e.imageAspectRatio=l/r;const{labelStyles:o}=(0,s.GX)(e);e.labelStyle=o;const d=a?.wrappingWidth;e.defaultWidth=a?.wrappingWidth;const y=Math.max(e.label?d??0:0,e?.assetWidth??l),p="on"===e.constraint&&e?.assetHeight?e.assetHeight*e.imageAspectRatio:y,f="on"===e.constraint?p/e.imageAspectRatio:e?.assetHeight??r;e.width=Math.max(p,d??0);const{shapeSvg:u,bbox:m,label:x}=await h(t,e,"image-shape default"),b="t"===e.pos,w=-p/2,S=-f/2,$=e.label?8:0,k=c.A.svg(u),v=(0,s.Fr)(e,{});"handDrawn"!==e.look&&(v.roughness=0,v.fillStyle="solid");const M=k.rectangle(w,S,p,f,v),D=Math.max(p,m.width),A=f+m.height+$,B=k.rectangle(-D/2,-A/2,D,A,{...v,fill:"none",stroke:"none"}),C=u.insert(()=>M,":first-child"),K=u.insert(()=>B);if(e.img){const t=u.append("image");t.attr("href",e.img),t.attr("width",p),t.attr("height",f),t.attr("preserveAspectRatio","none"),t.attr("transform",`translate(${-p/2},${b?A/2-f:-A/2})`)}return x.attr("transform",`translate(${-m.width/2-(m.x-(m.left??0))},${b?-f/2-m.height/2-$/2:f/2-m.height/2+$/2})`),C.attr("transform",`translate(0,${b?m.height/2+$/2:-m.height/2-$/2})`),g(e,K),e.intersect=function(t){if(i.Rm.info("iconSquare intersect",e,t),!e.label)return W.rect(e,t);const a=e.x??0,n=e.y??0,s=e.height??0;let l=[];l=b?[{x:a-m.width/2,y:n-s/2},{x:a+m.width/2,y:n-s/2},{x:a+m.width/2,y:n-s/2+m.height+$},{x:a+p/2,y:n-s/2+m.height+$},{x:a+p/2,y:n+s/2},{x:a-p/2,y:n+s/2},{x:a-p/2,y:n-s/2+m.height+$},{x:a-m.width/2,y:n-s/2+m.height+$}]:[{x:a-p/2,y:n-s/2},{x:a+p/2,y:n-s/2},{x:a+p/2,y:n-s/2+f},{x:a+m.width/2,y:n-s/2+f},{x:a+m.width/2/2,y:n+s/2},{x:a-m.width/2,y:n+s/2},{x:a-m.width/2,y:n-s/2+f},{x:a-p/2,y:n-s/2+f}];return W.polygon(e,l,t)},u}async function St(t,e){const{labelStyles:a,nodeStyles:n}=(0,s.GX)(e);e.labelStyle=a;const{shapeSvg:l,bbox:r}=await h(t,e,y(e)),i=Math.max(r.width+2*(e.padding??0),e?.width??0),o=Math.max(r.height+2*(e.padding??0),e?.height??0),d=[{x:0,y:0},{x:i,y:0},{x:i+3*o/6,y:-o},{x:-3*o/6,y:-o}];let f;const{cssStyles:u}=e;if("handDrawn"===e.look){const t=c.A.svg(l),a=(0,s.Fr)(e,{}),n=p(d),r=t.path(n,a);f=l.insert(()=>r,":first-child").attr("transform",`translate(${-i/2}, ${o/2})`),u&&f.attr("style",u)}else f=E(l,i,o,d);return n&&f.attr("style",n),e.width=i,e.height=o,g(e,f),e.intersect=function(t){return W.polygon(e,d,t)},l}async function $t(t,e,a){const{labelStyles:n,nodeStyles:l}=(0,s.GX)(e);e.labelStyle=n;const{shapeSvg:i,bbox:o}=await h(t,e,y(e)),d=Math.max(o.width+2*a.labelPaddingX,e?.width||0),p=Math.max(o.height+2*a.labelPaddingY,e?.height||0),f=-d/2,u=-p/2;let m,{rx:x,ry:b}=e;const{cssStyles:w}=e;if(a?.rx&&a.ry&&(x=a.rx,b=a.ry),"handDrawn"===e.look){const t=c.A.svg(i),a=(0,s.Fr)(e,{}),n=x||b?t.path(S(f,u,d,p,x||0),a):t.rectangle(f,u,d,p,a);m=i.insert(()=>n,":first-child"),m.attr("class","basic label-container").attr("style",(0,r.KL)(w))}else m=i.insert("rect",":first-child"),m.attr("class","basic label-container").attr("style",l).attr("rx",(0,r.KL)(x)).attr("ry",(0,r.KL)(b)).attr("x",f).attr("y",u).attr("width",d).attr("height",p);return g(e,m),e.intersect=function(t){return W.rect(e,t)},i}async function kt(t,e){const{shapeSvg:a,bbox:n,label:s}=await h(t,e,"label"),l=a.insert("rect",":first-child");return l.attr("width",.1).attr("height",.1),a.attr("class","label edgeLabel"),s.attr("transform",`translate(${-n.width/2-(n.x-(n.left??0))}, ${-n.height/2-(n.y-(n.top??0))})`),g(e,l),e.intersect=function(t){return W.rect(e,t)},a}async function vt(t,e){const{labelStyles:a,nodeStyles:n}=(0,s.GX)(e);e.labelStyle=a;const{shapeSvg:l,bbox:r}=await h(t,e,y(e)),i=Math.max(r.width+(e.padding??0),e?.width??0),o=Math.max(r.height+(e.padding??0),e?.height??0),d=[{x:0,y:0},{x:i+3*o/6,y:0},{x:i,y:-o},{x:-3*o/6,y:-o}];let f;const{cssStyles:u}=e;if("handDrawn"===e.look){const t=c.A.svg(l),a=(0,s.Fr)(e,{}),n=p(d),r=t.path(n,a);f=l.insert(()=>r,":first-child").attr("transform",`translate(${-i/2}, ${o/2})`),u&&f.attr("style",u)}else f=E(l,i,o,d);return n&&f.attr("style",n),e.width=i,e.height=o,g(e,f),e.intersect=function(t){return W.polygon(e,d,t)},l}async function Mt(t,e){const{labelStyles:a,nodeStyles:n}=(0,s.GX)(e);e.labelStyle=a;const{shapeSvg:l,bbox:r}=await h(t,e,y(e)),i=Math.max(r.width+(e.padding??0),e?.width??0),o=Math.max(r.height+(e.padding??0),e?.height??0),d=[{x:-3*o/6,y:0},{x:i,y:0},{x:i+3*o/6,y:-o},{x:0,y:-o}];let f;const{cssStyles:u}=e;if("handDrawn"===e.look){const t=c.A.svg(l),a=(0,s.Fr)(e,{}),n=p(d),r=t.path(n,a);f=l.insert(()=>r,":first-child").attr("transform",`translate(${-i/2}, ${o/2})`),u&&f.attr("style",u)}else f=E(l,i,o,d);return n&&f.attr("style",n),e.width=i,e.height=o,g(e,f),e.intersect=function(t){return W.polygon(e,d,t)},l}function Dt(t,e){const{labelStyles:a,nodeStyles:n}=(0,s.GX)(e);e.label="",e.labelStyle=a;const l=t.insert("g").attr("class",y(e)).attr("id",e.domId??e.id),{cssStyles:r}=e,o=Math.max(35,e?.width??0),h=Math.max(35,e?.height??0),d=[{x:o,y:0},{x:0,y:h+3.5},{x:o-14,y:h+3.5},{x:0,y:2*h},{x:o,y:h-3.5},{x:14,y:h-3.5}],f=c.A.svg(l),u=(0,s.Fr)(e,{});"handDrawn"!==e.look&&(u.roughness=0,u.fillStyle="solid");const m=p(d),x=f.path(m,u),b=l.insert(()=>x,":first-child");return r&&"handDrawn"!==e.look&&b.selectAll("path").attr("style",r),n&&"handDrawn"!==e.look&&b.selectAll("path").attr("style",n),b.attr("transform",`translate(-${o/2},${-h})`),g(e,b),e.intersect=function(t){i.Rm.info("lightningBolt intersect",e,t);return W.polygon(e,d,t)},l}(0,i.K2)(pt,"hexagon"),(0,i.K2)(ft,"hourglass"),(0,i.K2)(ut,"icon"),(0,i.K2)(mt,"iconCircle"),(0,i.K2)(xt,"iconRounded"),(0,i.K2)(bt,"iconSquare"),(0,i.K2)(wt,"imageSquare"),(0,i.K2)(St,"inv_trapezoid"),(0,i.K2)($t,"drawRect"),(0,i.K2)(kt,"labelRect"),(0,i.K2)(vt,"lean_left"),(0,i.K2)(Mt,"lean_right"),(0,i.K2)(Dt,"lightningBolt");var At=(0,i.K2)((t,e,a,n,s,l,r)=>[`M${t},${e+l}`,`a${s},${l} 0,0,0 ${a},0`,`a${s},${l} 0,0,0 ${-a},0`,`l0,${n}`,`a${s},${l} 0,0,0 ${a},0`,"l0,"+-n,`M${t},${e+l+r}`,`a${s},${l} 0,0,0 ${a},0`].join(" "),"createCylinderPathD"),Bt=(0,i.K2)((t,e,a,n,s,l,r)=>[`M${t},${e+l}`,`M${t+a},${e+l}`,`a${s},${l} 0,0,0 ${-a},0`,`l0,${n}`,`a${s},${l} 0,0,0 ${a},0`,"l0,"+-n,`M${t},${e+l+r}`,`a${s},${l} 0,0,0 ${a},0`].join(" "),"createOuterCylinderPathD"),Ct=(0,i.K2)((t,e,a,n,s,l)=>[`M${t-a/2},${-n/2}`,`a${s},${l} 0,0,0 ${a},0`].join(" "),"createInnerCylinderPathD");async function Kt(t,e){const{labelStyles:a,nodeStyles:n}=(0,s.GX)(e);e.labelStyle=a;const{shapeSvg:l,bbox:i,label:o}=await h(t,e,y(e)),d=Math.max(i.width+(e.padding??0),e.width??0),p=d/2,f=p/(2.5+d/50),u=Math.max(i.height+f+(e.padding??0),e.height??0),m=.1*u;let x;const{cssStyles:b}=e;if("handDrawn"===e.look){const t=c.A.svg(l),a=Bt(0,0,d,u,p,f,m),n=Ct(0,f,d,u,p,f),r=(0,s.Fr)(e,{}),i=t.path(a,r),o=t.path(n,r);l.insert(()=>o,":first-child").attr("class","line"),x=l.insert(()=>i,":first-child"),x.attr("class","basic label-container"),b&&x.attr("style",b)}else{const t=At(0,0,d,u,p,f,m);x=l.insert("path",":first-child").attr("d",t).attr("class","basic label-container").attr("style",(0,r.KL)(b)).attr("style",n)}return x.attr("label-offset-y",f),x.attr("transform",`translate(${-d/2}, ${-(u/2+f)})`),g(e,x),o.attr("transform",`translate(${-i.width/2-(i.x-(i.left??0))}, ${-i.height/2+f-(i.y-(i.top??0))})`),e.intersect=function(t){const a=W.rect(e,t),n=a.x-(e.x??0);if(0!=p&&(Math.abs(n)<(e.width??0)/2||Math.abs(n)==(e.width??0)/2&&Math.abs(a.y-(e.y??0))>(e.height??0)/2-f)){let s=f*f*(1-n*n/(p*p));s>0&&(s=Math.sqrt(s)),s=f-s,t.y-(e.y??0)>0&&(s=-s),a.y+=s}return a},l}async function Lt(t,e){const{labelStyles:a,nodeStyles:n}=(0,s.GX)(e);e.labelStyle=a;const{shapeSvg:l,bbox:r,label:i}=await h(t,e,y(e)),o=Math.max(r.width+2*(e.padding??0),e?.width??0),d=Math.max(r.height+2*(e.padding??0),e?.height??0),p=d/4,u=d+p,{cssStyles:m}=e,x=c.A.svg(l),b=(0,s.Fr)(e,{});"handDrawn"!==e.look&&(b.roughness=0,b.fillStyle="solid");const w=[{x:-o/2-o/2*.1,y:-u/2},{x:-o/2-o/2*.1,y:u/2},...f(-o/2-o/2*.1,u/2,o/2+o/2*.1,u/2,p,.8),{x:o/2+o/2*.1,y:-u/2},{x:-o/2-o/2*.1,y:-u/2},{x:-o/2,y:-u/2},{x:-o/2,y:u/2*1.1},{x:-o/2,y:-u/2}],S=x.polygon(w.map(t=>[t.x,t.y]),b),$=l.insert(()=>S,":first-child");return $.attr("class","basic label-container"),m&&"handDrawn"!==e.look&&$.selectAll("path").attr("style",m),n&&"handDrawn"!==e.look&&$.selectAll("path").attr("style",n),$.attr("transform",`translate(0,${-p/2})`),i.attr("transform",`translate(${-o/2+(e.padding??0)+o/2*.1/2-(r.x-(r.left??0))},${-d/2+(e.padding??0)-p/2-(r.y-(r.top??0))})`),g(e,$),e.intersect=function(t){return W.polygon(e,w,t)},l}async function Nt(t,e){const{labelStyles:a,nodeStyles:n}=(0,s.GX)(e);e.labelStyle=a;const{shapeSvg:l,bbox:r,label:i}=await h(t,e,y(e)),o=Math.max(r.width+2*(e.padding??0),e?.width??0),d=Math.max(r.height+2*(e.padding??0),e?.height??0),f=-o/2,u=-d/2,{cssStyles:m}=e,x=c.A.svg(l),b=(0,s.Fr)(e,{}),w=[{x:f-5,y:u+5},{x:f-5,y:u+d+5},{x:f+o-5,y:u+d+5},{x:f+o-5,y:u+d},{x:f+o,y:u+d},{x:f+o,y:u+d-5},{x:f+o+5,y:u+d-5},{x:f+o+5,y:u-5},{x:f+5,y:u-5},{x:f+5,y:u},{x:f,y:u},{x:f,y:u+5}],S=[{x:f,y:u+5},{x:f+o-5,y:u+5},{x:f+o-5,y:u+d},{x:f+o,y:u+d},{x:f+o,y:u},{x:f,y:u}];"handDrawn"!==e.look&&(b.roughness=0,b.fillStyle="solid");const $=p(w),k=x.path($,b),v=p(S),M=x.path(v,{...b,fill:"none"}),D=l.insert(()=>M,":first-child");return D.insert(()=>k,":first-child"),D.attr("class","basic label-container"),m&&"handDrawn"!==e.look&&D.selectAll("path").attr("style",m),n&&"handDrawn"!==e.look&&D.selectAll("path").attr("style",n),i.attr("transform",`translate(${-r.width/2-5-(r.x-(r.left??0))}, ${-r.height/2+5-(r.y-(r.top??0))})`),g(e,D),e.intersect=function(t){return W.polygon(e,w,t)},l}async function Rt(t,e){const{labelStyles:a,nodeStyles:n}=(0,s.GX)(e);e.labelStyle=a;const{shapeSvg:l,bbox:r,label:i}=await h(t,e,y(e)),o=Math.max(r.width+2*(e.padding??0),e?.width??0),d=Math.max(r.height+2*(e.padding??0),e?.height??0),u=d/4,m=d+u,x=-o/2,b=-m/2,{cssStyles:w}=e,S=f(x-5,b+m+5,x+o-5,b+m+5,u,.8),$=S?.[S.length-1],k=[{x:x-5,y:b+5},{x:x-5,y:b+m+5},...S,{x:x+o-5,y:$.y-5},{x:x+o,y:$.y-5},{x:x+o,y:$.y-10},{x:x+o+5,y:$.y-10},{x:x+o+5,y:b-5},{x:x+5,y:b-5},{x:x+5,y:b},{x:x,y:b},{x:x,y:b+5}],v=[{x:x,y:b+5},{x:x+o-5,y:b+5},{x:x+o-5,y:$.y-5},{x:x+o,y:$.y-5},{x:x+o,y:b},{x:x,y:b}],M=c.A.svg(l),D=(0,s.Fr)(e,{});"handDrawn"!==e.look&&(D.roughness=0,D.fillStyle="solid");const A=p(k),B=M.path(A,D),C=p(v),K=M.path(C,D),L=l.insert(()=>B,":first-child");return L.insert(()=>K),L.attr("class","basic label-container"),w&&"handDrawn"!==e.look&&L.selectAll("path").attr("style",w),n&&"handDrawn"!==e.look&&L.selectAll("path").attr("style",n),L.attr("transform",`translate(0,${-u/2})`),i.attr("transform",`translate(${-r.width/2-5-(r.x-(r.left??0))}, ${-r.height/2+5-u/2-(r.y-(r.top??0))})`),g(e,L),e.intersect=function(t){return W.polygon(e,k,t)},l}async function Pt(t,e,{config:{themeVariables:a}}){const{labelStyles:n,nodeStyles:l}=(0,s.GX)(e);e.labelStyle=n;e.useHtmlLabels||!1!==(0,i.zj)().flowchart?.htmlLabels||(e.centerLabel=!0);const{shapeSvg:r,bbox:o}=await h(t,e,y(e)),d=Math.max(o.width+2*(e.padding??0),e?.width??0),p=Math.max(o.height+2*(e.padding??0),e?.height??0),f=-d/2,u=-p/2,{cssStyles:m}=e,x=c.A.svg(r),b=(0,s.Fr)(e,{fill:a.noteBkgColor,stroke:a.noteBorderColor});"handDrawn"!==e.look&&(b.roughness=0,b.fillStyle="solid");const w=x.rectangle(f,u,d,p,b),S=r.insert(()=>w,":first-child");return S.attr("class","basic label-container"),m&&"handDrawn"!==e.look&&S.selectAll("path").attr("style",m),l&&"handDrawn"!==e.look&&S.selectAll("path").attr("style",l),g(e,S),e.intersect=function(t){return W.rect(e,t)},r}(0,i.K2)(Kt,"linedCylinder"),(0,i.K2)(Lt,"linedWaveEdgedRect"),(0,i.K2)(Nt,"multiRect"),(0,i.K2)(Rt,"multiWaveEdgedRectangle"),(0,i.K2)(Pt,"note");var Ft=(0,i.K2)((t,e,a)=>[`M${t+a/2},${e}`,`L${t+a},${e-a/2}`,`L${t+a/2},${e-a}`,`L${t},${e-a/2}`,"Z"].join(" "),"createDecisionBoxPathD");async function Xt(t,e){const{labelStyles:a,nodeStyles:n}=(0,s.GX)(e);e.labelStyle=a;const{shapeSvg:l,bbox:r}=await h(t,e,y(e)),o=r.width+e.padding+(r.height+e.padding),d=[{x:o/2,y:0},{x:o,y:-o/2},{x:o/2,y:-o},{x:0,y:-o/2}];let p;const{cssStyles:f}=e;if("handDrawn"===e.look){const t=c.A.svg(l),a=(0,s.Fr)(e,{}),n=Ft(0,0,o),r=t.path(n,a);p=l.insert(()=>r,":first-child").attr("transform",`translate(${-o/2}, ${o/2})`),f&&p.attr("style",f)}else p=E(l,o,o,d);return n&&p.attr("style",n),g(e,p),e.intersect=function(t){return i.Rm.debug("APA12 Intersect called SPLIT\npoint:",t,"\nnode:\n",e,"\nres:",W.polygon(e,d,t)),W.polygon(e,d,t)},l}async function Gt(t,e){const{labelStyles:a,nodeStyles:n}=(0,s.GX)(e);e.labelStyle=a;const{shapeSvg:l,bbox:r,label:i}=await h(t,e,y(e)),o=-Math.max(r.width+(e.padding??0),e?.width??0)/2,d=-Math.max(r.height+(e.padding??0),e?.height??0)/2,f=d/2,u=[{x:o+f,y:d},{x:o,y:0},{x:o+f,y:-d},{x:-o,y:-d},{x:-o,y:d}],{cssStyles:m}=e,x=c.A.svg(l),b=(0,s.Fr)(e,{});"handDrawn"!==e.look&&(b.roughness=0,b.fillStyle="solid");const w=p(u),S=x.path(w,b),$=l.insert(()=>S,":first-child");return $.attr("class","basic label-container"),m&&"handDrawn"!==e.look&&$.selectAll("path").attr("style",m),n&&"handDrawn"!==e.look&&$.selectAll("path").attr("style",n),$.attr("transform",`translate(${-f/2},0)`),i.attr("transform",`translate(${-f/2-r.width/2-(r.x-(r.left??0))}, ${-r.height/2-(r.y-(r.top??0))})`),g(e,$),e.intersect=function(t){return W.polygon(e,u,t)},l}async function Tt(t,e){const{labelStyles:a,nodeStyles:n}=(0,s.GX)(e);let l;e.labelStyle=a,l=e.cssClasses?"node "+e.cssClasses:"node default";const r=t.insert("g").attr("class",l).attr("id",e.domId||e.id),h=r.insert("g"),d=r.insert("g").attr("class","label").attr("style",n),y=e.description,p=e.label,f=d.node().appendChild(await w(p,e.labelStyle,!0,!0));let u={width:0,height:0};if((0,i._3)((0,i.D7)()?.flowchart?.htmlLabels)){const t=f.children[0],e=(0,o.Ltv)(f);u=t.getBoundingClientRect(),e.attr("width",u.width),e.attr("height",u.height)}i.Rm.info("Text 2",y);const m=y||[],x=f.getBBox(),b=d.node().appendChild(await w(m.join?m.join("<br/>"):m,e.labelStyle,!0,!0)),$=b.children[0],k=(0,o.Ltv)(b);u=$.getBoundingClientRect(),k.attr("width",u.width),k.attr("height",u.height);const v=(e.padding||0)/2;(0,o.Ltv)(b).attr("transform","translate( "+(u.width>x.width?0:(x.width-u.width)/2)+", "+(x.height+v+5)+")"),(0,o.Ltv)(f).attr("transform","translate( "+(u.width<x.width?0:-(x.width-u.width)/2)+", 0)"),u=d.node().getBBox(),d.attr("transform","translate("+-u.width/2+", "+(-u.height/2-v+3)+")");const M=u.width+(e.padding||0),D=u.height+(e.padding||0),A=-u.width/2-v,B=-u.height/2-v;let C,K;if("handDrawn"===e.look){const t=c.A.svg(r),a=(0,s.Fr)(e,{}),n=t.path(S(A,B,M,D,e.rx||0),a),l=t.line(-u.width/2-v,-u.height/2-v+x.height+v,u.width/2+v,-u.height/2-v+x.height+v,a);K=r.insert(()=>(i.Rm.debug("Rough node insert CXC",n),l),":first-child"),C=r.insert(()=>(i.Rm.debug("Rough node insert CXC",n),n),":first-child")}else C=h.insert("rect",":first-child"),K=h.insert("line"),C.attr("class","outer title-state").attr("style",n).attr("x",-u.width/2-v).attr("y",-u.height/2-v).attr("width",u.width+(e.padding||0)).attr("height",u.height+(e.padding||0)),K.attr("class","divider").attr("x1",-u.width/2-v).attr("x2",u.width/2+v).attr("y1",-u.height/2-v+x.height+v).attr("y2",-u.height/2-v+x.height+v);return g(e,C),e.intersect=function(t){return W.rect(e,t)},r}async function It(t,e){return $t(t,e,{rx:5,ry:5,classes:"",labelPaddingX:1*(e?.padding||0),labelPaddingY:1*(e?.padding||0)})}async function Wt(t,e){const{labelStyles:a,nodeStyles:n}=(0,s.GX)(e);e.labelStyle=a;const{shapeSvg:l,bbox:i,label:o}=await h(t,e,y(e)),d=e?.padding??0,p=Math.max(i.width+2*(e.padding??0),e?.width??0),f=Math.max(i.height+2*(e.padding??0),e?.height??0),u=-i.width/2-d,m=-i.height/2-d,{cssStyles:x}=e,b=c.A.svg(l),w=(0,s.Fr)(e,{});"handDrawn"!==e.look&&(w.roughness=0,w.fillStyle="solid");const S=[{x:u,y:m},{x:u+p+8,y:m},{x:u+p+8,y:m+f},{x:u-8,y:m+f},{x:u-8,y:m},{x:u,y:m},{x:u,y:m+f}],$=b.polygon(S.map(t=>[t.x,t.y]),w),k=l.insert(()=>$,":first-child");return k.attr("class","basic label-container").attr("style",(0,r.KL)(x)),n&&"handDrawn"!==e.look&&k.selectAll("path").attr("style",n),x&&"handDrawn"!==e.look&&k.selectAll("path").attr("style",n),o.attr("transform",`translate(${-p/2+4+(e.padding??0)-(i.x-(i.left??0))},${-f/2+(e.padding??0)-(i.y-(i.top??0))})`),g(e,k),e.intersect=function(t){return W.rect(e,t)},l}async function jt(t,e){const{labelStyles:a,nodeStyles:n}=(0,s.GX)(e);e.labelStyle=a;const{shapeSvg:l,bbox:r,label:i}=await h(t,e,y(e)),o=Math.max(r.width+2*(e.padding??0),e?.width??0),d=Math.max(r.height+2*(e.padding??0),e?.height??0),f=-o/2,u=-d/2,{cssStyles:m}=e,x=c.A.svg(l),b=(0,s.Fr)(e,{});"handDrawn"!==e.look&&(b.roughness=0,b.fillStyle="solid");const w=[{x:f,y:u},{x:f,y:u+d},{x:f+o,y:u+d},{x:f+o,y:u-d/2}],S=p(w),$=x.path(S,b),k=l.insert(()=>$,":first-child");return k.attr("class","basic label-container"),m&&"handDrawn"!==e.look&&k.selectChildren("path").attr("style",m),n&&"handDrawn"!==e.look&&k.selectChildren("path").attr("style",n),k.attr("transform",`translate(0, ${d/4})`),i.attr("transform",`translate(${-o/2+(e.padding??0)-(r.x-(r.left??0))}, ${-d/4+(e.padding??0)-(r.y-(r.top??0))})`),g(e,k),e.intersect=function(t){return W.polygon(e,w,t)},l}async function Ht(t,e){return $t(t,e,{rx:0,ry:0,classes:"",labelPaddingX:2*(e?.padding||0),labelPaddingY:1*(e?.padding||0)})}async function _t(t,e){const{labelStyles:a,nodeStyles:n}=(0,s.GX)(e);e.labelStyle=a;const{shapeSvg:l,bbox:i}=await h(t,e,y(e)),o=i.height+e.padding,d=i.width+o/4+e.padding;let p;const{cssStyles:f}=e;if("handDrawn"===e.look){const t=c.A.svg(l),a=(0,s.Fr)(e,{}),n=S(-d/2,-o/2,d,o,o/2),i=t.path(n,a);p=l.insert(()=>i,":first-child"),p.attr("class","basic label-container").attr("style",(0,r.KL)(f))}else p=l.insert("rect",":first-child"),p.attr("class","basic label-container").attr("style",n).attr("rx",o/2).attr("ry",o/2).attr("x",-d/2).attr("y",-o/2).attr("width",d).attr("height",o);return g(e,p),e.intersect=function(t){return W.rect(e,t)},l}async function Et(t,e){return $t(t,e,{rx:5,ry:5,classes:"flowchart-node"})}function qt(t,e,{config:{themeVariables:a}}){const{labelStyles:n,nodeStyles:l}=(0,s.GX)(e);e.labelStyle=n;const{cssStyles:r}=e,{lineColor:i,stateBorder:o,nodeBorder:h}=a,d=t.insert("g").attr("class","node default").attr("id",e.domId||e.id),y=c.A.svg(d),p=(0,s.Fr)(e,{});"handDrawn"!==e.look&&(p.roughness=0,p.fillStyle="solid");const f=y.circle(0,0,14,{...p,stroke:i,strokeWidth:2}),u=o??h,m=y.circle(0,0,5,{...p,fill:u,stroke:u,strokeWidth:2,fillStyle:"solid"}),x=d.insert(()=>f,":first-child");return x.insert(()=>m),r&&x.selectAll("path").attr("style",r),l&&x.selectAll("path").attr("style",l),g(e,x),e.intersect=function(t){return W.circle(e,7,t)},d}function zt(t,e,{config:{themeVariables:a}}){const{lineColor:n}=a,l=t.insert("g").attr("class","node default").attr("id",e.domId||e.id);let r;if("handDrawn"===e.look){const t=c.A.svg(l).circle(0,0,14,(0,s.ue)(n));r=l.insert(()=>t),r.attr("class","state-start").attr("r",7).attr("width",14).attr("height",14)}else r=l.insert("circle",":first-child"),r.attr("class","state-start").attr("r",7).attr("width",14).attr("height",14);return g(e,r),e.intersect=function(t){return W.circle(e,7,t)},l}async function Ot(t,e){const{labelStyles:a,nodeStyles:n}=(0,s.GX)(e);e.labelStyle=a;const{shapeSvg:l,bbox:i}=await h(t,e,y(e)),o=(e?.padding||0)/2,d=i.width+e.padding,p=i.height+e.padding,f=-i.width/2-o,u=-i.height/2-o,m=[{x:0,y:0},{x:d,y:0},{x:d,y:-p},{x:0,y:-p},{x:0,y:0},{x:-8,y:0},{x:d+8,y:0},{x:d+8,y:-p},{x:-8,y:-p},{x:-8,y:0}];if("handDrawn"===e.look){const t=c.A.svg(l),a=(0,s.Fr)(e,{}),n=t.rectangle(f-8,u,d+16,p,a),i=t.line(f,u,f,u+p,a),o=t.line(f+d,u,f+d,u+p,a);l.insert(()=>i,":first-child"),l.insert(()=>o,":first-child");const h=l.insert(()=>n,":first-child"),{cssStyles:y}=e;h.attr("class","basic label-container").attr("style",(0,r.KL)(y)),g(e,h)}else{const t=E(l,d,p,m);n&&t.attr("style",n),g(e,t)}return e.intersect=function(t){return W.polygon(e,m,t)},l}async function Vt(t,e){const{labelStyles:a,nodeStyles:n}=(0,s.GX)(e);e.labelStyle=a;const{shapeSvg:l,bbox:r}=await h(t,e,y(e)),i=Math.max(r.width+2*(e.padding??0),e?.width??0),o=Math.max(r.height+2*(e.padding??0),e?.height??0),d=-i/2,f=-o/2,u=.2*o,m=.2*o,{cssStyles:x}=e,b=c.A.svg(l),w=(0,s.Fr)(e,{}),S=[{x:d-u/2,y:f},{x:d+i+u/2,y:f},{x:d+i+u/2,y:f+o},{x:d-u/2,y:f+o}],$=[{x:d+i-u/2,y:f+o},{x:d+i+u/2,y:f+o},{x:d+i+u/2,y:f+o-m}];"handDrawn"!==e.look&&(w.roughness=0,w.fillStyle="solid");const k=p(S),v=b.path(k,w),M=p($),D=b.path(M,{...w,fillStyle:"solid"}),A=l.insert(()=>D,":first-child");return A.insert(()=>v,":first-child"),A.attr("class","basic label-container"),x&&"handDrawn"!==e.look&&A.selectAll("path").attr("style",x),n&&"handDrawn"!==e.look&&A.selectAll("path").attr("style",n),g(e,A),e.intersect=function(t){return W.polygon(e,S,t)},l}async function Zt(t,e){const{labelStyles:a,nodeStyles:n}=(0,s.GX)(e);e.labelStyle=a;const{shapeSvg:l,bbox:r,label:i}=await h(t,e,y(e)),o=Math.max(r.width+2*(e.padding??0),e?.width??0),d=Math.max(r.height+2*(e.padding??0),e?.height??0),u=d/4,m=.2*o,x=.2*d,b=d+u,{cssStyles:w}=e,S=c.A.svg(l),$=(0,s.Fr)(e,{});"handDrawn"!==e.look&&($.roughness=0,$.fillStyle="solid");const k=[{x:-o/2-o/2*.1,y:b/2},...f(-o/2-o/2*.1,b/2,o/2+o/2*.1,b/2,u,.8),{x:o/2+o/2*.1,y:-b/2},{x:-o/2-o/2*.1,y:-b/2}],v=-o/2+o/2*.1,M=-b/2-.4*x,D=[{x:v+o-m,y:1.4*(M+d)},{x:v+o,y:M+d-x},{x:v+o,y:.9*(M+d)},...f(v+o,1.3*(M+d),v+o-m,1.5*(M+d),.03*-d,.5)],A=p(k),B=S.path(A,$),C=p(D),K=S.path(C,{...$,fillStyle:"solid"}),L=l.insert(()=>K,":first-child");return L.insert(()=>B,":first-child"),L.attr("class","basic label-container"),w&&"handDrawn"!==e.look&&L.selectAll("path").attr("style",w),n&&"handDrawn"!==e.look&&L.selectAll("path").attr("style",n),L.attr("transform",`translate(0,${-u/2})`),i.attr("transform",`translate(${-o/2+(e.padding??0)-(r.x-(r.left??0))},${-d/2+(e.padding??0)-u/2-(r.y-(r.top??0))})`),g(e,L),e.intersect=function(t){return W.polygon(e,k,t)},l}async function Yt(t,e){const{labelStyles:a,nodeStyles:n}=(0,s.GX)(e);e.labelStyle=a;const{shapeSvg:l,bbox:r}=await h(t,e,y(e)),i=Math.max(r.width+e.padding,e?.width||0),o=Math.max(r.height+e.padding,e?.height||0),c=-i/2,d=-o/2,p=l.insert("rect",":first-child");return p.attr("class","text").attr("style",n).attr("rx",0).attr("ry",0).attr("x",c).attr("y",d).attr("width",i).attr("height",o),g(e,p),e.intersect=function(t){return W.rect(e,t)},l}(0,i.K2)(Xt,"question"),(0,i.K2)(Gt,"rect_left_inv_arrow"),(0,i.K2)(Tt,"rectWithTitle"),(0,i.K2)(It,"roundedRect"),(0,i.K2)(Wt,"shadedProcess"),(0,i.K2)(jt,"slopedRect"),(0,i.K2)(Ht,"squareRect"),(0,i.K2)(_t,"stadium"),(0,i.K2)(Et,"state"),(0,i.K2)(qt,"stateEnd"),(0,i.K2)(zt,"stateStart"),(0,i.K2)(Ot,"subroutine"),(0,i.K2)(Vt,"taggedRect"),(0,i.K2)(Zt,"taggedWaveEdgedRectangle"),(0,i.K2)(Yt,"text");var Ut=(0,i.K2)((t,e,a,n,s,l)=>`M${t},${e}\n    a${s},${l} 0,0,1 0,${-n}\n    l${a},0\n    a${s},${l} 0,0,1 0,${n}\n    M${a},${-n}\n    a${s},${l} 0,0,0 0,${n}\n    l${-a},0`,"createCylinderPathD"),Jt=(0,i.K2)((t,e,a,n,s,l)=>[`M${t},${e}`,`M${t+a},${e}`,`a${s},${l} 0,0,0 0,${-n}`,`l${-a},0`,`a${s},${l} 0,0,0 0,${n}`,`l${a},0`].join(" "),"createOuterCylinderPathD"),Qt=(0,i.K2)((t,e,a,n,s,l)=>[`M${t+a/2},${-n/2}`,`a${s},${l} 0,0,0 0,${n}`].join(" "),"createInnerCylinderPathD");async function te(t,e){const{labelStyles:a,nodeStyles:n}=(0,s.GX)(e);e.labelStyle=a;const{shapeSvg:l,bbox:i,label:o,halfPadding:d}=await h(t,e,y(e)),p="neo"===e.look?2*d:d,f=i.height+p,u=f/2,m=u/(2.5+f/50),x=i.width+m+p,{cssStyles:b}=e;let w;if("handDrawn"===e.look){const t=c.A.svg(l),a=Jt(0,0,x,f,m,u),n=Qt(0,0,x,f,m,u),r=t.path(a,(0,s.Fr)(e,{})),i=t.path(n,(0,s.Fr)(e,{fill:"none"}));w=l.insert(()=>i,":first-child"),w=l.insert(()=>r,":first-child"),w.attr("class","basic label-container"),b&&w.attr("style",b)}else{const t=Ut(0,0,x,f,m,u);w=l.insert("path",":first-child").attr("d",t).attr("class","basic label-container").attr("style",(0,r.KL)(b)).attr("style",n),w.attr("class","basic label-container"),b&&w.selectAll("path").attr("style",b),n&&w.selectAll("path").attr("style",n)}return w.attr("label-offset-x",m),w.attr("transform",`translate(${-x/2}, ${f/2} )`),o.attr("transform",`translate(${-i.width/2-m-(i.x-(i.left??0))}, ${-i.height/2-(i.y-(i.top??0))})`),g(e,w),e.intersect=function(t){const a=W.rect(e,t),n=a.y-(e.y??0);if(0!=u&&(Math.abs(n)<(e.height??0)/2||Math.abs(n)==(e.height??0)/2&&Math.abs(a.x-(e.x??0))>(e.width??0)/2-m)){let s=m*m*(1-n*n/(u*u));0!=s&&(s=Math.sqrt(Math.abs(s))),s=m-s,t.x-(e.x??0)>0&&(s=-s),a.x+=s}return a},l}async function ee(t,e){const{labelStyles:a,nodeStyles:n}=(0,s.GX)(e);e.labelStyle=a;const{shapeSvg:l,bbox:r}=await h(t,e,y(e)),i=r.width+e.padding,o=r.height+e.padding,d=[{x:-3*o/6,y:0},{x:i+3*o/6,y:0},{x:i,y:-o},{x:0,y:-o}];let f;const{cssStyles:u}=e;if("handDrawn"===e.look){const t=c.A.svg(l),a=(0,s.Fr)(e,{}),n=p(d),r=t.path(n,a);f=l.insert(()=>r,":first-child").attr("transform",`translate(${-i/2}, ${o/2})`),u&&f.attr("style",u)}else f=E(l,i,o,d);return n&&f.attr("style",n),e.width=i,e.height=o,g(e,f),e.intersect=function(t){return W.polygon(e,d,t)},l}async function ae(t,e){const{labelStyles:a,nodeStyles:n}=(0,s.GX)(e);e.labelStyle=a;const{shapeSvg:l,bbox:r}=await h(t,e,y(e)),i=Math.max(60,r.width+2*(e.padding??0),e?.width??0),o=Math.max(20,r.height+2*(e.padding??0),e?.height??0),{cssStyles:d}=e,f=c.A.svg(l),u=(0,s.Fr)(e,{});"handDrawn"!==e.look&&(u.roughness=0,u.fillStyle="solid");const m=[{x:-i/2*.8,y:-o/2},{x:i/2*.8,y:-o/2},{x:i/2,y:-o/2*.6},{x:i/2,y:o/2},{x:-i/2,y:o/2},{x:-i/2,y:-o/2*.6}],x=p(m),b=f.path(x,u),w=l.insert(()=>b,":first-child");return w.attr("class","basic label-container"),d&&"handDrawn"!==e.look&&w.selectChildren("path").attr("style",d),n&&"handDrawn"!==e.look&&w.selectChildren("path").attr("style",n),g(e,w),e.intersect=function(t){return W.polygon(e,m,t)},l}async function ne(t,e){const{labelStyles:a,nodeStyles:n}=(0,s.GX)(e);e.labelStyle=a;const{shapeSvg:l,bbox:r,label:o}=await h(t,e,y(e)),d=(0,i._3)((0,i.D7)().flowchart?.htmlLabels),f=r.width+(e.padding??0),u=f+r.height,m=f+r.height,x=[{x:0,y:0},{x:m,y:0},{x:m/2,y:-u}],{cssStyles:b}=e,w=c.A.svg(l),S=(0,s.Fr)(e,{});"handDrawn"!==e.look&&(S.roughness=0,S.fillStyle="solid");const $=p(x),k=w.path($,S),v=l.insert(()=>k,":first-child").attr("transform",`translate(${-u/2}, ${u/2})`);return b&&"handDrawn"!==e.look&&v.selectChildren("path").attr("style",b),n&&"handDrawn"!==e.look&&v.selectChildren("path").attr("style",n),e.width=f,e.height=u,g(e,v),o.attr("transform",`translate(${-r.width/2-(r.x-(r.left??0))}, ${u/2-(r.height+(e.padding??0)/(d?2:1)-(r.y-(r.top??0)))})`),e.intersect=function(t){return i.Rm.info("Triangle intersect",e,x,t),W.polygon(e,x,t)},l}async function se(t,e){const{labelStyles:a,nodeStyles:n}=(0,s.GX)(e);e.labelStyle=a;const{shapeSvg:l,bbox:r,label:i}=await h(t,e,y(e)),o=Math.max(r.width+2*(e.padding??0),e?.width??0),d=Math.max(r.height+2*(e.padding??0),e?.height??0),u=d/8,m=d+u,{cssStyles:x}=e,b=70-o,w=b>0?b/2:0,S=c.A.svg(l),$=(0,s.Fr)(e,{});"handDrawn"!==e.look&&($.roughness=0,$.fillStyle="solid");const k=[{x:-o/2-w,y:m/2},...f(-o/2-w,m/2,o/2+w,m/2,u,.8),{x:o/2+w,y:-m/2},{x:-o/2-w,y:-m/2}],v=p(k),M=S.path(v,$),D=l.insert(()=>M,":first-child");return D.attr("class","basic label-container"),x&&"handDrawn"!==e.look&&D.selectAll("path").attr("style",x),n&&"handDrawn"!==e.look&&D.selectAll("path").attr("style",n),D.attr("transform",`translate(0,${-u/2})`),i.attr("transform",`translate(${-o/2+(e.padding??0)-(r.x-(r.left??0))},${-d/2+(e.padding??0)-u-(r.y-(r.top??0))})`),g(e,D),e.intersect=function(t){return W.polygon(e,k,t)},l}async function le(t,e){const{labelStyles:a,nodeStyles:n}=(0,s.GX)(e);e.labelStyle=a;const{shapeSvg:l,bbox:r}=await h(t,e,y(e)),i=Math.max(r.width+2*(e.padding??0),e?.width??0),o=Math.max(r.height+2*(e.padding??0),e?.height??0),d=i/o;let u=i,m=o;u>m*d?m=u/d:u=m*d,u=Math.max(u,100),m=Math.max(m,50);const x=Math.min(.2*m,m/4),b=m+2*x,{cssStyles:w}=e,S=c.A.svg(l),$=(0,s.Fr)(e,{});"handDrawn"!==e.look&&($.roughness=0,$.fillStyle="solid");const k=[{x:-u/2,y:b/2},...f(-u/2,b/2,u/2,b/2,x,1),{x:u/2,y:-b/2},...f(u/2,-b/2,-u/2,-b/2,x,-1)],v=p(k),M=S.path(v,$),D=l.insert(()=>M,":first-child");return D.attr("class","basic label-container"),w&&"handDrawn"!==e.look&&D.selectAll("path").attr("style",w),n&&"handDrawn"!==e.look&&D.selectAll("path").attr("style",n),g(e,D),e.intersect=function(t){return W.polygon(e,k,t)},l}async function re(t,e){const{labelStyles:a,nodeStyles:n}=(0,s.GX)(e);e.labelStyle=a;const{shapeSvg:l,bbox:r,label:i}=await h(t,e,y(e)),o=Math.max(r.width+2*(e.padding??0),e?.width??0),d=Math.max(r.height+2*(e.padding??0),e?.height??0),p=-o/2,f=-d/2,{cssStyles:u}=e,m=c.A.svg(l),x=(0,s.Fr)(e,{}),b=[{x:p-5,y:f-5},{x:p-5,y:f+d},{x:p+o,y:f+d},{x:p+o,y:f-5}],w=`M${p-5},${f-5} L${p+o},${f-5} L${p+o},${f+d} L${p-5},${f+d} L${p-5},${f-5}\n                M${p-5},${f} L${p+o},${f}\n                M${p},${f-5} L${p},${f+d}`;"handDrawn"!==e.look&&(x.roughness=0,x.fillStyle="solid");const S=m.path(w,x),$=l.insert(()=>S,":first-child");return $.attr("transform","translate(2.5, 2.5)"),$.attr("class","basic label-container"),u&&"handDrawn"!==e.look&&$.selectAll("path").attr("style",u),n&&"handDrawn"!==e.look&&$.selectAll("path").attr("style",n),i.attr("transform",`translate(${-r.width/2+2.5-(r.x-(r.left??0))}, ${-r.height/2+2.5-(r.y-(r.top??0))})`),g(e,$),e.intersect=function(t){return W.polygon(e,b,t)},l}async function ie(t,e){const a=e;if(a.alias&&(e.label=a.alias),"handDrawn"===e.look){const{themeVariables:a}=(0,i.zj)(),{background:n}=a,s={...e,id:e.id+"-background",look:"default",cssStyles:["stroke: none",`fill: ${n}`]};await ie(t,s)}const n=(0,i.zj)();e.useHtmlLabels=n.htmlLabels;let l=n.er?.diagramPadding??10,h=n.er?.entityPadding??6;const{cssStyles:d}=e,{labelStyles:p,nodeStyles:f}=(0,s.GX)(e);if(0===a.attributes.length&&e.label){const a={rx:0,ry:0,labelPaddingX:l,labelPaddingY:1.5*l,classes:""};(0,r.Un)(e.label,n)+2*a.labelPaddingX<n.er.minEntityWidth&&(e.width=n.er.minEntityWidth);const s=await $t(t,e,a);if(!(0,i._3)(n.htmlLabels)){const t=s.select("text"),e=t.node()?.getBBox();t.attr("transform",`translate(${-e.width/2}, 0)`)}return s}n.htmlLabels||(l*=1.25,h*=1.25);let u=y(e);u||(u="node default");const m=t.insert("g").attr("class",u).attr("id",e.domId||e.id),x=await oe(m,e.label??"",n,0,0,["name"],p);x.height+=h;let b=0;const w=[],S=[];let $=0,k=0,v=0,M=0,D=!0,A=!0;for(const s of a.attributes){const t=await oe(m,s.type,n,0,b,["attribute-type"],p);$=Math.max($,t.width+l);const e=await oe(m,s.name,n,0,b,["attribute-name"],p);k=Math.max(k,e.width+l);const a=await oe(m,s.keys.join(),n,0,b,["attribute-keys"],p);v=Math.max(v,a.width+l);const r=await oe(m,s.comment,n,0,b,["attribute-comment"],p);M=Math.max(M,r.width+l);const i=Math.max(t.height,e.height,a.height,r.height)+h;S.push({yOffset:b,rowHeight:i}),b+=i}let B=4;v<=l&&(D=!1,v=0,B--),M<=l&&(A=!1,M=0,B--);const C=m.node().getBBox();if(x.width+2*l-($+k+v+M)>0){const t=x.width+2*l-($+k+v+M);$+=t/B,k+=t/B,v>0&&(v+=t/B),M>0&&(M+=t/B)}const K=$+k+v+M,L=c.A.svg(m),N=(0,s.Fr)(e,{});"handDrawn"!==e.look&&(N.roughness=0,N.fillStyle="solid");let R=0;S.length>0&&(R=S.reduce((t,e)=>t+(e?.rowHeight??0),0));const P=Math.max(C.width+2*l,e?.width||0,K),F=Math.max((R??0)+x.height,e?.height||0),X=-P/2,G=-F/2;m.selectAll("g:not(:first-child)").each((t,e,a)=>{const n=(0,o.Ltv)(a[e]),s=n.attr("transform");let r=0,i=0;if(s){const t=RegExp(/translate\(([^,]+),([^)]+)\)/).exec(s);t&&(r=parseFloat(t[1]),i=parseFloat(t[2]),n.attr("class").includes("attribute-name")?r+=$:n.attr("class").includes("attribute-keys")?r+=$+k:n.attr("class").includes("attribute-comment")&&(r+=$+k+v))}n.attr("transform",`translate(${X+l/2+r}, ${i+G+x.height+h/2})`)}),m.select(".name").attr("transform","translate("+-x.width/2+", "+(G+h/2)+")");const T=L.rectangle(X,G,P,F,N),I=m.insert(()=>T,":first-child").attr("style",d.join("")),{themeVariables:j}=(0,i.zj)(),{rowEven:H,rowOdd:_,nodeBorder:E}=j;w.push(0);for(const[s,r]of S.entries()){const t=(s+1)%2==0&&0!==r.yOffset,e=L.rectangle(X,x.height+G+r?.yOffset,P,r?.rowHeight,{...N,fill:t?H:_,stroke:E});m.insert(()=>e,"g.label").attr("style",d.join("")).attr("class","row-rect-"+(t?"even":"odd"))}let q=L.line(X,x.height+G,P+X,x.height+G,N);m.insert(()=>q).attr("class","divider"),q=L.line($+X,x.height+G,$+X,F+G,N),m.insert(()=>q).attr("class","divider"),D&&(q=L.line($+k+X,x.height+G,$+k+X,F+G,N),m.insert(()=>q).attr("class","divider")),A&&(q=L.line($+k+v+X,x.height+G,$+k+v+X,F+G,N),m.insert(()=>q).attr("class","divider"));for(const s of w)q=L.line(X,x.height+G+s,P+X,x.height+G+s,N),m.insert(()=>q).attr("class","divider");if(g(e,I),f&&"handDrawn"!==e.look){const t=f.split(";"),e=t?.filter(t=>t.includes("stroke"))?.map(t=>`${t}`).join("; ");m.selectAll("path").attr("style",e??""),m.selectAll(".row-rect-even path").attr("style",f)}return e.intersect=function(t){return W.rect(e,t)},m}async function oe(t,e,a,n=0,s=0,c=[],h=""){const d=t.insert("g").attr("class",`label ${c.join(" ")}`).attr("transform",`translate(${n}, ${s})`).attr("style",h);e!==(0,i.QO)(e)&&(e=(e=(0,i.QO)(e)).replaceAll("<","&lt;").replaceAll(">","&gt;"));const g=d.node().appendChild(await(0,l.GZ)(d,e,{width:(0,r.Un)(e,a)+100,style:h,useHtmlLabels:a.htmlLabels},a));if(e.includes("&lt;")||e.includes("&gt;")){let t=g.children[0];for(t.textContent=t.textContent.replaceAll("&lt;","<").replaceAll("&gt;",">");t.childNodes[0];)t=t.childNodes[0],t.textContent=t.textContent.replaceAll("&lt;","<").replaceAll("&gt;",">")}let y=g.getBBox();if((0,i._3)(a.htmlLabels)){const t=g.children[0];t.style.textAlign="start";const e=(0,o.Ltv)(g);y=t.getBoundingClientRect(),e.attr("width",y.width),e.attr("height",y.height)}return y}async function ce(t,e,a,n,s=a.class.padding??12){const l=n?0:3,r=t.insert("g").attr("class",y(e)).attr("id",e.domId||e.id);let i=null,o=null,c=null,h=null,d=0,g=0,p=0;if(i=r.insert("g").attr("class","annotation-group text"),e.annotations.length>0){const t=e.annotations[0];await he(i,{text:`${t}`},0);d=i.node().getBBox().height}o=r.insert("g").attr("class","label-group text"),await he(o,e,0,["font-weight: bolder"]);const f=o.node().getBBox();g=f.height,c=r.insert("g").attr("class","members-group text");let u=0;for(const y of e.members){u+=await he(c,y,u,[y.parseClassifier()])+l}p=c.node().getBBox().height,p<=0&&(p=s/2),h=r.insert("g").attr("class","methods-group text");let m=0;for(const y of e.methods){m+=await he(h,y,m,[y.parseClassifier()])+l}let x=r.node().getBBox();if(null!==i){const t=i.node().getBBox();i.attr("transform",`translate(${-t.width/2})`)}return o.attr("transform",`translate(${-f.width/2}, ${d})`),x=r.node().getBBox(),c.attr("transform",`translate(0, ${d+g+2*s})`),x=r.node().getBBox(),h.attr("transform",`translate(0, ${d+g+(p?p+4*s:2*s)})`),x=r.node().getBBox(),{shapeSvg:r,bbox:x}}async function he(t,e,a,n=[]){const s=t.insert("g").attr("class","label").attr("style",n.join("; ")),c=(0,i.zj)();let h="useHtmlLabels"in e?e.useHtmlLabels:(0,i._3)(c.htmlLabels)??!0,d="";d="text"in e?e.text:e.label,!h&&d.startsWith("\\")&&(d=d.substring(1)),(0,i.Wi)(d)&&(h=!0);const g=await(0,l.GZ)(s,(0,i.oB)((0,r.Sm)(d)),{width:(0,r.Un)(d,c)+50,classes:"markdown-node-label",useHtmlLabels:h},c);let y,p=1;if(h){const t=g.children[0],e=(0,o.Ltv)(g);p=t.innerHTML.split("<br>").length,t.innerHTML.includes("</math>")&&(p+=t.innerHTML.split("<mrow>").length-1);const a=t.getElementsByTagName("img");if(a){const t=""===d.replace(/<img[^>]*>/g,"").trim();await Promise.all([...a].map(e=>new Promise(a=>{function n(){if(e.style.display="flex",e.style.flexDirection="column",t){const t=c.fontSize?.toString()??window.getComputedStyle(document.body).fontSize,a=5,n=parseInt(t,10)*a+"px";e.style.minWidth=n,e.style.maxWidth=n}else e.style.width="100%";a(e)}(0,i.K2)(n,"setupImage"),setTimeout(()=>{e.complete&&n()}),e.addEventListener("error",n),e.addEventListener("load",n)})))}y=t.getBoundingClientRect(),e.attr("width",y.width),e.attr("height",y.height)}else{n.includes("font-weight: bolder")&&(0,o.Ltv)(g).selectAll("tspan").attr("font-weight",""),p=g.children.length;const t=g.children[0];if(""===g.textContent||g.textContent.includes("&gt")){t.textContent=d[0]+d.substring(1).replaceAll("&gt;",">").replaceAll("&lt;","<").trim();" "===d[1]&&(t.textContent=t.textContent[0]+" "+t.textContent.substring(1))}"undefined"===t.textContent&&(t.textContent=""),y=g.getBBox()}return s.attr("transform","translate(0,"+(-y.height/(2*p)+a)+")"),y.height}async function de(t,e){const a=(0,i.D7)(),n=a.class.padding??12,l=n,r=e.useHtmlLabels??(0,i._3)(a.htmlLabels)??!0,h=e;h.annotations=h.annotations??[],h.members=h.members??[],h.methods=h.methods??[];const{shapeSvg:d,bbox:y}=await ce(t,e,a,r,l),{labelStyles:p,nodeStyles:f}=(0,s.GX)(e);e.labelStyle=p,e.cssStyles=h.styles||"";const u=h.styles?.join(";")||f||"";e.cssStyles||(e.cssStyles=u.replaceAll("!important","").split(";"));const m=0===h.members.length&&0===h.methods.length&&!a.class?.hideEmptyMembersBox,x=c.A.svg(d),b=(0,s.Fr)(e,{});"handDrawn"!==e.look&&(b.roughness=0,b.fillStyle="solid");const w=y.width;let S=y.height;0===h.members.length&&0===h.methods.length?S+=l:h.members.length>0&&0===h.methods.length&&(S+=2*l);const $=-w/2,k=-S/2,v=x.rectangle($-n,k-n-(m?n:0===h.members.length&&0===h.methods.length?-n/2:0),w+2*n,S+2*n+(m?2*n:0===h.members.length&&0===h.methods.length?-n:0),b),M=d.insert(()=>v,":first-child");M.attr("class","basic label-container");const D=M.node().getBBox();d.selectAll(".text").each((t,e,a)=>{const s=(0,o.Ltv)(a[e]),l=s.attr("transform");let i=0;if(l){const t=RegExp(/translate\(([^,]+),([^)]+)\)/).exec(l);t&&(i=parseFloat(t[2]))}let c=i+k+n-(m?n:0===h.members.length&&0===h.methods.length?-n/2:0);r||(c-=4);let g=$;(s.attr("class").includes("label-group")||s.attr("class").includes("annotation-group"))&&(g=-s.node()?.getBBox().width/2||0,d.selectAll("text").each(function(t,e,a){"middle"===window.getComputedStyle(a[e]).textAnchor&&(g=0)})),s.attr("transform",`translate(${g}, ${c})`)});const A=d.select(".annotation-group").node().getBBox().height-(m?n/2:0)||0,B=d.select(".label-group").node().getBBox().height-(m?n/2:0)||0,C=d.select(".members-group").node().getBBox().height-(m?n/2:0)||0;if(h.members.length>0||h.methods.length>0||m){const t=x.line(D.x,A+B+k+n,D.x+D.width,A+B+k+n,b);d.insert(()=>t).attr("class","divider").attr("style",u)}if(m||h.members.length>0||h.methods.length>0){const t=x.line(D.x,A+B+C+k+2*l+n,D.x+D.width,A+B+C+k+n+2*l,b);d.insert(()=>t).attr("class","divider").attr("style",u)}if("handDrawn"!==h.look&&d.selectAll("path").attr("style",u),M.select(":nth-child(2)").attr("style",u),d.selectAll(".divider").select("path").attr("style",u),e.labelStyle?d.selectAll("span").attr("style",e.labelStyle):d.selectAll("span").attr("style",u),!r){const t=RegExp(/color\s*:\s*([^;]*)/),e=t.exec(u);if(e){const t=e[0].replace("color","fill");d.selectAll("tspan").attr("style",t)}else if(p){const e=t.exec(p);if(e){const t=e[0].replace("color","fill");d.selectAll("tspan").attr("style",t)}}}return g(e,M),e.intersect=function(t){return W.rect(e,t)},d}async function ge(t,e){const{labelStyles:a,nodeStyles:n}=(0,s.GX)(e);e.labelStyle=a;const l=e,r=e,i="verifyMethod"in e,h=y(e),d=t.insert("g").attr("class",h).attr("id",e.domId??e.id);let p;p=i?await ye(d,`&lt;&lt;${l.type}&gt;&gt;`,0,e.labelStyle):await ye(d,"&lt;&lt;Element&gt;&gt;",0,e.labelStyle);let f=p;const u=await ye(d,l.name,f,e.labelStyle+"; font-weight: bold;");if(f+=u+20,i){f+=await ye(d,""+(l.requirementId?`id: ${l.requirementId}`:""),f,e.labelStyle);f+=await ye(d,""+(l.text?`Text: ${l.text}`:""),f,e.labelStyle);f+=await ye(d,""+(l.risk?`Risk: ${l.risk}`:""),f,e.labelStyle),await ye(d,""+(l.verifyMethod?`Verification: ${l.verifyMethod}`:""),f,e.labelStyle)}else{f+=await ye(d,""+(r.type?`Type: ${r.type}`:""),f,e.labelStyle),await ye(d,""+(r.docRef?`Doc Ref: ${r.docRef}`:""),f,e.labelStyle)}const m=(d.node()?.getBBox().width??200)+20,x=(d.node()?.getBBox().height??200)+20,b=-m/2,w=-x/2,S=c.A.svg(d),$=(0,s.Fr)(e,{});"handDrawn"!==e.look&&($.roughness=0,$.fillStyle="solid");const k=S.rectangle(b,w,m,x,$),v=d.insert(()=>k,":first-child");if(v.attr("class","basic label-container").attr("style",n),d.selectAll(".label").each((t,e,a)=>{const n=(0,o.Ltv)(a[e]),s=n.attr("transform");let l=0,r=0;if(s){const t=RegExp(/translate\(([^,]+),([^)]+)\)/).exec(s);t&&(l=parseFloat(t[1]),r=parseFloat(t[2]))}const i=r-x/2;let c=b+10;0!==e&&1!==e||(c=l),n.attr("transform",`translate(${c}, ${i+20})`)}),f>p+u+20){const t=S.line(b,w+p+u+20,b+m,w+p+u+20,$);d.insert(()=>t).attr("style",n)}return g(e,v),e.intersect=function(t){return W.rect(e,t)},d}async function ye(t,e,a,n=""){if(""===e)return 0;const s=t.insert("g").attr("class","label").attr("style",n),c=(0,i.D7)(),h=c.htmlLabels??!0,d=await(0,l.GZ)(s,(0,i.oB)((0,r.Sm)(e)),{width:(0,r.Un)(e,c)+50,classes:"markdown-node-label",useHtmlLabels:h,style:n},c);let g;if(h){const t=d.children[0],e=(0,o.Ltv)(d);g=t.getBoundingClientRect(),e.attr("width",g.width),e.attr("height",g.height)}else{const t=d.children[0];for(const e of t.children)e.textContent=e.textContent.replaceAll("&gt;",">").replaceAll("&lt;","<"),n&&e.setAttribute("style",n);g=d.getBBox(),g.height+=6}return s.attr("transform",`translate(${-g.width/2},${-g.height/2+a})`),g.height}(0,i.K2)(te,"tiltedCylinder"),(0,i.K2)(ee,"trapezoid"),(0,i.K2)(ae,"trapezoidalPentagon"),(0,i.K2)(ne,"triangle"),(0,i.K2)(se,"waveEdgedRectangle"),(0,i.K2)(le,"waveRectangle"),(0,i.K2)(re,"windowPane"),(0,i.K2)(ie,"erBox"),(0,i.K2)(oe,"addText"),(0,i.K2)(ce,"textHelper"),(0,i.K2)(he,"addText"),(0,i.K2)(de,"classBox"),(0,i.K2)(ge,"requirementBox"),(0,i.K2)(ye,"addText");var pe=(0,i.K2)(t=>{switch(t){case"Very High":return"red";case"High":return"orange";case"Medium":return null;case"Low":return"blue";case"Very Low":return"lightblue"}},"colorFromPriority");async function fe(t,e,{config:a}){const{labelStyles:n,nodeStyles:l}=(0,s.GX)(e);e.labelStyle=n||"";const r=e.width;e.width=(e.width??200)-10;const{shapeSvg:i,bbox:o,label:p}=await h(t,e,y(e)),f=e.padding||10;let u,m="";"ticket"in e&&e.ticket&&a?.kanban?.ticketBaseUrl&&(m=a?.kanban?.ticketBaseUrl.replace("#TICKET#",e.ticket),u=i.insert("svg:a",":first-child").attr("class","kanban-ticket-link").attr("xlink:href",m).attr("target","_blank"));const x={useHtmlLabels:e.useHtmlLabels,labelStyle:e.labelStyle||"",width:e.width,img:e.img,padding:e.padding||8,centerLabel:!1};let b,w;({label:b,bbox:w}=u?await d(u,"ticket"in e&&e.ticket||"",x):await d(i,"ticket"in e&&e.ticket||"",x));const{label:$,bbox:k}=await d(i,"assigned"in e&&e.assigned||"",x);e.width=r;const v=e?.width||0,M=Math.max(w.height,k.height)/2,D=Math.max(o.height+20,e?.height||0)+M,A=-v/2,B=-D/2;let C;p.attr("transform","translate("+(f-v/2)+", "+(-M-o.height/2)+")"),b.attr("transform","translate("+(f-v/2)+", "+(-M+o.height/2)+")"),$.attr("transform","translate("+(f+v/2-k.width-20)+", "+(-M+o.height/2)+")");const{rx:K,ry:L}=e,{cssStyles:N}=e;if("handDrawn"===e.look){const t=c.A.svg(i),a=(0,s.Fr)(e,{}),n=K||L?t.path(S(A,B,v,D,K||0),a):t.rectangle(A,B,v,D,a);C=i.insert(()=>n,":first-child"),C.attr("class","basic label-container").attr("style",N||null)}else{C=i.insert("rect",":first-child"),C.attr("class","basic label-container __APA__").attr("style",l).attr("rx",K??5).attr("ry",L??5).attr("x",A).attr("y",B).attr("width",v).attr("height",D);const t="priority"in e&&e.priority;if(t){const e=i.append("line"),a=A+2,n=B+Math.floor((K??0)/2),s=B+D-Math.floor((K??0)/2);e.attr("x1",a).attr("y1",n).attr("x2",a).attr("y2",s).attr("stroke-width","4").attr("stroke",pe(t))}}return g(e,C),e.height=D,e.intersect=function(t){return W.rect(e,t)},i}(0,i.K2)(fe,"kanbanItem");var ue=[{semanticName:"Process",name:"Rectangle",shortName:"rect",description:"Standard process shape",aliases:["proc","process","rectangle"],internalAliases:["squareRect"],handler:Ht},{semanticName:"Event",name:"Rounded Rectangle",shortName:"rounded",description:"Represents an event",aliases:["event"],internalAliases:["roundedRect"],handler:It},{semanticName:"Terminal Point",name:"Stadium",shortName:"stadium",description:"Terminal point",aliases:["terminal","pill"],handler:_t},{semanticName:"Subprocess",name:"Framed Rectangle",shortName:"fr-rect",description:"Subprocess",aliases:["subprocess","subproc","framed-rectangle","subroutine"],handler:Ot},{semanticName:"Database",name:"Cylinder",shortName:"cyl",description:"Database storage",aliases:["db","database","cylinder"],handler:rt},{semanticName:"Start",name:"Circle",shortName:"circle",description:"Starting point",aliases:["circ"],handler:O},{semanticName:"Decision",name:"Diamond",shortName:"diam",description:"Decision-making step",aliases:["decision","diamond","question"],handler:Xt},{semanticName:"Prepare Conditional",name:"Hexagon",shortName:"hex",description:"Preparation or condition step",aliases:["hexagon","prepare"],handler:pt},{semanticName:"Data Input/Output",name:"Lean Right",shortName:"lean-r",description:"Represents input or output",aliases:["lean-right","in-out"],internalAliases:["lean_right"],handler:Mt},{semanticName:"Data Input/Output",name:"Lean Left",shortName:"lean-l",description:"Represents output or input",aliases:["lean-left","out-in"],internalAliases:["lean_left"],handler:vt},{semanticName:"Priority Action",name:"Trapezoid Base Bottom",shortName:"trap-b",description:"Priority action",aliases:["priority","trapezoid-bottom","trapezoid"],handler:ee},{semanticName:"Manual Operation",name:"Trapezoid Base Top",shortName:"trap-t",description:"Represents a manual task",aliases:["manual","trapezoid-top","inv-trapezoid"],internalAliases:["inv_trapezoid"],handler:St},{semanticName:"Stop",name:"Double Circle",shortName:"dbl-circ",description:"Represents a stop point",aliases:["double-circle"],internalAliases:["doublecircle"],handler:ot},{semanticName:"Text Block",name:"Text Block",shortName:"text",description:"Text block",handler:Yt},{semanticName:"Card",name:"Notched Rectangle",shortName:"notch-rect",description:"Represents a card",aliases:["card","notched-rectangle"],handler:q},{semanticName:"Lined/Shaded Process",name:"Lined Rectangle",shortName:"lin-rect",description:"Lined process shape",aliases:["lined-rectangle","lined-process","lin-proc","shaded-process"],handler:Wt},{semanticName:"Start",name:"Small Circle",shortName:"sm-circ",description:"Small starting point",aliases:["start","small-circle"],internalAliases:["stateStart"],handler:zt},{semanticName:"Stop",name:"Framed Circle",shortName:"fr-circ",description:"Stop point",aliases:["stop","framed-circle"],internalAliases:["stateEnd"],handler:qt},{semanticName:"Fork/Join",name:"Filled Rectangle",shortName:"fork",description:"Fork or join in process flow",aliases:["join"],internalAliases:["forkJoin"],handler:dt},{semanticName:"Collate",name:"Hourglass",shortName:"hourglass",description:"Represents a collate operation",aliases:["hourglass","collate"],handler:ft},{semanticName:"Comment",name:"Curly Brace",shortName:"brace",description:"Adds a comment",aliases:["comment","brace-l"],handler:U},{semanticName:"Comment Right",name:"Curly Brace",shortName:"brace-r",description:"Adds a comment",handler:Q},{semanticName:"Comment with braces on both sides",name:"Curly Braces",shortName:"braces",description:"Adds a comment",handler:et},{semanticName:"Com Link",name:"Lightning Bolt",shortName:"bolt",description:"Communication link",aliases:["com-link","lightning-bolt"],handler:Dt},{semanticName:"Document",name:"Document",shortName:"doc",description:"Represents a document",aliases:["doc","document"],handler:se},{semanticName:"Delay",name:"Half-Rounded Rectangle",shortName:"delay",description:"Represents a delay",aliases:["half-rounded-rectangle"],handler:gt},{semanticName:"Direct Access Storage",name:"Horizontal Cylinder",shortName:"h-cyl",description:"Direct access storage",aliases:["das","horizontal-cylinder"],handler:te},{semanticName:"Disk Storage",name:"Lined Cylinder",shortName:"lin-cyl",description:"Disk storage",aliases:["disk","lined-cylinder"],handler:Kt},{semanticName:"Display",name:"Curved Trapezoid",shortName:"curv-trap",description:"Represents a display",aliases:["curved-trapezoid","display"],handler:at},{semanticName:"Divided Process",name:"Divided Rectangle",shortName:"div-rect",description:"Divided process shape",aliases:["div-proc","divided-rectangle","divided-process"],handler:it},{semanticName:"Extract",name:"Triangle",shortName:"tri",description:"Extraction process",aliases:["extract","triangle"],handler:ne},{semanticName:"Internal Storage",name:"Window Pane",shortName:"win-pane",description:"Internal storage",aliases:["internal-storage","window-pane"],handler:re},{semanticName:"Junction",name:"Filled Circle",shortName:"f-circ",description:"Junction point",aliases:["junction","filled-circle"],handler:ct},{semanticName:"Loop Limit",name:"Trapezoidal Pentagon",shortName:"notch-pent",description:"Loop limit step",aliases:["loop-limit","notched-pentagon"],handler:ae},{semanticName:"Manual File",name:"Flipped Triangle",shortName:"flip-tri",description:"Manual file operation",aliases:["manual-file","flipped-triangle"],handler:ht},{semanticName:"Manual Input",name:"Sloped Rectangle",shortName:"sl-rect",description:"Manual input step",aliases:["manual-input","sloped-rectangle"],handler:jt},{semanticName:"Multi-Document",name:"Stacked Document",shortName:"docs",description:"Multiple documents",aliases:["documents","st-doc","stacked-document"],handler:Rt},{semanticName:"Multi-Process",name:"Stacked Rectangle",shortName:"st-rect",description:"Multiple processes",aliases:["procs","processes","stacked-rectangle"],handler:Nt},{semanticName:"Stored Data",name:"Bow Tie Rectangle",shortName:"bow-rect",description:"Stored data",aliases:["stored-data","bow-tie-rectangle"],handler:_},{semanticName:"Summary",name:"Crossed Circle",shortName:"cross-circ",description:"Summary",aliases:["summary","crossed-circle"],handler:Z},{semanticName:"Tagged Document",name:"Tagged Document",shortName:"tag-doc",description:"Tagged document",aliases:["tag-doc","tagged-document"],handler:Zt},{semanticName:"Tagged Process",name:"Tagged Rectangle",shortName:"tag-rect",description:"Tagged process",aliases:["tagged-rectangle","tag-proc","tagged-process"],handler:Vt},{semanticName:"Paper Tape",name:"Flag",shortName:"flag",description:"Paper tape",aliases:["paper-tape"],handler:le},{semanticName:"Odd",name:"Odd",shortName:"odd",description:"Odd shape",internalAliases:["rect_left_inv_arrow"],handler:Gt},{semanticName:"Lined Document",name:"Lined Document",shortName:"lin-doc",description:"Lined document",aliases:["lined-document"],handler:Lt}],me=(0,i.K2)(()=>{const t={state:Et,choice:z,note:Pt,rectWithTitle:Tt,labelRect:kt,iconSquare:bt,iconCircle:mt,icon:ut,iconRounded:xt,imageSquare:wt,anchor:j,kanbanItem:fe,classBox:de,erBox:ie,requirementBox:ge},e=[...Object.entries(t),...ue.flatMap(t=>[t.shortName,..."aliases"in t?t.aliases:[],..."internalAliases"in t?t.internalAliases:[]].map(e=>[e,t.handler]))];return Object.fromEntries(e)},"generateShapeMap")();function xe(t){return t in me}(0,i.K2)(xe,"isValidShape");var be=new Map;async function we(t,e,a){let n,s;"rect"===e.shape&&(e.rx&&e.ry?e.shape="roundedRect":e.shape="squareRect");const l=e.shape?me[e.shape]:void 0;if(!l)throw new Error(`No such shape: ${e.shape}. Please check your syntax.`);if(e.link){let r;"sandbox"===a.config.securityLevel?r="_top":e.linkTarget&&(r=e.linkTarget||"_blank"),n=t.insert("svg:a").attr("xlink:href",e.link).attr("target",r??null),s=await l(n,e,a)}else s=await l(t,e,a),n=s;return e.tooltip&&s.attr("title",e.tooltip),be.set(e.id,n),e.haveCallback&&n.attr("class",n.attr("class")+" clickable"),n}(0,i.K2)(we,"insertNode");var Se=(0,i.K2)((t,e)=>{be.set(e.id,t)},"setNodeElem"),$e=(0,i.K2)(()=>{be.clear()},"clear"),ke=(0,i.K2)(t=>{const e=be.get(t.id);i.Rm.trace("Transforming node",t.diff,t,"translate("+(t.x-t.width/2-5)+", "+t.width/2+")");const a=t.diff||0;return t.clusterNode?e.attr("transform","translate("+(t.x+a-t.width/2)+", "+(t.y-t.height/2-8)+")"):e.attr("transform","translate("+t.x+", "+t.y+")"),a},"positionNode")}}]);
//# sourceMappingURL=ae66da62-4c21e4d961dbe2d10b1c.js.map