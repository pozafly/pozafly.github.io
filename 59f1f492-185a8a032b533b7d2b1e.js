"use strict";(self.webpackChunkrecord_journey=self.webpackChunkrecord_journey||[]).push([[7433],{7459:function(t,e,a){a.d(e,{DA:function(){return S},IU:function(){return K},U:function(){return C},U7:function(){return De},U_:function(){return Be},Zk:function(){return d},aP:function(){return ke},gh:function(){return Ae},lC:function(){return g},on:function(){return Me}});var n=a(7904),s=a(3402),l=a(2941),r=a(6111),i=a(9026),o=a(52),c=a(4991),h=a(726),d=(0,o.K2)(async(t,e,a)=>{let n;const s=e.useHtmlLabels||(0,i._3)((0,i.D7)()?.htmlLabels);n=a||"node default";const h=t.insert("g").attr("class",n).attr("id",e.domId||e.id),d=h.insert("g").attr("class","label").attr("style",(0,r.KL)(e.labelStyle));let y;y=void 0===e.label?"":"string"==typeof e.label?e.label:e.label[0];const g=await(0,l.GZ)(d,(0,i.jZ)((0,r.Sm)(y),(0,i.D7)()),{useHtmlLabels:s,width:e.width||(0,i.D7)().flowchart?.wrappingWidth,cssClasses:"markdown-node-label",style:e.labelStyle,addSvgBackground:!!e.icon||!!e.img});let p=g.getBBox();const f=(e?.padding??0)/2;if(s){const t=g.children[0],e=(0,c.Ltv)(g),a=t.getElementsByTagName("img");if(a){const t=""===y.replace(/<img[^>]*>/g,"").trim();await Promise.all([...a].map(e=>new Promise(a=>{function n(){if(e.style.display="flex",e.style.flexDirection="column",t){const t=(0,i.D7)().fontSize?(0,i.D7)().fontSize:window.getComputedStyle(document.body).fontSize,a=5,[n=i.UI.fontSize]=(0,r.I5)(t),s=n*a+"px";e.style.minWidth=s,e.style.maxWidth=s}else e.style.width="100%";a(e)}(0,o.K2)(n,"setupImage"),setTimeout(()=>{e.complete&&n()}),e.addEventListener("error",n),e.addEventListener("load",n)})))}p=t.getBoundingClientRect(),e.attr("width",p.width),e.attr("height",p.height)}return s?d.attr("transform","translate("+-p.width/2+", "+-p.height/2+")"):d.attr("transform","translate(0, "+-p.height/2+")"),e.centerLabel&&d.attr("transform","translate("+-p.width/2+", "+-p.height/2+")"),d.insert("rect",":first-child"),{shapeSvg:h,bbox:p,halfPadding:f,label:d}},"labelHelper"),y=(0,o.K2)(async(t,e,a)=>{const n=a.useHtmlLabels||(0,i._3)((0,i.D7)()?.flowchart?.htmlLabels),s=t.insert("g").attr("class","label").attr("style",a.labelStyle||""),o=await(0,l.GZ)(s,(0,i.jZ)((0,r.Sm)(e),(0,i.D7)()),{useHtmlLabels:n,width:a.width||(0,i.D7)()?.flowchart?.wrappingWidth,style:a.labelStyle,addSvgBackground:!!a.icon||!!a.img});let h=o.getBBox();const d=a.padding/2;if((0,i._3)((0,i.D7)()?.flowchart?.htmlLabels)){const t=o.children[0],e=(0,c.Ltv)(o);h=t.getBoundingClientRect(),e.attr("width",h.width),e.attr("height",h.height)}return n?s.attr("transform","translate("+-h.width/2+", "+-h.height/2+")"):s.attr("transform","translate(0, "+-h.height/2+")"),a.centerLabel&&s.attr("transform","translate("+-h.width/2+", "+-h.height/2+")"),s.insert("rect",":first-child"),{shapeSvg:t,bbox:h,halfPadding:d,label:s}},"insertLabel"),g=(0,o.K2)((t,e)=>{const a=e.node().getBBox();t.width=a.width,t.height=a.height},"updateNodeBounds"),p=(0,o.K2)((t,e)=>("handDrawn"===t.look?"rough-node":"node")+" "+t.cssClasses+" "+(e||""),"getNodeClasses");function f(t){const e=t.map((t,e)=>`${0===e?"M":"L"}${t.x},${t.y}`);return e.push("Z"),e.join(" ")}function u(t,e,a,n,s,l){const r=[],i=a-t,o=n-e,c=i/l,h=2*Math.PI/c,d=e+o/2;for(let y=0;y<=50;y++){const e=t+y/50*i,a=d+s*Math.sin(h*(e-t));r.push({x:e,y:a})}return r}function m(t,e,a,n,s,l){const r=[],i=s*Math.PI/180,o=(l*Math.PI/180-i)/(n-1);for(let c=0;c<n;c++){const n=i+c*o,s=t+a*Math.cos(n),l=e+a*Math.sin(n);r.push({x:-s,y:-l})}return r}(0,o.K2)(f,"createPathFromPoints"),(0,o.K2)(u,"generateFullSineWavePoints"),(0,o.K2)(m,"generateCirclePoints");var x=(0,o.K2)((t,e)=>{var a,n,s=t.x,l=t.y,r=e.x-s,i=e.y-l,o=t.width/2,c=t.height/2;return Math.abs(i)*o>Math.abs(r)*c?(i<0&&(c=-c),a=0===i?0:c*r/i,n=c):(r<0&&(o=-o),a=o,n=0===r?0:o*i/r),{x:s+a,y:l+n}},"intersectRect");function b(t,e){e&&t.attr("style",e)}async function w(t){const e=(0,c.Ltv)(document.createElementNS("http://www.w3.org/2000/svg","foreignObject")),a=e.append("xhtml:div"),n=(0,i.D7)();let s=t.label;t.label&&(0,i.Wi)(t.label)&&(s=await(0,i.dj)(t.label.replace(i.Y2.lineBreakRegex,"\n"),n));const l='<span class="'+(t.isNode?"nodeLabel":"edgeLabel")+'" '+(t.labelStyle?'style="'+t.labelStyle+'"':"")+">"+s+"</span>";return a.html((0,i.jZ)(l,n)),b(a,t.labelStyle),a.style("display","inline-block"),a.style("padding-right","1px"),a.style("white-space","nowrap"),a.attr("xmlns","http://www.w3.org/1999/xhtml"),e.node()}(0,o.K2)(b,"applyStyle"),(0,o.K2)(w,"addHtmlLabel");var S=(0,o.K2)(async(t,e,a,n)=>{let s=t||"";if("object"==typeof s&&(s=s[0]),(0,i._3)((0,i.D7)().flowchart.htmlLabels)){s=s.replace(/\\n|\n/g,"<br />"),o.Rm.info("vertexText"+s);const t={isNode:n,label:(0,r.Sm)(s).replace(/fa[blrs]?:fa-[\w-]+/g,t=>`<i class='${t.replace(":"," ")}'></i>`),labelStyle:e?e.replace("fill:","color:"):e};return await w(t)}{const t=document.createElementNS("http://www.w3.org/2000/svg","text");t.setAttribute("style",e.replace("color:","fill:"));let n=[];n="string"==typeof s?s.split(/\\n|\n|<br\s*\/?>/gi):Array.isArray(s)?s:[];for(const e of n){const n=document.createElementNS("http://www.w3.org/2000/svg","tspan");n.setAttributeNS("http://www.w3.org/XML/1998/namespace","xml:space","preserve"),n.setAttribute("dy","1em"),n.setAttribute("x","0"),a?n.setAttribute("class","title-row"):n.setAttribute("class","row"),n.textContent=e.trim(),t.appendChild(n)}return t}},"createLabel"),$=(0,o.K2)((t,e,a,n,s)=>["M",t+s,e,"H",t+a-s,"A",s,s,0,0,1,t+a,e+s,"V",e+n-s,"A",s,s,0,0,1,t+a-s,e+n,"H",t+s,"A",s,s,0,0,1,t,e+n-s,"V",e+s,"A",s,s,0,0,1,t+s,e,"Z"].join(" "),"createRoundedRectPathD"),k=(0,o.K2)(async(t,e)=>{o.Rm.info("Creating subgraph rect for ",e.id,e);const a=(0,i.D7)(),{themeVariables:r,handDrawnSeed:d}=a,{clusterBkg:y,clusterBorder:g}=r,{labelStyles:p,nodeStyles:f,borderStyles:u,backgroundStyles:m}=(0,s.GX)(e),b=t.insert("g").attr("class","cluster "+e.cssClasses).attr("id",e.id).attr("data-look",e.look),w=(0,i._3)(a.flowchart.htmlLabels),S=b.insert("g").attr("class","cluster-label "),k=await(0,l.GZ)(S,e.label,{style:e.labelStyle,useHtmlLabels:w,isNode:!0});let v=k.getBBox();if((0,i._3)(a.flowchart.htmlLabels)){const t=k.children[0],e=(0,c.Ltv)(k);v=t.getBoundingClientRect(),e.attr("width",v.width),e.attr("height",v.height)}const M=e.width<=v.width+e.padding?v.width+e.padding:e.width;e.width<=v.width+e.padding?e.diff=(M-e.width)/2-e.padding:e.diff=-e.padding;const D=e.height,A=e.x-M/2,B=e.y-D/2;let C;if(o.Rm.trace("Data ",e,JSON.stringify(e)),"handDrawn"===e.look){const t=h.A.svg(b),a=(0,s.Fr)(e,{roughness:.7,fill:y,stroke:g,fillWeight:3,seed:d}),n=t.path($(A,B,M,D,0),a);C=b.insert(()=>(o.Rm.debug("Rough node insert CXC",n),n),":first-child"),C.select("path:nth-child(2)").attr("style",u.join(";")),C.select("path").attr("style",m.join(";").replace("fill","stroke"))}else C=b.insert("rect",":first-child"),C.attr("style",f).attr("rx",e.rx).attr("ry",e.ry).attr("x",A).attr("y",B).attr("width",M).attr("height",D);const{subGraphTitleTopMargin:K}=(0,n.O)(a);if(S.attr("transform",`translate(${e.x-v.width/2}, ${e.y-e.height/2+K})`),p){const t=S.select("span");t&&t.attr("style",p)}const N=C.node().getBBox();return e.offsetX=0,e.width=N.width,e.height=N.height,e.offsetY=v.height-e.padding/2,e.intersect=function(t){return x(e,t)},{cluster:b,labelBBox:v}},"rect"),v=(0,o.K2)((t,e)=>{const a=t.insert("g").attr("class","note-cluster").attr("id",e.id),n=a.insert("rect",":first-child"),s=0*e.padding,l=s/2;n.attr("rx",e.rx).attr("ry",e.ry).attr("x",e.x-e.width/2-l).attr("y",e.y-e.height/2-l).attr("width",e.width+s).attr("height",e.height+s).attr("fill","none");const r=n.node().getBBox();return e.width=r.width,e.height=r.height,e.intersect=function(t){return x(e,t)},{cluster:a,labelBBox:{width:0,height:0}}},"noteGroup"),M=(0,o.K2)(async(t,e)=>{const a=(0,i.D7)(),{themeVariables:n,handDrawnSeed:s}=a,{altBackground:l,compositeBackground:r,compositeTitleBackground:o,nodeBorder:d}=n,y=t.insert("g").attr("class",e.cssClasses).attr("id",e.id).attr("data-id",e.id).attr("data-look",e.look),g=y.insert("g",":first-child"),p=y.insert("g").attr("class","cluster-label");let f=y.append("rect");const u=p.node().appendChild(await S(e.label,e.labelStyle,void 0,!0));let m=u.getBBox();if((0,i._3)(a.flowchart.htmlLabels)){const t=u.children[0],e=(0,c.Ltv)(u);m=t.getBoundingClientRect(),e.attr("width",m.width),e.attr("height",m.height)}const b=0*e.padding,w=b/2,k=(e.width<=m.width+e.padding?m.width+e.padding:e.width)+b;e.width<=m.width+e.padding?e.diff=(k-e.width)/2-e.padding:e.diff=-e.padding;const v=e.height+b,M=e.height+b-m.height-6,D=e.x-k/2,A=e.y-v/2;e.width=k;const B=e.y-e.height/2-w+m.height+2;let C;if("handDrawn"===e.look){const t=e.cssClasses.includes("statediagram-cluster-alt"),a=h.A.svg(y),n=e.rx||e.ry?a.path($(D,A,k,v,10),{roughness:.7,fill:o,fillStyle:"solid",stroke:d,seed:s}):a.rectangle(D,A,k,v,{seed:s});C=y.insert(()=>n,":first-child");const i=a.rectangle(D,B,k,M,{fill:t?l:r,fillStyle:t?"hachure":"solid",stroke:d,seed:s});C=y.insert(()=>n,":first-child"),f=y.insert(()=>i)}else{C=g.insert("rect",":first-child");const t="outer";C.attr("class",t).attr("x",D).attr("y",A).attr("width",k).attr("height",v).attr("data-look",e.look),f.attr("class","inner").attr("x",D).attr("y",B).attr("width",k).attr("height",M)}p.attr("transform",`translate(${e.x-m.width/2}, ${A+1-((0,i._3)(a.flowchart.htmlLabels)?0:3)})`);const K=C.node().getBBox();return e.height=K.height,e.offsetX=0,e.offsetY=m.height-e.padding/2,e.labelBBox=m,e.intersect=function(t){return x(e,t)},{cluster:y,labelBBox:m}},"roundedWithTitle"),D=(0,o.K2)(async(t,e)=>{o.Rm.info("Creating subgraph rect for ",e.id,e);const a=(0,i.D7)(),{themeVariables:r,handDrawnSeed:d}=a,{clusterBkg:y,clusterBorder:g}=r,{labelStyles:p,nodeStyles:f,borderStyles:u,backgroundStyles:m}=(0,s.GX)(e),b=t.insert("g").attr("class","cluster "+e.cssClasses).attr("id",e.id).attr("data-look",e.look),w=(0,i._3)(a.flowchart.htmlLabels),S=b.insert("g").attr("class","cluster-label "),k=await(0,l.GZ)(S,e.label,{style:e.labelStyle,useHtmlLabels:w,isNode:!0,width:e.width});let v=k.getBBox();if((0,i._3)(a.flowchart.htmlLabels)){const t=k.children[0],e=(0,c.Ltv)(k);v=t.getBoundingClientRect(),e.attr("width",v.width),e.attr("height",v.height)}const M=e.width<=v.width+e.padding?v.width+e.padding:e.width;e.width<=v.width+e.padding?e.diff=(M-e.width)/2-e.padding:e.diff=-e.padding;const D=e.height,A=e.x-M/2,B=e.y-D/2;let C;if(o.Rm.trace("Data ",e,JSON.stringify(e)),"handDrawn"===e.look){const t=h.A.svg(b),a=(0,s.Fr)(e,{roughness:.7,fill:y,stroke:g,fillWeight:4,seed:d}),n=t.path($(A,B,M,D,e.rx),a);C=b.insert(()=>(o.Rm.debug("Rough node insert CXC",n),n),":first-child"),C.select("path:nth-child(2)").attr("style",u.join(";")),C.select("path").attr("style",m.join(";").replace("fill","stroke"))}else C=b.insert("rect",":first-child"),C.attr("style",f).attr("rx",e.rx).attr("ry",e.ry).attr("x",A).attr("y",B).attr("width",M).attr("height",D);const{subGraphTitleTopMargin:K}=(0,n.O)(a);if(S.attr("transform",`translate(${e.x-v.width/2}, ${e.y-e.height/2+K})`),p){const t=S.select("span");t&&t.attr("style",p)}const N=C.node().getBBox();return e.offsetX=0,e.width=N.width,e.height=N.height,e.offsetY=v.height-e.padding/2,e.intersect=function(t){return x(e,t)},{cluster:b,labelBBox:v}},"kanbanSection"),A={rect:k,squareRect:k,roundedWithTitle:M,noteGroup:v,divider:(0,o.K2)((t,e)=>{const a=(0,i.D7)(),{themeVariables:n,handDrawnSeed:s}=a,{nodeBorder:l}=n,r=t.insert("g").attr("class",e.cssClasses).attr("id",e.id).attr("data-look",e.look),o=r.insert("g",":first-child"),c=0*e.padding,d=e.width+c;e.diff=-e.padding;const y=e.height+c,g=e.x-d/2,p=e.y-y/2;let f;if(e.width=d,"handDrawn"===e.look){const t=h.A.svg(r).rectangle(g,p,d,y,{fill:"lightgrey",roughness:.5,strokeLineDash:[5],stroke:l,seed:s});f=r.insert(()=>t,":first-child")}else{f=o.insert("rect",":first-child");const t="divider";f.attr("class",t).attr("x",g).attr("y",p).attr("width",d).attr("height",y).attr("data-look",e.look)}const u=f.node().getBBox();return e.height=u.height,e.offsetX=0,e.offsetY=0,e.intersect=function(t){return x(e,t)},{cluster:r,labelBBox:{}}},"divider"),kanbanSection:D},B=new Map,C=(0,o.K2)(async(t,e)=>{const a=e.shape||"rect",n=await A[a](t,e);return B.set(e.id,n),n},"insertCluster"),K=(0,o.K2)(()=>{B=new Map},"clear");function N(t,e){return t.intersect(e)}(0,o.K2)(N,"intersectNode");var L=N;function R(t,e,a,n){var s=t.x,l=t.y,r=s-n.x,i=l-n.y,o=Math.sqrt(e*e*i*i+a*a*r*r),c=Math.abs(e*a*r/o);n.x<s&&(c=-c);var h=Math.abs(e*a*i/o);return n.y<l&&(h=-h),{x:s+c,y:l+h}}(0,o.K2)(R,"intersectEllipse");var P=R;function F(t,e,a){return P(t,e,e,a)}(0,o.K2)(F,"intersectCircle");var X=F;function G(t,e,a,n){{const s=e.y-t.y,l=t.x-e.x,r=e.x*t.y-t.x*e.y,i=s*a.x+l*a.y+r,o=s*n.x+l*n.y+r,c=1e-6;if(0!==i&&0!==o&&I(i,o))return;const h=n.y-a.y,d=a.x-n.x,y=n.x*a.y-a.x*n.y,g=h*t.x+d*t.y+y,p=h*e.x+d*e.y+y;if(Math.abs(g)<c&&Math.abs(p)<c&&I(g,p))return;const f=s*d-h*l;if(0===f)return;const u=Math.abs(f/2);let m=l*y-d*r;const x=m<0?(m-u)/f:(m+u)/f;m=h*r-s*y;return{x:x,y:m<0?(m-u)/f:(m+u)/f}}}function I(t,e){return t*e>0}(0,o.K2)(G,"intersectLine"),(0,o.K2)(I,"sameSign");var T=G;function W(t,e,a){let n=t.x,s=t.y,l=[],r=Number.POSITIVE_INFINITY,i=Number.POSITIVE_INFINITY;"function"==typeof e.forEach?e.forEach(function(t){r=Math.min(r,t.x),i=Math.min(i,t.y)}):(r=Math.min(r,e.x),i=Math.min(i,e.y));let o=n-t.width/2-r,c=s-t.height/2-i;for(let h=0;h<e.length;h++){let n=e[h],s=e[h<e.length-1?h+1:0],r=T(t,a,{x:o+n.x,y:c+n.y},{x:o+s.x,y:c+s.y});r&&l.push(r)}return l.length?(l.length>1&&l.sort(function(t,e){let n=t.x-a.x,s=t.y-a.y,l=Math.sqrt(n*n+s*s),r=e.x-a.x,i=e.y-a.y,o=Math.sqrt(r*r+i*i);return l<o?-1:l===o?0:1}),l[0]):t}(0,o.K2)(W,"intersectPolygon");var j={node:L,circle:X,ellipse:P,polygon:W,rect:x};function H(t,e){const{labelStyles:a}=(0,s.GX)(e);e.labelStyle=a;const n=p(e);let l=n;n||(l="anchor");const i=t.insert("g").attr("class",l).attr("id",e.domId||e.id),{cssStyles:c}=e,d=h.A.svg(i),y=(0,s.Fr)(e,{fill:"black",stroke:"none",fillStyle:"solid"});"handDrawn"!==e.look&&(y.roughness=0);const f=d.circle(0,0,2,y),u=i.insert(()=>f,":first-child");return u.attr("class","anchor").attr("style",(0,r.KL)(c)),g(e,u),e.intersect=function(t){return o.Rm.info("Circle intersect",e,1,t),j.circle(e,1,t)},i}function _(t,e,a,n,s,l,r){const i=(t+a)/2,o=(e+n)/2,c=Math.atan2(n-e,a-t),h=(a-t)/2/s,d=(n-e)/2/l,y=Math.sqrt(h**2+d**2);if(y>1)throw new Error("The given radii are too small to create an arc between the points.");const g=Math.sqrt(1-y**2),p=i+g*l*Math.sin(c)*(r?-1:1),f=o-g*s*Math.cos(c)*(r?-1:1),u=Math.atan2((e-f)/l,(t-p)/s);let m=Math.atan2((n-f)/l,(a-p)/s)-u;r&&m<0&&(m+=2*Math.PI),!r&&m>0&&(m-=2*Math.PI);const x=[];for(let b=0;b<20;b++){const t=u+b/19*m,e=p+s*Math.cos(t),a=f+l*Math.sin(t);x.push({x:e,y:a})}return x}async function E(t,e){const{labelStyles:a,nodeStyles:n}=(0,s.GX)(e);e.labelStyle=a;const{shapeSvg:l,bbox:r}=await d(t,e,p(e)),i=r.width+e.padding+20,o=r.height+e.padding,c=o/2,y=c/(2.5+o/50),{cssStyles:u}=e,m=[{x:i/2,y:-o/2},{x:-i/2,y:-o/2},..._(-i/2,-o/2,-i/2,o/2,y,c,!1),{x:i/2,y:o/2},..._(i/2,o/2,i/2,-o/2,y,c,!0)],x=h.A.svg(l),b=(0,s.Fr)(e,{});"handDrawn"!==e.look&&(b.roughness=0,b.fillStyle="solid");const w=f(m),S=x.path(w,b),$=l.insert(()=>S,":first-child");return $.attr("class","basic label-container"),u&&"handDrawn"!==e.look&&$.selectAll("path").attr("style",u),n&&"handDrawn"!==e.look&&$.selectAll("path").attr("style",n),$.attr("transform",`translate(${y/2}, 0)`),g(e,$),e.intersect=function(t){return j.polygon(e,m,t)},l}function q(t,e,a,n){return t.insert("polygon",":first-child").attr("points",n.map(function(t){return t.x+","+t.y}).join(" ")).attr("class","label-container").attr("transform","translate("+-e/2+","+a/2+")")}async function z(t,e){const{labelStyles:a,nodeStyles:n}=(0,s.GX)(e);e.labelStyle=a;const{shapeSvg:l,bbox:r}=await d(t,e,p(e)),i=r.height+e.padding,o=r.width+e.padding+12,c=-i,y=[{x:12,y:c},{x:o,y:c},{x:o,y:0},{x:0,y:0},{x:0,y:c+12},{x:12,y:c}];let u;const{cssStyles:m}=e;if("handDrawn"===e.look){const t=h.A.svg(l),a=(0,s.Fr)(e,{}),n=f(y),r=t.path(n,a);u=l.insert(()=>r,":first-child").attr("transform",`translate(${-o/2}, ${i/2})`),m&&u.attr("style",m)}else u=q(l,o,i,y);return n&&u.attr("style",n),g(e,u),e.intersect=function(t){return j.polygon(e,y,t)},l}function V(t,e){const{nodeStyles:a}=(0,s.GX)(e);e.label="";const n=t.insert("g").attr("class",p(e)).attr("id",e.domId??e.id),{cssStyles:l}=e,r=Math.max(28,e.width??0),i=[{x:0,y:r/2},{x:r/2,y:0},{x:0,y:-r/2},{x:-r/2,y:0}],o=h.A.svg(n),c=(0,s.Fr)(e,{});"handDrawn"!==e.look&&(c.roughness=0,c.fillStyle="solid");const d=f(i),y=o.path(d,c),g=n.insert(()=>y,":first-child");return l&&"handDrawn"!==e.look&&g.selectAll("path").attr("style",l),a&&"handDrawn"!==e.look&&g.selectAll("path").attr("style",a),e.width=28,e.height=28,e.intersect=function(t){return j.polygon(e,i,t)},n}async function O(t,e,a){const{labelStyles:n,nodeStyles:l}=(0,s.GX)(e);e.labelStyle=n;const{shapeSvg:i,bbox:c,halfPadding:y}=await d(t,e,p(e)),f=a?.padding??y,u=c.width/2+f;let m;const{cssStyles:x}=e;if("handDrawn"===e.look){const t=h.A.svg(i),a=(0,s.Fr)(e,{}),n=t.circle(0,0,2*u,a);m=i.insert(()=>n,":first-child"),m.attr("class","basic label-container").attr("style",(0,r.KL)(x))}else m=i.insert("circle",":first-child").attr("class","basic label-container").attr("style",l).attr("r",u).attr("cx",0).attr("cy",0);return g(e,m),e.calcIntersect=function(t,e){const a=t.width/2;return j.circle(t,a,e)},e.intersect=function(t){return o.Rm.info("Circle intersect",e,u,t),j.circle(e,u,t)},i}function Z(t){const e=Math.cos(Math.PI/4),a=Math.sin(Math.PI/4),n=2*t;return`M ${-n/2*e},${n/2*a} L ${n/2*e},${-n/2*a}\n                   M ${n/2*e},${n/2*a} L ${-n/2*e},${-n/2*a}`}function Y(t,e){const{labelStyles:a,nodeStyles:n}=(0,s.GX)(e);e.labelStyle=a,e.label="";const l=t.insert("g").attr("class",p(e)).attr("id",e.domId??e.id),r=Math.max(30,e?.width??0),{cssStyles:i}=e,c=h.A.svg(l),d=(0,s.Fr)(e,{});"handDrawn"!==e.look&&(d.roughness=0,d.fillStyle="solid");const y=c.circle(0,0,2*r,d),f=Z(r),u=c.path(f,d),m=l.insert(()=>y,":first-child");return m.insert(()=>u),i&&"handDrawn"!==e.look&&m.selectAll("path").attr("style",i),n&&"handDrawn"!==e.look&&m.selectAll("path").attr("style",n),g(e,m),e.intersect=function(t){o.Rm.info("crossedCircle intersect",e,{radius:r,point:t});return j.circle(e,r,t)},l}function U(t,e,a,n=100,s=0,l=180){const r=[],i=s*Math.PI/180,o=(l*Math.PI/180-i)/(n-1);for(let c=0;c<n;c++){const n=i+c*o,s=t+a*Math.cos(n),l=e+a*Math.sin(n);r.push({x:-s,y:-l})}return r}async function J(t,e){const{labelStyles:a,nodeStyles:n}=(0,s.GX)(e);e.labelStyle=a;const{shapeSvg:l,bbox:r,label:i}=await d(t,e,p(e)),o=r.width+(e.padding??0),c=r.height+(e.padding??0),y=Math.max(5,.1*c),{cssStyles:u}=e,m=[...U(o/2,-c/2,y,30,-90,0),{x:-o/2-y,y:y},...U(o/2+2*y,-y,y,20,-180,-270),...U(o/2+2*y,y,y,20,-90,-180),{x:-o/2-y,y:-c/2},...U(o/2,c/2,y,20,0,90)],x=[{x:o/2,y:-c/2-y},{x:-o/2,y:-c/2-y},...U(o/2,-c/2,y,20,-90,0),{x:-o/2-y,y:-y},...U(o/2+.1*o,-y,y,20,-180,-270),...U(o/2+.1*o,y,y,20,-90,-180),{x:-o/2-y,y:c/2},...U(o/2,c/2,y,20,0,90),{x:-o/2,y:c/2+y},{x:o/2,y:c/2+y}],b=h.A.svg(l),w=(0,s.Fr)(e,{fill:"none"});"handDrawn"!==e.look&&(w.roughness=0,w.fillStyle="solid");const S=f(m).replace("Z",""),$=b.path(S,w),k=f(x),v=b.path(k,{...w}),M=l.insert("g",":first-child");return M.insert(()=>v,":first-child").attr("stroke-opacity",0),M.insert(()=>$,":first-child"),M.attr("class","text"),u&&"handDrawn"!==e.look&&M.selectAll("path").attr("style",u),n&&"handDrawn"!==e.look&&M.selectAll("path").attr("style",n),M.attr("transform",`translate(${y}, 0)`),i.attr("transform",`translate(${-o/2+y-(r.x-(r.left??0))},${-c/2+(e.padding??0)/2-(r.y-(r.top??0))})`),g(e,M),e.intersect=function(t){return j.polygon(e,x,t)},l}function Q(t,e,a,n=100,s=0,l=180){const r=[],i=s*Math.PI/180,o=(l*Math.PI/180-i)/(n-1);for(let c=0;c<n;c++){const n=i+c*o,s=t+a*Math.cos(n),l=e+a*Math.sin(n);r.push({x:s,y:l})}return r}async function tt(t,e){const{labelStyles:a,nodeStyles:n}=(0,s.GX)(e);e.labelStyle=a;const{shapeSvg:l,bbox:r,label:i}=await d(t,e,p(e)),o=r.width+(e.padding??0),c=r.height+(e.padding??0),y=Math.max(5,.1*c),{cssStyles:u}=e,m=[...Q(o/2,-c/2,y,20,-90,0),{x:o/2+y,y:-y},...Q(o/2+2*y,-y,y,20,-180,-270),...Q(o/2+2*y,y,y,20,-90,-180),{x:o/2+y,y:c/2},...Q(o/2,c/2,y,20,0,90)],x=[{x:-o/2,y:-c/2-y},{x:o/2,y:-c/2-y},...Q(o/2,-c/2,y,20,-90,0),{x:o/2+y,y:-y},...Q(o/2+2*y,-y,y,20,-180,-270),...Q(o/2+2*y,y,y,20,-90,-180),{x:o/2+y,y:c/2},...Q(o/2,c/2,y,20,0,90),{x:o/2,y:c/2+y},{x:-o/2,y:c/2+y}],b=h.A.svg(l),w=(0,s.Fr)(e,{fill:"none"});"handDrawn"!==e.look&&(w.roughness=0,w.fillStyle="solid");const S=f(m).replace("Z",""),$=b.path(S,w),k=f(x),v=b.path(k,{...w}),M=l.insert("g",":first-child");return M.insert(()=>v,":first-child").attr("stroke-opacity",0),M.insert(()=>$,":first-child"),M.attr("class","text"),u&&"handDrawn"!==e.look&&M.selectAll("path").attr("style",u),n&&"handDrawn"!==e.look&&M.selectAll("path").attr("style",n),M.attr("transform",`translate(${-y}, 0)`),i.attr("transform",`translate(${-o/2+(e.padding??0)/2-(r.x-(r.left??0))},${-c/2+(e.padding??0)/2-(r.y-(r.top??0))})`),g(e,M),e.intersect=function(t){return j.polygon(e,x,t)},l}function et(t,e,a,n=100,s=0,l=180){const r=[],i=s*Math.PI/180,o=(l*Math.PI/180-i)/(n-1);for(let c=0;c<n;c++){const n=i+c*o,s=t+a*Math.cos(n),l=e+a*Math.sin(n);r.push({x:-s,y:-l})}return r}async function at(t,e){const{labelStyles:a,nodeStyles:n}=(0,s.GX)(e);e.labelStyle=a;const{shapeSvg:l,bbox:r,label:i}=await d(t,e,p(e)),o=r.width+(e.padding??0),c=r.height+(e.padding??0),y=Math.max(5,.1*c),{cssStyles:u}=e,m=[...et(o/2,-c/2,y,30,-90,0),{x:-o/2-y,y:y},...et(o/2+2*y,-y,y,20,-180,-270),...et(o/2+2*y,y,y,20,-90,-180),{x:-o/2-y,y:-c/2},...et(o/2,c/2,y,20,0,90)],x=[...et(-o/2+y+y/2,-c/2,y,20,-90,-180),{x:o/2-y/2,y:y},...et(-o/2-y/2,-y,y,20,0,90),...et(-o/2-y/2,y,y,20,-90,0),{x:o/2-y/2,y:-y},...et(-o/2+y+y/2,c/2,y,30,-180,-270)],b=[{x:o/2,y:-c/2-y},{x:-o/2,y:-c/2-y},...et(o/2,-c/2,y,20,-90,0),{x:-o/2-y,y:-y},...et(o/2+2*y,-y,y,20,-180,-270),...et(o/2+2*y,y,y,20,-90,-180),{x:-o/2-y,y:c/2},...et(o/2,c/2,y,20,0,90),{x:-o/2,y:c/2+y},{x:o/2-y-y/2,y:c/2+y},...et(-o/2+y+y/2,-c/2,y,20,-90,-180),{x:o/2-y/2,y:y},...et(-o/2-y/2,-y,y,20,0,90),...et(-o/2-y/2,y,y,20,-90,0),{x:o/2-y/2,y:-y},...et(-o/2+y+y/2,c/2,y,30,-180,-270)],w=h.A.svg(l),S=(0,s.Fr)(e,{fill:"none"});"handDrawn"!==e.look&&(S.roughness=0,S.fillStyle="solid");const $=f(m).replace("Z",""),k=w.path($,S),v=f(x).replace("Z",""),M=w.path(v,S),D=f(b),A=w.path(D,{...S}),B=l.insert("g",":first-child");return B.insert(()=>A,":first-child").attr("stroke-opacity",0),B.insert(()=>k,":first-child"),B.insert(()=>M,":first-child"),B.attr("class","text"),u&&"handDrawn"!==e.look&&B.selectAll("path").attr("style",u),n&&"handDrawn"!==e.look&&B.selectAll("path").attr("style",n),B.attr("transform",`translate(${y-y/4}, 0)`),i.attr("transform",`translate(${-o/2+(e.padding??0)/2-(r.x-(r.left??0))},${-c/2+(e.padding??0)/2-(r.y-(r.top??0))})`),g(e,B),e.intersect=function(t){return j.polygon(e,b,t)},l}async function nt(t,e){const{labelStyles:a,nodeStyles:n}=(0,s.GX)(e);e.labelStyle=a;const{shapeSvg:l,bbox:r}=await d(t,e,p(e)),i=Math.max(80,1.25*(r.width+2*(e.padding??0)),e?.width??0),o=Math.max(20,r.height+2*(e.padding??0),e?.height??0),c=o/2,{cssStyles:y}=e,u=h.A.svg(l),x=(0,s.Fr)(e,{});"handDrawn"!==e.look&&(x.roughness=0,x.fillStyle="solid");const b=i-c,w=o/4,S=[{x:b,y:0},{x:w,y:0},{x:0,y:o/2},{x:w,y:o},{x:b,y:o},...m(-b,-o/2,c,50,270,90)],$=f(S),k=u.path($,x),v=l.insert(()=>k,":first-child");return v.attr("class","basic label-container"),y&&"handDrawn"!==e.look&&v.selectChildren("path").attr("style",y),n&&"handDrawn"!==e.look&&v.selectChildren("path").attr("style",n),v.attr("transform",`translate(${-i/2}, ${-o/2})`),g(e,v),e.intersect=function(t){return j.polygon(e,S,t)},l}(0,o.K2)(H,"anchor"),(0,o.K2)(_,"generateArcPoints"),(0,o.K2)(E,"bowTieRect"),(0,o.K2)(q,"insertPolygonShape"),(0,o.K2)(z,"card"),(0,o.K2)(V,"choice"),(0,o.K2)(O,"circle"),(0,o.K2)(Z,"createLine"),(0,o.K2)(Y,"crossedCircle"),(0,o.K2)(U,"generateCirclePoints"),(0,o.K2)(J,"curlyBraceLeft"),(0,o.K2)(Q,"generateCirclePoints"),(0,o.K2)(tt,"curlyBraceRight"),(0,o.K2)(et,"generateCirclePoints"),(0,o.K2)(at,"curlyBraces"),(0,o.K2)(nt,"curvedTrapezoid");var st=(0,o.K2)((t,e,a,n,s,l)=>[`M${t},${e+l}`,`a${s},${l} 0,0,0 ${a},0`,`a${s},${l} 0,0,0 ${-a},0`,`l0,${n}`,`a${s},${l} 0,0,0 ${a},0`,"l0,"+-n].join(" "),"createCylinderPathD"),lt=(0,o.K2)((t,e,a,n,s,l)=>[`M${t},${e+l}`,`M${t+a},${e+l}`,`a${s},${l} 0,0,0 ${-a},0`,`l0,${n}`,`a${s},${l} 0,0,0 ${a},0`,"l0,"+-n].join(" "),"createOuterCylinderPathD"),rt=(0,o.K2)((t,e,a,n,s,l)=>[`M${t-a/2},${-n/2}`,`a${s},${l} 0,0,0 ${a},0`].join(" "),"createInnerCylinderPathD");async function it(t,e){const{labelStyles:a,nodeStyles:n}=(0,s.GX)(e);e.labelStyle=a;const{shapeSvg:l,bbox:i,label:o}=await d(t,e,p(e)),c=Math.max(i.width+e.padding,e.width??0),y=c/2,f=y/(2.5+c/50),u=Math.max(i.height+f+e.padding,e.height??0);let m;const{cssStyles:x}=e;if("handDrawn"===e.look){const t=h.A.svg(l),a=lt(0,0,c,u,y,f),n=rt(0,f,c,u,y,f),r=t.path(a,(0,s.Fr)(e,{})),i=t.path(n,(0,s.Fr)(e,{fill:"none"}));m=l.insert(()=>i,":first-child"),m=l.insert(()=>r,":first-child"),m.attr("class","basic label-container"),x&&m.attr("style",x)}else{const t=st(0,0,c,u,y,f);m=l.insert("path",":first-child").attr("d",t).attr("class","basic label-container").attr("style",(0,r.KL)(x)).attr("style",n)}return m.attr("label-offset-y",f),m.attr("transform",`translate(${-c/2}, ${-(u/2+f)})`),g(e,m),o.attr("transform",`translate(${-i.width/2-(i.x-(i.left??0))}, ${-i.height/2+(e.padding??0)/1.5-(i.y-(i.top??0))})`),e.intersect=function(t){const a=j.rect(e,t),n=a.x-(e.x??0);if(0!=y&&(Math.abs(n)<(e.width??0)/2||Math.abs(n)==(e.width??0)/2&&Math.abs(a.y-(e.y??0))>(e.height??0)/2-f)){let s=f*f*(1-n*n/(y*y));s>0&&(s=Math.sqrt(s)),s=f-s,t.y-(e.y??0)>0&&(s=-s),a.y+=s}return a},l}async function ot(t,e){const{labelStyles:a,nodeStyles:n}=(0,s.GX)(e);e.labelStyle=a;const{shapeSvg:l,bbox:r,label:i}=await d(t,e,p(e)),o=r.width+e.padding,c=r.height+e.padding,y=.2*c,f=-o/2,u=-c/2-y/2,{cssStyles:m}=e,x=h.A.svg(l),b=(0,s.Fr)(e,{});"handDrawn"!==e.look&&(b.roughness=0,b.fillStyle="solid");const w=[{x:f,y:u+y},{x:-f,y:u+y},{x:-f,y:-u},{x:f,y:-u},{x:f,y:u},{x:-f,y:u},{x:-f,y:u+y}],S=x.polygon(w.map(t=>[t.x,t.y]),b),$=l.insert(()=>S,":first-child");return $.attr("class","basic label-container"),m&&"handDrawn"!==e.look&&$.selectAll("path").attr("style",m),n&&"handDrawn"!==e.look&&$.selectAll("path").attr("style",n),i.attr("transform",`translate(${f+(e.padding??0)/2-(r.x-(r.left??0))}, ${u+y+(e.padding??0)/2-(r.y-(r.top??0))})`),g(e,$),e.intersect=function(t){return j.rect(e,t)},l}async function ct(t,e){const{labelStyles:a,nodeStyles:n}=(0,s.GX)(e);e.labelStyle=a;const{shapeSvg:l,bbox:i,halfPadding:c}=await d(t,e,p(e)),y=i.width/2+c+5,f=i.width/2+c;let u;const{cssStyles:m}=e;if("handDrawn"===e.look){const t=h.A.svg(l),a=(0,s.Fr)(e,{roughness:.2,strokeWidth:2.5}),n=(0,s.Fr)(e,{roughness:.2,strokeWidth:1.5}),i=t.circle(0,0,2*y,a),o=t.circle(0,0,2*f,n);u=l.insert("g",":first-child"),u.attr("class",(0,r.KL)(e.cssClasses)).attr("style",(0,r.KL)(m)),u.node()?.appendChild(i),u.node()?.appendChild(o)}else{u=l.insert("g",":first-child");const t=u.insert("circle",":first-child"),e=u.insert("circle");u.attr("class","basic label-container").attr("style",n),t.attr("class","outer-circle").attr("style",n).attr("r",y).attr("cx",0).attr("cy",0),e.attr("class","inner-circle").attr("style",n).attr("r",f).attr("cx",0).attr("cy",0)}return g(e,u),e.intersect=function(t){return o.Rm.info("DoubleCircle intersect",e,y,t),j.circle(e,y,t)},l}function ht(t,e,{config:{themeVariables:a}}){const{labelStyles:n,nodeStyles:l}=(0,s.GX)(e);e.label="",e.labelStyle=n;const r=t.insert("g").attr("class",p(e)).attr("id",e.domId??e.id),{cssStyles:i}=e,c=h.A.svg(r),{nodeBorder:d}=a,y=(0,s.Fr)(e,{fillStyle:"solid"});"handDrawn"!==e.look&&(y.roughness=0);const f=c.circle(0,0,14,y),u=r.insert(()=>f,":first-child");return u.selectAll("path").attr("style",`fill: ${d} !important;`),i&&i.length>0&&"handDrawn"!==e.look&&u.selectAll("path").attr("style",i),l&&"handDrawn"!==e.look&&u.selectAll("path").attr("style",l),g(e,u),e.intersect=function(t){o.Rm.info("filledCircle intersect",e,{radius:7,point:t});return j.circle(e,7,t)},r}async function dt(t,e){const{labelStyles:a,nodeStyles:n}=(0,s.GX)(e);e.labelStyle=a;const{shapeSvg:l,bbox:r,label:i}=await d(t,e,p(e)),c=r.width+(e.padding??0),y=c+r.height,u=c+r.height,m=[{x:0,y:-y},{x:u,y:-y},{x:u/2,y:0}],{cssStyles:x}=e,b=h.A.svg(l),w=(0,s.Fr)(e,{});"handDrawn"!==e.look&&(w.roughness=0,w.fillStyle="solid");const S=f(m),$=b.path(S,w),k=l.insert(()=>$,":first-child").attr("transform",`translate(${-y/2}, ${y/2})`);return x&&"handDrawn"!==e.look&&k.selectChildren("path").attr("style",x),n&&"handDrawn"!==e.look&&k.selectChildren("path").attr("style",n),e.width=c,e.height=y,g(e,k),i.attr("transform",`translate(${-r.width/2-(r.x-(r.left??0))}, ${-y/2+(e.padding??0)/2+(r.y-(r.top??0))})`),e.intersect=function(t){return o.Rm.info("Triangle intersect",e,m,t),j.polygon(e,m,t)},l}function yt(t,e,{dir:a,config:{state:n,themeVariables:l}}){const{nodeStyles:r}=(0,s.GX)(e);e.label="";const i=t.insert("g").attr("class",p(e)).attr("id",e.domId??e.id),{cssStyles:o}=e;let c=Math.max(70,e?.width??0),d=Math.max(10,e?.height??0);"LR"===a&&(c=Math.max(10,e?.width??0),d=Math.max(70,e?.height??0));const y=-1*c/2,f=-1*d/2,u=h.A.svg(i),m=(0,s.Fr)(e,{stroke:l.lineColor,fill:l.lineColor});"handDrawn"!==e.look&&(m.roughness=0,m.fillStyle="solid");const x=u.rectangle(y,f,c,d,m),b=i.insert(()=>x,":first-child");o&&"handDrawn"!==e.look&&b.selectAll("path").attr("style",o),r&&"handDrawn"!==e.look&&b.selectAll("path").attr("style",r),g(e,b);const w=n?.padding??0;return e.width&&e.height&&(e.width+=w/2||0,e.height+=w/2||0),e.intersect=function(t){return j.rect(e,t)},i}async function gt(t,e){const{labelStyles:a,nodeStyles:n}=(0,s.GX)(e);e.labelStyle=a;const{shapeSvg:l,bbox:r}=await d(t,e,p(e)),i=Math.max(80,r.width+2*(e.padding??0),e?.width??0),c=Math.max(50,r.height+2*(e.padding??0),e?.height??0),y=c/2,{cssStyles:u}=e,x=h.A.svg(l),b=(0,s.Fr)(e,{});"handDrawn"!==e.look&&(b.roughness=0,b.fillStyle="solid");const w=[{x:-i/2,y:-c/2},{x:i/2-y,y:-c/2},...m(-i/2+y,0,y,50,90,270),{x:i/2-y,y:c/2},{x:-i/2,y:c/2}],S=f(w),$=x.path(S,b),k=l.insert(()=>$,":first-child");return k.attr("class","basic label-container"),u&&"handDrawn"!==e.look&&k.selectChildren("path").attr("style",u),n&&"handDrawn"!==e.look&&k.selectChildren("path").attr("style",n),g(e,k),e.intersect=function(t){o.Rm.info("Pill intersect",e,{radius:y,point:t});return j.polygon(e,w,t)},l}async function pt(t,e){const{labelStyles:a,nodeStyles:n}=(0,s.GX)(e);e.labelStyle=a;const{shapeSvg:l,bbox:r}=await d(t,e,p(e)),i=r.height+(e.padding??0),o=r.width+2.5*(e.padding??0),{cssStyles:c}=e,y=h.A.svg(l),u=(0,s.Fr)(e,{});"handDrawn"!==e.look&&(u.roughness=0,u.fillStyle="solid");let m=o/2;m+=m/6;const x=i/2,b=m-x/2,w=[{x:-b,y:-x},{x:0,y:-x},{x:b,y:-x},{x:m,y:0},{x:b,y:x},{x:0,y:x},{x:-b,y:x},{x:-m,y:0}],S=f(w),$=y.path(S,u),k=l.insert(()=>$,":first-child");return k.attr("class","basic label-container"),c&&"handDrawn"!==e.look&&k.selectChildren("path").attr("style",c),n&&"handDrawn"!==e.look&&k.selectChildren("path").attr("style",n),e.width=o,e.height=i,g(e,k),e.intersect=function(t){return j.polygon(e,w,t)},l}async function ft(t,e){const{labelStyles:a,nodeStyles:n}=(0,s.GX)(e);e.label="",e.labelStyle=a;const{shapeSvg:l}=await d(t,e,p(e)),r=Math.max(30,e?.width??0),i=Math.max(30,e?.height??0),{cssStyles:c}=e,y=h.A.svg(l),u=(0,s.Fr)(e,{});"handDrawn"!==e.look&&(u.roughness=0,u.fillStyle="solid");const m=[{x:0,y:0},{x:r,y:0},{x:0,y:i},{x:r,y:i}],x=f(m),b=y.path(x,u),w=l.insert(()=>b,":first-child");return w.attr("class","basic label-container"),c&&"handDrawn"!==e.look&&w.selectChildren("path").attr("style",c),n&&"handDrawn"!==e.look&&w.selectChildren("path").attr("style",n),w.attr("transform",`translate(${-r/2}, ${-i/2})`),g(e,w),e.intersect=function(t){o.Rm.info("Pill intersect",e,{points:m});return j.polygon(e,m,t)},l}async function ut(t,e,{config:{themeVariables:a,flowchart:n}}){const{labelStyles:r}=(0,s.GX)(e);e.labelStyle=r;const i=e.assetHeight??48,c=e.assetWidth??48,y=Math.max(i,c),p=n?.wrappingWidth;e.width=Math.max(y,p??0);const{shapeSvg:f,bbox:u,label:m}=await d(t,e,"icon-shape default"),x="t"===e.pos,b=y,w=y,{nodeBorder:S}=a,{stylesMap:$}=(0,s.WW)(e),k=-w/2,v=-b/2,M=e.label?8:0,D=h.A.svg(f),A=(0,s.Fr)(e,{stroke:"none",fill:"none"});"handDrawn"!==e.look&&(A.roughness=0,A.fillStyle="solid");const B=D.rectangle(k,v,w,b,A),C=Math.max(w,u.width),K=b+u.height+M,N=D.rectangle(-C/2,-K/2,C,K,{...A,fill:"transparent",stroke:"none"}),L=f.insert(()=>B,":first-child"),R=f.insert(()=>N);if(e.icon){const t=f.append("g");t.html(`<g>${await(0,l.WY)(e.icon,{height:y,width:y,fallbackPrefix:""})}</g>`);const a=t.node().getBBox(),n=a.width,s=a.height,r=a.x,i=a.y;t.attr("transform",`translate(${-n/2-r},${x?u.height/2+M/2-s/2-i:-u.height/2-M/2-s/2-i})`),t.attr("style",`color: ${$.get("stroke")??S};`)}return m.attr("transform",`translate(${-u.width/2-(u.x-(u.left??0))},${x?-K/2:K/2-u.height})`),L.attr("transform",`translate(0,${x?u.height/2+M/2:-u.height/2-M/2})`),g(e,R),e.intersect=function(t){if(o.Rm.info("iconSquare intersect",e,t),!e.label)return j.rect(e,t);const a=e.x??0,n=e.y??0,s=e.height??0;let l=[];l=x?[{x:a-u.width/2,y:n-s/2},{x:a+u.width/2,y:n-s/2},{x:a+u.width/2,y:n-s/2+u.height+M},{x:a+w/2,y:n-s/2+u.height+M},{x:a+w/2,y:n+s/2},{x:a-w/2,y:n+s/2},{x:a-w/2,y:n-s/2+u.height+M},{x:a-u.width/2,y:n-s/2+u.height+M}]:[{x:a-w/2,y:n-s/2},{x:a+w/2,y:n-s/2},{x:a+w/2,y:n-s/2+b},{x:a+u.width/2,y:n-s/2+b},{x:a+u.width/2/2,y:n+s/2},{x:a-u.width/2,y:n+s/2},{x:a-u.width/2,y:n-s/2+b},{x:a-w/2,y:n-s/2+b}];return j.polygon(e,l,t)},f}async function mt(t,e,{config:{themeVariables:a,flowchart:n}}){const{labelStyles:r}=(0,s.GX)(e);e.labelStyle=r;const i=e.assetHeight??48,c=e.assetWidth??48,y=Math.max(i,c),p=n?.wrappingWidth;e.width=Math.max(y,p??0);const{shapeSvg:f,bbox:u,label:m}=await d(t,e,"icon-shape default"),x=e.label?8:0,b="t"===e.pos,{nodeBorder:w,mainBkg:S}=a,{stylesMap:$}=(0,s.WW)(e),k=h.A.svg(f),v=(0,s.Fr)(e,{});"handDrawn"!==e.look&&(v.roughness=0,v.fillStyle="solid");const M=$.get("fill");v.stroke=M??S;const D=f.append("g");e.icon&&D.html(`<g>${await(0,l.WY)(e.icon,{height:y,width:y,fallbackPrefix:""})}</g>`);const A=D.node().getBBox(),B=A.width,C=A.height,K=A.x,N=A.y,L=Math.max(B,C)*Math.SQRT2+40,R=k.circle(0,0,L,v),P=Math.max(L,u.width),F=L+u.height+x,X=k.rectangle(-P/2,-F/2,P,F,{...v,fill:"transparent",stroke:"none"}),G=f.insert(()=>R,":first-child"),I=f.insert(()=>X);return D.attr("transform",`translate(${-B/2-K},${b?u.height/2+x/2-C/2-N:-u.height/2-x/2-C/2-N})`),D.attr("style",`color: ${$.get("stroke")??w};`),m.attr("transform",`translate(${-u.width/2-(u.x-(u.left??0))},${b?-F/2:F/2-u.height})`),G.attr("transform",`translate(0,${b?u.height/2+x/2:-u.height/2-x/2})`),g(e,I),e.intersect=function(t){o.Rm.info("iconSquare intersect",e,t);return j.rect(e,t)},f}async function xt(t,e,{config:{themeVariables:a,flowchart:n}}){const{labelStyles:r}=(0,s.GX)(e);e.labelStyle=r;const i=e.assetHeight??48,c=e.assetWidth??48,y=Math.max(i,c),p=n?.wrappingWidth;e.width=Math.max(y,p??0);const{shapeSvg:f,bbox:u,halfPadding:m,label:x}=await d(t,e,"icon-shape default"),b="t"===e.pos,w=y+2*m,S=y+2*m,{nodeBorder:k,mainBkg:v}=a,{stylesMap:M}=(0,s.WW)(e),D=-S/2,A=-w/2,B=e.label?8:0,C=h.A.svg(f),K=(0,s.Fr)(e,{});"handDrawn"!==e.look&&(K.roughness=0,K.fillStyle="solid");const N=M.get("fill");K.stroke=N??v;const L=C.path($(D,A,S,w,5),K),R=Math.max(S,u.width),P=w+u.height+B,F=C.rectangle(-R/2,-P/2,R,P,{...K,fill:"transparent",stroke:"none"}),X=f.insert(()=>L,":first-child").attr("class","icon-shape2"),G=f.insert(()=>F);if(e.icon){const t=f.append("g");t.html(`<g>${await(0,l.WY)(e.icon,{height:y,width:y,fallbackPrefix:""})}</g>`);const a=t.node().getBBox(),n=a.width,s=a.height,r=a.x,i=a.y;t.attr("transform",`translate(${-n/2-r},${b?u.height/2+B/2-s/2-i:-u.height/2-B/2-s/2-i})`),t.attr("style",`color: ${M.get("stroke")??k};`)}return x.attr("transform",`translate(${-u.width/2-(u.x-(u.left??0))},${b?-P/2:P/2-u.height})`),X.attr("transform",`translate(0,${b?u.height/2+B/2:-u.height/2-B/2})`),g(e,G),e.intersect=function(t){if(o.Rm.info("iconSquare intersect",e,t),!e.label)return j.rect(e,t);const a=e.x??0,n=e.y??0,s=e.height??0;let l=[];l=b?[{x:a-u.width/2,y:n-s/2},{x:a+u.width/2,y:n-s/2},{x:a+u.width/2,y:n-s/2+u.height+B},{x:a+S/2,y:n-s/2+u.height+B},{x:a+S/2,y:n+s/2},{x:a-S/2,y:n+s/2},{x:a-S/2,y:n-s/2+u.height+B},{x:a-u.width/2,y:n-s/2+u.height+B}]:[{x:a-S/2,y:n-s/2},{x:a+S/2,y:n-s/2},{x:a+S/2,y:n-s/2+w},{x:a+u.width/2,y:n-s/2+w},{x:a+u.width/2/2,y:n+s/2},{x:a-u.width/2,y:n+s/2},{x:a-u.width/2,y:n-s/2+w},{x:a-S/2,y:n-s/2+w}];return j.polygon(e,l,t)},f}async function bt(t,e,{config:{themeVariables:a,flowchart:n}}){const{labelStyles:r}=(0,s.GX)(e);e.labelStyle=r;const i=e.assetHeight??48,c=e.assetWidth??48,y=Math.max(i,c),p=n?.wrappingWidth;e.width=Math.max(y,p??0);const{shapeSvg:f,bbox:u,halfPadding:m,label:x}=await d(t,e,"icon-shape default"),b="t"===e.pos,w=y+2*m,S=y+2*m,{nodeBorder:k,mainBkg:v}=a,{stylesMap:M}=(0,s.WW)(e),D=-S/2,A=-w/2,B=e.label?8:0,C=h.A.svg(f),K=(0,s.Fr)(e,{});"handDrawn"!==e.look&&(K.roughness=0,K.fillStyle="solid");const N=M.get("fill");K.stroke=N??v;const L=C.path($(D,A,S,w,.1),K),R=Math.max(S,u.width),P=w+u.height+B,F=C.rectangle(-R/2,-P/2,R,P,{...K,fill:"transparent",stroke:"none"}),X=f.insert(()=>L,":first-child"),G=f.insert(()=>F);if(e.icon){const t=f.append("g");t.html(`<g>${await(0,l.WY)(e.icon,{height:y,width:y,fallbackPrefix:""})}</g>`);const a=t.node().getBBox(),n=a.width,s=a.height,r=a.x,i=a.y;t.attr("transform",`translate(${-n/2-r},${b?u.height/2+B/2-s/2-i:-u.height/2-B/2-s/2-i})`),t.attr("style",`color: ${M.get("stroke")??k};`)}return x.attr("transform",`translate(${-u.width/2-(u.x-(u.left??0))},${b?-P/2:P/2-u.height})`),X.attr("transform",`translate(0,${b?u.height/2+B/2:-u.height/2-B/2})`),g(e,G),e.intersect=function(t){if(o.Rm.info("iconSquare intersect",e,t),!e.label)return j.rect(e,t);const a=e.x??0,n=e.y??0,s=e.height??0;let l=[];l=b?[{x:a-u.width/2,y:n-s/2},{x:a+u.width/2,y:n-s/2},{x:a+u.width/2,y:n-s/2+u.height+B},{x:a+S/2,y:n-s/2+u.height+B},{x:a+S/2,y:n+s/2},{x:a-S/2,y:n+s/2},{x:a-S/2,y:n-s/2+u.height+B},{x:a-u.width/2,y:n-s/2+u.height+B}]:[{x:a-S/2,y:n-s/2},{x:a+S/2,y:n-s/2},{x:a+S/2,y:n-s/2+w},{x:a+u.width/2,y:n-s/2+w},{x:a+u.width/2/2,y:n+s/2},{x:a-u.width/2,y:n+s/2},{x:a-u.width/2,y:n-s/2+w},{x:a-S/2,y:n-s/2+w}];return j.polygon(e,l,t)},f}async function wt(t,e,{config:{flowchart:a}}){const n=new Image;n.src=e?.img??"",await n.decode();const l=Number(n.naturalWidth.toString().replace("px","")),r=Number(n.naturalHeight.toString().replace("px",""));e.imageAspectRatio=l/r;const{labelStyles:i}=(0,s.GX)(e);e.labelStyle=i;const c=a?.wrappingWidth;e.defaultWidth=a?.wrappingWidth;const y=Math.max(e.label?c??0:0,e?.assetWidth??l),p="on"===e.constraint&&e?.assetHeight?e.assetHeight*e.imageAspectRatio:y,f="on"===e.constraint?p/e.imageAspectRatio:e?.assetHeight??r;e.width=Math.max(p,c??0);const{shapeSvg:u,bbox:m,label:x}=await d(t,e,"image-shape default"),b="t"===e.pos,w=-p/2,S=-f/2,$=e.label?8:0,k=h.A.svg(u),v=(0,s.Fr)(e,{});"handDrawn"!==e.look&&(v.roughness=0,v.fillStyle="solid");const M=k.rectangle(w,S,p,f,v),D=Math.max(p,m.width),A=f+m.height+$,B=k.rectangle(-D/2,-A/2,D,A,{...v,fill:"none",stroke:"none"}),C=u.insert(()=>M,":first-child"),K=u.insert(()=>B);if(e.img){const t=u.append("image");t.attr("href",e.img),t.attr("width",p),t.attr("height",f),t.attr("preserveAspectRatio","none"),t.attr("transform",`translate(${-p/2},${b?A/2-f:-A/2})`)}return x.attr("transform",`translate(${-m.width/2-(m.x-(m.left??0))},${b?-f/2-m.height/2-$/2:f/2-m.height/2+$/2})`),C.attr("transform",`translate(0,${b?m.height/2+$/2:-m.height/2-$/2})`),g(e,K),e.intersect=function(t){if(o.Rm.info("iconSquare intersect",e,t),!e.label)return j.rect(e,t);const a=e.x??0,n=e.y??0,s=e.height??0;let l=[];l=b?[{x:a-m.width/2,y:n-s/2},{x:a+m.width/2,y:n-s/2},{x:a+m.width/2,y:n-s/2+m.height+$},{x:a+p/2,y:n-s/2+m.height+$},{x:a+p/2,y:n+s/2},{x:a-p/2,y:n+s/2},{x:a-p/2,y:n-s/2+m.height+$},{x:a-m.width/2,y:n-s/2+m.height+$}]:[{x:a-p/2,y:n-s/2},{x:a+p/2,y:n-s/2},{x:a+p/2,y:n-s/2+f},{x:a+m.width/2,y:n-s/2+f},{x:a+m.width/2/2,y:n+s/2},{x:a-m.width/2,y:n+s/2},{x:a-m.width/2,y:n-s/2+f},{x:a-p/2,y:n-s/2+f}];return j.polygon(e,l,t)},u}async function St(t,e){const{labelStyles:a,nodeStyles:n}=(0,s.GX)(e);e.labelStyle=a;const{shapeSvg:l,bbox:r}=await d(t,e,p(e)),i=Math.max(r.width+2*(e.padding??0),e?.width??0),o=Math.max(r.height+2*(e.padding??0),e?.height??0),c=[{x:0,y:0},{x:i,y:0},{x:i+3*o/6,y:-o},{x:-3*o/6,y:-o}];let y;const{cssStyles:u}=e;if("handDrawn"===e.look){const t=h.A.svg(l),a=(0,s.Fr)(e,{}),n=f(c),r=t.path(n,a);y=l.insert(()=>r,":first-child").attr("transform",`translate(${-i/2}, ${o/2})`),u&&y.attr("style",u)}else y=q(l,i,o,c);return n&&y.attr("style",n),e.width=i,e.height=o,g(e,y),e.intersect=function(t){return j.polygon(e,c,t)},l}async function $t(t,e,a){const{labelStyles:n,nodeStyles:l}=(0,s.GX)(e);e.labelStyle=n;const{shapeSvg:i,bbox:o}=await d(t,e,p(e)),c=Math.max(o.width+2*a.labelPaddingX,e?.width||0),y=Math.max(o.height+2*a.labelPaddingY,e?.height||0),f=-c/2,u=-y/2;let m,{rx:x,ry:b}=e;const{cssStyles:w}=e;if(a?.rx&&a.ry&&(x=a.rx,b=a.ry),"handDrawn"===e.look){const t=h.A.svg(i),a=(0,s.Fr)(e,{}),n=x||b?t.path($(f,u,c,y,x||0),a):t.rectangle(f,u,c,y,a);m=i.insert(()=>n,":first-child"),m.attr("class","basic label-container").attr("style",(0,r.KL)(w))}else m=i.insert("rect",":first-child"),m.attr("class","basic label-container").attr("style",l).attr("rx",(0,r.KL)(x)).attr("ry",(0,r.KL)(b)).attr("x",f).attr("y",u).attr("width",c).attr("height",y);return g(e,m),e.calcIntersect=function(t,e){return j.rect(t,e)},e.intersect=function(t){return j.rect(e,t)},i}async function kt(t,e){const{shapeSvg:a,bbox:n,label:s}=await d(t,e,"label"),l=a.insert("rect",":first-child");return l.attr("width",.1).attr("height",.1),a.attr("class","label edgeLabel"),s.attr("transform",`translate(${-n.width/2-(n.x-(n.left??0))}, ${-n.height/2-(n.y-(n.top??0))})`),g(e,l),e.intersect=function(t){return j.rect(e,t)},a}async function vt(t,e){const{labelStyles:a,nodeStyles:n}=(0,s.GX)(e);e.labelStyle=a;const{shapeSvg:l,bbox:r}=await d(t,e,p(e)),i=Math.max(r.width+(e.padding??0),e?.width??0),o=Math.max(r.height+(e.padding??0),e?.height??0),c=[{x:0,y:0},{x:i+3*o/6,y:0},{x:i,y:-o},{x:-3*o/6,y:-o}];let y;const{cssStyles:u}=e;if("handDrawn"===e.look){const t=h.A.svg(l),a=(0,s.Fr)(e,{}),n=f(c),r=t.path(n,a);y=l.insert(()=>r,":first-child").attr("transform",`translate(${-i/2}, ${o/2})`),u&&y.attr("style",u)}else y=q(l,i,o,c);return n&&y.attr("style",n),e.width=i,e.height=o,g(e,y),e.intersect=function(t){return j.polygon(e,c,t)},l}async function Mt(t,e){const{labelStyles:a,nodeStyles:n}=(0,s.GX)(e);e.labelStyle=a;const{shapeSvg:l,bbox:r}=await d(t,e,p(e)),i=Math.max(r.width+(e.padding??0),e?.width??0),o=Math.max(r.height+(e.padding??0),e?.height??0),c=[{x:-3*o/6,y:0},{x:i,y:0},{x:i+3*o/6,y:-o},{x:0,y:-o}];let y;const{cssStyles:u}=e;if("handDrawn"===e.look){const t=h.A.svg(l),a=(0,s.Fr)(e,{}),n=f(c),r=t.path(n,a);y=l.insert(()=>r,":first-child").attr("transform",`translate(${-i/2}, ${o/2})`),u&&y.attr("style",u)}else y=q(l,i,o,c);return n&&y.attr("style",n),e.width=i,e.height=o,g(e,y),e.intersect=function(t){return j.polygon(e,c,t)},l}function Dt(t,e){const{labelStyles:a,nodeStyles:n}=(0,s.GX)(e);e.label="",e.labelStyle=a;const l=t.insert("g").attr("class",p(e)).attr("id",e.domId??e.id),{cssStyles:r}=e,i=Math.max(35,e?.width??0),c=Math.max(35,e?.height??0),d=[{x:i,y:0},{x:0,y:c+3.5},{x:i-14,y:c+3.5},{x:0,y:2*c},{x:i,y:c-3.5},{x:14,y:c-3.5}],y=h.A.svg(l),u=(0,s.Fr)(e,{});"handDrawn"!==e.look&&(u.roughness=0,u.fillStyle="solid");const m=f(d),x=y.path(m,u),b=l.insert(()=>x,":first-child");return r&&"handDrawn"!==e.look&&b.selectAll("path").attr("style",r),n&&"handDrawn"!==e.look&&b.selectAll("path").attr("style",n),b.attr("transform",`translate(-${i/2},${-c})`),g(e,b),e.intersect=function(t){o.Rm.info("lightningBolt intersect",e,t);return j.polygon(e,d,t)},l}(0,o.K2)(it,"cylinder"),(0,o.K2)(ot,"dividedRectangle"),(0,o.K2)(ct,"doublecircle"),(0,o.K2)(ht,"filledCircle"),(0,o.K2)(dt,"flippedTriangle"),(0,o.K2)(yt,"forkJoin"),(0,o.K2)(gt,"halfRoundedRectangle"),(0,o.K2)(pt,"hexagon"),(0,o.K2)(ft,"hourglass"),(0,o.K2)(ut,"icon"),(0,o.K2)(mt,"iconCircle"),(0,o.K2)(xt,"iconRounded"),(0,o.K2)(bt,"iconSquare"),(0,o.K2)(wt,"imageSquare"),(0,o.K2)(St,"inv_trapezoid"),(0,o.K2)($t,"drawRect"),(0,o.K2)(kt,"labelRect"),(0,o.K2)(vt,"lean_left"),(0,o.K2)(Mt,"lean_right"),(0,o.K2)(Dt,"lightningBolt");var At=(0,o.K2)((t,e,a,n,s,l,r)=>[`M${t},${e+l}`,`a${s},${l} 0,0,0 ${a},0`,`a${s},${l} 0,0,0 ${-a},0`,`l0,${n}`,`a${s},${l} 0,0,0 ${a},0`,"l0,"+-n,`M${t},${e+l+r}`,`a${s},${l} 0,0,0 ${a},0`].join(" "),"createCylinderPathD"),Bt=(0,o.K2)((t,e,a,n,s,l,r)=>[`M${t},${e+l}`,`M${t+a},${e+l}`,`a${s},${l} 0,0,0 ${-a},0`,`l0,${n}`,`a${s},${l} 0,0,0 ${a},0`,"l0,"+-n,`M${t},${e+l+r}`,`a${s},${l} 0,0,0 ${a},0`].join(" "),"createOuterCylinderPathD"),Ct=(0,o.K2)((t,e,a,n,s,l)=>[`M${t-a/2},${-n/2}`,`a${s},${l} 0,0,0 ${a},0`].join(" "),"createInnerCylinderPathD");async function Kt(t,e){const{labelStyles:a,nodeStyles:n}=(0,s.GX)(e);e.labelStyle=a;const{shapeSvg:l,bbox:i,label:o}=await d(t,e,p(e)),c=Math.max(i.width+(e.padding??0),e.width??0),y=c/2,f=y/(2.5+c/50),u=Math.max(i.height+f+(e.padding??0),e.height??0),m=.1*u;let x;const{cssStyles:b}=e;if("handDrawn"===e.look){const t=h.A.svg(l),a=Bt(0,0,c,u,y,f,m),n=Ct(0,f,c,u,y,f),r=(0,s.Fr)(e,{}),i=t.path(a,r),o=t.path(n,r);l.insert(()=>o,":first-child").attr("class","line"),x=l.insert(()=>i,":first-child"),x.attr("class","basic label-container"),b&&x.attr("style",b)}else{const t=At(0,0,c,u,y,f,m);x=l.insert("path",":first-child").attr("d",t).attr("class","basic label-container").attr("style",(0,r.KL)(b)).attr("style",n)}return x.attr("label-offset-y",f),x.attr("transform",`translate(${-c/2}, ${-(u/2+f)})`),g(e,x),o.attr("transform",`translate(${-i.width/2-(i.x-(i.left??0))}, ${-i.height/2+f-(i.y-(i.top??0))})`),e.intersect=function(t){const a=j.rect(e,t),n=a.x-(e.x??0);if(0!=y&&(Math.abs(n)<(e.width??0)/2||Math.abs(n)==(e.width??0)/2&&Math.abs(a.y-(e.y??0))>(e.height??0)/2-f)){let s=f*f*(1-n*n/(y*y));s>0&&(s=Math.sqrt(s)),s=f-s,t.y-(e.y??0)>0&&(s=-s),a.y+=s}return a},l}async function Nt(t,e){const{labelStyles:a,nodeStyles:n}=(0,s.GX)(e);e.labelStyle=a;const{shapeSvg:l,bbox:r,label:i}=await d(t,e,p(e)),o=Math.max(r.width+2*(e.padding??0),e?.width??0),c=Math.max(r.height+2*(e.padding??0),e?.height??0),y=c/4,f=c+y,{cssStyles:m}=e,x=h.A.svg(l),b=(0,s.Fr)(e,{});"handDrawn"!==e.look&&(b.roughness=0,b.fillStyle="solid");const w=[{x:-o/2-o/2*.1,y:-f/2},{x:-o/2-o/2*.1,y:f/2},...u(-o/2-o/2*.1,f/2,o/2+o/2*.1,f/2,y,.8),{x:o/2+o/2*.1,y:-f/2},{x:-o/2-o/2*.1,y:-f/2},{x:-o/2,y:-f/2},{x:-o/2,y:f/2*1.1},{x:-o/2,y:-f/2}],S=x.polygon(w.map(t=>[t.x,t.y]),b),$=l.insert(()=>S,":first-child");return $.attr("class","basic label-container"),m&&"handDrawn"!==e.look&&$.selectAll("path").attr("style",m),n&&"handDrawn"!==e.look&&$.selectAll("path").attr("style",n),$.attr("transform",`translate(0,${-y/2})`),i.attr("transform",`translate(${-o/2+(e.padding??0)+o/2*.1/2-(r.x-(r.left??0))},${-c/2+(e.padding??0)-y/2-(r.y-(r.top??0))})`),g(e,$),e.intersect=function(t){return j.polygon(e,w,t)},l}async function Lt(t,e){const{labelStyles:a,nodeStyles:n}=(0,s.GX)(e);e.labelStyle=a;const{shapeSvg:l,bbox:r,label:i}=await d(t,e,p(e)),o=Math.max(r.width+2*(e.padding??0),e?.width??0),c=Math.max(r.height+2*(e.padding??0),e?.height??0),y=-o/2,u=-c/2,{cssStyles:m}=e,x=h.A.svg(l),b=(0,s.Fr)(e,{}),w=[{x:y-5,y:u+5},{x:y-5,y:u+c+5},{x:y+o-5,y:u+c+5},{x:y+o-5,y:u+c},{x:y+o,y:u+c},{x:y+o,y:u+c-5},{x:y+o+5,y:u+c-5},{x:y+o+5,y:u-5},{x:y+5,y:u-5},{x:y+5,y:u},{x:y,y:u},{x:y,y:u+5}],S=[{x:y,y:u+5},{x:y+o-5,y:u+5},{x:y+o-5,y:u+c},{x:y+o,y:u+c},{x:y+o,y:u},{x:y,y:u}];"handDrawn"!==e.look&&(b.roughness=0,b.fillStyle="solid");const $=f(w),k=x.path($,b),v=f(S),M=x.path(v,{...b,fill:"none"}),D=l.insert(()=>M,":first-child");return D.insert(()=>k,":first-child"),D.attr("class","basic label-container"),m&&"handDrawn"!==e.look&&D.selectAll("path").attr("style",m),n&&"handDrawn"!==e.look&&D.selectAll("path").attr("style",n),i.attr("transform",`translate(${-r.width/2-5-(r.x-(r.left??0))}, ${-r.height/2+5-(r.y-(r.top??0))})`),g(e,D),e.intersect=function(t){return j.polygon(e,w,t)},l}async function Rt(t,e){const{labelStyles:a,nodeStyles:n}=(0,s.GX)(e);e.labelStyle=a;const{shapeSvg:l,bbox:r,label:i}=await d(t,e,p(e)),o=Math.max(r.width+2*(e.padding??0),e?.width??0),c=Math.max(r.height+2*(e.padding??0),e?.height??0),y=c/4,m=c+y,x=-o/2,b=-m/2,{cssStyles:w}=e,S=u(x-5,b+m+5,x+o-5,b+m+5,y,.8),$=S?.[S.length-1],k=[{x:x-5,y:b+5},{x:x-5,y:b+m+5},...S,{x:x+o-5,y:$.y-5},{x:x+o,y:$.y-5},{x:x+o,y:$.y-10},{x:x+o+5,y:$.y-10},{x:x+o+5,y:b-5},{x:x+5,y:b-5},{x:x+5,y:b},{x:x,y:b},{x:x,y:b+5}],v=[{x:x,y:b+5},{x:x+o-5,y:b+5},{x:x+o-5,y:$.y-5},{x:x+o,y:$.y-5},{x:x+o,y:b},{x:x,y:b}],M=h.A.svg(l),D=(0,s.Fr)(e,{});"handDrawn"!==e.look&&(D.roughness=0,D.fillStyle="solid");const A=f(k),B=M.path(A,D),C=f(v),K=M.path(C,D),N=l.insert(()=>B,":first-child");return N.insert(()=>K),N.attr("class","basic label-container"),w&&"handDrawn"!==e.look&&N.selectAll("path").attr("style",w),n&&"handDrawn"!==e.look&&N.selectAll("path").attr("style",n),N.attr("transform",`translate(0,${-y/2})`),i.attr("transform",`translate(${-r.width/2-5-(r.x-(r.left??0))}, ${-r.height/2+5-y/2-(r.y-(r.top??0))})`),g(e,N),e.intersect=function(t){return j.polygon(e,k,t)},l}async function Pt(t,e,{config:{themeVariables:a}}){const{labelStyles:n,nodeStyles:l}=(0,s.GX)(e);e.labelStyle=n;e.useHtmlLabels||!1!==(0,i.zj)().flowchart?.htmlLabels||(e.centerLabel=!0);const{shapeSvg:r,bbox:o,label:c}=await d(t,e,p(e)),y=Math.max(o.width+2*(e.padding??0),e?.width??0),f=Math.max(o.height+2*(e.padding??0),e?.height??0),u=-y/2,m=-f/2,{cssStyles:x}=e,b=h.A.svg(r),w=(0,s.Fr)(e,{fill:a.noteBkgColor,stroke:a.noteBorderColor});"handDrawn"!==e.look&&(w.roughness=0,w.fillStyle="solid");const S=b.rectangle(u,m,y,f,w),$=r.insert(()=>S,":first-child");return $.attr("class","basic label-container"),x&&"handDrawn"!==e.look&&$.selectAll("path").attr("style",x),l&&"handDrawn"!==e.look&&$.selectAll("path").attr("style",l),c.attr("transform",`translate(${-o.width/2-(o.x-(o.left??0))}, ${-o.height/2-(o.y-(o.top??0))})`),g(e,$),e.intersect=function(t){return j.rect(e,t)},r}(0,o.K2)(Kt,"linedCylinder"),(0,o.K2)(Nt,"linedWaveEdgedRect"),(0,o.K2)(Lt,"multiRect"),(0,o.K2)(Rt,"multiWaveEdgedRectangle"),(0,o.K2)(Pt,"note");var Ft=(0,o.K2)((t,e,a)=>[`M${t+a/2},${e}`,`L${t+a},${e-a/2}`,`L${t+a/2},${e-a}`,`L${t},${e-a/2}`,"Z"].join(" "),"createDecisionBoxPathD");async function Xt(t,e){const{labelStyles:a,nodeStyles:n}=(0,s.GX)(e);e.labelStyle=a;const{shapeSvg:l,bbox:r}=await d(t,e,p(e)),i=r.width+e.padding+(r.height+e.padding),o=[{x:i/2,y:0},{x:i,y:-i/2},{x:i/2,y:-i},{x:0,y:-i/2}];let c;const{cssStyles:y}=e;if("handDrawn"===e.look){const t=h.A.svg(l),a=(0,s.Fr)(e,{}),n=Ft(0,0,i),r=t.path(n,a);c=l.insert(()=>r,":first-child").attr("transform",`translate(${-i/2+.5}, ${i/2})`),y&&c.attr("style",y)}else c=q(l,i,i,o),c.attr("transform",`translate(${-i/2+.5}, ${i/2})`);return n&&c.attr("style",n),g(e,c),e.calcIntersect=function(t,e){const a=t.width,n=[{x:a/2,y:0},{x:a,y:-a/2},{x:a/2,y:-a},{x:0,y:-a/2}],s=j.polygon(t,n,e);return{x:s.x-.5,y:s.y-.5}},e.intersect=function(t){return this.calcIntersect(e,t)},l}async function Gt(t,e){const{labelStyles:a,nodeStyles:n}=(0,s.GX)(e);e.labelStyle=a;const{shapeSvg:l,bbox:r,label:i}=await d(t,e,p(e)),o=-Math.max(r.width+(e.padding??0),e?.width??0)/2,c=-Math.max(r.height+(e.padding??0),e?.height??0)/2,y=c/2,u=[{x:o+y,y:c},{x:o,y:0},{x:o+y,y:-c},{x:-o,y:-c},{x:-o,y:c}],{cssStyles:m}=e,x=h.A.svg(l),b=(0,s.Fr)(e,{});"handDrawn"!==e.look&&(b.roughness=0,b.fillStyle="solid");const w=f(u),S=x.path(w,b),$=l.insert(()=>S,":first-child");return $.attr("class","basic label-container"),m&&"handDrawn"!==e.look&&$.selectAll("path").attr("style",m),n&&"handDrawn"!==e.look&&$.selectAll("path").attr("style",n),$.attr("transform",`translate(${-y/2},0)`),i.attr("transform",`translate(${-y/2-r.width/2-(r.x-(r.left??0))}, ${-r.height/2-(r.y-(r.top??0))})`),g(e,$),e.intersect=function(t){return j.polygon(e,u,t)},l}async function It(t,e){const{labelStyles:a,nodeStyles:n}=(0,s.GX)(e);let l;e.labelStyle=a,l=e.cssClasses?"node "+e.cssClasses:"node default";const r=t.insert("g").attr("class",l).attr("id",e.domId||e.id),d=r.insert("g"),y=r.insert("g").attr("class","label").attr("style",n),p=e.description,f=e.label,u=y.node().appendChild(await S(f,e.labelStyle,!0,!0));let m={width:0,height:0};if((0,i._3)((0,i.D7)()?.flowchart?.htmlLabels)){const t=u.children[0],e=(0,c.Ltv)(u);m=t.getBoundingClientRect(),e.attr("width",m.width),e.attr("height",m.height)}o.Rm.info("Text 2",p);const x=p||[],b=u.getBBox(),w=y.node().appendChild(await S(x.join?x.join("<br/>"):x,e.labelStyle,!0,!0)),k=w.children[0],v=(0,c.Ltv)(w);m=k.getBoundingClientRect(),v.attr("width",m.width),v.attr("height",m.height);const M=(e.padding||0)/2;(0,c.Ltv)(w).attr("transform","translate( "+(m.width>b.width?0:(b.width-m.width)/2)+", "+(b.height+M+5)+")"),(0,c.Ltv)(u).attr("transform","translate( "+(m.width<b.width?0:-(b.width-m.width)/2)+", 0)"),m=y.node().getBBox(),y.attr("transform","translate("+-m.width/2+", "+(-m.height/2-M+3)+")");const D=m.width+(e.padding||0),A=m.height+(e.padding||0),B=-m.width/2-M,C=-m.height/2-M;let K,N;if("handDrawn"===e.look){const t=h.A.svg(r),a=(0,s.Fr)(e,{}),n=t.path($(B,C,D,A,e.rx||0),a),l=t.line(-m.width/2-M,-m.height/2-M+b.height+M,m.width/2+M,-m.height/2-M+b.height+M,a);N=r.insert(()=>(o.Rm.debug("Rough node insert CXC",n),l),":first-child"),K=r.insert(()=>(o.Rm.debug("Rough node insert CXC",n),n),":first-child")}else K=d.insert("rect",":first-child"),N=d.insert("line"),K.attr("class","outer title-state").attr("style",n).attr("x",-m.width/2-M).attr("y",-m.height/2-M).attr("width",m.width+(e.padding||0)).attr("height",m.height+(e.padding||0)),N.attr("class","divider").attr("x1",-m.width/2-M).attr("x2",m.width/2+M).attr("y1",-m.height/2-M+b.height+M).attr("y2",-m.height/2-M+b.height+M);return g(e,K),e.intersect=function(t){return j.rect(e,t)},r}function Tt(t,e,a,n,s,l,r){const i=(t+a)/2,o=(e+n)/2,c=Math.atan2(n-e,a-t),h=(a-t)/2/s,d=(n-e)/2/l,y=Math.sqrt(h**2+d**2);if(y>1)throw new Error("The given radii are too small to create an arc between the points.");const g=Math.sqrt(1-y**2),p=i+g*l*Math.sin(c)*(r?-1:1),f=o-g*s*Math.cos(c)*(r?-1:1),u=Math.atan2((e-f)/l,(t-p)/s);let m=Math.atan2((n-f)/l,(a-p)/s)-u;r&&m<0&&(m+=2*Math.PI),!r&&m>0&&(m-=2*Math.PI);const x=[];for(let b=0;b<20;b++){const t=u+b/19*m,e=p+s*Math.cos(t),a=f+l*Math.sin(t);x.push({x:e,y:a})}return x}async function Wt(t,e){const{labelStyles:a,nodeStyles:n}=(0,s.GX)(e);e.labelStyle=a;const{shapeSvg:l,bbox:r}=await d(t,e,p(e)),i=e?.padding??0,o=e?.padding??0,c=(e?.width?e?.width:r.width)+2*i,y=(e?.height?e?.height:r.height)+2*o,u=e.radius||5,m=e.taper||5,{cssStyles:x}=e,b=h.A.svg(l),w=(0,s.Fr)(e,{});e.stroke&&(w.stroke=e.stroke),"handDrawn"!==e.look&&(w.roughness=0,w.fillStyle="solid");const S=[{x:-c/2+m,y:-y/2},{x:c/2-m,y:-y/2},...Tt(c/2-m,-y/2,c/2,-y/2+m,u,u,!0),{x:c/2,y:-y/2+m},{x:c/2,y:y/2-m},...Tt(c/2,y/2-m,c/2-m,y/2,u,u,!0),{x:c/2-m,y:y/2},{x:-c/2+m,y:y/2},...Tt(-c/2+m,y/2,-c/2,y/2-m,u,u,!0),{x:-c/2,y:y/2-m},{x:-c/2,y:-y/2+m},...Tt(-c/2,-y/2+m,-c/2+m,-y/2,u,u,!0)],$=f(S),k=b.path($,w),v=l.insert(()=>k,":first-child");return v.attr("class","basic label-container outer-path"),x&&"handDrawn"!==e.look&&v.selectChildren("path").attr("style",x),n&&"handDrawn"!==e.look&&v.selectChildren("path").attr("style",n),g(e,v),e.intersect=function(t){return j.polygon(e,S,t)},l}async function jt(t,e){const{labelStyles:a,nodeStyles:n}=(0,s.GX)(e);e.labelStyle=a;const{shapeSvg:l,bbox:i,label:o}=await d(t,e,p(e)),c=e?.padding??0,y=Math.max(i.width+2*(e.padding??0),e?.width??0),f=Math.max(i.height+2*(e.padding??0),e?.height??0),u=-i.width/2-c,m=-i.height/2-c,{cssStyles:x}=e,b=h.A.svg(l),w=(0,s.Fr)(e,{});"handDrawn"!==e.look&&(w.roughness=0,w.fillStyle="solid");const S=[{x:u,y:m},{x:u+y+8,y:m},{x:u+y+8,y:m+f},{x:u-8,y:m+f},{x:u-8,y:m},{x:u,y:m},{x:u,y:m+f}],$=b.polygon(S.map(t=>[t.x,t.y]),w),k=l.insert(()=>$,":first-child");return k.attr("class","basic label-container").attr("style",(0,r.KL)(x)),n&&"handDrawn"!==e.look&&k.selectAll("path").attr("style",n),x&&"handDrawn"!==e.look&&k.selectAll("path").attr("style",n),o.attr("transform",`translate(${-y/2+4+(e.padding??0)-(i.x-(i.left??0))},${-f/2+(e.padding??0)-(i.y-(i.top??0))})`),g(e,k),e.intersect=function(t){return j.rect(e,t)},l}async function Ht(t,e){const{labelStyles:a,nodeStyles:n}=(0,s.GX)(e);e.labelStyle=a;const{shapeSvg:l,bbox:r,label:i}=await d(t,e,p(e)),o=Math.max(r.width+2*(e.padding??0),e?.width??0),c=Math.max(r.height+2*(e.padding??0),e?.height??0),y=-o/2,u=-c/2,{cssStyles:m}=e,x=h.A.svg(l),b=(0,s.Fr)(e,{});"handDrawn"!==e.look&&(b.roughness=0,b.fillStyle="solid");const w=[{x:y,y:u},{x:y,y:u+c},{x:y+o,y:u+c},{x:y+o,y:u-c/2}],S=f(w),$=x.path(S,b),k=l.insert(()=>$,":first-child");return k.attr("class","basic label-container"),m&&"handDrawn"!==e.look&&k.selectChildren("path").attr("style",m),n&&"handDrawn"!==e.look&&k.selectChildren("path").attr("style",n),k.attr("transform",`translate(0, ${c/4})`),i.attr("transform",`translate(${-o/2+(e.padding??0)-(r.x-(r.left??0))}, ${-c/4+(e.padding??0)-(r.y-(r.top??0))})`),g(e,k),e.intersect=function(t){return j.polygon(e,w,t)},l}async function _t(t,e){return $t(t,e,{rx:0,ry:0,classes:"",labelPaddingX:e.labelPaddingX??2*(e?.padding||0),labelPaddingY:1*(e?.padding||0)})}async function Et(t,e){const{labelStyles:a,nodeStyles:n}=(0,s.GX)(e);e.labelStyle=a;const{shapeSvg:l,bbox:r}=await d(t,e,p(e)),i=r.height+e.padding,o=r.width+i/4+e.padding,c=i/2,{cssStyles:y}=e,u=h.A.svg(l),x=(0,s.Fr)(e,{});"handDrawn"!==e.look&&(x.roughness=0,x.fillStyle="solid");const b=[{x:-o/2+c,y:-i/2},{x:o/2-c,y:-i/2},...m(-o/2+c,0,c,50,90,270),{x:o/2-c,y:i/2},...m(o/2-c,0,c,50,270,450)],w=f(b),S=u.path(w,x),$=l.insert(()=>S,":first-child");return $.attr("class","basic label-container outer-path"),y&&"handDrawn"!==e.look&&$.selectChildren("path").attr("style",y),n&&"handDrawn"!==e.look&&$.selectChildren("path").attr("style",n),g(e,$),e.intersect=function(t){return j.polygon(e,b,t)},l}async function qt(t,e){return $t(t,e,{rx:5,ry:5,classes:"flowchart-node"})}function zt(t,e,{config:{themeVariables:a}}){const{labelStyles:n,nodeStyles:l}=(0,s.GX)(e);e.labelStyle=n;const{cssStyles:r}=e,{lineColor:i,stateBorder:o,nodeBorder:c}=a,d=t.insert("g").attr("class","node default").attr("id",e.domId||e.id),y=h.A.svg(d),p=(0,s.Fr)(e,{});"handDrawn"!==e.look&&(p.roughness=0,p.fillStyle="solid");const f=y.circle(0,0,14,{...p,stroke:i,strokeWidth:2}),u=o??c,m=y.circle(0,0,5,{...p,fill:u,stroke:u,strokeWidth:2,fillStyle:"solid"}),x=d.insert(()=>f,":first-child");return x.insert(()=>m),r&&x.selectAll("path").attr("style",r),l&&x.selectAll("path").attr("style",l),g(e,x),e.intersect=function(t){return j.circle(e,7,t)},d}function Vt(t,e,{config:{themeVariables:a}}){const{lineColor:n}=a,l=t.insert("g").attr("class","node default").attr("id",e.domId||e.id);let r;if("handDrawn"===e.look){const t=h.A.svg(l).circle(0,0,14,(0,s.ue)(n));r=l.insert(()=>t),r.attr("class","state-start").attr("r",7).attr("width",14).attr("height",14)}else r=l.insert("circle",":first-child"),r.attr("class","state-start").attr("r",7).attr("width",14).attr("height",14);return g(e,r),e.intersect=function(t){return j.circle(e,7,t)},l}async function Ot(t,e){const{labelStyles:a,nodeStyles:n}=(0,s.GX)(e);e.labelStyle=a;const{shapeSvg:l,bbox:i}=await d(t,e,p(e)),o=(e?.padding||0)/2,c=i.width+e.padding,y=i.height+e.padding,f=-i.width/2-o,u=-i.height/2-o,m=[{x:0,y:0},{x:c,y:0},{x:c,y:-y},{x:0,y:-y},{x:0,y:0},{x:-8,y:0},{x:c+8,y:0},{x:c+8,y:-y},{x:-8,y:-y},{x:-8,y:0}];if("handDrawn"===e.look){const t=h.A.svg(l),a=(0,s.Fr)(e,{}),n=t.rectangle(f-8,u,c+16,y,a),i=t.line(f,u,f,u+y,a),o=t.line(f+c,u,f+c,u+y,a);l.insert(()=>i,":first-child"),l.insert(()=>o,":first-child");const d=l.insert(()=>n,":first-child"),{cssStyles:p}=e;d.attr("class","basic label-container").attr("style",(0,r.KL)(p)),g(e,d)}else{const t=q(l,c,y,m);n&&t.attr("style",n),g(e,t)}return e.intersect=function(t){return j.polygon(e,m,t)},l}async function Zt(t,e){const{labelStyles:a,nodeStyles:n}=(0,s.GX)(e);e.labelStyle=a;const{shapeSvg:l,bbox:r}=await d(t,e,p(e)),i=Math.max(r.width+2*(e.padding??0),e?.width??0),o=Math.max(r.height+2*(e.padding??0),e?.height??0),c=-i/2,y=-o/2,u=.2*o,m=.2*o,{cssStyles:x}=e,b=h.A.svg(l),w=(0,s.Fr)(e,{}),S=[{x:c-u/2,y:y},{x:c+i+u/2,y:y},{x:c+i+u/2,y:y+o},{x:c-u/2,y:y+o}],$=[{x:c+i-u/2,y:y+o},{x:c+i+u/2,y:y+o},{x:c+i+u/2,y:y+o-m}];"handDrawn"!==e.look&&(w.roughness=0,w.fillStyle="solid");const k=f(S),v=b.path(k,w),M=f($),D=b.path(M,{...w,fillStyle:"solid"}),A=l.insert(()=>D,":first-child");return A.insert(()=>v,":first-child"),A.attr("class","basic label-container"),x&&"handDrawn"!==e.look&&A.selectAll("path").attr("style",x),n&&"handDrawn"!==e.look&&A.selectAll("path").attr("style",n),g(e,A),e.intersect=function(t){return j.polygon(e,S,t)},l}async function Yt(t,e){const{labelStyles:a,nodeStyles:n}=(0,s.GX)(e);e.labelStyle=a;const{shapeSvg:l,bbox:r,label:i}=await d(t,e,p(e)),o=Math.max(r.width+2*(e.padding??0),e?.width??0),c=Math.max(r.height+2*(e.padding??0),e?.height??0),y=c/4,m=.2*o,x=.2*c,b=c+y,{cssStyles:w}=e,S=h.A.svg(l),$=(0,s.Fr)(e,{});"handDrawn"!==e.look&&($.roughness=0,$.fillStyle="solid");const k=[{x:-o/2-o/2*.1,y:b/2},...u(-o/2-o/2*.1,b/2,o/2+o/2*.1,b/2,y,.8),{x:o/2+o/2*.1,y:-b/2},{x:-o/2-o/2*.1,y:-b/2}],v=-o/2+o/2*.1,M=-b/2-.4*x,D=[{x:v+o-m,y:1.4*(M+c)},{x:v+o,y:M+c-x},{x:v+o,y:.9*(M+c)},...u(v+o,1.3*(M+c),v+o-m,1.5*(M+c),.03*-c,.5)],A=f(k),B=S.path(A,$),C=f(D),K=S.path(C,{...$,fillStyle:"solid"}),N=l.insert(()=>K,":first-child");return N.insert(()=>B,":first-child"),N.attr("class","basic label-container"),w&&"handDrawn"!==e.look&&N.selectAll("path").attr("style",w),n&&"handDrawn"!==e.look&&N.selectAll("path").attr("style",n),N.attr("transform",`translate(0,${-y/2})`),i.attr("transform",`translate(${-o/2+(e.padding??0)-(r.x-(r.left??0))},${-c/2+(e.padding??0)-y/2-(r.y-(r.top??0))})`),g(e,N),e.intersect=function(t){return j.polygon(e,k,t)},l}async function Ut(t,e){const{labelStyles:a,nodeStyles:n}=(0,s.GX)(e);e.labelStyle=a;const{shapeSvg:l,bbox:r}=await d(t,e,p(e)),i=Math.max(r.width+e.padding,e?.width||0),o=Math.max(r.height+e.padding,e?.height||0),c=-i/2,h=-o/2,y=l.insert("rect",":first-child");return y.attr("class","text").attr("style",n).attr("rx",0).attr("ry",0).attr("x",c).attr("y",h).attr("width",i).attr("height",o),g(e,y),e.intersect=function(t){return j.rect(e,t)},l}(0,o.K2)(Xt,"question"),(0,o.K2)(Gt,"rect_left_inv_arrow"),(0,o.K2)(It,"rectWithTitle"),(0,o.K2)(Tt,"generateArcPoints"),(0,o.K2)(Wt,"roundedRect"),(0,o.K2)(jt,"shadedProcess"),(0,o.K2)(Ht,"slopedRect"),(0,o.K2)(_t,"squareRect"),(0,o.K2)(Et,"stadium"),(0,o.K2)(qt,"state"),(0,o.K2)(zt,"stateEnd"),(0,o.K2)(Vt,"stateStart"),(0,o.K2)(Ot,"subroutine"),(0,o.K2)(Zt,"taggedRect"),(0,o.K2)(Yt,"taggedWaveEdgedRectangle"),(0,o.K2)(Ut,"text");var Jt=(0,o.K2)((t,e,a,n,s,l)=>`M${t},${e}\n    a${s},${l} 0,0,1 0,${-n}\n    l${a},0\n    a${s},${l} 0,0,1 0,${n}\n    M${a},${-n}\n    a${s},${l} 0,0,0 0,${n}\n    l${-a},0`,"createCylinderPathD"),Qt=(0,o.K2)((t,e,a,n,s,l)=>[`M${t},${e}`,`M${t+a},${e}`,`a${s},${l} 0,0,0 0,${-n}`,`l${-a},0`,`a${s},${l} 0,0,0 0,${n}`,`l${a},0`].join(" "),"createOuterCylinderPathD"),te=(0,o.K2)((t,e,a,n,s,l)=>[`M${t+a/2},${-n/2}`,`a${s},${l} 0,0,0 0,${n}`].join(" "),"createInnerCylinderPathD");async function ee(t,e){const{labelStyles:a,nodeStyles:n}=(0,s.GX)(e);e.labelStyle=a;const{shapeSvg:l,bbox:i,label:o,halfPadding:c}=await d(t,e,p(e)),y="neo"===e.look?2*c:c,f=i.height+y,u=f/2,m=u/(2.5+f/50),x=i.width+m+y,{cssStyles:b}=e;let w;if("handDrawn"===e.look){const t=h.A.svg(l),a=Qt(0,0,x,f,m,u),n=te(0,0,x,f,m,u),r=t.path(a,(0,s.Fr)(e,{})),i=t.path(n,(0,s.Fr)(e,{fill:"none"}));w=l.insert(()=>i,":first-child"),w=l.insert(()=>r,":first-child"),w.attr("class","basic label-container"),b&&w.attr("style",b)}else{const t=Jt(0,0,x,f,m,u);w=l.insert("path",":first-child").attr("d",t).attr("class","basic label-container").attr("style",(0,r.KL)(b)).attr("style",n),w.attr("class","basic label-container"),b&&w.selectAll("path").attr("style",b),n&&w.selectAll("path").attr("style",n)}return w.attr("label-offset-x",m),w.attr("transform",`translate(${-x/2}, ${f/2} )`),o.attr("transform",`translate(${-i.width/2-m-(i.x-(i.left??0))}, ${-i.height/2-(i.y-(i.top??0))})`),g(e,w),e.intersect=function(t){const a=j.rect(e,t),n=a.y-(e.y??0);if(0!=u&&(Math.abs(n)<(e.height??0)/2||Math.abs(n)==(e.height??0)/2&&Math.abs(a.x-(e.x??0))>(e.width??0)/2-m)){let s=m*m*(1-n*n/(u*u));0!=s&&(s=Math.sqrt(Math.abs(s))),s=m-s,t.x-(e.x??0)>0&&(s=-s),a.x+=s}return a},l}async function ae(t,e){const{labelStyles:a,nodeStyles:n}=(0,s.GX)(e);e.labelStyle=a;const{shapeSvg:l,bbox:r}=await d(t,e,p(e)),i=r.width+e.padding,o=r.height+e.padding,c=[{x:-3*o/6,y:0},{x:i+3*o/6,y:0},{x:i,y:-o},{x:0,y:-o}];let y;const{cssStyles:u}=e;if("handDrawn"===e.look){const t=h.A.svg(l),a=(0,s.Fr)(e,{}),n=f(c),r=t.path(n,a);y=l.insert(()=>r,":first-child").attr("transform",`translate(${-i/2}, ${o/2})`),u&&y.attr("style",u)}else y=q(l,i,o,c);return n&&y.attr("style",n),e.width=i,e.height=o,g(e,y),e.intersect=function(t){return j.polygon(e,c,t)},l}async function ne(t,e){const{labelStyles:a,nodeStyles:n}=(0,s.GX)(e);e.labelStyle=a;const{shapeSvg:l,bbox:r}=await d(t,e,p(e)),i=Math.max(60,r.width+2*(e.padding??0),e?.width??0),o=Math.max(20,r.height+2*(e.padding??0),e?.height??0),{cssStyles:c}=e,y=h.A.svg(l),u=(0,s.Fr)(e,{});"handDrawn"!==e.look&&(u.roughness=0,u.fillStyle="solid");const m=[{x:-i/2*.8,y:-o/2},{x:i/2*.8,y:-o/2},{x:i/2,y:-o/2*.6},{x:i/2,y:o/2},{x:-i/2,y:o/2},{x:-i/2,y:-o/2*.6}],x=f(m),b=y.path(x,u),w=l.insert(()=>b,":first-child");return w.attr("class","basic label-container"),c&&"handDrawn"!==e.look&&w.selectChildren("path").attr("style",c),n&&"handDrawn"!==e.look&&w.selectChildren("path").attr("style",n),g(e,w),e.intersect=function(t){return j.polygon(e,m,t)},l}async function se(t,e){const{labelStyles:a,nodeStyles:n}=(0,s.GX)(e);e.labelStyle=a;const{shapeSvg:l,bbox:r,label:c}=await d(t,e,p(e)),y=(0,i._3)((0,i.D7)().flowchart?.htmlLabels),u=r.width+(e.padding??0),m=u+r.height,x=u+r.height,b=[{x:0,y:0},{x:x,y:0},{x:x/2,y:-m}],{cssStyles:w}=e,S=h.A.svg(l),$=(0,s.Fr)(e,{});"handDrawn"!==e.look&&($.roughness=0,$.fillStyle="solid");const k=f(b),v=S.path(k,$),M=l.insert(()=>v,":first-child").attr("transform",`translate(${-m/2}, ${m/2})`);return w&&"handDrawn"!==e.look&&M.selectChildren("path").attr("style",w),n&&"handDrawn"!==e.look&&M.selectChildren("path").attr("style",n),e.width=u,e.height=m,g(e,M),c.attr("transform",`translate(${-r.width/2-(r.x-(r.left??0))}, ${m/2-(r.height+(e.padding??0)/(y?2:1)-(r.y-(r.top??0)))})`),e.intersect=function(t){return o.Rm.info("Triangle intersect",e,b,t),j.polygon(e,b,t)},l}async function le(t,e){const{labelStyles:a,nodeStyles:n}=(0,s.GX)(e);e.labelStyle=a;const{shapeSvg:l,bbox:r,label:i}=await d(t,e,p(e)),o=Math.max(r.width+2*(e.padding??0),e?.width??0),c=Math.max(r.height+2*(e.padding??0),e?.height??0),y=c/8,m=c+y,{cssStyles:x}=e,b=70-o,w=b>0?b/2:0,S=h.A.svg(l),$=(0,s.Fr)(e,{});"handDrawn"!==e.look&&($.roughness=0,$.fillStyle="solid");const k=[{x:-o/2-w,y:m/2},...u(-o/2-w,m/2,o/2+w,m/2,y,.8),{x:o/2+w,y:-m/2},{x:-o/2-w,y:-m/2}],v=f(k),M=S.path(v,$),D=l.insert(()=>M,":first-child");return D.attr("class","basic label-container"),x&&"handDrawn"!==e.look&&D.selectAll("path").attr("style",x),n&&"handDrawn"!==e.look&&D.selectAll("path").attr("style",n),D.attr("transform",`translate(0,${-y/2})`),i.attr("transform",`translate(${-o/2+(e.padding??0)-(r.x-(r.left??0))},${-c/2+(e.padding??0)-y-(r.y-(r.top??0))})`),g(e,D),e.intersect=function(t){return j.polygon(e,k,t)},l}async function re(t,e){const{labelStyles:a,nodeStyles:n}=(0,s.GX)(e);e.labelStyle=a;const{shapeSvg:l,bbox:r}=await d(t,e,p(e)),i=Math.max(r.width+2*(e.padding??0),e?.width??0),o=Math.max(r.height+2*(e.padding??0),e?.height??0),c=i/o;let y=i,m=o;y>m*c?m=y/c:y=m*c,y=Math.max(y,100),m=Math.max(m,50);const x=Math.min(.2*m,m/4),b=m+2*x,{cssStyles:w}=e,S=h.A.svg(l),$=(0,s.Fr)(e,{});"handDrawn"!==e.look&&($.roughness=0,$.fillStyle="solid");const k=[{x:-y/2,y:b/2},...u(-y/2,b/2,y/2,b/2,x,1),{x:y/2,y:-b/2},...u(y/2,-b/2,-y/2,-b/2,x,-1)],v=f(k),M=S.path(v,$),D=l.insert(()=>M,":first-child");return D.attr("class","basic label-container"),w&&"handDrawn"!==e.look&&D.selectAll("path").attr("style",w),n&&"handDrawn"!==e.look&&D.selectAll("path").attr("style",n),g(e,D),e.intersect=function(t){return j.polygon(e,k,t)},l}async function ie(t,e){const{labelStyles:a,nodeStyles:n}=(0,s.GX)(e);e.labelStyle=a;const{shapeSvg:l,bbox:r,label:i}=await d(t,e,p(e)),o=Math.max(r.width+2*(e.padding??0),e?.width??0),c=Math.max(r.height+2*(e.padding??0),e?.height??0),y=-o/2,f=-c/2,{cssStyles:u}=e,m=h.A.svg(l),x=(0,s.Fr)(e,{}),b=[{x:y-5,y:f-5},{x:y-5,y:f+c},{x:y+o,y:f+c},{x:y+o,y:f-5}],w=`M${y-5},${f-5} L${y+o},${f-5} L${y+o},${f+c} L${y-5},${f+c} L${y-5},${f-5}\n                M${y-5},${f} L${y+o},${f}\n                M${y},${f-5} L${y},${f+c}`;"handDrawn"!==e.look&&(x.roughness=0,x.fillStyle="solid");const S=m.path(w,x),$=l.insert(()=>S,":first-child");return $.attr("transform","translate(2.5, 2.5)"),$.attr("class","basic label-container"),u&&"handDrawn"!==e.look&&$.selectAll("path").attr("style",u),n&&"handDrawn"!==e.look&&$.selectAll("path").attr("style",n),i.attr("transform",`translate(${-r.width/2+2.5-(r.x-(r.left??0))}, ${-r.height/2+2.5-(r.y-(r.top??0))})`),g(e,$),e.intersect=function(t){return j.polygon(e,b,t)},l}async function oe(t,e){const a=e;if(a.alias&&(e.label=a.alias),"handDrawn"===e.look){const{themeVariables:a}=(0,i.zj)(),{background:n}=a,s={...e,id:e.id+"-background",look:"default",cssStyles:["stroke: none",`fill: ${n}`]};await oe(t,s)}const n=(0,i.zj)();e.useHtmlLabels=n.htmlLabels;let l=n.er?.diagramPadding??10,o=n.er?.entityPadding??6;const{cssStyles:d}=e,{labelStyles:y,nodeStyles:f}=(0,s.GX)(e);if(0===a.attributes.length&&e.label){const a={rx:0,ry:0,labelPaddingX:l,labelPaddingY:1.5*l,classes:""};(0,r.Un)(e.label,n)+2*a.labelPaddingX<n.er.minEntityWidth&&(e.width=n.er.minEntityWidth);const s=await $t(t,e,a);if(!(0,i._3)(n.htmlLabels)){const t=s.select("text"),e=t.node()?.getBBox();t.attr("transform",`translate(${-e.width/2}, 0)`)}return s}n.htmlLabels||(l*=1.25,o*=1.25);let u=p(e);u||(u="node default");const m=t.insert("g").attr("class",u).attr("id",e.domId||e.id),x=await ce(m,e.label??"",n,0,0,["name"],y);x.height+=o;let b=0;const w=[],S=[];let $=0,k=0,v=0,M=0,D=!0,A=!0;for(const s of a.attributes){const t=await ce(m,s.type,n,0,b,["attribute-type"],y);$=Math.max($,t.width+l);const e=await ce(m,s.name,n,0,b,["attribute-name"],y);k=Math.max(k,e.width+l);const a=await ce(m,s.keys.join(),n,0,b,["attribute-keys"],y);v=Math.max(v,a.width+l);const r=await ce(m,s.comment,n,0,b,["attribute-comment"],y);M=Math.max(M,r.width+l);const i=Math.max(t.height,e.height,a.height,r.height)+o;S.push({yOffset:b,rowHeight:i}),b+=i}let B=4;v<=l&&(D=!1,v=0,B--),M<=l&&(A=!1,M=0,B--);const C=m.node().getBBox();if(x.width+2*l-($+k+v+M)>0){const t=x.width+2*l-($+k+v+M);$+=t/B,k+=t/B,v>0&&(v+=t/B),M>0&&(M+=t/B)}const K=$+k+v+M,N=h.A.svg(m),L=(0,s.Fr)(e,{});"handDrawn"!==e.look&&(L.roughness=0,L.fillStyle="solid");let R=0;S.length>0&&(R=S.reduce((t,e)=>t+(e?.rowHeight??0),0));const P=Math.max(C.width+2*l,e?.width||0,K),F=Math.max((R??0)+x.height,e?.height||0),X=-P/2,G=-F/2;m.selectAll("g:not(:first-child)").each((t,e,a)=>{const n=(0,c.Ltv)(a[e]),s=n.attr("transform");let r=0,i=0;if(s){const t=RegExp(/translate\(([^,]+),([^)]+)\)/).exec(s);t&&(r=parseFloat(t[1]),i=parseFloat(t[2]),n.attr("class").includes("attribute-name")?r+=$:n.attr("class").includes("attribute-keys")?r+=$+k:n.attr("class").includes("attribute-comment")&&(r+=$+k+v))}n.attr("transform",`translate(${X+l/2+r}, ${i+G+x.height+o/2})`)}),m.select(".name").attr("transform","translate("+-x.width/2+", "+(G+o/2)+")");const I=N.rectangle(X,G,P,F,L),T=m.insert(()=>I,":first-child").attr("style",d.join("")),{themeVariables:W}=(0,i.zj)(),{rowEven:H,rowOdd:_,nodeBorder:E}=W;w.push(0);for(const[s,r]of S.entries()){const t=(s+1)%2==0&&0!==r.yOffset,e=N.rectangle(X,x.height+G+r?.yOffset,P,r?.rowHeight,{...L,fill:t?H:_,stroke:E});m.insert(()=>e,"g.label").attr("style",d.join("")).attr("class","row-rect-"+(t?"even":"odd"))}let q=N.line(X,x.height+G,P+X,x.height+G,L);m.insert(()=>q).attr("class","divider"),q=N.line($+X,x.height+G,$+X,F+G,L),m.insert(()=>q).attr("class","divider"),D&&(q=N.line($+k+X,x.height+G,$+k+X,F+G,L),m.insert(()=>q).attr("class","divider")),A&&(q=N.line($+k+v+X,x.height+G,$+k+v+X,F+G,L),m.insert(()=>q).attr("class","divider"));for(const s of w)q=N.line(X,x.height+G+s,P+X,x.height+G+s,L),m.insert(()=>q).attr("class","divider");if(g(e,T),f&&"handDrawn"!==e.look){const t=f.split(";"),e=t?.filter(t=>t.includes("stroke"))?.map(t=>`${t}`).join("; ");m.selectAll("path").attr("style",e??""),m.selectAll(".row-rect-even path").attr("style",f)}return e.intersect=function(t){return j.rect(e,t)},m}async function ce(t,e,a,n=0,s=0,o=[],h=""){const d=t.insert("g").attr("class",`label ${o.join(" ")}`).attr("transform",`translate(${n}, ${s})`).attr("style",h);e!==(0,i.QO)(e)&&(e=(e=(0,i.QO)(e)).replaceAll("<","&lt;").replaceAll(">","&gt;"));const y=d.node().appendChild(await(0,l.GZ)(d,e,{width:(0,r.Un)(e,a)+100,style:h,useHtmlLabels:a.htmlLabels},a));if(e.includes("&lt;")||e.includes("&gt;")){let t=y.children[0];for(t.textContent=t.textContent.replaceAll("&lt;","<").replaceAll("&gt;",">");t.childNodes[0];)t=t.childNodes[0],t.textContent=t.textContent.replaceAll("&lt;","<").replaceAll("&gt;",">")}let g=y.getBBox();if((0,i._3)(a.htmlLabels)){const t=y.children[0];t.style.textAlign="start";const e=(0,c.Ltv)(y);g=t.getBoundingClientRect(),e.attr("width",g.width),e.attr("height",g.height)}return g}async function he(t,e,a,n,s=a.class.padding??12){const l=n?0:3,r=t.insert("g").attr("class",p(e)).attr("id",e.domId||e.id);let i=null,o=null,c=null,h=null,d=0,y=0,g=0;if(i=r.insert("g").attr("class","annotation-group text"),e.annotations.length>0){const t=e.annotations[0];await de(i,{text:`${t}`},0);d=i.node().getBBox().height}o=r.insert("g").attr("class","label-group text"),await de(o,e,0,["font-weight: bolder"]);const f=o.node().getBBox();y=f.height,c=r.insert("g").attr("class","members-group text");let u=0;for(const p of e.members){u+=await de(c,p,u,[p.parseClassifier()])+l}g=c.node().getBBox().height,g<=0&&(g=s/2),h=r.insert("g").attr("class","methods-group text");let m=0;for(const p of e.methods){m+=await de(h,p,m,[p.parseClassifier()])+l}let x=r.node().getBBox();if(null!==i){const t=i.node().getBBox();i.attr("transform",`translate(${-t.width/2})`)}return o.attr("transform",`translate(${-f.width/2}, ${d})`),x=r.node().getBBox(),c.attr("transform",`translate(0, ${d+y+2*s})`),x=r.node().getBBox(),h.attr("transform",`translate(0, ${d+y+(g?g+4*s:2*s)})`),x=r.node().getBBox(),{shapeSvg:r,bbox:x}}async function de(t,e,a,n=[]){const s=t.insert("g").attr("class","label").attr("style",n.join("; ")),h=(0,i.zj)();let d="useHtmlLabels"in e?e.useHtmlLabels:(0,i._3)(h.htmlLabels)??!0,y="";y="text"in e?e.text:e.label,!d&&y.startsWith("\\")&&(y=y.substring(1)),(0,i.Wi)(y)&&(d=!0);const g=await(0,l.GZ)(s,(0,i.oB)((0,r.Sm)(y)),{width:(0,r.Un)(y,h)+50,classes:"markdown-node-label",useHtmlLabels:d},h);let p,f=1;if(d){const t=g.children[0],e=(0,c.Ltv)(g);f=t.innerHTML.split("<br>").length,t.innerHTML.includes("</math>")&&(f+=t.innerHTML.split("<mrow>").length-1);const a=t.getElementsByTagName("img");if(a){const t=""===y.replace(/<img[^>]*>/g,"").trim();await Promise.all([...a].map(e=>new Promise(a=>{function n(){if(e.style.display="flex",e.style.flexDirection="column",t){const t=h.fontSize?.toString()??window.getComputedStyle(document.body).fontSize,a=5,n=parseInt(t,10)*a+"px";e.style.minWidth=n,e.style.maxWidth=n}else e.style.width="100%";a(e)}(0,o.K2)(n,"setupImage"),setTimeout(()=>{e.complete&&n()}),e.addEventListener("error",n),e.addEventListener("load",n)})))}p=t.getBoundingClientRect(),e.attr("width",p.width),e.attr("height",p.height)}else{n.includes("font-weight: bolder")&&(0,c.Ltv)(g).selectAll("tspan").attr("font-weight",""),f=g.children.length;const t=g.children[0];if(""===g.textContent||g.textContent.includes("&gt")){t.textContent=y[0]+y.substring(1).replaceAll("&gt;",">").replaceAll("&lt;","<").trim();" "===y[1]&&(t.textContent=t.textContent[0]+" "+t.textContent.substring(1))}"undefined"===t.textContent&&(t.textContent=""),p=g.getBBox()}return s.attr("transform","translate(0,"+(-p.height/(2*f)+a)+")"),p.height}async function ye(t,e){const a=(0,i.D7)(),n=a.class.padding??12,l=n,r=e.useHtmlLabels??(0,i._3)(a.htmlLabels)??!0,o=e;o.annotations=o.annotations??[],o.members=o.members??[],o.methods=o.methods??[];const{shapeSvg:d,bbox:y}=await he(t,e,a,r,l),{labelStyles:p,nodeStyles:f}=(0,s.GX)(e);e.labelStyle=p,e.cssStyles=o.styles||"";const u=o.styles?.join(";")||f||"";e.cssStyles||(e.cssStyles=u.replaceAll("!important","").split(";"));const m=0===o.members.length&&0===o.methods.length&&!a.class?.hideEmptyMembersBox,x=h.A.svg(d),b=(0,s.Fr)(e,{});"handDrawn"!==e.look&&(b.roughness=0,b.fillStyle="solid");const w=y.width;let S=y.height;0===o.members.length&&0===o.methods.length?S+=l:o.members.length>0&&0===o.methods.length&&(S+=2*l);const $=-w/2,k=-S/2,v=x.rectangle($-n,k-n-(m?n:0===o.members.length&&0===o.methods.length?-n/2:0),w+2*n,S+2*n+(m?2*n:0===o.members.length&&0===o.methods.length?-n:0),b),M=d.insert(()=>v,":first-child");M.attr("class","basic label-container");const D=M.node().getBBox();d.selectAll(".text").each((t,e,a)=>{const s=(0,c.Ltv)(a[e]),l=s.attr("transform");let i=0;if(l){const t=RegExp(/translate\(([^,]+),([^)]+)\)/).exec(l);t&&(i=parseFloat(t[2]))}let h=i+k+n-(m?n:0===o.members.length&&0===o.methods.length?-n/2:0);r||(h-=4);let y=$;(s.attr("class").includes("label-group")||s.attr("class").includes("annotation-group"))&&(y=-s.node()?.getBBox().width/2||0,d.selectAll("text").each(function(t,e,a){"middle"===window.getComputedStyle(a[e]).textAnchor&&(y=0)})),s.attr("transform",`translate(${y}, ${h})`)});const A=d.select(".annotation-group").node().getBBox().height-(m?n/2:0)||0,B=d.select(".label-group").node().getBBox().height-(m?n/2:0)||0,C=d.select(".members-group").node().getBBox().height-(m?n/2:0)||0;if(o.members.length>0||o.methods.length>0||m){const t=x.line(D.x,A+B+k+n,D.x+D.width,A+B+k+n,b);d.insert(()=>t).attr("class","divider").attr("style",u)}if(m||o.members.length>0||o.methods.length>0){const t=x.line(D.x,A+B+C+k+2*l+n,D.x+D.width,A+B+C+k+n+2*l,b);d.insert(()=>t).attr("class","divider").attr("style",u)}if("handDrawn"!==o.look&&d.selectAll("path").attr("style",u),M.select(":nth-child(2)").attr("style",u),d.selectAll(".divider").select("path").attr("style",u),e.labelStyle?d.selectAll("span").attr("style",e.labelStyle):d.selectAll("span").attr("style",u),!r){const t=RegExp(/color\s*:\s*([^;]*)/),e=t.exec(u);if(e){const t=e[0].replace("color","fill");d.selectAll("tspan").attr("style",t)}else if(p){const e=t.exec(p);if(e){const t=e[0].replace("color","fill");d.selectAll("tspan").attr("style",t)}}}return g(e,M),e.intersect=function(t){return j.rect(e,t)},d}async function ge(t,e){const{labelStyles:a,nodeStyles:n}=(0,s.GX)(e);e.labelStyle=a;const l=e,r=e,i="verifyMethod"in e,o=p(e),d=t.insert("g").attr("class",o).attr("id",e.domId??e.id);let y;y=i?await pe(d,`&lt;&lt;${l.type}&gt;&gt;`,0,e.labelStyle):await pe(d,"&lt;&lt;Element&gt;&gt;",0,e.labelStyle);let f=y;const u=await pe(d,l.name,f,e.labelStyle+"; font-weight: bold;");if(f+=u+20,i){f+=await pe(d,""+(l.requirementId?`ID: ${l.requirementId}`:""),f,e.labelStyle);f+=await pe(d,""+(l.text?`Text: ${l.text}`:""),f,e.labelStyle);f+=await pe(d,""+(l.risk?`Risk: ${l.risk}`:""),f,e.labelStyle),await pe(d,""+(l.verifyMethod?`Verification: ${l.verifyMethod}`:""),f,e.labelStyle)}else{f+=await pe(d,""+(r.type?`Type: ${r.type}`:""),f,e.labelStyle),await pe(d,""+(r.docRef?`Doc Ref: ${r.docRef}`:""),f,e.labelStyle)}const m=(d.node()?.getBBox().width??200)+20,x=(d.node()?.getBBox().height??200)+20,b=-m/2,w=-x/2,S=h.A.svg(d),$=(0,s.Fr)(e,{});"handDrawn"!==e.look&&($.roughness=0,$.fillStyle="solid");const k=S.rectangle(b,w,m,x,$),v=d.insert(()=>k,":first-child");if(v.attr("class","basic label-container").attr("style",n),d.selectAll(".label").each((t,e,a)=>{const n=(0,c.Ltv)(a[e]),s=n.attr("transform");let l=0,r=0;if(s){const t=RegExp(/translate\(([^,]+),([^)]+)\)/).exec(s);t&&(l=parseFloat(t[1]),r=parseFloat(t[2]))}const i=r-x/2;let o=b+10;0!==e&&1!==e||(o=l),n.attr("transform",`translate(${o}, ${i+20})`)}),f>y+u+20){const t=S.line(b,w+y+u+20,b+m,w+y+u+20,$);d.insert(()=>t).attr("style",n)}return g(e,v),e.intersect=function(t){return j.rect(e,t)},d}async function pe(t,e,a,n=""){if(""===e)return 0;const s=t.insert("g").attr("class","label").attr("style",n),o=(0,i.D7)(),h=o.htmlLabels??!0,d=await(0,l.GZ)(s,(0,i.oB)((0,r.Sm)(e)),{width:(0,r.Un)(e,o)+50,classes:"markdown-node-label",useHtmlLabels:h,style:n},o);let y;if(h){const t=d.children[0],e=(0,c.Ltv)(d);y=t.getBoundingClientRect(),e.attr("width",y.width),e.attr("height",y.height)}else{const t=d.children[0];for(const e of t.children)e.textContent=e.textContent.replaceAll("&gt;",">").replaceAll("&lt;","<"),n&&e.setAttribute("style",n);y=d.getBBox(),y.height+=6}return s.attr("transform",`translate(${-y.width/2},${-y.height/2+a})`),y.height}(0,o.K2)(ee,"tiltedCylinder"),(0,o.K2)(ae,"trapezoid"),(0,o.K2)(ne,"trapezoidalPentagon"),(0,o.K2)(se,"triangle"),(0,o.K2)(le,"waveEdgedRectangle"),(0,o.K2)(re,"waveRectangle"),(0,o.K2)(ie,"windowPane"),(0,o.K2)(oe,"erBox"),(0,o.K2)(ce,"addText"),(0,o.K2)(he,"textHelper"),(0,o.K2)(de,"addText"),(0,o.K2)(ye,"classBox"),(0,o.K2)(ge,"requirementBox"),(0,o.K2)(pe,"addText");var fe=(0,o.K2)(t=>{switch(t){case"Very High":return"red";case"High":return"orange";case"Medium":return null;case"Low":return"blue";case"Very Low":return"lightblue"}},"colorFromPriority");async function ue(t,e,{config:a}){const{labelStyles:n,nodeStyles:l}=(0,s.GX)(e);e.labelStyle=n||"";const r=e.width;e.width=(e.width??200)-10;const{shapeSvg:i,bbox:o,label:c}=await d(t,e,p(e)),f=e.padding||10;let u,m="";"ticket"in e&&e.ticket&&a?.kanban?.ticketBaseUrl&&(m=a?.kanban?.ticketBaseUrl.replace("#TICKET#",e.ticket),u=i.insert("svg:a",":first-child").attr("class","kanban-ticket-link").attr("xlink:href",m).attr("target","_blank"));const x={useHtmlLabels:e.useHtmlLabels,labelStyle:e.labelStyle||"",width:e.width,img:e.img,padding:e.padding||8,centerLabel:!1};let b,w;({label:b,bbox:w}=u?await y(u,"ticket"in e&&e.ticket||"",x):await y(i,"ticket"in e&&e.ticket||"",x));const{label:S,bbox:k}=await y(i,"assigned"in e&&e.assigned||"",x);e.width=r;const v=e?.width||0,M=Math.max(w.height,k.height)/2,D=Math.max(o.height+20,e?.height||0)+M,A=-v/2,B=-D/2;let C;c.attr("transform","translate("+(f-v/2)+", "+(-M-o.height/2)+")"),b.attr("transform","translate("+(f-v/2)+", "+(-M+o.height/2)+")"),S.attr("transform","translate("+(f+v/2-k.width-20)+", "+(-M+o.height/2)+")");const{rx:K,ry:N}=e,{cssStyles:L}=e;if("handDrawn"===e.look){const t=h.A.svg(i),a=(0,s.Fr)(e,{}),n=K||N?t.path($(A,B,v,D,K||0),a):t.rectangle(A,B,v,D,a);C=i.insert(()=>n,":first-child"),C.attr("class","basic label-container").attr("style",L||null)}else{C=i.insert("rect",":first-child"),C.attr("class","basic label-container __APA__").attr("style",l).attr("rx",K??5).attr("ry",N??5).attr("x",A).attr("y",B).attr("width",v).attr("height",D);const t="priority"in e&&e.priority;if(t){const e=i.append("line"),a=A+2,n=B+Math.floor((K??0)/2),s=B+D-Math.floor((K??0)/2);e.attr("x1",a).attr("y1",n).attr("x2",a).attr("y2",s).attr("stroke-width","4").attr("stroke",fe(t))}}return g(e,C),e.height=D,e.intersect=function(t){return j.rect(e,t)},i}async function me(t,e){const{labelStyles:a,nodeStyles:n}=(0,s.GX)(e);e.labelStyle=a;const{shapeSvg:l,bbox:i,halfPadding:c,label:y}=await d(t,e,p(e)),f=i.width+10*c,u=i.height+8*c,m=.15*f,{cssStyles:x}=e,b=i.width+20,w=i.height+20,S=Math.max(f,b),$=Math.max(u,w);let k;y.attr("transform",`translate(${-i.width/2}, ${-i.height/2})`);const v=`M0 0 \n    a${m},${m} 1 0,0 ${.25*S},${-1*$*.1}\n    a${m},${m} 1 0,0 ${.25*S},0\n    a${m},${m} 1 0,0 ${.25*S},0\n    a${m},${m} 1 0,0 ${.25*S},${.1*$}\n\n    a${m},${m} 1 0,0 ${.15*S},${.33*$}\n    a${.8*m},${.8*m} 1 0,0 0,${.34*$}\n    a${m},${m} 1 0,0 ${-1*S*.15},${.33*$}\n\n    a${m},${m} 1 0,0 ${-1*S*.25},${.15*$}\n    a${m},${m} 1 0,0 ${-1*S*.25},0\n    a${m},${m} 1 0,0 ${-1*S*.25},0\n    a${m},${m} 1 0,0 ${-1*S*.25},${-1*$*.15}\n\n    a${m},${m} 1 0,0 ${-1*S*.1},${-1*$*.33}\n    a${.8*m},${.8*m} 1 0,0 0,${-1*$*.34}\n    a${m},${m} 1 0,0 ${.1*S},${-1*$*.33}\n  H0 V0 Z`;if("handDrawn"===e.look){const t=h.A.svg(l),a=(0,s.Fr)(e,{}),n=t.path(v,a);k=l.insert(()=>n,":first-child"),k.attr("class","basic label-container").attr("style",(0,r.KL)(x))}else k=l.insert("path",":first-child").attr("class","basic label-container").attr("style",n).attr("d",v);return k.attr("transform",`translate(${-S/2}, ${-$/2})`),g(e,k),e.calcIntersect=function(t,e){return j.rect(t,e)},e.intersect=function(t){return o.Rm.info("Bang intersect",e,t),j.rect(e,t)},l}async function xe(t,e){const{labelStyles:a,nodeStyles:n}=(0,s.GX)(e);e.labelStyle=a;const{shapeSvg:l,bbox:i,halfPadding:c,label:y}=await d(t,e,p(e)),f=i.width+2*c,u=i.height+2*c,m=.15*f,x=.25*f,b=.35*f,w=.2*f,{cssStyles:S}=e;let $;const k=`M0 0 \n    a${m},${m} 0 0,1 ${.25*f},${-1*f*.1}\n    a${b},${b} 1 0,1 ${.4*f},${-1*f*.1}\n    a${x},${x} 1 0,1 ${.35*f},${.2*f}\n\n    a${m},${m} 1 0,1 ${.15*f},${.35*u}\n    a${w},${w} 1 0,1 ${-1*f*.15},${.65*u}\n\n    a${x},${m} 1 0,1 ${-1*f*.25},${.15*f}\n    a${b},${b} 1 0,1 ${-1*f*.5},0\n    a${m},${m} 1 0,1 ${-1*f*.25},${-1*f*.15}\n\n    a${m},${m} 1 0,1 ${-1*f*.1},${-1*u*.35}\n    a${w},${w} 1 0,1 ${.1*f},${-1*u*.65}\n  H0 V0 Z`;if("handDrawn"===e.look){const t=h.A.svg(l),a=(0,s.Fr)(e,{}),n=t.path(k,a);$=l.insert(()=>n,":first-child"),$.attr("class","basic label-container").attr("style",(0,r.KL)(S))}else $=l.insert("path",":first-child").attr("class","basic label-container").attr("style",n).attr("d",k);return y.attr("transform",`translate(${-i.width/2}, ${-i.height/2})`),$.attr("transform",`translate(${-f/2}, ${-u/2})`),g(e,$),e.calcIntersect=function(t,e){return j.rect(t,e)},e.intersect=function(t){return o.Rm.info("Cloud intersect",e,t),j.rect(e,t)},l}async function be(t,e){const{labelStyles:a,nodeStyles:n}=(0,s.GX)(e);e.labelStyle=a;const{shapeSvg:l,bbox:r,halfPadding:i,label:o}=await d(t,e,p(e)),c=r.width+8*i,h=r.height+2*i,y=`\n    M${-c/2} ${h/2-5}\n    v${10-h}\n    q0,-5 5,-5\n    h${c-10}\n    q5,0 5,5\n    v${h-10}\n    q0,5 -5,5\n    h${10-c}\n    q-5,0 -5,-5\n    Z\n  `,f=l.append("path").attr("id","node-"+e.id).attr("class","node-bkg node-"+e.type).attr("style",n).attr("d",y);return l.append("line").attr("class","node-line-").attr("x1",-c/2).attr("y1",h/2).attr("x2",c/2).attr("y2",h/2),o.attr("transform",`translate(${-r.width/2}, ${-r.height/2})`),l.append(()=>o.node()),g(e,f),e.calcIntersect=function(t,e){return j.rect(t,e)},e.intersect=function(t){return j.rect(e,t)},l}async function we(t,e){return O(t,e,{padding:e.padding??0})}(0,o.K2)(ue,"kanbanItem"),(0,o.K2)(me,"bang"),(0,o.K2)(xe,"cloud"),(0,o.K2)(be,"defaultMindmapNode"),(0,o.K2)(we,"mindmapCircle");var Se=[{semanticName:"Process",name:"Rectangle",shortName:"rect",description:"Standard process shape",aliases:["proc","process","rectangle"],internalAliases:["squareRect"],handler:_t},{semanticName:"Event",name:"Rounded Rectangle",shortName:"rounded",description:"Represents an event",aliases:["event"],internalAliases:["roundedRect"],handler:Wt},{semanticName:"Terminal Point",name:"Stadium",shortName:"stadium",description:"Terminal point",aliases:["terminal","pill"],handler:Et},{semanticName:"Subprocess",name:"Framed Rectangle",shortName:"fr-rect",description:"Subprocess",aliases:["subprocess","subproc","framed-rectangle","subroutine"],handler:Ot},{semanticName:"Database",name:"Cylinder",shortName:"cyl",description:"Database storage",aliases:["db","database","cylinder"],handler:it},{semanticName:"Start",name:"Circle",shortName:"circle",description:"Starting point",aliases:["circ"],handler:O},{semanticName:"Bang",name:"Bang",shortName:"bang",description:"Bang",aliases:["bang"],handler:me},{semanticName:"Cloud",name:"Cloud",shortName:"cloud",description:"cloud",aliases:["cloud"],handler:xe},{semanticName:"Decision",name:"Diamond",shortName:"diam",description:"Decision-making step",aliases:["decision","diamond","question"],handler:Xt},{semanticName:"Prepare Conditional",name:"Hexagon",shortName:"hex",description:"Preparation or condition step",aliases:["hexagon","prepare"],handler:pt},{semanticName:"Data Input/Output",name:"Lean Right",shortName:"lean-r",description:"Represents input or output",aliases:["lean-right","in-out"],internalAliases:["lean_right"],handler:Mt},{semanticName:"Data Input/Output",name:"Lean Left",shortName:"lean-l",description:"Represents output or input",aliases:["lean-left","out-in"],internalAliases:["lean_left"],handler:vt},{semanticName:"Priority Action",name:"Trapezoid Base Bottom",shortName:"trap-b",description:"Priority action",aliases:["priority","trapezoid-bottom","trapezoid"],handler:ae},{semanticName:"Manual Operation",name:"Trapezoid Base Top",shortName:"trap-t",description:"Represents a manual task",aliases:["manual","trapezoid-top","inv-trapezoid"],internalAliases:["inv_trapezoid"],handler:St},{semanticName:"Stop",name:"Double Circle",shortName:"dbl-circ",description:"Represents a stop point",aliases:["double-circle"],internalAliases:["doublecircle"],handler:ct},{semanticName:"Text Block",name:"Text Block",shortName:"text",description:"Text block",handler:Ut},{semanticName:"Card",name:"Notched Rectangle",shortName:"notch-rect",description:"Represents a card",aliases:["card","notched-rectangle"],handler:z},{semanticName:"Lined/Shaded Process",name:"Lined Rectangle",shortName:"lin-rect",description:"Lined process shape",aliases:["lined-rectangle","lined-process","lin-proc","shaded-process"],handler:jt},{semanticName:"Start",name:"Small Circle",shortName:"sm-circ",description:"Small starting point",aliases:["start","small-circle"],internalAliases:["stateStart"],handler:Vt},{semanticName:"Stop",name:"Framed Circle",shortName:"fr-circ",description:"Stop point",aliases:["stop","framed-circle"],internalAliases:["stateEnd"],handler:zt},{semanticName:"Fork/Join",name:"Filled Rectangle",shortName:"fork",description:"Fork or join in process flow",aliases:["join"],internalAliases:["forkJoin"],handler:yt},{semanticName:"Collate",name:"Hourglass",shortName:"hourglass",description:"Represents a collate operation",aliases:["hourglass","collate"],handler:ft},{semanticName:"Comment",name:"Curly Brace",shortName:"brace",description:"Adds a comment",aliases:["comment","brace-l"],handler:J},{semanticName:"Comment Right",name:"Curly Brace",shortName:"brace-r",description:"Adds a comment",handler:tt},{semanticName:"Comment with braces on both sides",name:"Curly Braces",shortName:"braces",description:"Adds a comment",handler:at},{semanticName:"Com Link",name:"Lightning Bolt",shortName:"bolt",description:"Communication link",aliases:["com-link","lightning-bolt"],handler:Dt},{semanticName:"Document",name:"Document",shortName:"doc",description:"Represents a document",aliases:["doc","document"],handler:le},{semanticName:"Delay",name:"Half-Rounded Rectangle",shortName:"delay",description:"Represents a delay",aliases:["half-rounded-rectangle"],handler:gt},{semanticName:"Direct Access Storage",name:"Horizontal Cylinder",shortName:"h-cyl",description:"Direct access storage",aliases:["das","horizontal-cylinder"],handler:ee},{semanticName:"Disk Storage",name:"Lined Cylinder",shortName:"lin-cyl",description:"Disk storage",aliases:["disk","lined-cylinder"],handler:Kt},{semanticName:"Display",name:"Curved Trapezoid",shortName:"curv-trap",description:"Represents a display",aliases:["curved-trapezoid","display"],handler:nt},{semanticName:"Divided Process",name:"Divided Rectangle",shortName:"div-rect",description:"Divided process shape",aliases:["div-proc","divided-rectangle","divided-process"],handler:ot},{semanticName:"Extract",name:"Triangle",shortName:"tri",description:"Extraction process",aliases:["extract","triangle"],handler:se},{semanticName:"Internal Storage",name:"Window Pane",shortName:"win-pane",description:"Internal storage",aliases:["internal-storage","window-pane"],handler:ie},{semanticName:"Junction",name:"Filled Circle",shortName:"f-circ",description:"Junction point",aliases:["junction","filled-circle"],handler:ht},{semanticName:"Loop Limit",name:"Trapezoidal Pentagon",shortName:"notch-pent",description:"Loop limit step",aliases:["loop-limit","notched-pentagon"],handler:ne},{semanticName:"Manual File",name:"Flipped Triangle",shortName:"flip-tri",description:"Manual file operation",aliases:["manual-file","flipped-triangle"],handler:dt},{semanticName:"Manual Input",name:"Sloped Rectangle",shortName:"sl-rect",description:"Manual input step",aliases:["manual-input","sloped-rectangle"],handler:Ht},{semanticName:"Multi-Document",name:"Stacked Document",shortName:"docs",description:"Multiple documents",aliases:["documents","st-doc","stacked-document"],handler:Rt},{semanticName:"Multi-Process",name:"Stacked Rectangle",shortName:"st-rect",description:"Multiple processes",aliases:["procs","processes","stacked-rectangle"],handler:Lt},{semanticName:"Stored Data",name:"Bow Tie Rectangle",shortName:"bow-rect",description:"Stored data",aliases:["stored-data","bow-tie-rectangle"],handler:E},{semanticName:"Summary",name:"Crossed Circle",shortName:"cross-circ",description:"Summary",aliases:["summary","crossed-circle"],handler:Y},{semanticName:"Tagged Document",name:"Tagged Document",shortName:"tag-doc",description:"Tagged document",aliases:["tag-doc","tagged-document"],handler:Yt},{semanticName:"Tagged Process",name:"Tagged Rectangle",shortName:"tag-rect",description:"Tagged process",aliases:["tagged-rectangle","tag-proc","tagged-process"],handler:Zt},{semanticName:"Paper Tape",name:"Flag",shortName:"flag",description:"Paper tape",aliases:["paper-tape"],handler:re},{semanticName:"Odd",name:"Odd",shortName:"odd",description:"Odd shape",internalAliases:["rect_left_inv_arrow"],handler:Gt},{semanticName:"Lined Document",name:"Lined Document",shortName:"lin-doc",description:"Lined document",aliases:["lined-document"],handler:Nt}],$e=(0,o.K2)(()=>{const t={state:qt,choice:V,note:Pt,rectWithTitle:It,labelRect:kt,iconSquare:bt,iconCircle:mt,icon:ut,iconRounded:xt,imageSquare:wt,anchor:H,kanbanItem:ue,mindmapCircle:we,defaultMindmapNode:be,classBox:ye,erBox:oe,requirementBox:ge},e=[...Object.entries(t),...Se.flatMap(t=>[t.shortName,..."aliases"in t?t.aliases:[],..."internalAliases"in t?t.internalAliases:[]].map(e=>[e,t.handler]))];return Object.fromEntries(e)},"generateShapeMap")();function ke(t){return t in $e}(0,o.K2)(ke,"isValidShape");var ve=new Map;async function Me(t,e,a){let n,s;"rect"===e.shape&&(e.rx&&e.ry?e.shape="roundedRect":e.shape="squareRect");const l=e.shape?$e[e.shape]:void 0;if(!l)throw new Error(`No such shape: ${e.shape}. Please check your syntax.`);if(e.link){let r;"sandbox"===a.config.securityLevel?r="_top":e.linkTarget&&(r=e.linkTarget||"_blank"),n=t.insert("svg:a").attr("xlink:href",e.link).attr("target",r??null),s=await l(n,e,a)}else s=await l(t,e,a),n=s;return e.tooltip&&s.attr("title",e.tooltip),ve.set(e.id,n),e.haveCallback&&n.attr("class",n.attr("class")+" clickable"),n}(0,o.K2)(Me,"insertNode");var De=(0,o.K2)((t,e)=>{ve.set(e.id,t)},"setNodeElem"),Ae=(0,o.K2)(()=>{ve.clear()},"clear"),Be=(0,o.K2)(t=>{const e=ve.get(t.id);o.Rm.trace("Transforming node",t.diff,t,"translate("+(t.x-t.width/2-5)+", "+t.width/2+")");const a=t.diff||0;return t.clusterNode?e.attr("transform","translate("+(t.x+a-t.width/2)+", "+(t.y-t.height/2-8)+")"):e.attr("transform","translate("+t.x+", "+t.y+")"),a},"positionNode")}}]);
//# sourceMappingURL=59f1f492-185a8a032b533b7d2b1e.js.map