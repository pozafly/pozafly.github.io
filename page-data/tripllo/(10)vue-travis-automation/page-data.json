{"componentChunkName":"component---src-templates-post-tsx","path":"/tripllo/(10)vue-travis-automation/","result":{"data":{"markdownRemark":{"html":"<p>Travis CI에 대해서 알아보자. 우선 <a href=\"https://docs.travis-ci.com/\" target=\"_blank\" rel=\"nofollow\">Travis 공식</a> Docs를 보고 따라 해봤다. 참고 자료는 이동욱 님의 스프링 부트와 AWS로 혼자 구현하는 웹 서비스 책을 참고했다.</p>\n<p>우선 travis endpoint에 대해 알아야 한다.</p>\n<ul>\n<li>travis 엔드 포인트 —pro\n<ul>\n<li>API 엔드 포인트 : <a href=\"https://api.travis-ci.com/\" target=\"_blank\" rel=\"nofollow\">https://api.travis-ci.com/</a></li>\n</ul>\n</li>\n<li>travis 엔드 포인트\n<ul>\n<li>API 엔드 포인트 : <a href=\"https://api.travis-ci.org/\" target=\"_blank\" rel=\"nofollow\">https://api.travis-ci.org/</a></li>\n</ul>\n</li>\n</ul>\n<p>차이점은, <code class=\"language-text\">--pro</code> 가 붙은 녀석은 <code class=\"language-text\">.com</code> 으로 연결되고, —pro 옵션이 없는 엔드포인트는 <code class=\"language-text\">.org</code> 로 연결된다는 것임.</p>\n<p>endpoint를 잘 설정해 주어야지 오류가 나지 않는다. springboot를 travis로 빌드 자동화를 했을 때도 겪었었지만, .org 엔드 포인트는 오류가 많고 잘되지 않는 경우가 많다. 버전 차이인듯싶다. 어쨌든 우리는 앞으로 <code class=\"language-text\">.com</code> 인 <code class=\"language-text\">--pro</code> 를 붙여 엔드포인트를 설정해줄 것이다.</p>\n<br/>\n<h2 id=\"Github-repository-연동\" style=\"position:relative;\">Github repository 연동<a href=\"#Github-repository-%EC%97%B0%EB%8F%99\" aria-label=\"Github repository 연동 permalink\" class=\"auto-link after\"><svg viewBox=\"0 0 16 16\" width=\"16\" height=\"16\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a></h2>\n<p><a href=\"https://travis-ci.com/\" target=\"_blank\" rel=\"nofollow\">https://travis-ci.com/</a> 이곳에 먼저 들어가서 github ID로 로그인을 해주자. 우측 상단에 내 아이콘을 선택하고 Setting -> Repositories에 가면 무슨 프로젝트를 설정할 것인지 페이지가 나온다. 여기서 어떤 프로젝트를 CI 할 것인지 설정해 줄 수 있다. Manage repositories on GitHub 을 클릭하고, github 페이지에 들어가면,</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 764px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 45.4%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAAsTAAALEwEAmpwYAAABNUlEQVR42pWR3VLCMBBG+yhIf5M2m6YNBdoCUhAUxisVff8X+dwUnAEGR7w4s7ttcrKz65lqjqbbo2qfYOsO08UWqZlgEGYYxvRvvFAWSLWFVAZxVkIoi1Aa+AkhEBpBciTiPJKn+JNf1e6858cZdFGinMywaBQema4lzjXmNaGb6T43RsHk6jJefXNSz+fXpdLIyICIGAXFkOLIuJo0Ic3+JhQnoaBRPz9br5DQGMPEIEwtAlkyBQYR4eEOnMvzRY5YjSDzMcsqCF1xzTLhZmoR8VzvXchRmOQoubP17g0rZvN6wHr/DrINBkHKL/O2I3WG2776XeguCD1Fu/nA7PmA+csnFrsvFO0OAdUIdYOQztCzvvtb0l7ofkR8SVYbxMUSiaPs+lxwvGTJ57Y8Bsud3xZ+A5/wFGbH2oViAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"travis-repo-register\"\n        title=\"\"\n        src=\"/static/676786a962ff7a95a82ec594a8d7f868/2cbcd/travis-repo-register.png\"\n        srcset=\"/static/676786a962ff7a95a82ec594a8d7f868/0eb09/travis-repo-register.png 500w,\n/static/676786a962ff7a95a82ec594a8d7f868/2cbcd/travis-repo-register.png 764w\"\n        sizes=\"(max-width: 764px) 100vw, 764px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>이곳에서 자신의 프로젝트를 선택해서 연동시킬 수 있다.</p>\n<br/>\n<h2 id=\"travisyml\" style=\"position:relative;\">.travis.yml<a href=\"#travisyml\" aria-label=\"travisyml permalink\" class=\"auto-link after\"><svg viewBox=\"0 0 16 16\" width=\"16\" height=\"16\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a></h2>\n<p>후에, 자신의 프로젝트에 .travis.yml 파일을 만들자.</p>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token key atrule\">language</span><span class=\"token punctuation\">:</span> node_js\n<span class=\"token key atrule\">node_js</span><span class=\"token punctuation\">:</span>\n  <span class=\"token punctuation\">-</span> 14.16.0\n<span class=\"token key atrule\">branches</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">only</span><span class=\"token punctuation\">:</span>\n    <span class=\"token punctuation\">-</span> master\n<span class=\"token key atrule\">cache</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">directories</span><span class=\"token punctuation\">:</span>\n    <span class=\"token punctuation\">-</span> node_modules\n<span class=\"token key atrule\">script</span><span class=\"token punctuation\">:</span> npm run build\n<span class=\"token key atrule\">notifications</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">email</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">recipients</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> pozafly@kakao.com</code></pre></div>\n<ul>\n<li>language : vue 프로젝트를 설정할 것이므로, language는 node_js 형태로 빌드 한다.</li>\n<li>node_js : 버전은 자신이 설정한 것 대로 해주면 됨</li>\n<li>branches : master 브랜치에 push 되었을 때 자동으로 돌아가게 해줌.</li>\n<li>cache : 빌드 시, node_modules가 계속 install 될 필요는 없으므로 해당 폴더를 캐시화 시켜주겠다는 말이다.</li>\n<li>script : 빌드 명령어</li>\n<li>notifications : CI가 완료되었을 때 결과를 noti 해준다. 내 메일 주소를 적었다.</li>\n</ul>\n<p>우선 기본 틀이다. 이제 이 파일을 작성했다면, master 브랜치에 <code class=\"language-text\">push</code> or <code class=\"language-text\">merge후 push</code> 할 때마다 travis가 알아서 프로젝트를 빌드해줄 것이다. push후 travis 페이지에 가보면 build log가 실시간으로 찍힌다.</p>\n<p>첫 번째 에러가 났다.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">error\nTemplate execution failed: ReferenceError: VUE_APP_GOOGLE_CLIENT_ID is not defined</code></pre></div>\n<p><code class=\"language-text\">VUE_APP_GOOGLE_CLINET_ID</code> 는 .env 파일에 있는데, 이걸 build 하지 못하는 이유는 .env 파일이 github에 올라가지 않아서다. 따라서 .env 파일을 travis 서버에서 인식하도록 할 필요가 있다. 방법은 3가지가 있다. <a href=\"https://docs.travis-ci.com/user/environment-variables/\" target=\"_blank\" rel=\"nofollow\">공식 페이지 환경변수</a> 이곳에 잘 설명되어 있다,</p>\n<table>\n<thead>\n<tr>\n<th align=\"center\">사용방법</th>\n<th align=\"center\">Github 오픈 여부</th>\n<th align=\"center\">암호화</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td align=\"center\">.travis.yml에서 공용 변수 정의</td>\n<td align=\"center\">O</td>\n<td align=\"center\">X</td>\n</tr>\n<tr>\n<td align=\"center\">.travis.yml에서 암호화된 변수 정의</td>\n<td align=\"center\">O</td>\n<td align=\"center\">O</td>\n</tr>\n<tr>\n<td align=\"center\">리포지토리 설정에서 변수 정의</td>\n<td align=\"center\">X</td>\n<td align=\"center\">O</td>\n</tr>\n</tbody>\n</table>\n<p>이렇게 3가지 방법인데, 조금 더 자세히 알아보면,</p>\n<ol>\n<li><code class=\"language-text\">.travis.yml에서 공용 변수 정의</code> : 단순히 yml 파일에 공통 변수로 지정 후 사용한다. 따라서 암호가 Github에도 노출되고, 암호화되어있지 않다.</li>\n<li><code class=\"language-text\">.travis.yml에서 암호화된 변수 정의</code> : 암호화해서 .enc 파일을 프로젝트에 생성한다. 그리고, 이 암호화된 파일이 travis 서버 상에 올라갈 때 복호화 되어 컴파일 된다. 따라서 .enc 파일은 github에도 올라가게 된다.</li>\n<li><code class=\"language-text\">리포지토리 설정에서 변수 정의</code> : 아예 traivs 홈페이지에서 환경 변수를 만들고 값을 넣어주고, yml 파일에 해당 변수를 선언하면 값이 들어가는 형태이다. .enc 파일이 존재하지 않기 때문에 찌꺼기가 남지 않는다.</li>\n</ol>\n<p>나는 두 번째 방법인 .travis.yml 에서 secret 파일 암호화하는 방법을 사용하겠다. .enc 파일이라는 찌꺼기가 생기겠지만 괜찮다. 그리고 세 번째 방법은 AWS 변수를 나중에 넣을 때 사용할 것이다.</p>\n<br/>\n<br/>\n<h2 id=\"evn-파일을-AES256-이용하여-envenc-파일-생성하기\" style=\"position:relative;\">.evn 파일을 AES256 이용하여 .env.enc 파일 생성하기<a href=\"#evn-%ED%8C%8C%EC%9D%BC%EC%9D%84-AES256-%EC%9D%B4%EC%9A%A9%ED%95%98%EC%97%AC-envenc-%ED%8C%8C%EC%9D%BC-%EC%83%9D%EC%84%B1%ED%95%98%EA%B8%B0\" aria-label=\"evn 파일을 AES256 이용하여 envenc 파일 생성하기 permalink\" class=\"auto-link after\"><svg viewBox=\"0 0 16 16\" width=\"16\" height=\"16\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a></h2>\n<h3 id=\"CLC-설치--login\" style=\"position:relative;\">CLC 설치 &#x26; login<a href=\"#CLC-%EC%84%A4%EC%B9%98--login\" aria-label=\"CLC 설치  login permalink\" class=\"auto-link after\"><svg viewBox=\"0 0 16 16\" width=\"16\" height=\"16\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a></h3>\n<p><a href=\"https://sanghye.tistory.com/42\" target=\"_blank\" rel=\"nofollow\">여기</a> 참고하였다. 먼저 로컬 컴퓨터에서 암호화 해 .enc 파일을 생성할 것이기 때문에 travis CLC가 필요하다.</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">$ gem <span class=\"token function\">install</span> travis</code></pre></div>\n<p>만약 권한 오류가 난다면 sudo를 붙여주도록 하자. 이제 travis에 login을 해야 함.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">$ travis login --pro</code></pre></div>\n<p>—com, —org 옵션을 줄 수 있는데, pro를 붙여주자. 아니면 빌드 시 오류 발생. org를 사용하고 있다면 org를 써도 된다. login을 할 때 Not Found 에러가 날 수 있다. <a href=\"https://github.com/pozafly/TIL/blob/main/%F0%9F%A7%A8%E1%84%8B%E1%85%A9%E1%84%85%E1%85%B2%E1%84%8B%E1%85%AA%E1%84%8B%E1%85%B4%20%E1%84%8C%E1%85%A9%E1%84%8B%E1%85%AE/travis/travis%20login%20Not%20Found.md\" target=\"_blank\" rel=\"nofollow\">travis login Not Found 오류 정리</a> 이곳에 정리해 뒀으니, github token으로 로그인해 주자.</p>\n<br/>\n<h3 id=\"endpoint-설정\" style=\"position:relative;\">endpoint 설정<a href=\"#endpoint-%EC%84%A4%EC%A0%95\" aria-label=\"endpoint 설정 permalink\" class=\"auto-link after\"><svg viewBox=\"0 0 16 16\" width=\"16\" height=\"16\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a></h3>\n<p>우리는 pro로 설정했으니 endpoint를 잡아주자. endpoint를 잡아주지 않으면, 암호화를 진행할 때, <code class=\"language-text\">not logged in -try running travis login --org</code> 오류가 뜰 수 있다. <a href=\"https://github.com/travis-ci/travis-ci/issues/9668\" target=\"_blank\" rel=\"nofollow\">github issues</a> 이곳을 참고했다.</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">$ travis endpoint <span class=\"token parameter variable\">--pro</span></code></pre></div>\n<br/>\n<h3 id=\"env-파일-암호화\" style=\"position:relative;\">.env 파일 암호화<a href=\"#env-%ED%8C%8C%EC%9D%BC-%EC%95%94%ED%98%B8%ED%99%94\" aria-label=\"env 파일 암호화 permalink\" class=\"auto-link after\"><svg viewBox=\"0 0 16 16\" width=\"16\" height=\"16\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a></h3>\n<p>이제 암호화를 진행하자.</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">$ travis encrypt-file <span class=\"token parameter variable\">--pro</span> <span class=\"token punctuation\">[</span>파일명<span class=\"token punctuation\">]</span></code></pre></div>\n<p>—pro를 붙여주자. 붙여주지 않으면,</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 754px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 14.2%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAYAAACTWi8uAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAtUlEQVR42j2MUW6DMBBEuUoqRSqNlNjGJjiAqiAnhdooUHP/q7xu+ejH6O3OjKZY15XX8mIRfsfIPM/knMnbxk/eSGnmaxwJj4fciSidKEzSG6eJ+zDQdh0hhD0vtmUhSdB7T9s0dL6hvd3oRH+eM4a6qkQGqzVGKZzQGU1jK7y1/5lSF4rkr0y1I1Sa/nLmU8y7Vvs/GCXSxGu9d56uoldngjU8ZcyUJfXphC7f+TgeeTsc+AWKs2bN0PjGkQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"travis-error-log\"\n        title=\"\"\n        src=\"/static/d63bd3b884b43d05a76c0da6013cdf92/a0d62/travis-error-log.png\"\n        srcset=\"/static/d63bd3b884b43d05a76c0da6013cdf92/0eb09/travis-error-log.png 500w,\n/static/d63bd3b884b43d05a76c0da6013cdf92/a0d62/travis-error-log.png 754w\"\n        sizes=\"(max-width: 754px) 100vw, 754px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>push 후 build 때, <code class=\"language-text\">iv undefined</code> 오류가 계속 뜰 것임.</p>\n<p>그리고 —add 옵션을 붙여주면 .travis.yml 파일에 자동으로 <code class=\"language-text\">before_install</code> 란이 생기도록 할 수 있다. build 때 install 전에 암호화한 파일을 복호화 해서 travis가 알아먹을 수 있도록 해주는 작업이다. 따라서 최종적으로는</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">$ travis encrypt-file <span class=\"token parameter variable\">--pro</span> .env.production <span class=\"token parameter variable\">--add</span></code></pre></div>\n<p>요렇게 해줬다. 그러면 <code class=\"language-text\">DANGER ZONE: Override existing .env.production.enc? |no|</code> 이런 문구가 뜰 것인데, yes 를 입력해 주자. (yes를 입력해 준다는 의미는 .travis.yml 파일에 인코딩한 것을 설정해 주는 문구를 자동으로 입력해 준다는 의미. no를 하면 수동으로 해줘야 한다. 어떤 것을 하든지 상관없음.) 그러면 .env 파일 밑에 .evn.enc 라는 파일이 생겼다. 암호화된 .env 파일이다.</p>\n<p>📌 .env 파일은 반드시 gitignore 처리. .env.enc 파일은 ignore 하면 안 된다.</p>\n<br/>\n<h3 id=\"빌드-test\" style=\"position:relative;\">빌드 test<a href=\"#%EB%B9%8C%EB%93%9C-test\" aria-label=\"빌드 test permalink\" class=\"auto-link after\"><svg viewBox=\"0 0 16 16\" width=\"16\" height=\"16\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a></h3>\n<p>이제 암호화된 파일이 생겼으니, 얘를 push 해서 build 해주자. 우선 travis 서버 상 build가 성공했으면 반은 성공한 거임.</p>\n<br/>\n<br/>\n<h2 id=\"s3에-호스팅-되어있는-버킷에-빌드-파일-올리기\" style=\"position:relative;\">s3에 호스팅 되어있는 버킷에 빌드 파일 올리기<a href=\"#s3%EC%97%90-%ED%98%B8%EC%8A%A4%ED%8C%85-%EB%90%98%EC%96%B4%EC%9E%88%EB%8A%94-%EB%B2%84%ED%82%B7%EC%97%90-%EB%B9%8C%EB%93%9C-%ED%8C%8C%EC%9D%BC-%EC%98%AC%EB%A6%AC%EA%B8%B0\" aria-label=\"s3에 호스팅 되어있는 버킷에 빌드 파일 올리기 permalink\" class=\"auto-link after\"><svg viewBox=\"0 0 16 16\" width=\"16\" height=\"16\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a></h2>\n<p>traivs 상에서 내 파일이 build 까지 완료되었다면, 이제 호스팅 되고 있는 public s3 버킷에 내 빌드 파일을 올려서 master 브랜치에 수정한 소스가 git push 될 때마다 자동으로 배포되도록 설정해보자. 단, 기존에 s3 조건이 설정되어 있어야 함. 아래와 같음.</p>\n<ul>\n<li>s3 버킷은 public 접근 가능함.</li>\n<li>버킷 정책 JSON이 설정되어 있을 것.</li>\n</ul>\n<br/>\n<h3 id=\"AWS-IAM-key-받기\" style=\"position:relative;\">AWS IAM key 받기<a href=\"#AWS-IAM-key-%EB%B0%9B%EA%B8%B0\" aria-label=\"AWS IAM key 받기 permalink\" class=\"auto-link after\"><svg viewBox=\"0 0 16 16\" width=\"16\" height=\"16\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a></h3>\n<p><a href=\"https://console.aws.amazon.com/iam/home?region=ap-northeast-2#/home\" target=\"_blank\" rel=\"nofollow\">IAM</a>에 사용자 탭 -> 사용자 추가 -> 이름 설정 -> AWS 액세스 유형은 <em>프로그래밍 방식 엑세스</em> 체크 -> 기존 정책 직접 연결 -> 정책 필터에 <em>s3full</em> 검색 후 AmazonS3FullAccess 체크. -> cloudfront 검색 후 CloudFrontFullAccess 체크 -> 태그 등록 -> 권한 최종 확인 후 생성이 완료되면 엑세스 키와 비밀 엑세스 키가 생성된다.</p>\n<p>즉, IAM 에서는 <code class=\"language-text\">AmazonS3FullAccess</code>, <code class=\"language-text\">CloudFrontFullAccess</code> 두 가지 권한이 필요한 것이다.</p>\n<br/>\n<h3 id=\"Travis-CI에-키-등록\" style=\"position:relative;\">Travis CI에 키 등록<a href=\"#Travis-CI%EC%97%90-%ED%82%A4-%EB%93%B1%EB%A1%9D\" aria-label=\"Travis CI에 키 등록 permalink\" class=\"auto-link after\"><svg viewBox=\"0 0 16 16\" width=\"16\" height=\"16\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a></h3>\n<p>aws s3에 접근할 수 있는 엑세스키와 비밀키는 <strong>절대절대절대절대</strong> github 에 올라가서는 안된다. 따라서 travis 상에 키를 등록해놓고 .traivs.yml에서 불러다 쓰는 형태로 진행해야 한다. (만약 github에 올라가면 aws로부터 이메일이 겁나 많이 오고 aws에 설정했던 인스턴스를 모두 삭제해야 하는 상황이 발생할 수도 있다. 한번 더 확인하세요… 아니 다섯 번) 이 방법이 아까 환경 변수 설정 방법 3가지 중 3번째 방법을 사용하는 것이라 볼 수 있다. travis.com에 가서, Settings 화면에 가자. 해당 프로젝트 우측에 Settings 를 눌러서 key를 등록할 수 있다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1254px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 31.2%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAAsTAAALEwEAmpwYAAABAElEQVR42l2P6W6DMBCEef+36p8+QPqnCSkUQxUOcYjD+ACmnkWK0iJ9snc9OztEfd+jbVssyyJorVFVFdI0RZ7nKIpCzqZp0HWdMM/zU//KNE2IhmEQw3Ecn8KyLJEkCZRSQpZlqOsaXE5DDlL7HzGkiAZMxSYTsr7HsZgxnVKZvDMleU1I/Z+E1jkYa2GMhbUOrPW6YpqXc3MQkjX0jDFyEiszZ+3CjN82ITLzBKcXuGWGDZiwZZ1G+FVLn6cNKTjovRcTpqIJ70y27zuO8ObNikh/XuC+45PsDn+9YLt+4FAJjuwLR3rD9sjlL2TwOMBvC2loSrbQ048CP+9v+AW6/8q9T0aD7gAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"travis-key-register\"\n        title=\"\"\n        src=\"/static/17e17113002e6d4bbc61aebde11d2f7b/a4588/travis-key-register.png\"\n        srcset=\"/static/17e17113002e6d4bbc61aebde11d2f7b/0eb09/travis-key-register.png 500w,\n/static/17e17113002e6d4bbc61aebde11d2f7b/1263b/travis-key-register.png 1000w,\n/static/17e17113002e6d4bbc61aebde11d2f7b/a4588/travis-key-register.png 1254w\"\n        sizes=\"(max-width: 1254px) 100vw, 1254px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>name : AWS_ACCESS_KEY, AWS_SECRET_KEY 두 개</li>\n<li>value : IAM에서 받은 엑세스키와 시크릿키</li>\n</ul>\n<p>이렇게 각각 등록해두면 된다. 그럼 이걸 .travis.yml 파일에서 변수로 가져올 수 있는 형태가 되는 것임.</p>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token key atrule\">deploy</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">provider</span><span class=\"token punctuation\">:</span> s3\n  <span class=\"token key atrule\">access_key_id</span><span class=\"token punctuation\">:</span> $AWS_ACCESS_KEY <span class=\"token comment\"># 여기</span>\n  <span class=\"token key atrule\">secret_access_key</span><span class=\"token punctuation\">:</span> $AWS_SECRET_KEY <span class=\"token comment\"># 여기</span>\n  <span class=\"token key atrule\">bucket</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span>버킷명<span class=\"token punctuation\">]</span>\n  <span class=\"token key atrule\">skip_cleanup</span><span class=\"token punctuation\">:</span> <span class=\"token boolean important\">true</span>\n  <span class=\"token key atrule\">acl</span><span class=\"token punctuation\">:</span> public_read\n  <span class=\"token key atrule\">region</span><span class=\"token punctuation\">:</span> ap<span class=\"token punctuation\">-</span>northeast<span class=\"token punctuation\">-</span><span class=\"token number\">2</span>\n  <span class=\"token key atrule\">wait-until-deploy</span><span class=\"token punctuation\">:</span> <span class=\"token boolean important\">true</span>\n  <span class=\"token key atrule\">local_dir</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span>vue라면 dist<span class=\"token punctuation\">,</span> react라면 build<span class=\"token punctuation\">]</span></code></pre></div>\n<p>이런 식으로. yml에 적어둔 것을 알아보자.</p>\n<ul>\n<li>provider : 배포 대상</li>\n<li>bucket : 내가 미리 생성해둔 public 접근 가능한 버킷.</li>\n<li>skip_cleanup : 공식 홈피에 따르면 빌드 중 이루어진 모든 변경 사항을 삭제하지 않게 함.</li>\n<li>acl : public 버킷이라 하더라도, 버킷에 올릴 때마다 파일을 일일이 public 객체로 바꿔주어야 하는데 이 옵션을 주면 자동으로 해줌. 하지만 aws cloudFront 설정을 따로 해줘야 한다. 자세한 건 밑에 있다. 이렇게 적어주자.</li>\n<li>region : 버킷의 region</li>\n<li>wait-until-deploy : 배포 시, 기다려줌</li>\n<li>local_dir : build 후 어떤 특정 폴더를 배포할지 설정. 나는 vue build 시 dist 폴더 안에 파일이 생성되므로 dist를 적어줬다.</li>\n</ul>\n<p>여기까지 해보고 git push해서 성공하나 확인해보는 게 좋다. 만약 성공하면 S3 버킷에 새 파일이 올라온 것을 확인할 수 있다. 이제 AWS CloudFront 를 통해 CDN 되어있는 페이지를 무효화 시키고 새 캐싱을 진행할 것임.</p>\n<br/>\n<br/>\n<h2 id=\"CloudFront-배포-설정\" style=\"position:relative;\">CloudFront 배포 설정<a href=\"#CloudFront-%EB%B0%B0%ED%8F%AC-%EC%84%A4%EC%A0%95\" aria-label=\"CloudFront 배포 설정 permalink\" class=\"auto-link after\"><svg viewBox=\"0 0 16 16\" width=\"16\" height=\"16\"><path fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"></path></svg></a></h2>\n<p>위에서 설정한 S3를 오리진으로 CloudFront 배포를 설정해 줄 것이다. <a href=\"https://docs.aws.amazon.com/ko_kr/AmazonCloudFront/latest/DeveloperGuide/private-content-restricting-access-to-s3.html#private-content-creating-oai\" target=\"_blank\" rel=\"nofollow\">aws 원본 액세스 ID를 배포에 추가</a> 여길 보고 따라 하면 된다. OAI를 설정해 주었다.</p>\n<hr>\n<p><strong>📌 CloudFront 콘솔을 사용하여 CloudFront OAI를 생성하려면</strong></p>\n<ol>\n<li>AWS Management Console에 로그인하여 <a href=\"https://console.aws.amazon.com/cloudfront/%EC%97%90%EC%84%9C\" target=\"_blank\" rel=\"nofollow\">https://console.aws.amazon.com/cloudfront/에서</a> CloudFront 콘솔을 엽니다.</li>\n<li>S3 오리진이 있는 배포의 ID를 선택합니다.</li>\n<li><strong>Origins and Origin Groups(오리진 및 오리진 그룹)</strong> 탭을 선택합니다.</li>\n<li>오리진 옆의 확인란을 선택한 다음 **Edit(편집)**을 선택합니다.</li>\n<li>**Restrict Bucket Access(버킷 액세스 제한)**에서 <strong>예</strong>를 선택합니다.</li>\n<li>사용할 OAI가 이미 있는 경우 **Use an Existing Identity(기존 자격 증명 사용)**를 선택합니다. 그런 다음 <strong>Your Identities(사용자 자격 증명)</strong> 목록에서 OAI를 선택합니다.</li>\n<li>CloudFront가 **오리진 도메인 이름(Origin Domain Name)**에 지정된 Amazon S3 버킷의 파일에 대한 읽기 권한을 자동으로 OAI에 부여하도록 하려면 **예, 버킷 정책을 업데이트합니다.(Yes, Update Bucket Policy)**를 선택합니다.</li>\n<li><strong>예, 편집합니다</strong>를 선택합니다.</li>\n</ol>\n<p>OAI를 생성했다면, Amazon S3 버킷 정책 사용 해주면 되는데 나는 기존에 해두었으므로 패스. 위의 url에 자세하게 나와있다. 따라하면 됨.</p>\n<hr>\n<p>이제, .travis.yml 파일을 수정해 주자.</p>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\">(<span class=\"token punctuation\">...</span>)\n<span class=\"token key atrule\">before_deploy</span><span class=\"token punctuation\">:</span>\n  <span class=\"token punctuation\">-</span> npm install <span class=\"token punctuation\">-</span>g travis<span class=\"token punctuation\">-</span>ci<span class=\"token punctuation\">-</span>cloudfront<span class=\"token punctuation\">-</span>invalidation\n\n<span class=\"token key atrule\">after_deploy</span><span class=\"token punctuation\">:</span>\n  <span class=\"token punctuation\">-</span> aws configure set preview.cloudfront true\n  <span class=\"token punctuation\">-</span> travis<span class=\"token punctuation\">-</span>ci<span class=\"token punctuation\">-</span>cloudfront<span class=\"token punctuation\">-</span>invalidation <span class=\"token punctuation\">-</span>a $AWS_ACCESS_KEY <span class=\"token punctuation\">-</span>s $AWS_SECRET_KEY <span class=\"token punctuation\">-</span>c $AWS_CLOUDFRONT_DIST_ID <span class=\"token punctuation\">-</span>i '/<span class=\"token important\">*'</span> <span class=\"token punctuation\">-</span>b $TRAVIS_BRANCH <span class=\"token punctuation\">-</span>p $TRAVIS_PULL_REQUEST <span class=\"token punctuation\">-</span>o 'master'</code></pre></div>\n<p>이렇게 설정해 주었다. S3에 매번 올린 후 cloudfront에서 매번 다시 캐싱 해줄 필요 없이 위 명령어로 travis가 알아서 해준다. 여기서 <code class=\"language-text\">travis-ci-cloudfront-invalidation</code> 라는 패키지를 travis 상에 설치 후, 제일 아래에 있는 명령어로 진행하는 것이다.</p>\n<p>$AWS_ACCESS_KEY, $AWS_SECRET_KEY는 기존 travis에 설정된 대로 들어갈 것이고, <code class=\"language-text\">$AWS_CLOUDFRONT_DIST_ID</code> 는 travis의 환경 변수 설정에서 직접 입력해 주자. aws의 cloudfront 페이지에 가장 먼저 id가 나와있다. 나머지는 필요 없다. 다만 위의 yml에 적여 있어야 한다.</p>\n<p>이제 git push 해주면,</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 934px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 29.2%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAAsTAAALEwEAmpwYAAABQUlEQVR42jVR2U7DMBDM/38FDzwh/gCJShWIB4SgVKiAczhpGtu5k6ZNnKPDxiWWRrs7Hq93bCutOySVRtP2uFwmjONI8YJpmgyWfI5LPo4Tzl0P3V+185lFY6UyRH+uEIsQvu+Dc444jiGEMHWe54ab6yiKTJ6kObbfLmx+oP3C6LXWpql19/CG+9UGq9cdHPYLxhhsl8P2JZwwwT4UcB0bnuvCJTiOA+55UEqirioUZWkaLcu6XXPcrDw8bhWOVYGSBEVRoDmdydJsa4AmS3oYrrXu0LUtuq7DQNxAXEt5S9wMK44CcLZDtOd0q4KQgiCNvWi26XOwzTtC9gMRBFeOIIQ09j2aVkr1/yQClspKJFmOvKxQHxtkVQNVNohn5DWSry3cl2ewpzXizw/6wBNUcTRxrzIwHsI7KAINkZb4A9rAwZ82inDSAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"aws-cache-invalidation\"\n        title=\"\"\n        src=\"/static/27a660a09eef9344d4f6c8aceac5d8de/e7956/aws-cache-invalidation.png\"\n        srcset=\"/static/27a660a09eef9344d4f6c8aceac5d8de/0eb09/aws-cache-invalidation.png 500w,\n/static/27a660a09eef9344d4f6c8aceac5d8de/e7956/aws-cache-invalidation.png 934w\"\n        sizes=\"(max-width: 934px) 100vw, 934px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>요런식으로 도는걸 볼 수 있다. 완료!!</p>\n<p>.travis.yml 완성본</p>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token key atrule\">language</span><span class=\"token punctuation\">:</span> node_js\n\n<span class=\"token comment\"># nodeJS 버전</span>\n<span class=\"token key atrule\">node_js</span><span class=\"token punctuation\">:</span>\n  <span class=\"token punctuation\">-</span> 14.16.0\n\n<span class=\"token comment\"># Git Commit 수신 허용 목록 master 브랜치만.</span>\n<span class=\"token key atrule\">branches</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">only</span><span class=\"token punctuation\">:</span>\n    <span class=\"token punctuation\">-</span> master\n\n<span class=\"token comment\"># Travis CI 에서 node_modules를 캐싱한다.</span>\n<span class=\"token comment\"># 빌드 프로세스 속도를 높여줌.</span>\n<span class=\"token key atrule\">cache</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">directories</span><span class=\"token punctuation\">:</span>\n    <span class=\"token punctuation\">-</span> node_modules\n\n<span class=\"token comment\"># Travis 서버에서 빌드 명령어</span>\n<span class=\"token key atrule\">script</span><span class=\"token punctuation\">:</span> npm run build\n\n<span class=\"token comment\"># .env.production 파일 인코딩했던 것을 디코딩해서 만들어줌.</span>\n<span class=\"token key atrule\">before_install</span><span class=\"token punctuation\">:</span>\n  <span class=\"token punctuation\">-</span> openssl aes<span class=\"token punctuation\">-</span>256<span class=\"token punctuation\">-</span>cbc <span class=\"token punctuation\">-</span>K <span class=\"token punctuation\">[</span>$encrypted_key<span class=\"token punctuation\">...</span><span class=\"token punctuation\">]</span> <span class=\"token punctuation\">-</span>iv <span class=\"token punctuation\">[</span>$encrypted_iv<span class=\"token punctuation\">...</span><span class=\"token punctuation\">]</span>\n    <span class=\"token punctuation\">-</span>in .env.production.enc <span class=\"token punctuation\">-</span>out .env.production <span class=\"token punctuation\">-</span>d\n\n<span class=\"token comment\"># AWS CloudFront 캐싱을 위해 설치.</span>\n<span class=\"token key atrule\">before_deploy</span><span class=\"token punctuation\">:</span>\n  <span class=\"token punctuation\">-</span> npm install <span class=\"token punctuation\">-</span>g travis<span class=\"token punctuation\">-</span>ci<span class=\"token punctuation\">-</span>cloudfront<span class=\"token punctuation\">-</span>invalidation\n\n<span class=\"token comment\"># build후 배포 대상</span>\n<span class=\"token key atrule\">deploy</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">provider</span><span class=\"token punctuation\">:</span> s3\n  <span class=\"token key atrule\">access_key_id</span><span class=\"token punctuation\">:</span> $AWS_ACCESS_KEY\n  <span class=\"token key atrule\">secret_access_key</span><span class=\"token punctuation\">:</span> $AWS_SECRET_KEY\n  <span class=\"token key atrule\">bucket</span><span class=\"token punctuation\">:</span> tripllo.tech\n  <span class=\"token key atrule\">skip_cleanup</span><span class=\"token punctuation\">:</span> <span class=\"token boolean important\">true</span>\n  <span class=\"token key atrule\">acl</span><span class=\"token punctuation\">:</span> public_read\n  <span class=\"token key atrule\">region</span><span class=\"token punctuation\">:</span> ap<span class=\"token punctuation\">-</span>northeast<span class=\"token punctuation\">-</span><span class=\"token number\">2</span>\n  <span class=\"token key atrule\">wait-until-deploy</span><span class=\"token punctuation\">:</span> <span class=\"token boolean important\">true</span>\n  <span class=\"token key atrule\">local_dir</span><span class=\"token punctuation\">:</span> dist\n\n<span class=\"token comment\"># 배포 완료 후 AWS CloudFront의 캐시를 무효화.</span>\n<span class=\"token key atrule\">after_deploy</span><span class=\"token punctuation\">:</span>\n  <span class=\"token punctuation\">-</span> aws configure set preview.cloudfront true\n  <span class=\"token punctuation\">-</span> travis<span class=\"token punctuation\">-</span>ci<span class=\"token punctuation\">-</span>cloudfront<span class=\"token punctuation\">-</span>invalidation <span class=\"token punctuation\">-</span>a $AWS_ACCESS_KEY <span class=\"token punctuation\">-</span>s $AWS_SECRET_KEY <span class=\"token punctuation\">-</span>c $AWS_CLOUDFRONT_DIST_ID <span class=\"token punctuation\">-</span>i '/<span class=\"token important\">*'</span> <span class=\"token punctuation\">-</span>b $TRAVIS_BRANCH <span class=\"token punctuation\">-</span>p $TRAVIS_PULL_REQUEST <span class=\"token punctuation\">-</span>o 'master'\n\n<span class=\"token comment\"># 빌드 후 알림</span>\n<span class=\"token key atrule\">notifications</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">email</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">recipients</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> pozafly@kakao.com</code></pre></div>\n<p>아쉬운 점은 npm 모듈을 사용하지 않고 CloudFront 설정을 할 수 있을텐데 하지 못했다. <a href=\"https://medium.com/lunit/travis-ci%EB%A1%9C-aws-s3%EC%97%90-spa-%EB%B0%B0%ED%8F%AC%ED%95%98%EA%B8%B0-c081e25335b5\" target=\"_blank\" rel=\"nofollow\">여기1</a>, <a href=\"https://renzolucioni.com/s3-deployment-with-travis/\" target=\"_blank\" rel=\"nofollow\">여기2</a>, <a href=\"https://github.com/CircleCI-Public/aws-cli-orb/issues/24\" target=\"_blank\" rel=\"nofollow\">여기3</a> 를 보면서 연구했는데 잘 안됐다…</p>\n<br/>\n<blockquote>\n<p>프로젝트 구경하기 -> <a href=\"https://tripllo.tech\" target=\"_blank\" rel=\"nofollow\">Tripllo_메인</a>, <a href=\"https://github.com/pozafly/tripllo_vue\" target=\"_blank\" rel=\"nofollow\">Vue_Github</a>, <a href=\"https://github.com/pozafly/tripllo_springBoot\" target=\"_blank\" rel=\"nofollow\">SpringBoot_Github</a></p>\n</blockquote>","htmlAst":{"type":"root","children":[{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Travis CI에 대해서 알아보자. 우선 "},{"type":"element","tagName":"a","properties":{"href":"https://docs.travis-ci.com/","target":"_blank","rel":["nofollow"]},"children":[{"type":"text","value":"Travis 공식"}]},{"type":"text","value":" Docs를 보고 따라 해봤다. 참고 자료는 이동욱 님의 스프링 부트와 AWS로 혼자 구현하는 웹 서비스 책을 참고했다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"우선 travis endpoint에 대해 알아야 한다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"travis 엔드 포인트 —pro\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"API 엔드 포인트 : "},{"type":"element","tagName":"a","properties":{"href":"https://api.travis-ci.com/","target":"_blank","rel":["nofollow"]},"children":[{"type":"text","value":"https://api.travis-ci.com/"}]}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"travis 엔드 포인트\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"API 엔드 포인트 : "},{"type":"element","tagName":"a","properties":{"href":"https://api.travis-ci.org/","target":"_blank","rel":["nofollow"]},"children":[{"type":"text","value":"https://api.travis-ci.org/"}]}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"차이점은, "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"--pro"}]},{"type":"text","value":" 가 붙은 녀석은 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":".com"}]},{"type":"text","value":" 으로 연결되고, —pro 옵션이 없는 엔드포인트는 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":".org"}]},{"type":"text","value":" 로 연결된다는 것임."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"endpoint를 잘 설정해 주어야지 오류가 나지 않는다. springboot를 travis로 빌드 자동화를 했을 때도 겪었었지만, .org 엔드 포인트는 오류가 많고 잘되지 않는 경우가 많다. 버전 차이인듯싶다. 어쨌든 우리는 앞으로 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":".com"}]},{"type":"text","value":" 인 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"--pro"}]},{"type":"text","value":" 를 붙여 엔드포인트를 설정해줄 것이다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"br","properties":{},"children":[]},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{"id":"Github-repository-연동","style":"position:relative;"},"children":[{"type":"text","value":"Github repository 연동"},{"type":"element","tagName":"a","properties":{"href":"#Github-repository-%EC%97%B0%EB%8F%99","ariaLabel":"Github repository 연동 permalink","className":["auto-link","after"]},"children":[{"type":"element","tagName":"svg","properties":{"viewBox":"0 0 16 16","width":"16","height":"16"},"children":[{"type":"element","tagName":"path","properties":{"fillRule":"evenodd","d":"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"},"children":[]}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"a","properties":{"href":"https://travis-ci.com/","target":"_blank","rel":["nofollow"]},"children":[{"type":"text","value":"https://travis-ci.com/"}]},{"type":"text","value":" 이곳에 먼저 들어가서 github ID로 로그인을 해주자. 우측 상단에 내 아이콘을 선택하고 Setting -> Repositories에 가면 무슨 프로젝트를 설정할 것인지 페이지가 나온다. 여기서 어떤 프로젝트를 CI 할 것인지 설정해 줄 수 있다. Manage repositories on GitHub 을 클릭하고, github 페이지에 들어가면,"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-wrapper"],"style":"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 764px; "},"children":[{"type":"text","value":"\n      "},{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-background-image"],"style":"padding-bottom: 45.4%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAAsTAAALEwEAmpwYAAABNUlEQVR42pWR3VLCMBBG+yhIf5M2m6YNBdoCUhAUxisVff8X+dwUnAEGR7w4s7ttcrKz65lqjqbbo2qfYOsO08UWqZlgEGYYxvRvvFAWSLWFVAZxVkIoi1Aa+AkhEBpBciTiPJKn+JNf1e6858cZdFGinMywaBQema4lzjXmNaGb6T43RsHk6jJefXNSz+fXpdLIyICIGAXFkOLIuJo0Ic3+JhQnoaBRPz9br5DQGMPEIEwtAlkyBQYR4eEOnMvzRY5YjSDzMcsqCF1xzTLhZmoR8VzvXchRmOQoubP17g0rZvN6wHr/DrINBkHKL/O2I3WG2776XeguCD1Fu/nA7PmA+csnFrsvFO0OAdUIdYOQztCzvvtb0l7ofkR8SVYbxMUSiaPs+lxwvGTJ57Y8Bsud3xZ+A5/wFGbH2oViAAAAAElFTkSuQmCC'); background-size: cover; display: block;"},"children":[]},{"type":"text","value":"\n  "},{"type":"element","tagName":"img","properties":{"className":["gatsby-resp-image-image"],"alt":"travis-repo-register","title":"","src":"/static/676786a962ff7a95a82ec594a8d7f868/2cbcd/travis-repo-register.png","srcSet":["/static/676786a962ff7a95a82ec594a8d7f868/0eb09/travis-repo-register.png 500w","/static/676786a962ff7a95a82ec594a8d7f868/2cbcd/travis-repo-register.png 764w"],"sizes":"(max-width: 764px) 100vw, 764px","style":"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;","loading":"lazy","decoding":"async"},"children":[]},{"type":"text","value":"\n    "}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"이곳에서 자신의 프로젝트를 선택해서 연동시킬 수 있다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"br","properties":{},"children":[]},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{"id":"travisyml","style":"position:relative;"},"children":[{"type":"text","value":".travis.yml"},{"type":"element","tagName":"a","properties":{"href":"#travisyml","ariaLabel":"travisyml permalink","className":["auto-link","after"]},"children":[{"type":"element","tagName":"svg","properties":{"viewBox":"0 0 16 16","width":"16","height":"16"},"children":[{"type":"element","tagName":"path","properties":{"fillRule":"evenodd","d":"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"},"children":[]}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"후에, 자신의 프로젝트에 .travis.yml 파일을 만들자."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"yaml"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-yaml"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-yaml"]},"children":[{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"language"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" node_js\n"},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"node_js"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":"\n  "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":" 14.16.0\n"},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"branches"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":"\n  "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"only"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":" master\n"},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"cache"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":"\n  "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"directories"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":" node_modules\n"},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"script"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" npm run build\n"},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"notifications"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":"\n  "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"email"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"recipients"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":"\n      "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":" pozafly@kakao.com"}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"language : vue 프로젝트를 설정할 것이므로, language는 node_js 형태로 빌드 한다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"node_js : 버전은 자신이 설정한 것 대로 해주면 됨"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"branches : master 브랜치에 push 되었을 때 자동으로 돌아가게 해줌."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"cache : 빌드 시, node_modules가 계속 install 될 필요는 없으므로 해당 폴더를 캐시화 시켜주겠다는 말이다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"script : 빌드 명령어"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"notifications : CI가 완료되었을 때 결과를 noti 해준다. 내 메일 주소를 적었다."}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"우선 기본 틀이다. 이제 이 파일을 작성했다면, master 브랜치에 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"push"}]},{"type":"text","value":" or "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"merge후 push"}]},{"type":"text","value":" 할 때마다 travis가 알아서 프로젝트를 빌드해줄 것이다. push후 travis 페이지에 가보면 build log가 실시간으로 찍힌다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"첫 번째 에러가 났다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"text"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-text"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"error\nTemplate execution failed: ReferenceError: VUE_APP_GOOGLE_CLIENT_ID is not defined"}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"VUE_APP_GOOGLE_CLINET_ID"}]},{"type":"text","value":" 는 .env 파일에 있는데, 이걸 build 하지 못하는 이유는 .env 파일이 github에 올라가지 않아서다. 따라서 .env 파일을 travis 서버에서 인식하도록 할 필요가 있다. 방법은 3가지가 있다. "},{"type":"element","tagName":"a","properties":{"href":"https://docs.travis-ci.com/user/environment-variables/","target":"_blank","rel":["nofollow"]},"children":[{"type":"text","value":"공식 페이지 환경변수"}]},{"type":"text","value":" 이곳에 잘 설명되어 있다,"}]},{"type":"text","value":"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n"},{"type":"element","tagName":"table","properties":{},"children":[{"type":"element","tagName":"thead","properties":{},"children":[{"type":"element","tagName":"tr","properties":{},"children":[{"type":"element","tagName":"th","properties":{"align":"center"},"children":[{"type":"text","value":"사용방법"}]},{"type":"element","tagName":"th","properties":{"align":"center"},"children":[{"type":"text","value":"Github 오픈 여부"}]},{"type":"element","tagName":"th","properties":{"align":"center"},"children":[{"type":"text","value":"암호화"}]}]}]},{"type":"element","tagName":"tbody","properties":{},"children":[{"type":"element","tagName":"tr","properties":{},"children":[{"type":"element","tagName":"td","properties":{"align":"center"},"children":[{"type":"text","value":".travis.yml에서 공용 변수 정의"}]},{"type":"element","tagName":"td","properties":{"align":"center"},"children":[{"type":"text","value":"O"}]},{"type":"element","tagName":"td","properties":{"align":"center"},"children":[{"type":"text","value":"X"}]}]},{"type":"element","tagName":"tr","properties":{},"children":[{"type":"element","tagName":"td","properties":{"align":"center"},"children":[{"type":"text","value":".travis.yml에서 암호화된 변수 정의"}]},{"type":"element","tagName":"td","properties":{"align":"center"},"children":[{"type":"text","value":"O"}]},{"type":"element","tagName":"td","properties":{"align":"center"},"children":[{"type":"text","value":"O"}]}]},{"type":"element","tagName":"tr","properties":{},"children":[{"type":"element","tagName":"td","properties":{"align":"center"},"children":[{"type":"text","value":"리포지토리 설정에서 변수 정의"}]},{"type":"element","tagName":"td","properties":{"align":"center"},"children":[{"type":"text","value":"X"}]},{"type":"element","tagName":"td","properties":{"align":"center"},"children":[{"type":"text","value":"O"}]}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"이렇게 3가지 방법인데, 조금 더 자세히 알아보면,"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"ol","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":".travis.yml에서 공용 변수 정의"}]},{"type":"text","value":" : 단순히 yml 파일에 공통 변수로 지정 후 사용한다. 따라서 암호가 Github에도 노출되고, 암호화되어있지 않다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":".travis.yml에서 암호화된 변수 정의"}]},{"type":"text","value":" : 암호화해서 .enc 파일을 프로젝트에 생성한다. 그리고, 이 암호화된 파일이 travis 서버 상에 올라갈 때 복호화 되어 컴파일 된다. 따라서 .enc 파일은 github에도 올라가게 된다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"리포지토리 설정에서 변수 정의"}]},{"type":"text","value":" : 아예 traivs 홈페이지에서 환경 변수를 만들고 값을 넣어주고, yml 파일에 해당 변수를 선언하면 값이 들어가는 형태이다. .enc 파일이 존재하지 않기 때문에 찌꺼기가 남지 않는다."}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"나는 두 번째 방법인 .travis.yml 에서 secret 파일 암호화하는 방법을 사용하겠다. .enc 파일이라는 찌꺼기가 생기겠지만 괜찮다. 그리고 세 번째 방법은 AWS 변수를 나중에 넣을 때 사용할 것이다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"br","properties":{},"children":[]},{"type":"text","value":"\n"},{"type":"element","tagName":"br","properties":{},"children":[]},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{"id":"evn-파일을-AES256-이용하여-envenc-파일-생성하기","style":"position:relative;"},"children":[{"type":"text","value":".evn 파일을 AES256 이용하여 .env.enc 파일 생성하기"},{"type":"element","tagName":"a","properties":{"href":"#evn-%ED%8C%8C%EC%9D%BC%EC%9D%84-AES256-%EC%9D%B4%EC%9A%A9%ED%95%98%EC%97%AC-envenc-%ED%8C%8C%EC%9D%BC-%EC%83%9D%EC%84%B1%ED%95%98%EA%B8%B0","ariaLabel":"evn 파일을 AES256 이용하여 envenc 파일 생성하기 permalink","className":["auto-link","after"]},"children":[{"type":"element","tagName":"svg","properties":{"viewBox":"0 0 16 16","width":"16","height":"16"},"children":[{"type":"element","tagName":"path","properties":{"fillRule":"evenodd","d":"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"},"children":[]}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h3","properties":{"id":"CLC-설치--login","style":"position:relative;"},"children":[{"type":"text","value":"CLC 설치 & login"},{"type":"element","tagName":"a","properties":{"href":"#CLC-%EC%84%A4%EC%B9%98--login","ariaLabel":"CLC 설치  login permalink","className":["auto-link","after"]},"children":[{"type":"element","tagName":"svg","properties":{"viewBox":"0 0 16 16","width":"16","height":"16"},"children":[{"type":"element","tagName":"path","properties":{"fillRule":"evenodd","d":"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"},"children":[]}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"a","properties":{"href":"https://sanghye.tistory.com/42","target":"_blank","rel":["nofollow"]},"children":[{"type":"text","value":"여기"}]},{"type":"text","value":" 참고하였다. 먼저 로컬 컴퓨터에서 암호화 해 .enc 파일을 생성할 것이기 때문에 travis CLC가 필요하다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"shell"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-shell"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-shell"]},"children":[{"type":"text","value":"$ gem "},{"type":"element","tagName":"span","properties":{"className":["token","function"]},"children":[{"type":"text","value":"install"}]},{"type":"text","value":" travis"}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"만약 권한 오류가 난다면 sudo를 붙여주도록 하자. 이제 travis에 login을 해야 함."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"text"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-text"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"$ travis login --pro"}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"—com, —org 옵션을 줄 수 있는데, pro를 붙여주자. 아니면 빌드 시 오류 발생. org를 사용하고 있다면 org를 써도 된다. login을 할 때 Not Found 에러가 날 수 있다. "},{"type":"element","tagName":"a","properties":{"href":"https://github.com/pozafly/TIL/blob/main/%F0%9F%A7%A8%E1%84%8B%E1%85%A9%E1%84%85%E1%85%B2%E1%84%8B%E1%85%AA%E1%84%8B%E1%85%B4%20%E1%84%8C%E1%85%A9%E1%84%8B%E1%85%AE/travis/travis%20login%20Not%20Found.md","target":"_blank","rel":["nofollow"]},"children":[{"type":"text","value":"travis login Not Found 오류 정리"}]},{"type":"text","value":" 이곳에 정리해 뒀으니, github token으로 로그인해 주자."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"br","properties":{},"children":[]},{"type":"text","value":"\n"},{"type":"element","tagName":"h3","properties":{"id":"endpoint-설정","style":"position:relative;"},"children":[{"type":"text","value":"endpoint 설정"},{"type":"element","tagName":"a","properties":{"href":"#endpoint-%EC%84%A4%EC%A0%95","ariaLabel":"endpoint 설정 permalink","className":["auto-link","after"]},"children":[{"type":"element","tagName":"svg","properties":{"viewBox":"0 0 16 16","width":"16","height":"16"},"children":[{"type":"element","tagName":"path","properties":{"fillRule":"evenodd","d":"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"},"children":[]}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"우리는 pro로 설정했으니 endpoint를 잡아주자. endpoint를 잡아주지 않으면, 암호화를 진행할 때, "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"not logged in -try running travis login --org"}]},{"type":"text","value":" 오류가 뜰 수 있다. "},{"type":"element","tagName":"a","properties":{"href":"https://github.com/travis-ci/travis-ci/issues/9668","target":"_blank","rel":["nofollow"]},"children":[{"type":"text","value":"github issues"}]},{"type":"text","value":" 이곳을 참고했다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"shell"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-shell"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-shell"]},"children":[{"type":"text","value":"$ travis endpoint "},{"type":"element","tagName":"span","properties":{"className":["token","parameter","variable"]},"children":[{"type":"text","value":"--pro"}]}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"br","properties":{},"children":[]},{"type":"text","value":"\n"},{"type":"element","tagName":"h3","properties":{"id":"env-파일-암호화","style":"position:relative;"},"children":[{"type":"text","value":".env 파일 암호화"},{"type":"element","tagName":"a","properties":{"href":"#env-%ED%8C%8C%EC%9D%BC-%EC%95%94%ED%98%B8%ED%99%94","ariaLabel":"env 파일 암호화 permalink","className":["auto-link","after"]},"children":[{"type":"element","tagName":"svg","properties":{"viewBox":"0 0 16 16","width":"16","height":"16"},"children":[{"type":"element","tagName":"path","properties":{"fillRule":"evenodd","d":"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"},"children":[]}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"이제 암호화를 진행하자."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"shell"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-shell"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-shell"]},"children":[{"type":"text","value":"$ travis encrypt-file "},{"type":"element","tagName":"span","properties":{"className":["token","parameter","variable"]},"children":[{"type":"text","value":"--pro"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"["}]},{"type":"text","value":"파일명"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"]"}]}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"—pro를 붙여주자. 붙여주지 않으면,"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-wrapper"],"style":"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 754px; "},"children":[{"type":"text","value":"\n      "},{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-background-image"],"style":"padding-bottom: 14.2%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAYAAACTWi8uAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAtUlEQVR42j2MUW6DMBBEuUoqRSqNlNjGJjiAqiAnhdooUHP/q7xu+ejH6O3OjKZY15XX8mIRfsfIPM/knMnbxk/eSGnmaxwJj4fciSidKEzSG6eJ+zDQdh0hhD0vtmUhSdB7T9s0dL6hvd3oRH+eM4a6qkQGqzVGKZzQGU1jK7y1/5lSF4rkr0y1I1Sa/nLmU8y7Vvs/GCXSxGu9d56uoldngjU8ZcyUJfXphC7f+TgeeTsc+AWKs2bN0PjGkQAAAABJRU5ErkJggg=='); background-size: cover; display: block;"},"children":[]},{"type":"text","value":"\n  "},{"type":"element","tagName":"img","properties":{"className":["gatsby-resp-image-image"],"alt":"travis-error-log","title":"","src":"/static/d63bd3b884b43d05a76c0da6013cdf92/a0d62/travis-error-log.png","srcSet":["/static/d63bd3b884b43d05a76c0da6013cdf92/0eb09/travis-error-log.png 500w","/static/d63bd3b884b43d05a76c0da6013cdf92/a0d62/travis-error-log.png 754w"],"sizes":"(max-width: 754px) 100vw, 754px","style":"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;","loading":"lazy","decoding":"async"},"children":[]},{"type":"text","value":"\n    "}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"push 후 build 때, "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"iv undefined"}]},{"type":"text","value":" 오류가 계속 뜰 것임."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"그리고 —add 옵션을 붙여주면 .travis.yml 파일에 자동으로 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"before_install"}]},{"type":"text","value":" 란이 생기도록 할 수 있다. build 때 install 전에 암호화한 파일을 복호화 해서 travis가 알아먹을 수 있도록 해주는 작업이다. 따라서 최종적으로는"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"shell"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-shell"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-shell"]},"children":[{"type":"text","value":"$ travis encrypt-file "},{"type":"element","tagName":"span","properties":{"className":["token","parameter","variable"]},"children":[{"type":"text","value":"--pro"}]},{"type":"text","value":" .env.production "},{"type":"element","tagName":"span","properties":{"className":["token","parameter","variable"]},"children":[{"type":"text","value":"--add"}]}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"요렇게 해줬다. 그러면 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"DANGER ZONE: Override existing .env.production.enc? |no|"}]},{"type":"text","value":" 이런 문구가 뜰 것인데, yes 를 입력해 주자. (yes를 입력해 준다는 의미는 .travis.yml 파일에 인코딩한 것을 설정해 주는 문구를 자동으로 입력해 준다는 의미. no를 하면 수동으로 해줘야 한다. 어떤 것을 하든지 상관없음.) 그러면 .env 파일 밑에 .evn.enc 라는 파일이 생겼다. 암호화된 .env 파일이다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"📌 .env 파일은 반드시 gitignore 처리. .env.enc 파일은 ignore 하면 안 된다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"br","properties":{},"children":[]},{"type":"text","value":"\n"},{"type":"element","tagName":"h3","properties":{"id":"빌드-test","style":"position:relative;"},"children":[{"type":"text","value":"빌드 test"},{"type":"element","tagName":"a","properties":{"href":"#%EB%B9%8C%EB%93%9C-test","ariaLabel":"빌드 test permalink","className":["auto-link","after"]},"children":[{"type":"element","tagName":"svg","properties":{"viewBox":"0 0 16 16","width":"16","height":"16"},"children":[{"type":"element","tagName":"path","properties":{"fillRule":"evenodd","d":"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"},"children":[]}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"이제 암호화된 파일이 생겼으니, 얘를 push 해서 build 해주자. 우선 travis 서버 상 build가 성공했으면 반은 성공한 거임."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"br","properties":{},"children":[]},{"type":"text","value":"\n"},{"type":"element","tagName":"br","properties":{},"children":[]},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{"id":"s3에-호스팅-되어있는-버킷에-빌드-파일-올리기","style":"position:relative;"},"children":[{"type":"text","value":"s3에 호스팅 되어있는 버킷에 빌드 파일 올리기"},{"type":"element","tagName":"a","properties":{"href":"#s3%EC%97%90-%ED%98%B8%EC%8A%A4%ED%8C%85-%EB%90%98%EC%96%B4%EC%9E%88%EB%8A%94-%EB%B2%84%ED%82%B7%EC%97%90-%EB%B9%8C%EB%93%9C-%ED%8C%8C%EC%9D%BC-%EC%98%AC%EB%A6%AC%EA%B8%B0","ariaLabel":"s3에 호스팅 되어있는 버킷에 빌드 파일 올리기 permalink","className":["auto-link","after"]},"children":[{"type":"element","tagName":"svg","properties":{"viewBox":"0 0 16 16","width":"16","height":"16"},"children":[{"type":"element","tagName":"path","properties":{"fillRule":"evenodd","d":"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"},"children":[]}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"traivs 상에서 내 파일이 build 까지 완료되었다면, 이제 호스팅 되고 있는 public s3 버킷에 내 빌드 파일을 올려서 master 브랜치에 수정한 소스가 git push 될 때마다 자동으로 배포되도록 설정해보자. 단, 기존에 s3 조건이 설정되어 있어야 함. 아래와 같음."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"s3 버킷은 public 접근 가능함."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"버킷 정책 JSON이 설정되어 있을 것."}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"br","properties":{},"children":[]},{"type":"text","value":"\n"},{"type":"element","tagName":"h3","properties":{"id":"AWS-IAM-key-받기","style":"position:relative;"},"children":[{"type":"text","value":"AWS IAM key 받기"},{"type":"element","tagName":"a","properties":{"href":"#AWS-IAM-key-%EB%B0%9B%EA%B8%B0","ariaLabel":"AWS IAM key 받기 permalink","className":["auto-link","after"]},"children":[{"type":"element","tagName":"svg","properties":{"viewBox":"0 0 16 16","width":"16","height":"16"},"children":[{"type":"element","tagName":"path","properties":{"fillRule":"evenodd","d":"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"},"children":[]}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"a","properties":{"href":"https://console.aws.amazon.com/iam/home?region=ap-northeast-2#/home","target":"_blank","rel":["nofollow"]},"children":[{"type":"text","value":"IAM"}]},{"type":"text","value":"에 사용자 탭 -> 사용자 추가 -> 이름 설정 -> AWS 액세스 유형은 "},{"type":"element","tagName":"em","properties":{},"children":[{"type":"text","value":"프로그래밍 방식 엑세스"}]},{"type":"text","value":" 체크 -> 기존 정책 직접 연결 -> 정책 필터에 "},{"type":"element","tagName":"em","properties":{},"children":[{"type":"text","value":"s3full"}]},{"type":"text","value":" 검색 후 AmazonS3FullAccess 체크. -> cloudfront 검색 후 CloudFrontFullAccess 체크 -> 태그 등록 -> 권한 최종 확인 후 생성이 완료되면 엑세스 키와 비밀 엑세스 키가 생성된다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"즉, IAM 에서는 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"AmazonS3FullAccess"}]},{"type":"text","value":", "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"CloudFrontFullAccess"}]},{"type":"text","value":" 두 가지 권한이 필요한 것이다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"br","properties":{},"children":[]},{"type":"text","value":"\n"},{"type":"element","tagName":"h3","properties":{"id":"Travis-CI에-키-등록","style":"position:relative;"},"children":[{"type":"text","value":"Travis CI에 키 등록"},{"type":"element","tagName":"a","properties":{"href":"#Travis-CI%EC%97%90-%ED%82%A4-%EB%93%B1%EB%A1%9D","ariaLabel":"Travis CI에 키 등록 permalink","className":["auto-link","after"]},"children":[{"type":"element","tagName":"svg","properties":{"viewBox":"0 0 16 16","width":"16","height":"16"},"children":[{"type":"element","tagName":"path","properties":{"fillRule":"evenodd","d":"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"},"children":[]}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"aws s3에 접근할 수 있는 엑세스키와 비밀키는 "},{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"절대절대절대절대"}]},{"type":"text","value":" github 에 올라가서는 안된다. 따라서 travis 상에 키를 등록해놓고 .traivs.yml에서 불러다 쓰는 형태로 진행해야 한다. (만약 github에 올라가면 aws로부터 이메일이 겁나 많이 오고 aws에 설정했던 인스턴스를 모두 삭제해야 하는 상황이 발생할 수도 있다. 한번 더 확인하세요… 아니 다섯 번) 이 방법이 아까 환경 변수 설정 방법 3가지 중 3번째 방법을 사용하는 것이라 볼 수 있다. travis.com에 가서, Settings 화면에 가자. 해당 프로젝트 우측에 Settings 를 눌러서 key를 등록할 수 있다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-wrapper"],"style":"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1254px; "},"children":[{"type":"text","value":"\n      "},{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-background-image"],"style":"padding-bottom: 31.2%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAAsTAAALEwEAmpwYAAABAElEQVR42l2P6W6DMBCEef+36p8+QPqnCSkUQxUOcYjD+ACmnkWK0iJ9snc9OztEfd+jbVssyyJorVFVFdI0RZ7nKIpCzqZp0HWdMM/zU//KNE2IhmEQw3Ecn8KyLJEkCZRSQpZlqOsaXE5DDlL7HzGkiAZMxSYTsr7HsZgxnVKZvDMleU1I/Z+E1jkYa2GMhbUOrPW6YpqXc3MQkjX0jDFyEiszZ+3CjN82ITLzBKcXuGWGDZiwZZ1G+FVLn6cNKTjovRcTpqIJ70y27zuO8ObNikh/XuC+45PsDn+9YLt+4FAJjuwLR3rD9sjlL2TwOMBvC2loSrbQ048CP+9v+AW6/8q9T0aD7gAAAABJRU5ErkJggg=='); background-size: cover; display: block;"},"children":[]},{"type":"text","value":"\n  "},{"type":"element","tagName":"img","properties":{"className":["gatsby-resp-image-image"],"alt":"travis-key-register","title":"","src":"/static/17e17113002e6d4bbc61aebde11d2f7b/a4588/travis-key-register.png","srcSet":["/static/17e17113002e6d4bbc61aebde11d2f7b/0eb09/travis-key-register.png 500w","/static/17e17113002e6d4bbc61aebde11d2f7b/1263b/travis-key-register.png 1000w","/static/17e17113002e6d4bbc61aebde11d2f7b/a4588/travis-key-register.png 1254w"],"sizes":"(max-width: 1254px) 100vw, 1254px","style":"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;","loading":"lazy","decoding":"async"},"children":[]},{"type":"text","value":"\n    "}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"name : AWS_ACCESS_KEY, AWS_SECRET_KEY 두 개"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"value : IAM에서 받은 엑세스키와 시크릿키"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"이렇게 각각 등록해두면 된다. 그럼 이걸 .travis.yml 파일에서 변수로 가져올 수 있는 형태가 되는 것임."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"yaml"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-yaml"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-yaml"]},"children":[{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"deploy"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":"\n  "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"provider"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" s3\n  "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"access_key_id"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" $AWS_ACCESS_KEY "},{"type":"element","tagName":"span","properties":{"className":["token","comment"]},"children":[{"type":"text","value":"# 여기"}]},{"type":"text","value":"\n  "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"secret_access_key"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" $AWS_SECRET_KEY "},{"type":"element","tagName":"span","properties":{"className":["token","comment"]},"children":[{"type":"text","value":"# 여기"}]},{"type":"text","value":"\n  "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"bucket"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"["}]},{"type":"text","value":"버킷명"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"]"}]},{"type":"text","value":"\n  "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"skip_cleanup"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","boolean","important"]},"children":[{"type":"text","value":"true"}]},{"type":"text","value":"\n  "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"acl"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" public_read\n  "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"region"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" ap"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"northeast"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"element","tagName":"span","properties":{"className":["token","number"]},"children":[{"type":"text","value":"2"}]},{"type":"text","value":"\n  "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"wait-until-deploy"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","boolean","important"]},"children":[{"type":"text","value":"true"}]},{"type":"text","value":"\n  "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"local_dir"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"["}]},{"type":"text","value":"vue라면 dist"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":","}]},{"type":"text","value":" react라면 build"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"]"}]}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"이런 식으로. yml에 적어둔 것을 알아보자."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"provider : 배포 대상"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"bucket : 내가 미리 생성해둔 public 접근 가능한 버킷."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"skip_cleanup : 공식 홈피에 따르면 빌드 중 이루어진 모든 변경 사항을 삭제하지 않게 함."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"acl : public 버킷이라 하더라도, 버킷에 올릴 때마다 파일을 일일이 public 객체로 바꿔주어야 하는데 이 옵션을 주면 자동으로 해줌. 하지만 aws cloudFront 설정을 따로 해줘야 한다. 자세한 건 밑에 있다. 이렇게 적어주자."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"region : 버킷의 region"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"wait-until-deploy : 배포 시, 기다려줌"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"local_dir : build 후 어떤 특정 폴더를 배포할지 설정. 나는 vue build 시 dist 폴더 안에 파일이 생성되므로 dist를 적어줬다."}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"여기까지 해보고 git push해서 성공하나 확인해보는 게 좋다. 만약 성공하면 S3 버킷에 새 파일이 올라온 것을 확인할 수 있다. 이제 AWS CloudFront 를 통해 CDN 되어있는 페이지를 무효화 시키고 새 캐싱을 진행할 것임."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"br","properties":{},"children":[]},{"type":"text","value":"\n"},{"type":"element","tagName":"br","properties":{},"children":[]},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{"id":"CloudFront-배포-설정","style":"position:relative;"},"children":[{"type":"text","value":"CloudFront 배포 설정"},{"type":"element","tagName":"a","properties":{"href":"#CloudFront-%EB%B0%B0%ED%8F%AC-%EC%84%A4%EC%A0%95","ariaLabel":"CloudFront 배포 설정 permalink","className":["auto-link","after"]},"children":[{"type":"element","tagName":"svg","properties":{"viewBox":"0 0 16 16","width":"16","height":"16"},"children":[{"type":"element","tagName":"path","properties":{"fillRule":"evenodd","d":"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"},"children":[]}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"위에서 설정한 S3를 오리진으로 CloudFront 배포를 설정해 줄 것이다. "},{"type":"element","tagName":"a","properties":{"href":"https://docs.aws.amazon.com/ko_kr/AmazonCloudFront/latest/DeveloperGuide/private-content-restricting-access-to-s3.html#private-content-creating-oai","target":"_blank","rel":["nofollow"]},"children":[{"type":"text","value":"aws 원본 액세스 ID를 배포에 추가"}]},{"type":"text","value":" 여길 보고 따라 하면 된다. OAI를 설정해 주었다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"hr","properties":{},"children":[]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"📌 CloudFront 콘솔을 사용하여 CloudFront OAI를 생성하려면"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"ol","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"AWS Management Console에 로그인하여 "},{"type":"element","tagName":"a","properties":{"href":"https://console.aws.amazon.com/cloudfront/%EC%97%90%EC%84%9C","target":"_blank","rel":["nofollow"]},"children":[{"type":"text","value":"https://console.aws.amazon.com/cloudfront/에서"}]},{"type":"text","value":" CloudFront 콘솔을 엽니다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"S3 오리진이 있는 배포의 ID를 선택합니다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"Origins and Origin Groups(오리진 및 오리진 그룹)"}]},{"type":"text","value":" 탭을 선택합니다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"오리진 옆의 확인란을 선택한 다음 **Edit(편집)**을 선택합니다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"**Restrict Bucket Access(버킷 액세스 제한)**에서 "},{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"예"}]},{"type":"text","value":"를 선택합니다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"사용할 OAI가 이미 있는 경우 **Use an Existing Identity(기존 자격 증명 사용)**를 선택합니다. 그런 다음 "},{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"Your Identities(사용자 자격 증명)"}]},{"type":"text","value":" 목록에서 OAI를 선택합니다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"CloudFront가 **오리진 도메인 이름(Origin Domain Name)**에 지정된 Amazon S3 버킷의 파일에 대한 읽기 권한을 자동으로 OAI에 부여하도록 하려면 **예, 버킷 정책을 업데이트합니다.(Yes, Update Bucket Policy)**를 선택합니다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"예, 편집합니다"}]},{"type":"text","value":"를 선택합니다."}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"OAI를 생성했다면, Amazon S3 버킷 정책 사용 해주면 되는데 나는 기존에 해두었으므로 패스. 위의 url에 자세하게 나와있다. 따라하면 됨."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"hr","properties":{},"children":[]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"이제, .travis.yml 파일을 수정해 주자."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"yaml"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-yaml"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-yaml"]},"children":[{"type":"text","value":"("},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"..."}]},{"type":"text","value":")\n"},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"before_deploy"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":"\n  "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":" npm install "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"g travis"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"ci"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"cloudfront"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"invalidation\n\n"},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"after_deploy"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":"\n  "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":" aws configure set preview.cloudfront true\n  "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":" travis"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"ci"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"cloudfront"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"invalidation "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"a $AWS_ACCESS_KEY "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"s $AWS_SECRET_KEY "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"c $AWS_CLOUDFRONT_DIST_ID "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"i '/"},{"type":"element","tagName":"span","properties":{"className":["token","important"]},"children":[{"type":"text","value":"*'"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"b $TRAVIS_BRANCH "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"p $TRAVIS_PULL_REQUEST "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"o 'master'"}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"이렇게 설정해 주었다. S3에 매번 올린 후 cloudfront에서 매번 다시 캐싱 해줄 필요 없이 위 명령어로 travis가 알아서 해준다. 여기서 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"travis-ci-cloudfront-invalidation"}]},{"type":"text","value":" 라는 패키지를 travis 상에 설치 후, 제일 아래에 있는 명령어로 진행하는 것이다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"$AWS_ACCESS_KEY, $AWS_SECRET_KEY는 기존 travis에 설정된 대로 들어갈 것이고, "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"$AWS_CLOUDFRONT_DIST_ID"}]},{"type":"text","value":" 는 travis의 환경 변수 설정에서 직접 입력해 주자. aws의 cloudfront 페이지에 가장 먼저 id가 나와있다. 나머지는 필요 없다. 다만 위의 yml에 적여 있어야 한다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"이제 git push 해주면,"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-wrapper"],"style":"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 934px; "},"children":[{"type":"text","value":"\n      "},{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-background-image"],"style":"padding-bottom: 29.2%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAAsTAAALEwEAmpwYAAABQUlEQVR42jVR2U7DMBDM/38FDzwh/gCJShWIB4SgVKiAczhpGtu5k6ZNnKPDxiWWRrs7Hq93bCutOySVRtP2uFwmjONI8YJpmgyWfI5LPo4Tzl0P3V+185lFY6UyRH+uEIsQvu+Dc444jiGEMHWe54ab6yiKTJ6kObbfLmx+oP3C6LXWpql19/CG+9UGq9cdHPYLxhhsl8P2JZwwwT4UcB0bnuvCJTiOA+55UEqirioUZWkaLcu6XXPcrDw8bhWOVYGSBEVRoDmdydJsa4AmS3oYrrXu0LUtuq7DQNxAXEt5S9wMK44CcLZDtOd0q4KQgiCNvWi26XOwzTtC9gMRBFeOIIQ09j2aVkr1/yQClspKJFmOvKxQHxtkVQNVNohn5DWSry3cl2ewpzXizw/6wBNUcTRxrzIwHsI7KAINkZb4A9rAwZ82inDSAAAAAElFTkSuQmCC'); background-size: cover; display: block;"},"children":[]},{"type":"text","value":"\n  "},{"type":"element","tagName":"img","properties":{"className":["gatsby-resp-image-image"],"alt":"aws-cache-invalidation","title":"","src":"/static/27a660a09eef9344d4f6c8aceac5d8de/e7956/aws-cache-invalidation.png","srcSet":["/static/27a660a09eef9344d4f6c8aceac5d8de/0eb09/aws-cache-invalidation.png 500w","/static/27a660a09eef9344d4f6c8aceac5d8de/e7956/aws-cache-invalidation.png 934w"],"sizes":"(max-width: 934px) 100vw, 934px","style":"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;","loading":"lazy","decoding":"async"},"children":[]},{"type":"text","value":"\n    "}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"요런식으로 도는걸 볼 수 있다. 완료!!"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":".travis.yml 완성본"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"yaml"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-yaml"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-yaml"]},"children":[{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"language"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" node_js\n\n"},{"type":"element","tagName":"span","properties":{"className":["token","comment"]},"children":[{"type":"text","value":"# nodeJS 버전"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"node_js"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":"\n  "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":" 14.16.0\n\n"},{"type":"element","tagName":"span","properties":{"className":["token","comment"]},"children":[{"type":"text","value":"# Git Commit 수신 허용 목록 master 브랜치만."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"branches"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":"\n  "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"only"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":" master\n\n"},{"type":"element","tagName":"span","properties":{"className":["token","comment"]},"children":[{"type":"text","value":"# Travis CI 에서 node_modules를 캐싱한다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["token","comment"]},"children":[{"type":"text","value":"# 빌드 프로세스 속도를 높여줌."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"cache"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":"\n  "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"directories"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":" node_modules\n\n"},{"type":"element","tagName":"span","properties":{"className":["token","comment"]},"children":[{"type":"text","value":"# Travis 서버에서 빌드 명령어"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"script"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" npm run build\n\n"},{"type":"element","tagName":"span","properties":{"className":["token","comment"]},"children":[{"type":"text","value":"# .env.production 파일 인코딩했던 것을 디코딩해서 만들어줌."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"before_install"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":"\n  "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":" openssl aes"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"256"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"cbc "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"K "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"["}]},{"type":"text","value":"$encrypted_key"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"..."}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"]"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"iv "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"["}]},{"type":"text","value":"$encrypted_iv"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"..."}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"]"}]},{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"in .env.production.enc "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"out .env.production "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"d\n\n"},{"type":"element","tagName":"span","properties":{"className":["token","comment"]},"children":[{"type":"text","value":"# AWS CloudFront 캐싱을 위해 설치."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"before_deploy"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":"\n  "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":" npm install "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"g travis"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"ci"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"cloudfront"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"invalidation\n\n"},{"type":"element","tagName":"span","properties":{"className":["token","comment"]},"children":[{"type":"text","value":"# build후 배포 대상"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"deploy"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":"\n  "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"provider"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" s3\n  "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"access_key_id"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" $AWS_ACCESS_KEY\n  "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"secret_access_key"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" $AWS_SECRET_KEY\n  "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"bucket"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" tripllo.tech\n  "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"skip_cleanup"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","boolean","important"]},"children":[{"type":"text","value":"true"}]},{"type":"text","value":"\n  "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"acl"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" public_read\n  "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"region"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" ap"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"northeast"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"element","tagName":"span","properties":{"className":["token","number"]},"children":[{"type":"text","value":"2"}]},{"type":"text","value":"\n  "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"wait-until-deploy"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","boolean","important"]},"children":[{"type":"text","value":"true"}]},{"type":"text","value":"\n  "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"local_dir"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" dist\n\n"},{"type":"element","tagName":"span","properties":{"className":["token","comment"]},"children":[{"type":"text","value":"# 배포 완료 후 AWS CloudFront의 캐시를 무효화."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"after_deploy"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":"\n  "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":" aws configure set preview.cloudfront true\n  "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":" travis"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"ci"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"cloudfront"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"invalidation "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"a $AWS_ACCESS_KEY "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"s $AWS_SECRET_KEY "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"c $AWS_CLOUDFRONT_DIST_ID "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"i '/"},{"type":"element","tagName":"span","properties":{"className":["token","important"]},"children":[{"type":"text","value":"*'"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"b $TRAVIS_BRANCH "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"p $TRAVIS_PULL_REQUEST "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"o 'master'\n\n"},{"type":"element","tagName":"span","properties":{"className":["token","comment"]},"children":[{"type":"text","value":"# 빌드 후 알림"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"notifications"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":"\n  "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"email"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"recipients"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":"\n      "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":" pozafly@kakao.com"}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"아쉬운 점은 npm 모듈을 사용하지 않고 CloudFront 설정을 할 수 있을텐데 하지 못했다. "},{"type":"element","tagName":"a","properties":{"href":"https://medium.com/lunit/travis-ci%EB%A1%9C-aws-s3%EC%97%90-spa-%EB%B0%B0%ED%8F%AC%ED%95%98%EA%B8%B0-c081e25335b5","target":"_blank","rel":["nofollow"]},"children":[{"type":"text","value":"여기1"}]},{"type":"text","value":", "},{"type":"element","tagName":"a","properties":{"href":"https://renzolucioni.com/s3-deployment-with-travis/","target":"_blank","rel":["nofollow"]},"children":[{"type":"text","value":"여기2"}]},{"type":"text","value":", "},{"type":"element","tagName":"a","properties":{"href":"https://github.com/CircleCI-Public/aws-cli-orb/issues/24","target":"_blank","rel":["nofollow"]},"children":[{"type":"text","value":"여기3"}]},{"type":"text","value":" 를 보면서 연구했는데 잘 안됐다…"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"br","properties":{},"children":[]},{"type":"text","value":"\n"},{"type":"element","tagName":"blockquote","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"프로젝트 구경하기 -> "},{"type":"element","tagName":"a","properties":{"href":"https://tripllo.tech","target":"_blank","rel":["nofollow"]},"children":[{"type":"text","value":"Tripllo_메인"}]},{"type":"text","value":", "},{"type":"element","tagName":"a","properties":{"href":"https://github.com/pozafly/tripllo_vue","target":"_blank","rel":["nofollow"]},"children":[{"type":"text","value":"Vue_Github"}]},{"type":"text","value":", "},{"type":"element","tagName":"a","properties":{"href":"https://github.com/pozafly/tripllo_springBoot","target":"_blank","rel":["nofollow"]},"children":[{"type":"text","value":"SpringBoot_Github"}]}]},{"type":"text","value":"\n"}]}],"data":{"quirksMode":false}},"excerpt":"Travis CI에 대해서 알아보자. 우선 Travis 공식 Docs를 보고 따라 해봤다. 참고 자료는 이동욱 님의 스프링 부트와 AWS로 혼자 구현하는 웹 서비스 책을 참고했다. 우선 travis endpoint에 대해 알아야 한다. travis…","fields":{"readingTime":{"text":"9 min read"}},"frontmatter":{"title":"(10) Frontend -travis 배포 자동화","userDate":"6 April 2021","date":"2021-04-06T17:13:47.149Z","tags":["Tripllo 제작기","DevOps","Automation"],"excerpt":"Vue프로젝트를 aws의 S3와 CloudFront에 Travis CI를 통해 배포 자동화를 해보자.","photoAuthor":null,"photoVender":null,"image":{"childImageSharp":{"gatsbyImageData":{"layout":"fullWidth","placeholder":{"fallback":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAsTAAALEwEAmpwYAAAFYklEQVR42m2Ua0xTZxjHj8m2D2aZyzJFky26eR0gt1NoT0sLVHqjpS0F2tL7aaH3C7S0IBS5iOAF5KYCc4KyzUuYc8liFrNsLrt8cJsmLpvoh/nBTd2iZskSXYT2/HcqM5nZnuTJ857z/J/f+ee8eV+CeDZWgMCKzCI/nxQk+Ly5EyL+zXkhtXRWxE+9J+Lf2sXnzxcXFcsyGrB6Yjn/N5Yb68iVXi41dUEsxC1ZBRZkZViQZ2r5k/qzrJz5prIMER5vnthCvvrM7DPOkHlJrkwUU+dvSitwVypMneCSqXiig9k/Oo7hkTG09w0wB0up1K8SwdIdmRg9JfxLRFbemv9AL3aXPZepESlv9IqtDLdDgsVvfTwcqS3CbECK0WQYY/1JTPkkmDZy8ZmLizsRweJPtAjJKt7pfzOI7rLlxRaSJ/gixk9d7eIzN/v5zFkWOKXLw5+d2ZjrsGG0qxn327fhZEM+ZhwluDPAx5VOKvXdzlLIKri6DMPtJp//x2P2C1EVd36hnY8JA5k6YihEWFmEcXMBrg+QmN6XxPShCVzq5eCUrxAeRRGOWkiM6DnpH9so9GiKvyKITS89Qa3ZzHlznBZcvz0lx9VZZfrkiAK/X6YxPbQD+7rzcHqGRDRmYdONdw6XYGJvHiYGhfjlsgsX5jS4OKli7r2rwtue0t9IkiwiysuFtde/pLH4IJD++vNaTE6o8NEHRsxOqzE5IsexQypMHazE4WExjk9WY3pMgdmpapw7Y8Dxoxp8fFaDxw98S3d/cMNuEgcIgUigODdvxvszHuZAXysGd7ehvyuGibE4+nub4G7RoDFZA5dfDY9Lia5OG8bHoti9O4bevjj2DiQwMxVKfXjGCo2uzEFkZWWtqdMqb7f19qGmm2bkznpU91pQZzDBZvEgGIkj2MxmMIZQOA6fJwKnmYbX5oDP6kBNvYEJJHbCaLSmVq5aXZD5jS9K7TXXWnpaUWoQpoW6cijtUhhUKthrVPAYdLDpNLDVauDS18Bv0MJRrwPN9qKWetBaBeNudDLGkBPruTk+Ik9M7Re5lYhF44yjWo2QSQ9/nQ68cimMWg18pjrE423o6NwFv90CZ60a3AoZ9NUqJGgzfHot4s0taVmTARu5+Z1ErlxUtV0leNQcaUHQ05T21lcj0KCDTloJU5UU4UAA0aCfhZnRGm+HQ6tEjUQMd50GQdZto8nAZE4TR1uBrZV8DrFVw9te4JAueVhIW6ItHQ6G4Hc5EXTRaA6F0ByNod1lRA/rIBTwIxZrRbDRBb+TRtDrRVt7R7rJUJvi2GXI0YsqCJLctPF1U/9fQrU9rRQL//DSVibo9SDk9yPQSCNiYT9E69Hq0CNs0sLvsCDo87EwH8JuJ6OU7HiULbUubrDvRwElKiay2Vjrnk1lOY/e4+TnN0fN2sVuVx06HTr0sa4GA2YEG7Tw1qvR5zVhwNeATro20093NRogowqPrG6au7EuNI/cYhFFcHI4xRZvF6os4WOZLa9TKT4dbnFib9i+mHTVQ6V3QhI6AHnkAKSmMFqtOgyG7KnhZiec9dq77MgrElOwlw7vgaBAoCA0sshMzHqK3YTQWAa4dnPhW3ad6tZQhMYen+mxSedIGQwDjNG4j6mr8aaTjfrF4bA97dFrkF1Q0pCZqSq3dCds81DLoucJqdjZ1t54PvMw8vQ6e2NLbl6tXHKt12vGUNjK7HTQSFhd2Be0MoNBK8wa+cOcAtL2VC+tdHV2NH0ClSQwRHA4FVurxJ4FipIXZprsAV++glatf1lAUUmjSvq9R6+4z+ZDi1p2QywsPfHatrzcZa37iZbLLdugELuvUVQV/2/nSskgn/V1aQAAAABJRU5ErkJggg=="},"images":{"fallback":{"src":"/static/49f04b06d4009a791ea88d198934da29/2b5bd/main.png","srcSet":"/static/49f04b06d4009a791ea88d198934da29/c6eb5/main.png 500w,\n/static/49f04b06d4009a791ea88d198934da29/6be77/main.png 800w,\n/static/49f04b06d4009a791ea88d198934da29/2b5bd/main.png 1053w","sizes":"100vw"},"sources":[{"srcSet":"/static/49f04b06d4009a791ea88d198934da29/40982/main.avif 500w,\n/static/49f04b06d4009a791ea88d198934da29/772ad/main.avif 800w,\n/static/49f04b06d4009a791ea88d198934da29/5dcc9/main.avif 1053w","type":"image/avif","sizes":"100vw"},{"srcSet":"/static/49f04b06d4009a791ea88d198934da29/cc32c/main.webp 500w,\n/static/49f04b06d4009a791ea88d198934da29/f6714/main.webp 800w,\n/static/49f04b06d4009a791ea88d198934da29/76746/main.webp 1053w","type":"image/webp","sizes":"100vw"}]},"width":1,"height":1.0066476733143401}}},"author":[{"name":"Pozafly","bio":"Frontend Developer","avatar":{"childImageSharp":{"gatsbyImageData":{"layout":"fullWidth","backgroundColor":"#6808f8","images":{"fallback":{"src":"/static/8c061761f263c344f2c0416607c8adf1/73bb6/pozafly.jpg","srcSet":"/static/8c061761f263c344f2c0416607c8adf1/2f28c/pozafly.jpg 40w,\n/static/8c061761f263c344f2c0416607c8adf1/499f6/pozafly.jpg 80w,\n/static/8c061761f263c344f2c0416607c8adf1/73bb6/pozafly.jpg 120w","sizes":"100vw"},"sources":[{"srcSet":"/static/8c061761f263c344f2c0416607c8adf1/e73fe/pozafly.webp 40w,\n/static/8c061761f263c344f2c0416607c8adf1/61ca6/pozafly.webp 80w,\n/static/8c061761f263c344f2c0416607c8adf1/507b0/pozafly.webp 120w","type":"image/webp","sizes":"100vw"}]},"width":1,"height":1}}}}]}},"relatedPosts":{"totalCount":16,"edges":[{"node":{"id":"876234ac-98a2-5852-be6a-73f65e06581e","excerpt":"3주 전에, 정들었던 Tripllo 어플리케이션을 삭제했다. AWS EC2, S3, RDB를 내렸다. 배포되어있는 도메인도. 씁쓸하면서 이상한 기분이었다. RDB 생성 script를 백업하고, 소개 페이지에 올려둔 gif…","frontmatter":{"title":"Tripllo 삭제 및 일상 회고","date":"2021-12-04T15:13:47.149Z"},"fields":{"readingTime":{"text":"3 min read"},"slug":"/tripllo/tripllo-delete/"}}},{"node":{"id":"6da9e425-8ca8-5770-afca-029717545daa","excerpt":"참고1, 참고2, 참고3 개념 currying…","frontmatter":{"title":"(14) Closure & Currying 적용기","date":"2021-04-30T15:13:47.149Z"},"fields":{"readingTime":{"text":"4 min read"},"slug":"/tripllo/(14)Closure-Currying/"}}},{"node":{"id":"8bb96610-3d05-5612-95e9-6d58ed6ce9b8","excerpt":"Tripllo 프로젝트를 리팩토링하면서, vue 리팩토링1의  파트를 진행하게 되었다. 해당 부분을 상세하게 한번 보면서 생각할 부분을 정리해보자. store에서 걷어낸 몇 가지가 있는데 이번 비교는  라는 Todo…","frontmatter":{"title":"(13) Vuex-store와 EventBus에 대한 고찰","date":"2021-04-16T15:13:47.149Z"},"fields":{"readingTime":{"text":"6 min read"},"slug":"/tripllo/(13)Vuex-and-eventBus/"}}},{"node":{"id":"dcc0deb5-a1d7-5950-a9be-0913aacb6c7a","excerpt":"서비스 환경은 AWS의 EC2(Amazon linux2) + Nginx 조합으로 되어있습니다. *amazon linux2는 apt-get 패키지 관련 명령어 대신 yum 패키지 명령어를 사용합니다. Let’s Encrypt는 사용자에게 무료로 SSL…","frontmatter":{"title":"(12) Let's Encrypt 갱신 자동화","date":"2021-04-12T10:13:47.149Z"},"fields":{"readingTime":{"text":"5 min read"},"slug":"/tripllo/(12)aws-lets-encrypt-renewal-automation/"}}},{"node":{"id":"3ec007a9-422c-5f7c-9c9d-4f709fd6521c","excerpt":"Sentry Sentry는 Application Error Monitoring…","frontmatter":{"title":"(11) Sentry 에러 로깅 시스템 도입","date":"2021-04-09T17:13:47.149Z"},"fields":{"readingTime":{"text":"8 min read"},"slug":"/tripllo/(11)vue-sentry-error-monitoring-system/"}}}]}},"pageContext":{"slug":"/tripllo/(10)vue-travis-automation/","prev":{"excerpt":"Sentry Sentry는 Application Error Monitoring…","frontmatter":{"title":"(11) Sentry 에러 로깅 시스템 도입","tags":["Tripllo 제작기","Sentry","Error"],"date":"2021-04-09T17:13:47.149Z","draft":false,"photoAuthor":null,"photoVender":null,"excerpt":"Sentry를 통해 프론트엔드 에러 로깅 시스템을 도입해보자.","image":{"childImageSharp":{"gatsbyImageData":{"layout":"fullWidth","placeholder":{"fallback":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAAsTAAALEwEAmpwYAAABO0lEQVR42qVS30+CUBTm/996aW25xlzlzDRJRYapsfwFiZgFKrCh2FbykD20xdzc5WIHr96wt+rs7t6Pcz7O+e63y6z/EQw5giDAOCQ4DDdbSMCaJuna+znc0bcAhzT5A5CAMWQSQ2oNSbPGU8IAEQhFQlYrRPsGm0AISoh2iSZ780XypCCW276/hE+h1BxoplRTVcWoCJ2h4Qz6ViEvAUHkW1VRhjXSHducMRjjTKqSPhXyl3VgExVCqXV4kL7v6Pz1HZvgMilRU0cPmnnGlmBMVzESRzn/c8nYpnue5NljLndR5bL198WHNXbLxUbh6rZ+o/S6I3f6WhPl55nnTl6GuvM0sL35W783ju4M5Xy2BkqEYlNuP8IVIAtyyE5djNkeM4yQdrQ9Yyn4Lsdi6zZpFs/+7pH87YV9ATTiZEEewzCUAAAAAElFTkSuQmCC"},"images":{"fallback":{"src":"/static/bf7a9491463863772f181d36c58051fa/245fe/main.png","srcSet":"/static/bf7a9491463863772f181d36c58051fa/6f128/main.png 750w,\n/static/bf7a9491463863772f181d36c58051fa/245fe/main.png 900w","sizes":"100vw"},"sources":[{"srcSet":"/static/bf7a9491463863772f181d36c58051fa/fdac4/main.webp 750w,\n/static/bf7a9491463863772f181d36c58051fa/ff899/main.webp 900w","type":"image/webp","sizes":"100vw"}]},"width":1,"height":0.5555555555555556}}}},"fields":{"readingTime":{"text":"8 min read"},"layout":"post","slug":"/tripllo/(11)vue-sentry-error-monitoring-system/"}},"next":{"excerpt":"아래 내용은 인프런 멘토링에서 캡틴판교님께 멘토링 받으며 코드 리뷰를 해주신 부분에 대한 반영 내용입니다. 목차 props type plugin 폴더 정리 nextTick 없애기 & 대신 사용자 정의 디렉티브 연결 API 함수 에러 핸들링 API…","frontmatter":{"title":"(9) vue 리팩토링2","tags":["Tripllo 제작기","Refactoring","Vue.js"],"date":"2021-04-04T19:13:47.149Z","draft":false,"photoAuthor":null,"photoVender":null,"excerpt":"멘토링 후 Tripllo에 꽤 많은 것을 손봐야한다는 것을 알게 되었다. 하나하나 고쳐보면서 정리한 것을 기록해보자.","image":{"childImageSharp":{"gatsbyImageData":{"layout":"fullWidth","placeholder":{"fallback":"data:image/jpeg;base64,/9j/2wBDAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQH/2wBDAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQH/wgARCAAPABQDASIAAhEBAxEB/8QAFwAAAwEAAAAAAAAAAAAAAAAAAAUGCf/EABcBAAMBAAAAAAAAAAAAAAAAAAEEBQj/2gAMAwEAAhADEAAAAcraqOe7CrS4vHT/AP/EABoQAAMAAwEAAAAAAAAAAAAAAAIEBQADBgH/2gAIAQEAAQUCnym6hhyNsyaV3JsJUWpx7ehpbvc//8QAGhEAAgIDAAAAAAAAAAAAAAAAAREQ8EGBkf/aAAgBAwEBPwEvC3ReR//EACERAQACAgEDBQAAAAAAAAAAAAECEQMTEgQxQQUhQlFh/9oACAECAQE/Ach6jslqn0er4c8WbZH8nWYjL3ssYffHwl0ckWi0KF8oXKhbotrtb3f/xAAnEAACAgECBQMFAAAAAAAAAAABAgMREgQFABQhIjITMUEzUmGh0f/aAAgBAQAGPwIx6Tliyo8jcxrdHolCx45d+rnhW+8YKCXkp8AfTenRV2zKPyB33ZFq/ambcAjZe64s1i/taptLOEE2ncxyBJYpkDCj2ywu8Ug6+Ubsp+Dwz6R0RnwsvDDN9NsloTI4FH8dfm+lI0nJFkd5FI2/SL3PHHEbxjAIxiSgR5ZMbLNf86frj//EABsQAQEAAwEBAQAAAAAAAAAAAAERACFBMVGB/9oACAEBAAE/Ie19ZzzV6Chx4FRCGbosLBoYF5hA81pJCZonZnCmUPbR0aqsg6MYaSlgsfFTkpaxn4G1gAVuhAPgAHM//9oADAMBAAIAAwAAABC0H//EABwRAAICAgMAAAAAAAAAAAAAAAERIXExQVFhof/aAAgBAwEBPxCXRYzQw6ZwS5ABoMh7inu/OJ//xAAXEQEBAQEAAAAAAAAAAAAAAAABEQAh/9oACAECAQE/EIemq2BBCuVXJOw6JMCDZIWWsFcInHH/xAAYEAEBAQEBAAAAAAAAAAAAAAABEQAhMf/aAAgBAQABPxAPw26hesWYP60PMO7j7XQzNMVOoDy5FRohEDC2et/NuRiQCPlXZWS4DJEaZeMVQTQSRBayxhwABv/Z"},"images":{"fallback":{"src":"/static/55cb55c1713d209ce0e78d1522e0f7bf/d0b9c/main.jpg","srcSet":"/static/55cb55c1713d209ce0e78d1522e0f7bf/6c918/main.jpg 750w,\n/static/55cb55c1713d209ce0e78d1522e0f7bf/d0b9c/main.jpg 800w","sizes":"100vw"},"sources":[{"srcSet":"/static/55cb55c1713d209ce0e78d1522e0f7bf/66907/main.webp 750w,\n/static/55cb55c1713d209ce0e78d1522e0f7bf/0d27e/main.webp 800w","type":"image/webp","sizes":"100vw"}]},"width":1,"height":0.75}}}},"fields":{"readingTime":{"text":"14 min read"},"layout":"post","slug":"/tripllo/(9)vue-refactor2/"}},"primaryTag":"Tripllo 제작기"}},"staticQueryHashes":["1661920220"],"slicesMap":{}}