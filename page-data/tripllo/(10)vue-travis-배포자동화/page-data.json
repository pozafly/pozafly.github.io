{"componentChunkName":"component---src-templates-post-tsx","path":"/tripllo/(10)vue-travis-배포자동화/","result":{"data":{"logo":{"childImageSharp":{"fixed":{"base64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAIAAAAC64paAAAACXBIWXMAAAsTAAALEwEAmpwYAAACY0lEQVQ4y42UTUhUURTHz7kzFiN9aLsSK5JIGV2URREGBX2ppKGUptVMZYJ9OPPemzfjyloXSDsXtRD6oFVUIFGtTHARFoEgSiFkJRFWGBPavHfvP+6rbLIZ9XIWh8P98T/vvP+5FCVkjAgpi5TpJdnuUMZqO7kJQq3v/lHRH9e8XDysDEKEZ1bw+gKuiP0WV4uC28lJCOyky7nlwUDJxv10PcG6uDAcIWkRzvJ4gPKDTweKeu7kUeFFkTS8jhaE3YQPpXQst66qfgbVX7CkonwHxTtEBnGaQ9qMBnq2dOWqksHRAYmHwLpHfbki/7R4bf03uXRYTyXmRyFty0vYpgJcZ9pxww6WhZo2UW2HLzusGxbYTV3+DWu2v50akgAUlOxTKH017s9bfojuxVlfy6xsCOyjrqLu3isAXCk1DTjSBoo6b1bTDetf8TRlHyzCmUocTKqPjvJ0oeWBEUfu+aTatsAkREXGthkxQpWVuj2Z0sIKv470kmvvUzWhlE2IZIQNgXOEq2XKnfZk/8DKU09OqEur1QWCwVng84T+bpX8hs9j+Dr+NybH8D2J3k7VRjB8Wf6zIRALuIZfmjnSyHFNHdLQ4Rh+GQvIKMv5HBYjmHoxlKlXUk/I9IpRkiapWDaHGXolflSKW838IszDzTxYz49DPBzi0Spxt5XfHeeXTTxoppmcZh0SJxzm3rVib1CEN4v2oAiXiZYCsatYNBaLxgPcs1XYR7jPTjPprLJ+NFroQ4Smmvl5Aw/U8IOTPHyCh07xm1aeqOMnYR6x5lkMryVpkbIJcdKemf1s28vnbOVPfGtgRKO972EAAAAASUVORK5CYII=","width":400,"height":400,"src":"/static/8c061761f263c344f2c0416607c8adf1/3891b/pozafly.png","srcSet":"/static/8c061761f263c344f2c0416607c8adf1/3891b/pozafly.png 1x,\n/static/8c061761f263c344f2c0416607c8adf1/8c332/pozafly.png 1.5x,\n/static/8c061761f263c344f2c0416607c8adf1/bc8e0/pozafly.png 2x"}}},"markdownRemark":{"html":"<h1>Travis</h1>\n<p>Travis CI에 대해서 알아보자. 우선 <a href=\"https://docs.travis-ci.com/\">Travis 공식</a> Docs를 보고 따라해봤다. 참고 자료는 이동욱님의 스프링 부트와 AWS로 혼자 구현하는 웹 서비스 책을 참고했다.</p>\n<p>우선 travis endpoint에 대해 알아야 한다.</p>\n<ul>\n<li>\n<p>travis 엔드 포인트 —pro</p>\n<ul>\n<li>API 엔드 포인트 : <a href=\"https://api.travis-ci.com/\">https://api.travis-ci.com/</a></li>\n</ul>\n</li>\n<li>\n<p>travis 엔드 포인트</p>\n<ul>\n<li>API 엔드 포인트 : <a href=\"https://api.travis-ci.org/\">https://api.travis-ci.org/</a></li>\n</ul>\n</li>\n</ul>\n<p>차이점은, <code>--pro</code> 가 붙은 녀석은 <code>.com</code> 으로 연결되고, —pro 옵션이 없는 엔드포인트는 <code>.org</code> 로 연결된다는 것임.</p>\n<p>endpoint를 잘 설정해주어야지 오류가 나지 않는다. springboot를 travis로 빌드 자동화를 했을 때도 겪었었지만, .org 엔드포인트는 오류가 많고 잘 되지 않는 경우가 많다. 버전 차이인듯 싶다. 어쨌든 우리는 앞으로 <code>.com</code> 인 <code>--pro</code> 를 붙여 엔드포인트를 설정해줄 것이다.</p>\n<br/>\n<br/>\n<h2>Github repository 연동</h2>\n<p><a href=\"https://travis-ci.com/\">https://travis-ci.com/</a> 이곳에 먼저 들어가서 github ID로 로그인을 해주자. 우측 상단에 내 아이콘을 선택하고 Setting -> Repositories에 가면 무슨 프로젝트를 설정할 것인지 페이지가 나온다. 여기서 어떤 프로젝트를 CI 할 것인지 설정해줄 수 있다. Manage repositories on GitHub 을 클릭하고, github 페이지에 들어가면, </p>\n<p><img src=\"https://user-images.githubusercontent.com/59427983/113650888-f3ef3600-96cb-11eb-83a3-fe7d8b9849ad.png\" alt=\"스크린샷 2021-04-06 오전 11 33 19\"></p>\n<p>이곳에서 자신의 프로젝트를 선택해서 연동시킬 수 있다.</p>\n<br/>\n<br/>\n<h2>.travis.yml</h2>\n<p>후에, 자신의 프로젝트에 .travis.yml 파일을 만들자.</p>\n<deckgo-highlight-code yaml  terminal=\"carbon\" theme=\"material\"  highlight-lines=\"\">\n          <code slot=\"code\">language: node_js\nnode_js:\n- 14.16.0\nbranches:\n  only:\n  - master\ncache:\n  directories:\n  - node_modules\nscript: npm run build\nnotifications:\n  email:\n    recipients:\n    - pozafly@kakao.com</code>\n        </deckgo-highlight-code>\n<ul>\n<li>language : vue 프로젝트를 설정할 것이므로, language는 node_js 형태로 빌드한다. </li>\n<li>node_js : 버전은 자신이 설정한 것 대로 해주면 됨</li>\n<li>branches : master 브랜치에 push 되었을 때 자동으로 돌아가게 해줌.</li>\n<li>cache : 빌드시, node_modules가 계속 install 될 필요는 없으므로 해당 폴더를 캐시화 시켜주겠다는 말이다.</li>\n<li>script : 빌드 명령어</li>\n<li>notifications : CI가 완료되었을 때 결과를 noti 해준다. 내 메일 주소를 적었다.</li>\n</ul>\n<p>우선 기본 틀이다. 이제 이 파일을 작성했다면, master 브랜치에 push or merge후 push 할 때마다 travis가 알아서 프로젝트를 빌드해줄 것이다. push후 travis 페이지에 가보면 build log가 실시간으로 찍힌다.</p>\n<p>첫번째 에러가 났다.</p>\n<deckgo-highlight-code   terminal=\"carbon\" theme=\"material\"  highlight-lines=\"undefined\">\n          <code slot=\"code\">error  \nTemplate execution failed: ReferenceError: VUE_APP_GOOGLE_CLIENT_ID is not defined</code>\n        </deckgo-highlight-code>\n<p><code>VUE_APP_GOOGLE_CLINET_ID</code>  는 .env 파일에 있는데, 이걸 build 하지 못하는 이유는 .env 파일이 github에 올라가지 않아서다. 따라서 .env 파일을 travis 서버에서 인식하도록 할 필요가 있다. 방법은 3가지가 있다. <a href=\"https://docs.travis-ci.com/user/environment-variables/\">공식 페이지 환경변수</a> 이곳에 잘 설명되어 있다, </p>\n<table>\n<thead>\n<tr>\n<th align=\"center\">사용방법</th>\n<th align=\"center\">Github 오픈 여부</th>\n<th align=\"center\">암호화</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td align=\"center\">.travis.yml에서 공용 변수 정의</td>\n<td align=\"center\">O</td>\n<td align=\"center\">X</td>\n</tr>\n<tr>\n<td align=\"center\">.travis.yml에서 암호화 된 변수 정의</td>\n<td align=\"center\">O</td>\n<td align=\"center\">O</td>\n</tr>\n<tr>\n<td align=\"center\">리포지토리 설정에서 변수 정의</td>\n<td align=\"center\">X</td>\n<td align=\"center\">O</td>\n</tr>\n</tbody>\n</table>\n<p>이렇게 3가지 방법인데, 조금 더 자세히 알아보면,</p>\n<ol>\n<li><code>.travis.yml에서 공용 변수 정의</code> : 단순히 yml 파일에 공통 변수로 지정후 사용한다. 따라서 암호가 Github에도 노출되고, 암호화 되어있지 않다.</li>\n<li><code>.travis.yml에서 암호화 된 변수 정의</code> : 암호화 해서 .enc 파일을 프로젝트에 생성한다. 그리고, 이 암호화 된 파일이 travis 서버 상에 올라갈 때 복호화 되어 컴파일 된다. 따라서 .enc 파일은 github에도 올라가게 된다.</li>\n<li><code>리포지토리 설정에서 변수 정의</code> : 아예 traivs 홈페이지에서 환경변수를 만들고 값을 넣어주고, yml 파일에 해당 변수를 선언하면 값이 들어가는 형태이다. .enc 파일이 존재하지 않기 때문에 찌꺼기가 남지 않는다.</li>\n</ol>\n<p>나는 두번째 방법인 .travis.yml에서 secret 파일 암호화하는 방법을 사용하겠다. .enc 파일이라는 찌꺼기가 생기겠지만 괜찮다. 그리고 세번째 방법은 AWS 변수를 나중에 넣을 때 사용할 것이다.</p>\n<br/>\n<br/>\n<h2>.evn 파일을 AES256 이용하여 .env.enc 파일 생성하기</h2>\n<h3>CLC 설치 &#x26; login</h3>\n<p><a href=\"https://sanghye.tistory.com/42\">여기</a> 참고하였다. 먼저 로컬 컴퓨터에서 암호화 해 .enc 파일을 생성할 것이기 때문에 travis CLC가 필요하다.</p>\n<deckgo-highlight-code shell  terminal=\"carbon\" theme=\"material\"  highlight-lines=\"\">\n          <code slot=\"code\">$ gem install travis</code>\n        </deckgo-highlight-code>\n<p>만약 권한 오류가 난다면 sudo를 붙여주도록 하자. 이제 travis에 login을 해야 함.</p>\n<deckgo-highlight-code   terminal=\"carbon\" theme=\"material\"  highlight-lines=\"undefined\">\n          <code slot=\"code\">$ travis login --pro</code>\n        </deckgo-highlight-code>\n<p>—com, —org 옵션을 줄 수 있는데, pro를 붙여주자. 아니면 빌드시 오류 발생. org를 사용하고 있다면 org를 써도 된다. login을 할 때 Not Found 에러가 날 수 있다. <a href=\"https://github.com/pozafly/TIL/blob/main/%F0%9F%A7%A8%E1%84%8B%E1%85%A9%E1%84%85%E1%85%B2%E1%84%8B%E1%85%AA%E1%84%8B%E1%85%B4%20%E1%84%8C%E1%85%A9%E1%84%8B%E1%85%AE/travis/travis%20login%20Not%20Found.md\">travis login Not Found 오류 정리</a> 이곳에 정리해 뒀으니, github token으로 로그인 해주자.</p>\n<br/>\n<h3>endpoint 설정</h3>\n<p>우리는 pro로 설정했으니 endpoint를 잡아주자. endpoint를 잡아주지 않으면, 암호화를 진행할 때, <code>not logged in -try running travis login --org</code> 오류가 뜰 수 있다. <a href=\"https://github.com/travis-ci/travis-ci/issues/9668\">github issues</a> 이곳을 참고 했다.</p>\n<deckgo-highlight-code shell  terminal=\"carbon\" theme=\"material\"  highlight-lines=\"\">\n          <code slot=\"code\">$ travis endpoint --pro</code>\n        </deckgo-highlight-code>\n<br/>\n<h3>.env 파일 암호화</h3>\n<p>이제 암호화를 진행하자.</p>\n<deckgo-highlight-code shell  terminal=\"carbon\" theme=\"material\"  highlight-lines=\"\">\n          <code slot=\"code\">$ travis encrypt-file --pro [파일명]</code>\n        </deckgo-highlight-code>\n<p>—pro를 붙여주자. 붙여주지 않으면,</p>\n<p><img src=\"https://user-images.githubusercontent.com/59427983/113652592-04ed7680-96cf-11eb-9b43-f67b49341adc.png\" alt=\"스크린샷 2021-04-06 오전 11 55 25\"></p>\n<p>push후 build 때, <code>iv undefined</code> 오류가 계속 뜰 것임.</p>\n<p>그리고 —add 옵션을 붙여주면 .travis.yml 파일에 자동으로 <code>before_install</code> 란이 생기도록 할 수 있다. build 때 install 전에 암호화한 파일을 복호화 해서 travis가 알아먹을 수 있도록 해주는 작업이다. 따라서 최종적으로는</p>\n<deckgo-highlight-code shell  terminal=\"carbon\" theme=\"material\"  highlight-lines=\"\">\n          <code slot=\"code\">$ travis encrypt-file --pro .env.production --add</code>\n        </deckgo-highlight-code>\n<p>요렇게 해줬다. 그러면 <code>DANGER ZONE: Override existing .env.production.enc? |no|</code> 이런 문구가 뜰 것인데, yes 를 입력해주자. 그러면 .env 파일 밑에 .evn.enc 라는 파일이 생겼다. 암호화된 .env 파일이다.</p>\n<p>📌 .env 파일은 반드시 gitignore 처리. .env.enc 파일은 ignore 하면 안된다.</p>\n<br/>\n<h3>빌드 test</h3>\n<p>이제 암호화 된 파일이 생겼으니, 얘를 push 해서 build 해주자. 우선 travis 서버 상 build가 성공했으면 반은 성공한거임.</p>\n<br/>\n<br/>\n<h2>s3에 호스팅 되어있는 버킷에 빌드 파일 올리기</h2>\n<p>traivs 상에서 내 파일이 build 까지 완료되었다면, 이제 호스팅 되고 있는 public s3 버킷에 내 빌드 파일을 올려서 master 브랜치에 수정한 소스가 git push 될 때마다 자동으로 배포되도록 설정해보자. 단, 기존에 s3 조건이 설정되어 있어야 함. 아래와 같음.</p>\n<ul>\n<li>s3 버킷은 public 접근 가능함.</li>\n<li>버킷 정책 JSON이 설정되어 있을 것.</li>\n</ul>\n<br/>\n<h3>AWS IAM key 받기</h3>\n<p><a href=\"https://console.aws.amazon.com/iam/home?region=ap-northeast-2#/home\">IAM</a>에 사용자 탭 -> 사용자 추가 -> 이름 설정 -> AWS 액세스 유형은 <em>프로그래밍 방식 엑세스</em> 체크 -> 기존 정책 직접 연결 -> 정책 필터에 <em>s3full</em> 검색 후 AmazonS3FullAccess 체크. -> cloudfront 검색 후 CloudFrontFullAccess 체크 -> 태그 등록 -> 권한 최종 확인 후 생성이 완료 되면 엑세스 키와 비밀 엑세스 키가 생성된다.</p>\n<p>즉, IAM 에서는 <code>AmazonS3FullAccess</code>, <code>CloudFrontFullAccess</code> 두가지 권한이 필요한 것이다.</p>\n<br/>\n<h3>Travis CI에 키 등록</h3>\n<p>aws s3에 접근할 수 있는 엑세스키와 비밀키는 절대절대절대절대 github 에 올라가서는 안된다. 따라서 travis 상에 키를 등록해놓고 .traivs.yml에서 불러다 쓰는 형태로 진행해야한다. 이 방법이 아까 환경변수 설정 방법 3가지 중 3번째 방법을 사용하는 것이라 볼 수 있다. travis.com에 가서, Settings 화면에 가자. 해당 프로젝트 우측에 Settings 를 눌러서 key를 등록할 수 있다.</p>\n<p><img src=\"https://user-images.githubusercontent.com/59427983/113663278-b6e36d80-96e4-11eb-9379-723b135ce55a.png\" alt=\"스크린샷 2021-04-06 오후 2 29 49\"></p>\n<ul>\n<li>name  : AWS<em>ACCESS</em>KEY, AWS<em>SECRET</em>KEY 두개</li>\n<li>value : IAM에서 받은 엑세스키와 시크릿키</li>\n</ul>\n<p>이렇게 각각 등록해두면 된다. 그럼 이걸 .travis.yml 파일에서 변수로 가져올 수 있는 형태가 되는 것임.</p>\n<deckgo-highlight-code yaml  terminal=\"carbon\" theme=\"material\"  highlight-lines=\"\">\n          <code slot=\"code\">deploy:\n  provider: s3\n  access_key_id: $AWS_ACCESS_KEY   # 여기\n  secret_access_key: $AWS_SECRET_KEY  # 여기\n  bucket: [버킷명]\n  skip_cleanup: true\n  acl: public_read\n  region: ap-northeast-2\n  wait-until-deploy: true\n  local_dir: [vue라면 dist, react라면 build]</code>\n        </deckgo-highlight-code>\n<p>이런식으로. yml에 적어둔 것을 알아보자.</p>\n<ul>\n<li>provider : 배포 대상</li>\n<li>bucket : 내가 미리 생성해둔 public 접근 가능한 버킷.</li>\n<li>skip_cleanup : 공식 홈피에 따르면 빌드 중 이루어진 모든 변경 사항을 삭제하지 않게 함.</li>\n<li>acl : public 버킷이라 하더라도, 버킷에 올릴 때마다 파일을 일일이 public 객체로 바꿔주어야 하는데 이 옵션을 주면 자동으로 해줌. 하지만 aws cloudFront 설정을 따로 해줘야 한다. 자세한건 밑에 있다. 이렇게 적어주자.</li>\n<li>region : 버킷의 region</li>\n<li>wait-until-deploy : 배포 시, 기다려줌</li>\n<li>local_dir : build 후 어떤 특정 폴더를 배포할 지 설정. 나는 vue build 시 dist 폴더 안에 파일이 생성되므로 dist를 적어줬다.</li>\n</ul>\n<p>여기까지 해보고 git push해서 성공하나 확인해보는게 좋다. 만약 성공하면 S3 버킷에 새 파일이 올라온 것을 확인할 수 있다. 이제 AWS CloudFront 를 통해 CDN 되어있는 페이지를 무효화 시키고 새 캐싱을 진행할 것임.</p>\n<br/>\n<br/>\n<h2>CloudFront 배포 설정</h2>\n<p>위에서 설정한 S3를 오리진으로 CloudFront 배포를 설정해줄 것이다. <a href=\"https://docs.aws.amazon.com/ko_kr/AmazonCloudFront/latest/DeveloperGuide/private-content-restricting-access-to-s3.html#private-content-creating-oai\">aws 원본 액세스 ID를 배포에 추가</a> 여길 보고 따라하면 된다. OAI를 설정해주었다.</p>\n<hr>\n<p><strong>📌 CloudFront 콘솔을 사용하여 CloudFront OAI를 생성하려면</strong></p>\n<ol>\n<li>AWS Management Console에 로그인하여 <a href=\"https://console.aws.amazon.com/cloudfront/%EC%97%90%EC%84%9C\">https://console.aws.amazon.com/cloudfront/에서</a> CloudFront 콘솔을 엽니다.</li>\n<li>S3 오리진이 있는 배포의 ID를 선택합니다.</li>\n<li><strong>Origins and Origin Groups(오리진 및 오리진 그룹)</strong> 탭을 선택합니다.</li>\n<li>오리진 옆의 확인란을 선택한 다음 <strong>Edit(편집)</strong>을 선택합니다.</li>\n<li><strong>Restrict Bucket Access(버킷 액세스 제한)</strong>에서 <strong>예</strong>를 선택합니다.</li>\n<li>사용할 OAI가 이미 있는 경우 <strong>Use an Existing Identity(기존 자격 증명 사용)</strong>를 선택합니다. 그런 다음 <strong>Your Identities(사용자 자격 증명)</strong> 목록에서 OAI를 선택합니다.</li>\n<li>CloudFront가 <strong>오리진 도메인 이름(Origin Domain Name)</strong>에 지정된 Amazon S3 버킷의 파일에 대한 읽기 권한을 자동으로 OAI에 부여하도록 하려면 <strong>예, 버킷 정책을 업데이트합니다.(Yes, Update Bucket Policy)</strong>를 선택합니다.</li>\n<li><strong>예, 편집합니다</strong>를 선택합니다.</li>\n</ol>\n<p>OAI를 생성했다면, Amazon S3 버킷 정책 사용 해주면 되는데 나는 기존에 해두었으므로 패스. 위의 url에 자세하게 나와있다. 따라하면 됨.</p>\n<hr>\n<p>이제, .travis.yml 파일을 수정해주자.</p>\n<deckgo-highlight-code yaml  terminal=\"carbon\" theme=\"material\"  highlight-lines=\"\">\n          <code slot=\"code\">(...)\nbefore_deploy:\n  - npm install -g travis-ci-cloudfront-invalidation\n\nafter_deploy:\n  - aws configure set preview.cloudfront true\n  - travis-ci-cloudfront-invalidation -a $AWS_ACCESS_KEY -s $AWS_SECRET_KEY -c $AWS_CLOUDFRONT_DIST_ID -i &#39;/*&#39; -b $TRAVIS_BRANCH -p $TRAVIS_PULL_REQUEST -o &#39;master&#39;</code>\n        </deckgo-highlight-code>\n<p>이렇게 설정해주었다. S3에 매번 올린 후 cloudfront에서 매번 다시 캐싱 해줄 필요없이 위 명령어로 travis가 알아서 해준다. 여기서 <code>travis-ci-cloudfront-invalidation</code> 라는 패키지를 travis 상에 설치 후, 제일 아래에 있는 명령어로 진행하는 것이다. </p>\n<p>$AWS<em>ACCESS</em>KEY, $AWS<em>SECRET</em>KEY는 기존 travis에 설정된 대로 들어갈 것이고, <code>$AWS_CLOUDFRONT_DIST_ID</code> 는 travis의 환경변수 설정에서 직접 입력해주자. aws의 cloudfront 페이지에 가장 먼저 id가 나와있다. 나머지는 필요없다. 다만 위의 yml에 적여 있어야한다.</p>\n<p>이제 git push 해주면, </p>\n<p><img src=\"https://user-images.githubusercontent.com/59427983/113683817-94128280-96ff-11eb-9a7c-e45173c60c60.png\" alt=\"스크린샷 2021-04-06 오후 5 41 15\"></p>\n<p>요런식으로 도는걸 볼 수 있다. 완료!!</p>\n<p>.travis.yml 완성본</p>\n<deckgo-highlight-code yaml  terminal=\"carbon\" theme=\"material\"  highlight-lines=\"\">\n          <code slot=\"code\">language: node_js\n\n# nodeJS 버전\nnode_js:\n- 14.16.0\n\n# Git Commit 수신 허용 목록 master 브랜치만.\nbranches:\n  only:\n  - master\n\n# Travis CI 에서 node_modules를 캐싱한다.\n# 빌드 프로세스 속도를 높여줌.\ncache:\n  directories:\n  - node_modules\n\n# Travis 서버에서 빌드 명령어\nscript: npm run build\n\n# .env.production 파일 인코딩했던 것을 디코딩해서 만들어줌.\nbefore_install:\n- openssl aes-256-cbc -K [$encrypted_key...] -iv [$encrypted_iv...]\n  -in .env.production.enc -out .env.production -d\n\n# AWS CloudFront 캐싱을 위해 설치.\nbefore_deploy:\n  - npm install -g travis-ci-cloudfront-invalidation\n\n# build후 배포 대상\ndeploy:\n  provider: s3\n  access_key_id: $AWS_ACCESS_KEY\n  secret_access_key: $AWS_SECRET_KEY\n  bucket: tripllo.tech\n  skip_cleanup: true\n  acl: public_read\n  region: ap-northeast-2\n  wait-until-deploy: true\n  local_dir: dist\n\n# 배포 완료 후 AWS CloudFront의 캐시를 무효화.\nafter_deploy:\n  - aws configure set preview.cloudfront true\n  - travis-ci-cloudfront-invalidation -a $AWS_ACCESS_KEY -s $AWS_SECRET_KEY -c $AWS_CLOUDFRONT_DIST_ID -i &#39;/*&#39; -b $TRAVIS_BRANCH -p $TRAVIS_PULL_REQUEST -o &#39;master&#39;\n\n# 빌드 후 알림\nnotifications:\n  email:\n    recipients:\n    - pozafly@kakao.com</code>\n        </deckgo-highlight-code>\n<p>아쉬운 점은 npm모듈을 사용하지 않고 CloudFront 설정을 할 수 있을텐데 하지 못했다. <a href=\"https://medium.com/lunit/travis-ci%EB%A1%9C-aws-s3%EC%97%90-spa-%EB%B0%B0%ED%8F%AC%ED%95%98%EA%B8%B0-c081e25335b5\">여기1</a>, <a href=\"https://renzolucioni.com/s3-deployment-with-travis/\">여기2</a>, <a href=\"https://github.com/CircleCI-Public/aws-cli-orb/issues/24\">여기3</a> 를 보면서 연구했는데 잘 안됐다…</p>\n<br/>\n<blockquote>\n<p>프로젝트 구경하기 -> <a href=\"https://tripllo.tech\">Tripllo_메인</a>, <a href=\"https://github.com/pozafly/tripllo_vue\">Vue_Github</a>, <a href=\"https://github.com/pozafly/tripllo_springBoot\">SpringBoot_Github</a></p>\n</blockquote>","htmlAst":{"type":"root","children":[{"type":"element","tagName":"h1","properties":{},"children":[{"type":"text","value":"Travis"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Travis CI에 대해서 알아보자. 우선 "},{"type":"element","tagName":"a","properties":{"href":"https://docs.travis-ci.com/"},"children":[{"type":"text","value":"Travis 공식"}]},{"type":"text","value":" Docs를 보고 따라해봤다. 참고 자료는 이동욱님의 스프링 부트와 AWS로 혼자 구현하는 웹 서비스 책을 참고했다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"우선 travis endpoint에 대해 알아야 한다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"travis 엔드 포인트 —pro"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"API 엔드 포인트 : "},{"type":"element","tagName":"a","properties":{"href":"https://api.travis-ci.com/"},"children":[{"type":"text","value":"https://api.travis-ci.com/"}]}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"travis 엔드 포인트"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"API 엔드 포인트 : "},{"type":"element","tagName":"a","properties":{"href":"https://api.travis-ci.org/"},"children":[{"type":"text","value":"https://api.travis-ci.org/"}]}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"차이점은, "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"--pro"}]},{"type":"text","value":" 가 붙은 녀석은 "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":".com"}]},{"type":"text","value":" 으로 연결되고, —pro 옵션이 없는 엔드포인트는 "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":".org"}]},{"type":"text","value":" 로 연결된다는 것임."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"endpoint를 잘 설정해주어야지 오류가 나지 않는다. springboot를 travis로 빌드 자동화를 했을 때도 겪었었지만, .org 엔드포인트는 오류가 많고 잘 되지 않는 경우가 많다. 버전 차이인듯 싶다. 어쨌든 우리는 앞으로 "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":".com"}]},{"type":"text","value":" 인 "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"--pro"}]},{"type":"text","value":" 를 붙여 엔드포인트를 설정해줄 것이다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"br","properties":{},"children":[]},{"type":"text","value":"\n"},{"type":"element","tagName":"br","properties":{},"children":[]},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"text","value":"Github repository 연동"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"a","properties":{"href":"https://travis-ci.com/"},"children":[{"type":"text","value":"https://travis-ci.com/"}]},{"type":"text","value":" 이곳에 먼저 들어가서 github ID로 로그인을 해주자. 우측 상단에 내 아이콘을 선택하고 Setting -> Repositories에 가면 무슨 프로젝트를 설정할 것인지 페이지가 나온다. 여기서 어떤 프로젝트를 CI 할 것인지 설정해줄 수 있다. Manage repositories on GitHub 을 클릭하고, github 페이지에 들어가면, "}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"img","properties":{"src":"https://user-images.githubusercontent.com/59427983/113650888-f3ef3600-96cb-11eb-83a3-fe7d8b9849ad.png","alt":"스크린샷 2021-04-06 오전 11 33 19"},"children":[]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"이곳에서 자신의 프로젝트를 선택해서 연동시킬 수 있다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"br","properties":{},"children":[]},{"type":"text","value":"\n"},{"type":"element","tagName":"br","properties":{},"children":[]},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"text","value":".travis.yml"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"후에, 자신의 프로젝트에 .travis.yml 파일을 만들자."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"deckgo-highlight-code","properties":{"yaml":"","terminal":"carbon","theme":"material","highlight-lines":""},"children":[{"type":"text","value":"\n          "},{"type":"element","tagName":"code","properties":{"slot":"code"},"children":[{"type":"text","value":"language: node_js\nnode_js:\n- 14.16.0\nbranches:\n  only:\n  - master\ncache:\n  directories:\n  - node_modules\nscript: npm run build\nnotifications:\n  email:\n    recipients:\n    - pozafly@kakao.com"}]},{"type":"text","value":"\n        "}]},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"language : vue 프로젝트를 설정할 것이므로, language는 node_js 형태로 빌드한다. "}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"node_js : 버전은 자신이 설정한 것 대로 해주면 됨"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"branches : master 브랜치에 push 되었을 때 자동으로 돌아가게 해줌."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"cache : 빌드시, node_modules가 계속 install 될 필요는 없으므로 해당 폴더를 캐시화 시켜주겠다는 말이다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"script : 빌드 명령어"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"notifications : CI가 완료되었을 때 결과를 noti 해준다. 내 메일 주소를 적었다."}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"우선 기본 틀이다. 이제 이 파일을 작성했다면, master 브랜치에 push or merge후 push 할 때마다 travis가 알아서 프로젝트를 빌드해줄 것이다. push후 travis 페이지에 가보면 build log가 실시간으로 찍힌다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"첫번째 에러가 났다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"deckgo-highlight-code","properties":{"terminal":"carbon","theme":"material","highlight-lines":"undefined"},"children":[{"type":"text","value":"\n          "},{"type":"element","tagName":"code","properties":{"slot":"code"},"children":[{"type":"text","value":"error  \nTemplate execution failed: ReferenceError: VUE_APP_GOOGLE_CLIENT_ID is not defined"}]},{"type":"text","value":"\n        "}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"VUE_APP_GOOGLE_CLINET_ID"}]},{"type":"text","value":"  는 .env 파일에 있는데, 이걸 build 하지 못하는 이유는 .env 파일이 github에 올라가지 않아서다. 따라서 .env 파일을 travis 서버에서 인식하도록 할 필요가 있다. 방법은 3가지가 있다. "},{"type":"element","tagName":"a","properties":{"href":"https://docs.travis-ci.com/user/environment-variables/"},"children":[{"type":"text","value":"공식 페이지 환경변수"}]},{"type":"text","value":" 이곳에 잘 설명되어 있다, "}]},{"type":"text","value":"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n"},{"type":"element","tagName":"table","properties":{},"children":[{"type":"element","tagName":"thead","properties":{},"children":[{"type":"element","tagName":"tr","properties":{},"children":[{"type":"element","tagName":"th","properties":{"align":"center"},"children":[{"type":"text","value":"사용방법"}]},{"type":"element","tagName":"th","properties":{"align":"center"},"children":[{"type":"text","value":"Github 오픈 여부"}]},{"type":"element","tagName":"th","properties":{"align":"center"},"children":[{"type":"text","value":"암호화"}]}]}]},{"type":"element","tagName":"tbody","properties":{},"children":[{"type":"element","tagName":"tr","properties":{},"children":[{"type":"element","tagName":"td","properties":{"align":"center"},"children":[{"type":"text","value":".travis.yml에서 공용 변수 정의"}]},{"type":"element","tagName":"td","properties":{"align":"center"},"children":[{"type":"text","value":"O"}]},{"type":"element","tagName":"td","properties":{"align":"center"},"children":[{"type":"text","value":"X"}]}]},{"type":"element","tagName":"tr","properties":{},"children":[{"type":"element","tagName":"td","properties":{"align":"center"},"children":[{"type":"text","value":".travis.yml에서 암호화 된 변수 정의"}]},{"type":"element","tagName":"td","properties":{"align":"center"},"children":[{"type":"text","value":"O"}]},{"type":"element","tagName":"td","properties":{"align":"center"},"children":[{"type":"text","value":"O"}]}]},{"type":"element","tagName":"tr","properties":{},"children":[{"type":"element","tagName":"td","properties":{"align":"center"},"children":[{"type":"text","value":"리포지토리 설정에서 변수 정의"}]},{"type":"element","tagName":"td","properties":{"align":"center"},"children":[{"type":"text","value":"X"}]},{"type":"element","tagName":"td","properties":{"align":"center"},"children":[{"type":"text","value":"O"}]}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"이렇게 3가지 방법인데, 조금 더 자세히 알아보면,"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"ol","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":".travis.yml에서 공용 변수 정의"}]},{"type":"text","value":" : 단순히 yml 파일에 공통 변수로 지정후 사용한다. 따라서 암호가 Github에도 노출되고, 암호화 되어있지 않다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":".travis.yml에서 암호화 된 변수 정의"}]},{"type":"text","value":" : 암호화 해서 .enc 파일을 프로젝트에 생성한다. 그리고, 이 암호화 된 파일이 travis 서버 상에 올라갈 때 복호화 되어 컴파일 된다. 따라서 .enc 파일은 github에도 올라가게 된다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"리포지토리 설정에서 변수 정의"}]},{"type":"text","value":" : 아예 traivs 홈페이지에서 환경변수를 만들고 값을 넣어주고, yml 파일에 해당 변수를 선언하면 값이 들어가는 형태이다. .enc 파일이 존재하지 않기 때문에 찌꺼기가 남지 않는다."}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"나는 두번째 방법인 .travis.yml에서 secret 파일 암호화하는 방법을 사용하겠다. .enc 파일이라는 찌꺼기가 생기겠지만 괜찮다. 그리고 세번째 방법은 AWS 변수를 나중에 넣을 때 사용할 것이다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"br","properties":{},"children":[]},{"type":"text","value":"\n"},{"type":"element","tagName":"br","properties":{},"children":[]},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"text","value":".evn 파일을 AES256 이용하여 .env.enc 파일 생성하기"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h3","properties":{},"children":[{"type":"text","value":"CLC 설치 & login"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"a","properties":{"href":"https://sanghye.tistory.com/42"},"children":[{"type":"text","value":"여기"}]},{"type":"text","value":" 참고하였다. 먼저 로컬 컴퓨터에서 암호화 해 .enc 파일을 생성할 것이기 때문에 travis CLC가 필요하다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"deckgo-highlight-code","properties":{"shell":"","terminal":"carbon","theme":"material","highlight-lines":""},"children":[{"type":"text","value":"\n          "},{"type":"element","tagName":"code","properties":{"slot":"code"},"children":[{"type":"text","value":"$ gem install travis"}]},{"type":"text","value":"\n        "}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"만약 권한 오류가 난다면 sudo를 붙여주도록 하자. 이제 travis에 login을 해야 함."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"deckgo-highlight-code","properties":{"terminal":"carbon","theme":"material","highlight-lines":"undefined"},"children":[{"type":"text","value":"\n          "},{"type":"element","tagName":"code","properties":{"slot":"code"},"children":[{"type":"text","value":"$ travis login --pro"}]},{"type":"text","value":"\n        "}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"—com, —org 옵션을 줄 수 있는데, pro를 붙여주자. 아니면 빌드시 오류 발생. org를 사용하고 있다면 org를 써도 된다. login을 할 때 Not Found 에러가 날 수 있다. "},{"type":"element","tagName":"a","properties":{"href":"https://github.com/pozafly/TIL/blob/main/%F0%9F%A7%A8%E1%84%8B%E1%85%A9%E1%84%85%E1%85%B2%E1%84%8B%E1%85%AA%E1%84%8B%E1%85%B4%20%E1%84%8C%E1%85%A9%E1%84%8B%E1%85%AE/travis/travis%20login%20Not%20Found.md"},"children":[{"type":"text","value":"travis login Not Found 오류 정리"}]},{"type":"text","value":" 이곳에 정리해 뒀으니, github token으로 로그인 해주자."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"br","properties":{},"children":[]},{"type":"text","value":"\n"},{"type":"element","tagName":"h3","properties":{},"children":[{"type":"text","value":"endpoint 설정"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"우리는 pro로 설정했으니 endpoint를 잡아주자. endpoint를 잡아주지 않으면, 암호화를 진행할 때, "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"not logged in -try running travis login --org"}]},{"type":"text","value":" 오류가 뜰 수 있다. "},{"type":"element","tagName":"a","properties":{"href":"https://github.com/travis-ci/travis-ci/issues/9668"},"children":[{"type":"text","value":"github issues"}]},{"type":"text","value":" 이곳을 참고 했다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"deckgo-highlight-code","properties":{"shell":"","terminal":"carbon","theme":"material","highlight-lines":""},"children":[{"type":"text","value":"\n          "},{"type":"element","tagName":"code","properties":{"slot":"code"},"children":[{"type":"text","value":"$ travis endpoint --pro"}]},{"type":"text","value":"\n        "}]},{"type":"text","value":"\n"},{"type":"element","tagName":"br","properties":{},"children":[]},{"type":"text","value":"\n"},{"type":"element","tagName":"h3","properties":{},"children":[{"type":"text","value":".env 파일 암호화"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"이제 암호화를 진행하자."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"deckgo-highlight-code","properties":{"shell":"","terminal":"carbon","theme":"material","highlight-lines":""},"children":[{"type":"text","value":"\n          "},{"type":"element","tagName":"code","properties":{"slot":"code"},"children":[{"type":"text","value":"$ travis encrypt-file --pro [파일명]"}]},{"type":"text","value":"\n        "}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"—pro를 붙여주자. 붙여주지 않으면,"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"img","properties":{"src":"https://user-images.githubusercontent.com/59427983/113652592-04ed7680-96cf-11eb-9b43-f67b49341adc.png","alt":"스크린샷 2021-04-06 오전 11 55 25"},"children":[]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"push후 build 때, "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"iv undefined"}]},{"type":"text","value":" 오류가 계속 뜰 것임."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"그리고 —add 옵션을 붙여주면 .travis.yml 파일에 자동으로 "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"before_install"}]},{"type":"text","value":" 란이 생기도록 할 수 있다. build 때 install 전에 암호화한 파일을 복호화 해서 travis가 알아먹을 수 있도록 해주는 작업이다. 따라서 최종적으로는"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"deckgo-highlight-code","properties":{"shell":"","terminal":"carbon","theme":"material","highlight-lines":""},"children":[{"type":"text","value":"\n          "},{"type":"element","tagName":"code","properties":{"slot":"code"},"children":[{"type":"text","value":"$ travis encrypt-file --pro .env.production --add"}]},{"type":"text","value":"\n        "}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"요렇게 해줬다. 그러면 "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"DANGER ZONE: Override existing .env.production.enc? |no|"}]},{"type":"text","value":" 이런 문구가 뜰 것인데, yes 를 입력해주자. 그러면 .env 파일 밑에 .evn.enc 라는 파일이 생겼다. 암호화된 .env 파일이다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"📌 .env 파일은 반드시 gitignore 처리. .env.enc 파일은 ignore 하면 안된다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"br","properties":{},"children":[]},{"type":"text","value":"\n"},{"type":"element","tagName":"h3","properties":{},"children":[{"type":"text","value":"빌드 test"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"이제 암호화 된 파일이 생겼으니, 얘를 push 해서 build 해주자. 우선 travis 서버 상 build가 성공했으면 반은 성공한거임."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"br","properties":{},"children":[]},{"type":"text","value":"\n"},{"type":"element","tagName":"br","properties":{},"children":[]},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"text","value":"s3에 호스팅 되어있는 버킷에 빌드 파일 올리기"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"traivs 상에서 내 파일이 build 까지 완료되었다면, 이제 호스팅 되고 있는 public s3 버킷에 내 빌드 파일을 올려서 master 브랜치에 수정한 소스가 git push 될 때마다 자동으로 배포되도록 설정해보자. 단, 기존에 s3 조건이 설정되어 있어야 함. 아래와 같음."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"s3 버킷은 public 접근 가능함."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"버킷 정책 JSON이 설정되어 있을 것."}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"br","properties":{},"children":[]},{"type":"text","value":"\n"},{"type":"element","tagName":"h3","properties":{},"children":[{"type":"text","value":"AWS IAM key 받기"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"a","properties":{"href":"https://console.aws.amazon.com/iam/home?region=ap-northeast-2#/home"},"children":[{"type":"text","value":"IAM"}]},{"type":"text","value":"에 사용자 탭 -> 사용자 추가 -> 이름 설정 -> AWS 액세스 유형은 "},{"type":"element","tagName":"em","properties":{},"children":[{"type":"text","value":"프로그래밍 방식 엑세스"}]},{"type":"text","value":" 체크 -> 기존 정책 직접 연결 -> 정책 필터에 "},{"type":"element","tagName":"em","properties":{},"children":[{"type":"text","value":"s3full"}]},{"type":"text","value":" 검색 후 AmazonS3FullAccess 체크. -> cloudfront 검색 후 CloudFrontFullAccess 체크 -> 태그 등록 -> 권한 최종 확인 후 생성이 완료 되면 엑세스 키와 비밀 엑세스 키가 생성된다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"즉, IAM 에서는 "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"AmazonS3FullAccess"}]},{"type":"text","value":", "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"CloudFrontFullAccess"}]},{"type":"text","value":" 두가지 권한이 필요한 것이다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"br","properties":{},"children":[]},{"type":"text","value":"\n"},{"type":"element","tagName":"h3","properties":{},"children":[{"type":"text","value":"Travis CI에 키 등록"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"aws s3에 접근할 수 있는 엑세스키와 비밀키는 절대절대절대절대 github 에 올라가서는 안된다. 따라서 travis 상에 키를 등록해놓고 .traivs.yml에서 불러다 쓰는 형태로 진행해야한다. 이 방법이 아까 환경변수 설정 방법 3가지 중 3번째 방법을 사용하는 것이라 볼 수 있다. travis.com에 가서, Settings 화면에 가자. 해당 프로젝트 우측에 Settings 를 눌러서 key를 등록할 수 있다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"img","properties":{"src":"https://user-images.githubusercontent.com/59427983/113663278-b6e36d80-96e4-11eb-9379-723b135ce55a.png","alt":"스크린샷 2021-04-06 오후 2 29 49"},"children":[]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"name  : AWS"},{"type":"element","tagName":"em","properties":{},"children":[{"type":"text","value":"ACCESS"}]},{"type":"text","value":"KEY, AWS"},{"type":"element","tagName":"em","properties":{},"children":[{"type":"text","value":"SECRET"}]},{"type":"text","value":"KEY 두개"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"value : IAM에서 받은 엑세스키와 시크릿키"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"이렇게 각각 등록해두면 된다. 그럼 이걸 .travis.yml 파일에서 변수로 가져올 수 있는 형태가 되는 것임."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"deckgo-highlight-code","properties":{"yaml":"","terminal":"carbon","theme":"material","highlight-lines":""},"children":[{"type":"text","value":"\n          "},{"type":"element","tagName":"code","properties":{"slot":"code"},"children":[{"type":"text","value":"deploy:\n  provider: s3\n  access_key_id: $AWS_ACCESS_KEY   # 여기\n  secret_access_key: $AWS_SECRET_KEY  # 여기\n  bucket: [버킷명]\n  skip_cleanup: true\n  acl: public_read\n  region: ap-northeast-2\n  wait-until-deploy: true\n  local_dir: [vue라면 dist, react라면 build]"}]},{"type":"text","value":"\n        "}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"이런식으로. yml에 적어둔 것을 알아보자."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"provider : 배포 대상"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"bucket : 내가 미리 생성해둔 public 접근 가능한 버킷."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"skip_cleanup : 공식 홈피에 따르면 빌드 중 이루어진 모든 변경 사항을 삭제하지 않게 함."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"acl : public 버킷이라 하더라도, 버킷에 올릴 때마다 파일을 일일이 public 객체로 바꿔주어야 하는데 이 옵션을 주면 자동으로 해줌. 하지만 aws cloudFront 설정을 따로 해줘야 한다. 자세한건 밑에 있다. 이렇게 적어주자."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"region : 버킷의 region"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"wait-until-deploy : 배포 시, 기다려줌"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"local_dir : build 후 어떤 특정 폴더를 배포할 지 설정. 나는 vue build 시 dist 폴더 안에 파일이 생성되므로 dist를 적어줬다."}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"여기까지 해보고 git push해서 성공하나 확인해보는게 좋다. 만약 성공하면 S3 버킷에 새 파일이 올라온 것을 확인할 수 있다. 이제 AWS CloudFront 를 통해 CDN 되어있는 페이지를 무효화 시키고 새 캐싱을 진행할 것임."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"br","properties":{},"children":[]},{"type":"text","value":"\n"},{"type":"element","tagName":"br","properties":{},"children":[]},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"text","value":"CloudFront 배포 설정"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"위에서 설정한 S3를 오리진으로 CloudFront 배포를 설정해줄 것이다. "},{"type":"element","tagName":"a","properties":{"href":"https://docs.aws.amazon.com/ko_kr/AmazonCloudFront/latest/DeveloperGuide/private-content-restricting-access-to-s3.html#private-content-creating-oai"},"children":[{"type":"text","value":"aws 원본 액세스 ID를 배포에 추가"}]},{"type":"text","value":" 여길 보고 따라하면 된다. OAI를 설정해주었다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"hr","properties":{},"children":[]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"📌 CloudFront 콘솔을 사용하여 CloudFront OAI를 생성하려면"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"ol","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"AWS Management Console에 로그인하여 "},{"type":"element","tagName":"a","properties":{"href":"https://console.aws.amazon.com/cloudfront/%EC%97%90%EC%84%9C"},"children":[{"type":"text","value":"https://console.aws.amazon.com/cloudfront/에서"}]},{"type":"text","value":" CloudFront 콘솔을 엽니다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"S3 오리진이 있는 배포의 ID를 선택합니다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"Origins and Origin Groups(오리진 및 오리진 그룹)"}]},{"type":"text","value":" 탭을 선택합니다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"오리진 옆의 확인란을 선택한 다음 "},{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"Edit(편집)"}]},{"type":"text","value":"을 선택합니다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"Restrict Bucket Access(버킷 액세스 제한)"}]},{"type":"text","value":"에서 "},{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"예"}]},{"type":"text","value":"를 선택합니다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"사용할 OAI가 이미 있는 경우 "},{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"Use an Existing Identity(기존 자격 증명 사용)"}]},{"type":"text","value":"를 선택합니다. 그런 다음 "},{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"Your Identities(사용자 자격 증명)"}]},{"type":"text","value":" 목록에서 OAI를 선택합니다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"CloudFront가 "},{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"오리진 도메인 이름(Origin Domain Name)"}]},{"type":"text","value":"에 지정된 Amazon S3 버킷의 파일에 대한 읽기 권한을 자동으로 OAI에 부여하도록 하려면 "},{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"예, 버킷 정책을 업데이트합니다.(Yes, Update Bucket Policy)"}]},{"type":"text","value":"를 선택합니다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"예, 편집합니다"}]},{"type":"text","value":"를 선택합니다."}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"OAI를 생성했다면, Amazon S3 버킷 정책 사용 해주면 되는데 나는 기존에 해두었으므로 패스. 위의 url에 자세하게 나와있다. 따라하면 됨."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"hr","properties":{},"children":[]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"이제, .travis.yml 파일을 수정해주자."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"deckgo-highlight-code","properties":{"yaml":"","terminal":"carbon","theme":"material","highlight-lines":""},"children":[{"type":"text","value":"\n          "},{"type":"element","tagName":"code","properties":{"slot":"code"},"children":[{"type":"text","value":"(...)\nbefore_deploy:\n  - npm install -g travis-ci-cloudfront-invalidation\n\nafter_deploy:\n  - aws configure set preview.cloudfront true\n  - travis-ci-cloudfront-invalidation -a $AWS_ACCESS_KEY -s $AWS_SECRET_KEY -c $AWS_CLOUDFRONT_DIST_ID -i '/*' -b $TRAVIS_BRANCH -p $TRAVIS_PULL_REQUEST -o 'master'"}]},{"type":"text","value":"\n        "}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"이렇게 설정해주었다. S3에 매번 올린 후 cloudfront에서 매번 다시 캐싱 해줄 필요없이 위 명령어로 travis가 알아서 해준다. 여기서 "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"travis-ci-cloudfront-invalidation"}]},{"type":"text","value":" 라는 패키지를 travis 상에 설치 후, 제일 아래에 있는 명령어로 진행하는 것이다. "}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"$AWS"},{"type":"element","tagName":"em","properties":{},"children":[{"type":"text","value":"ACCESS"}]},{"type":"text","value":"KEY, $AWS"},{"type":"element","tagName":"em","properties":{},"children":[{"type":"text","value":"SECRET"}]},{"type":"text","value":"KEY는 기존 travis에 설정된 대로 들어갈 것이고, "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"$AWS_CLOUDFRONT_DIST_ID"}]},{"type":"text","value":" 는 travis의 환경변수 설정에서 직접 입력해주자. aws의 cloudfront 페이지에 가장 먼저 id가 나와있다. 나머지는 필요없다. 다만 위의 yml에 적여 있어야한다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"이제 git push 해주면, "}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"img","properties":{"src":"https://user-images.githubusercontent.com/59427983/113683817-94128280-96ff-11eb-9a7c-e45173c60c60.png","alt":"스크린샷 2021-04-06 오후 5 41 15"},"children":[]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"요런식으로 도는걸 볼 수 있다. 완료!!"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":".travis.yml 완성본"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"deckgo-highlight-code","properties":{"yaml":"","terminal":"carbon","theme":"material","highlight-lines":""},"children":[{"type":"text","value":"\n          "},{"type":"element","tagName":"code","properties":{"slot":"code"},"children":[{"type":"text","value":"language: node_js\n\n# nodeJS 버전\nnode_js:\n- 14.16.0\n\n# Git Commit 수신 허용 목록 master 브랜치만.\nbranches:\n  only:\n  - master\n\n# Travis CI 에서 node_modules를 캐싱한다.\n# 빌드 프로세스 속도를 높여줌.\ncache:\n  directories:\n  - node_modules\n\n# Travis 서버에서 빌드 명령어\nscript: npm run build\n\n# .env.production 파일 인코딩했던 것을 디코딩해서 만들어줌.\nbefore_install:\n- openssl aes-256-cbc -K [$encrypted_key...] -iv [$encrypted_iv...]\n  -in .env.production.enc -out .env.production -d\n\n# AWS CloudFront 캐싱을 위해 설치.\nbefore_deploy:\n  - npm install -g travis-ci-cloudfront-invalidation\n\n# build후 배포 대상\ndeploy:\n  provider: s3\n  access_key_id: $AWS_ACCESS_KEY\n  secret_access_key: $AWS_SECRET_KEY\n  bucket: tripllo.tech\n  skip_cleanup: true\n  acl: public_read\n  region: ap-northeast-2\n  wait-until-deploy: true\n  local_dir: dist\n\n# 배포 완료 후 AWS CloudFront의 캐시를 무효화.\nafter_deploy:\n  - aws configure set preview.cloudfront true\n  - travis-ci-cloudfront-invalidation -a $AWS_ACCESS_KEY -s $AWS_SECRET_KEY -c $AWS_CLOUDFRONT_DIST_ID -i '/*' -b $TRAVIS_BRANCH -p $TRAVIS_PULL_REQUEST -o 'master'\n\n# 빌드 후 알림\nnotifications:\n  email:\n    recipients:\n    - pozafly@kakao.com"}]},{"type":"text","value":"\n        "}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"아쉬운 점은 npm모듈을 사용하지 않고 CloudFront 설정을 할 수 있을텐데 하지 못했다. "},{"type":"element","tagName":"a","properties":{"href":"https://medium.com/lunit/travis-ci%EB%A1%9C-aws-s3%EC%97%90-spa-%EB%B0%B0%ED%8F%AC%ED%95%98%EA%B8%B0-c081e25335b5"},"children":[{"type":"text","value":"여기1"}]},{"type":"text","value":", "},{"type":"element","tagName":"a","properties":{"href":"https://renzolucioni.com/s3-deployment-with-travis/"},"children":[{"type":"text","value":"여기2"}]},{"type":"text","value":", "},{"type":"element","tagName":"a","properties":{"href":"https://github.com/CircleCI-Public/aws-cli-orb/issues/24"},"children":[{"type":"text","value":"여기3"}]},{"type":"text","value":" 를 보면서 연구했는데 잘 안됐다…"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"br","properties":{},"children":[]},{"type":"text","value":"\n"},{"type":"element","tagName":"blockquote","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"프로젝트 구경하기 -> "},{"type":"element","tagName":"a","properties":{"href":"https://tripllo.tech"},"children":[{"type":"text","value":"Tripllo_메인"}]},{"type":"text","value":", "},{"type":"element","tagName":"a","properties":{"href":"https://github.com/pozafly/tripllo_vue"},"children":[{"type":"text","value":"Vue_Github"}]},{"type":"text","value":", "},{"type":"element","tagName":"a","properties":{"href":"https://github.com/pozafly/tripllo_springBoot"},"children":[{"type":"text","value":"SpringBoot_Github"}]}]},{"type":"text","value":"\n"}]}],"data":{"quirksMode":false}},"excerpt":"Travis Travis CI에 대해서 알아보자. 우선 Travis 공식 Docs를 보고 따라해봤다. 참고 자료는 이동욱님의 스프링 부트와 AWS로 혼자 구현하는 웹 서비스 책을 참고했다. 우선 travis endpoint…","timeToRead":9,"frontmatter":{"title":"(10) Frontend -travis 배포 자동화","userDate":"6 April 2021","date":"2021-04-06T17:13:47.149Z","tags":["Tripllo 제작기"],"excerpt":"Vue프로젝트를 aws의 S3와 CloudFront에 Travis CI를 통해 배포 자동화를 해보자.","image":{"childImageSharp":{"fluid":{"base64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAsTAAALEwEAmpwYAAAFzUlEQVQ4yyWMeUyb9xnHn9B0/aOT0ims3dJClUFCCIkN2Ly8ry+MjTEGXnyf+AAb4wsbMDYmJCOEq02WQVIirpy9pHbVDm1qoh1/ZFPWtVmTRalUbZpULdsUdetW9Vo1Cv59J7NH+vzz/Xz0EBFRiucpwPGklzWX0aFGQthEKhnnWlAK13+kER6+qRG239QIW2+ohQcnFcIP6xqa2r8waIgqJHSkgSvTy5rJ0dRMO9cicKQ/0kz6+uayxyqbiCQN5RMK/vpNrRL3W5V416jFH0x63DPp8fv2FtxrVeKXWiWSPH+N6moeo70yqq3jymqqOZI2cES7KpvoyEFuFz0lJ9ojK5/jhPf/rFPjLwbl1qqK38pOzRXPLl9gp8+9wMa+O1Nc4eVb/zCqt+9pVSjIhV8RHX6USEJPPMPtIpIRUbmcsKwqw290dLKLv/5OQIF/5hSbNwc5tuaR41pcy86fGmeLk2n2UlzLVpyNeDvFs4cjis1bfgVGOppX78cV9Ouo8AhRPdExO7/bKG8knZp3vpUTcGdS2PrglMAuBZvYKy4J+3TyMNam0tiYHMBnx2qxYpGw16IcezDDs7uTQvHnwzwqpDxXVdVAfe3cbmpTckRU/c1Zi/zunSyH79ll2+u+Bgx2NLCXYlLcmZNh7YUlrC0usLvzjVgJS1labGQXgzJc8Mq3bo9wyHXIbhDt/tq3q2REimZO8eKQ+pOHVzvx1qWu4o83RHx4L8wWZzRYmpfgyoocmWE/Rkd9uLoqY2emj+LiOT0+fG+A/fSyiNsvmot/vdKJCzHVg4pD8u+Q06oZ/+OtEP7zUfKrGz8xY2XZzF5/xcUur4hYXTLh8gURa0sGrJ0zsKsrItbPd7Jr62b2xqturC2L7Bc/s2Hz4+TW2zd6odMq7GS1ayM/eNWLjeXU9nPTBTY3PcFmp/JYWszjxGQEfcMWhAp2BCI9LBruwYkTEbb4/Rybns7h1KkCm58tsCtr6eLqsgPNSr6VKp99strndHwxNjOF7uM+Zghb0X3SB4fVjb7QIDKjeaSHx5BJjyGTybF4NIWwN4B4IMBivX6YnY7i8MQkLFbnR0S0h6hmT4U55vl38tgQVBZVsdWlh9ljhKfHjH5bNwYcZvitPSVYxGFGwmVhQaedhW0ixgIu1m8xsVQqwXqibjwrO+yho+38y9qIiPxwfjvU3YXRXjciVguaNG0IWEQk/B4UJiYxcew4En7vziZXl1wP8v0+xJwWls/lmdLbhWpZfYhqRY2rsVuFfDbPkpH+YsLZg7jLwuzteubvNiI7OoZMtB/pSAhj2RyCYgdKLu40s7hDRKK/rzgyloOkW/np4R5dOdX0KlvkoQ6kPDaWGy8gk86wZHQA6cEoy2bHkB5KY2rAvcNQamjnacmVmlI7Pl5Ar8UESaB9q66LP0B1aqOywn8G6i7vl106zeepcACpWJQNxWMs1R9gWb8V+T4nsgE7hn0WpPr9/3elJhxkOrXqvwfENCr8Zz7nqp+qpBqhXfGtxMt40n/+fXVDXTYXsGE64tg60W/HfNzD5hI+lnCbUWI+2ctKW8lNRxzF8aANQmP98+WJ1z7eN7C+KX368X3Uouyw+Qcm0emO5j/43S1yi6b3nhsK4nQmtJkP2qB3J1nb8OIOBleMFUI2nM70fbWQCsAldt4HQD3BkUvB6HEcPSBpIqsxfzNmX4Goj+ZMrYNUVcdJ+6xdny0k/ZiJezd99oFtr3OBeZzzrNce3p5LeDfnk354xY4vK2uaZN7OWbIahjYSzosw6qLXSDSkzw4619HWEhq2m2Zof+3TVHFQInWY2v5UCNkxG/NgPBhEIRjEXNyD8ZAdlnbd3545KOH3VDxOZ9N/p25DZi3m3IBO44uRQhB5Y2vknVqJZK+0sYlaVJrdVbVSIvrG11WCcNzdafhtxGb8V9hm/MRparut5IU5emL/3v2HpKRWtj6qVTtJrbQeaW8Nv1tXL9v3P3pg31CCEke/AAAAAElFTkSuQmCC","aspectRatio":0.9935897435897436,"src":"/static/49f04b06d4009a791ea88d198934da29/37b1d/travis.png","srcSet":"/static/49f04b06d4009a791ea88d198934da29/b7cb4/travis.png 930w,\n/static/49f04b06d4009a791ea88d198934da29/37b1d/travis.png 1053w","sizes":"(max-width: 1053px) 100vw, 1053px"}}},"author":[{"id":"Pozafly","bio":"Frontend Developer","avatar":{"children":[{"fluid":{"base64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAIAAAAC64paAAAACXBIWXMAAAsTAAALEwEAmpwYAAACY0lEQVQ4y42UTUhUURTHz7kzFiN9aLsSK5JIGV2URREGBX2ppKGUptVMZYJ9OPPemzfjyloXSDsXtRD6oFVUIFGtTHARFoEgSiFkJRFWGBPavHfvP+6rbLIZ9XIWh8P98T/vvP+5FCVkjAgpi5TpJdnuUMZqO7kJQq3v/lHRH9e8XDysDEKEZ1bw+gKuiP0WV4uC28lJCOyky7nlwUDJxv10PcG6uDAcIWkRzvJ4gPKDTweKeu7kUeFFkTS8jhaE3YQPpXQst66qfgbVX7CkonwHxTtEBnGaQ9qMBnq2dOWqksHRAYmHwLpHfbki/7R4bf03uXRYTyXmRyFty0vYpgJcZ9pxww6WhZo2UW2HLzusGxbYTV3+DWu2v50akgAUlOxTKH017s9bfojuxVlfy6xsCOyjrqLu3isAXCk1DTjSBoo6b1bTDetf8TRlHyzCmUocTKqPjvJ0oeWBEUfu+aTatsAkREXGthkxQpWVuj2Z0sIKv470kmvvUzWhlE2IZIQNgXOEq2XKnfZk/8DKU09OqEur1QWCwVng84T+bpX8hs9j+Dr+NybH8D2J3k7VRjB8Wf6zIRALuIZfmjnSyHFNHdLQ4Rh+GQvIKMv5HBYjmHoxlKlXUk/I9IpRkiapWDaHGXolflSKW838IszDzTxYz49DPBzi0Spxt5XfHeeXTTxoppmcZh0SJxzm3rVib1CEN4v2oAiXiZYCsatYNBaLxgPcs1XYR7jPTjPprLJ+NFroQ4Smmvl5Aw/U8IOTPHyCh07xm1aeqOMnYR6x5lkMryVpkbIJcdKemf1s28vnbOVPfGtgRKO972EAAAAASUVORK5CYII=","aspectRatio":1,"src":"/static/8c061761f263c344f2c0416607c8adf1/bc8e0/pozafly.png","srcSet":"/static/8c061761f263c344f2c0416607c8adf1/22f7f/pozafly.png 40w,\n/static/8c061761f263c344f2c0416607c8adf1/587c9/pozafly.png 80w,\n/static/8c061761f263c344f2c0416607c8adf1/d966b/pozafly.png 120w,\n/static/8c061761f263c344f2c0416607c8adf1/bc8e0/pozafly.png 800w,\n/static/8c061761f263c344f2c0416607c8adf1/d4b30/pozafly.png 1242w","sizes":"(max-width: 800px) 100vw, 800px"}}]}}]}},"relatedPosts":{"totalCount":14,"edges":[{"node":{"id":"c9f3a9e3-9606-54bf-a146-a1c74e316873","timeToRead":4,"excerpt":"Vuex-store와 EventBus에 대한 고찰  Tripllo 프로젝트를 리팩토링 하면서, vue 리팩토링1의 6.store에 필요없는 state 제거 파트를 진행하게 되었다. 해당 부분을 상세하게 한번 보면서 생각할 부분을 정리해보자. store…","frontmatter":{"title":"(13) Vuex-store와 EventBus에 대한 고찰","date":"2021-04-16T15:13:47.149Z"},"fields":{"slug":"/tripllo/(13)Vuex와-eventBus/"}}},{"node":{"id":"22386461-5ea3-517d-9526-e3776dfafdc4","timeToRead":4,"excerpt":"Let’s Encrypt 갱신 자동화 서비스 환경은 AWS의 EC2(Amazon linux2) + Nginx 조합으로 되어있습니다. *amazon linux2는 apt-get 패키지 관련 명령어 대신 yum 패키지 명령어를 사용합니다. Let’s…","frontmatter":{"title":"(12) Let's Encrypt 갱신 자동화","date":"2021-04-12T10:13:47.149Z"},"fields":{"slug":"/tripllo/(12)AWS-Lets-Encrypt-갱신자동화/"}}},{"node":{"id":"30976f12-c2a0-55f0-ba7e-52cf8e9dd8dc","timeToRead":7,"excerpt":"Sentry Sentry는 Application Error Monitoring…","frontmatter":{"title":"(11) Sentry 에러 로깅 시스템 도입","date":"2021-04-09T17:13:47.149Z"},"fields":{"slug":"/tripllo/(11)vue-Sentry-에러로깅/"}}},{"node":{"id":"b5c2cc39-37c8-51b3-8891-b8e8930b383d","timeToRead":9,"excerpt":"Travis Travis CI에 대해서 알아보자. 우선 Travis 공식 Docs를 보고 따라해봤다. 참고 자료는 이동욱님의 스프링 부트와 AWS로 혼자 구현하는 웹 서비스 책을 참고했다. 우선 travis endpoint…","frontmatter":{"title":"(10) Frontend -travis 배포 자동화","date":"2021-04-06T17:13:47.149Z"},"fields":{"slug":"/tripllo/(10)vue-travis-배포자동화/"}}},{"node":{"id":"fa1948e0-fc12-5e87-b831-73fdfcbee970","timeToRead":9,"excerpt":"목차 props valid plugin 폴더 정리 nextTick 없애기 & 사용자 정의 디렉티브 연결 비동기 메서드 에러 핸들링 API 함수에 JSDoc으로 스펙 명세하기 API 함수 이름 구체화 및 API 접두사로 감싼 속성 제거하기 Travis…","frontmatter":{"title":"(9) vue 리팩토링2","date":"2021-04-04T19:13:47.149Z"},"fields":{"slug":"/tripllo/(9)vue-refactor2/"}}}]}},"pageContext":{"slug":"/tripllo/(10)vue-travis-배포자동화/","prev":{"excerpt":"목차 props valid plugin 폴더 정리 nextTick 없애기 & 사용자 정의 디렉티브 연결 비동기 메서드 에러 핸들링 API 함수에 JSDoc으로 스펙 명세하기 API 함수 이름 구체화 및 API 접두사로 감싼 속성 제거하기 Travis…","timeToRead":9,"frontmatter":{"title":"(9) vue 리팩토링2","tags":["Tripllo 제작기"],"date":"2021-04-04T19:13:47.149Z","draft":false,"excerpt":"멘토링 후 Tripllo에 꽤 많은 것을 손봐야한다는 것을 알게 되었다. 하나하나 고쳐보면서 정리한 것을 기록해보자.","image":{"childImageSharp":{"fluid":{"aspectRatio":1.3333333333333333,"base64":"data:image/jpeg;base64,/9j/2wBDAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQH/2wBDAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQH/wgARCAAPABQDASIAAhEBAxEB/8QAGAAAAgMAAAAAAAAAAAAAAAAAAAYEBQn/xAAXAQADAQAAAAAAAAAAAAAAAAACBAUI/9oADAMBAAIQAxAAAAHK5pTbzYVZYIA4X//EABkQAAMBAQEAAAAAAAAAAAAAAAIEBQMGAP/aAAgBAQABBQKdKcq6ByFwzZW2UYSoNTz06ClqXv/EABcRAAMBAAAAAAAAAAAAAAAAAAEQEUH/2gAIAQMBAT8BNyL/xAAhEQEAAQMDBQEAAAAAAAAAAAABEQISEwMxQQAEBSFCYf/aAAgBAgEBPwGs8jkqx19ni+L9LWyU/ldusU1cklnqGOEuguRYJQgXlC5gXYljaXfr/8QAJRAAAgEDAwQCAwAAAAAAAAAAAQIDBBESISIyBRMxMwAQFEFh/9oACAEBAAY/AjFRinZwrORPWUlGAExvuq5oVuctq3yezlQcGsUVOnZKUBB650VfZw3NXhCG85KxW2pIsbTUs4UTQP25AkscyBrA7ZYXeKQa8kdl/vxnpWRHfC5eCGb1tkuPeR8dfNuXhr6WVpDSMyO8in8Km5SIkbaBMbYxrYW5Xb9/X//EABoQAQADAQEBAAAAAAAAAAAAAAEAESExYYH/2gAIAQEAAT8h6wzU1GfKTA0ecFud73BXwGsLE6DQqKCggajhYYK+LJljgaG4gMCQdYGCrDqrDg6lz4GrQAFt4GB4T//aAAwDAQACAAMAAAAQZy//xAAdEQEAAgEFAQAAAAAAAAAAAAABESExAGFxgbHw/9oACAEDAQE/ELcBGUW+kzNGyzcHP3uv/8QAGBEBAQEBAQAAAAAAAAAAAAAAAREhMQD/2gAIAQIBAT8Q7/at2AkE3rtNj4IMKDJIUVsKuETFf//EABcQAQEBAQAAAAAAAAAAAAAAAAERADH/2gAIAQEAAT8QScuGK6uGBzHxN08iUXfSIPWejeokJMXjsqQBZ8Xpfz/0lgnwkDJ62aByYyMxlUA0JkQMqWABwN//2Q==","sizes":"(max-width: 800px) 100vw, 800px","src":"/static/55cb55c1713d209ce0e78d1522e0f7bf/2f1b1/refactor2.jpg","srcSet":"/static/55cb55c1713d209ce0e78d1522e0f7bf/f0719/refactor2.jpg 500w,\n/static/55cb55c1713d209ce0e78d1522e0f7bf/2f1b1/refactor2.jpg 800w"}}},"author":[{"id":"Pozafly","bio":"Frontend Developer","avatar":{"children":[{"fluid":{"aspectRatio":1,"base64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAIAAAAC64paAAAACXBIWXMAAAsTAAALEwEAmpwYAAACY0lEQVQ4y42UTUhUURTHz7kzFiN9aLsSK5JIGV2URREGBX2ppKGUptVMZYJ9OPPemzfjyloXSDsXtRD6oFVUIFGtTHARFoEgSiFkJRFWGBPavHfvP+6rbLIZ9XIWh8P98T/vvP+5FCVkjAgpi5TpJdnuUMZqO7kJQq3v/lHRH9e8XDysDEKEZ1bw+gKuiP0WV4uC28lJCOyky7nlwUDJxv10PcG6uDAcIWkRzvJ4gPKDTweKeu7kUeFFkTS8jhaE3YQPpXQst66qfgbVX7CkonwHxTtEBnGaQ9qMBnq2dOWqksHRAYmHwLpHfbki/7R4bf03uXRYTyXmRyFty0vYpgJcZ9pxww6WhZo2UW2HLzusGxbYTV3+DWu2v50akgAUlOxTKH017s9bfojuxVlfy6xsCOyjrqLu3isAXCk1DTjSBoo6b1bTDetf8TRlHyzCmUocTKqPjvJ0oeWBEUfu+aTatsAkREXGthkxQpWVuj2Z0sIKv470kmvvUzWhlE2IZIQNgXOEq2XKnfZk/8DKU09OqEur1QWCwVng84T+bpX8hs9j+Dr+NybH8D2J3k7VRjB8Wf6zIRALuIZfmjnSyHFNHdLQ4Rh+GQvIKMv5HBYjmHoxlKlXUk/I9IpRkiapWDaHGXolflSKW838IszDzTxYz49DPBzi0Spxt5XfHeeXTTxoppmcZh0SJxzm3rVib1CEN4v2oAiXiZYCsatYNBaLxgPcs1XYR7jPTjPprLJ+NFroQ4Smmvl5Aw/U8IOTPHyCh07xm1aeqOMnYR6x5lkMryVpkbIJcdKemf1s28vnbOVPfGtgRKO972EAAAAASUVORK5CYII=","sizes":"(max-width: 800px) 100vw, 800px","src":"/static/8c061761f263c344f2c0416607c8adf1/bc8e0/pozafly.png","srcSet":"/static/8c061761f263c344f2c0416607c8adf1/8ac63/pozafly.png 200w,\n/static/8c061761f263c344f2c0416607c8adf1/3891b/pozafly.png 400w,\n/static/8c061761f263c344f2c0416607c8adf1/bc8e0/pozafly.png 800w,\n/static/8c061761f263c344f2c0416607c8adf1/6050d/pozafly.png 1200w,\n/static/8c061761f263c344f2c0416607c8adf1/d4b30/pozafly.png 1242w"}}]}}]},"fields":{"layout":"post","slug":"/tripllo/(9)vue-refactor2/"}},"next":{"excerpt":"Sentry Sentry는 Application Error Monitoring…","timeToRead":7,"frontmatter":{"title":"(11) Sentry 에러 로깅 시스템 도입","tags":["Tripllo 제작기"],"date":"2021-04-09T17:13:47.149Z","draft":false,"excerpt":"Sentry를 통해 프론트엔드 에러 로깅 시스템을 도입해보자.","image":{"childImageSharp":{"fluid":{"aspectRatio":1.7985611510791366,"base64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAAsTAAALEwEAmpwYAAABRElEQVQoz6VS207CQBDt/z/44oMmagBFJXKTtqyUCFJuAQrl3hYSLKKChBifGsouO2ugkXJ5MXqyyU7m7JndPTMc+wc4Z6OUAsAOA2w7AeCuHfFG5gTbVeAHexkK1L1ZQoWebjrccrlcLDClYFlzSsF5F8aEYIIxsW3sHKOUrsSj4cR3wSfiecuaM8aioVRN0SRUKBdbwn2mofaUcidy94iEHB/NxPlsQsy36v2ebnKEkGtv3O8TQ4FkpdRmjOVkVYzJx0c3pUIT8VnfeSzgf1AVraEaVx7h0iPUFP38NGzbmGs1+36veHYSDt4mo8HUbPbVbQ+SqIj4bEoq1WvG2+tUTldHL5OhOTZ0U+sMxu8zQ3te/bla6fKRJzldlVBRKXemH58Hnu13aO05uIYd0LBxfu0NbGNTnXNput+V3w7J3ybsGxUVZVdbkFoQAAAAAElFTkSuQmCC","sizes":"(max-width: 900px) 100vw, 900px","src":"/static/bf7a9491463863772f181d36c58051fa/03620/sentry.png","srcSet":"/static/bf7a9491463863772f181d36c58051fa/53f65/sentry.png 500w,\n/static/bf7a9491463863772f181d36c58051fa/03620/sentry.png 900w"}}},"author":[{"id":"Pozafly","bio":"Frontend Developer","avatar":{"children":[{"fluid":{"aspectRatio":1,"base64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAIAAAAC64paAAAACXBIWXMAAAsTAAALEwEAmpwYAAACY0lEQVQ4y42UTUhUURTHz7kzFiN9aLsSK5JIGV2URREGBX2ppKGUptVMZYJ9OPPemzfjyloXSDsXtRD6oFVUIFGtTHARFoEgSiFkJRFWGBPavHfvP+6rbLIZ9XIWh8P98T/vvP+5FCVkjAgpi5TpJdnuUMZqO7kJQq3v/lHRH9e8XDysDEKEZ1bw+gKuiP0WV4uC28lJCOyky7nlwUDJxv10PcG6uDAcIWkRzvJ4gPKDTweKeu7kUeFFkTS8jhaE3YQPpXQst66qfgbVX7CkonwHxTtEBnGaQ9qMBnq2dOWqksHRAYmHwLpHfbki/7R4bf03uXRYTyXmRyFty0vYpgJcZ9pxww6WhZo2UW2HLzusGxbYTV3+DWu2v50akgAUlOxTKH017s9bfojuxVlfy6xsCOyjrqLu3isAXCk1DTjSBoo6b1bTDetf8TRlHyzCmUocTKqPjvJ0oeWBEUfu+aTatsAkREXGthkxQpWVuj2Z0sIKv470kmvvUzWhlE2IZIQNgXOEq2XKnfZk/8DKU09OqEur1QWCwVng84T+bpX8hs9j+Dr+NybH8D2J3k7VRjB8Wf6zIRALuIZfmjnSyHFNHdLQ4Rh+GQvIKMv5HBYjmHoxlKlXUk/I9IpRkiapWDaHGXolflSKW838IszDzTxYz49DPBzi0Spxt5XfHeeXTTxoppmcZh0SJxzm3rVib1CEN4v2oAiXiZYCsatYNBaLxgPcs1XYR7jPTjPprLJ+NFroQ4Smmvl5Aw/U8IOTPHyCh07xm1aeqOMnYR6x5lkMryVpkbIJcdKemf1s28vnbOVPfGtgRKO972EAAAAASUVORK5CYII=","sizes":"(max-width: 800px) 100vw, 800px","src":"/static/8c061761f263c344f2c0416607c8adf1/bc8e0/pozafly.png","srcSet":"/static/8c061761f263c344f2c0416607c8adf1/8ac63/pozafly.png 200w,\n/static/8c061761f263c344f2c0416607c8adf1/3891b/pozafly.png 400w,\n/static/8c061761f263c344f2c0416607c8adf1/bc8e0/pozafly.png 800w,\n/static/8c061761f263c344f2c0416607c8adf1/6050d/pozafly.png 1200w,\n/static/8c061761f263c344f2c0416607c8adf1/d4b30/pozafly.png 1242w"}}]}}]},"fields":{"layout":"post","slug":"/tripllo/(11)vue-Sentry-에러로깅/"}},"primaryTag":"Tripllo 제작기"}},"staticQueryHashes":["1917168614","4083712403"]}