<!DOCTYPE html><html lang="ko"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><meta name="generator" content="Gatsby 5.5.0"/><meta data-react-helmet="true" name="description" content="Spring Security와 JWT를 사용해서 로그인 기능을 구현했다. Spring Security의 구현된 소스와 login의 Service 단 내부 로직을 개념에 맞춰서 알아보자."/><meta data-react-helmet="true" property="og:site_name" content="Pozafly Blog"/><meta data-react-helmet="true" property="og:type" content="article"/><meta data-react-helmet="true" property="og:title" content="(5) 로그인2 -SpringBoot 구현"/><meta data-react-helmet="true" property="og:description" content="Spring Security와 JWT를 사용해서 로그인 기능을 구현했다. Spring Security의 구현된 소스와 login의 Service 단 내부 로직을 개념에 맞춰서 알아보자."/><meta data-react-helmet="true" property="og:url" content="https://pozafly.github.io/tripllo/(5)login2-SpringBoot/"/><meta data-react-helmet="true" property="og:image" content="https://pozafly.github.io/static/cf052c2134f0abd114c107d149d0dd49/0022d/main.png"/><meta data-react-helmet="true" property="article:published_time" content="2021-02-04T15:03:47.149Z"/><meta data-react-helmet="true" property="article:tag" content="Tripllo 제작기"/><meta data-react-helmet="true" property="article:publisher" content="https://www.instagram.com/pozafly_/"/><meta data-react-helmet="true" property="article:author" content="https://www.instagram.com/pozafly_/"/><meta data-react-helmet="true" name="github:card" content="summary_large_image"/><meta data-react-helmet="true" name="github:title" content="(5) 로그인2 -SpringBoot 구현"/><meta data-react-helmet="true" name="github:description" content="Spring Security와 JWT를 사용해서 로그인 기능을 구현했다. Spring Security의 구현된 소스와 login의 Service 단 내부 로직을 개념에 맞춰서 알아보자."/><meta data-react-helmet="true" name="github:url" content="https://pozafly.github.io/tripllo/(5)login2-SpringBoot/"/><meta data-react-helmet="true" name="github:image" content="https://pozafly.github.io/static/cf052c2134f0abd114c107d149d0dd49/0022d/main.png"/><meta data-react-helmet="true" name="github:label1" content="Written by"/><meta data-react-helmet="true" name="github:data1" content="Pozafly"/><meta data-react-helmet="true" name="github:label2" content="Filed under"/><meta data-react-helmet="true" name="github:data2" content="Tripllo 제작기"/><meta data-react-helmet="true" name="github:site" content="@pozafly"/><meta data-react-helmet="true" name="github:creator" content="@pozafly"/><meta data-react-helmet="true" property="og:image:width" content="1"/><meta data-react-helmet="true" property="og:image:height" content="0.75"/><link rel="sitemap" type="application/xml" href="/sitemap-index.xml"/><style>.gatsby-image-wrapper{position:relative;overflow:hidden}.gatsby-image-wrapper picture.object-fit-polyfill{position:static!important}.gatsby-image-wrapper img{bottom:0;height:100%;left:0;margin:0;max-width:none;padding:0;position:absolute;right:0;top:0;width:100%;object-fit:cover}.gatsby-image-wrapper [data-main-image]{opacity:0;transform:translateZ(0);transition:opacity .25s linear;will-change:opacity}.gatsby-image-wrapper-constrained{display:inline-block;vertical-align:top}</style><noscript><style>.gatsby-image-wrapper noscript [data-main-image]{opacity:1!important}.gatsby-image-wrapper [data-placeholder-image]{opacity:0!important}</style></noscript><script type="module">const e="undefined"!=typeof HTMLImageElement&&"loading"in HTMLImageElement.prototype;e&&document.body.addEventListener("load",(function(e){const t=e.target;if(void 0===t.dataset.mainImage)return;if(void 0===t.dataset.gatsbyImageSsr)return;let a=null,n=t;for(;null===a&&n;)void 0!==n.parentNode.dataset.gatsbyImageWrapper&&(a=n.parentNode),n=n.parentNode;const o=a.querySelector("[data-placeholder-image]"),r=new Image;r.src=t.currentSrc,r.decode().catch((()=>{})).then((()=>{t.style.opacity=1,o&&(o.style.opacity=0,o.style.transition="opacity 500ms linear")}))}),!0);</script><style type="text/css">
    .auto-link.before {
      position: absolute;
      top: 0;
      left: 0;
      transform: translateX(-100%);
      padding-right: 4px;
    }
    .auto-link.after {
      display: inline-block;
      padding-left: 4px;
    }
    h1 .auto-link svg,
    h2 .auto-link svg,
    h3 .auto-link svg,
    h4 .auto-link svg,
    h5 .auto-link svg,
    h6 .auto-link svg {
      visibility: hidden;
    }
    h1:hover .auto-link svg,
    h2:hover .auto-link svg,
    h3:hover .auto-link svg,
    h4:hover .auto-link svg,
    h5:hover .auto-link svg,
    h6:hover .auto-link svg,
    h1 .auto-link:focus svg,
    h2 .auto-link:focus svg,
    h3 .auto-link:focus svg,
    h4 .auto-link:focus svg,
    h5 .auto-link:focus svg,
    h6 .auto-link:focus svg {
      visibility: visible;
    }
  </style><script>
    document.addEventListener("DOMContentLoaded", function(event) {
      var hash = window.decodeURI(location.hash.replace('#', ''))
      if (hash !== '') {
        var element = document.getElementById(hash)
        if (element) {
          var scrollTop = window.pageYOffset || document.documentElement.scrollTop || document.body.scrollTop
          var clientTop = document.documentElement.clientTop || document.body.clientTop || 0
          var offset = element.getBoundingClientRect().top + scrollTop - clientTop
          // Wait for the browser to finish rendering before scrolling.
          setTimeout((function() {
            window.scrollTo(0, offset - 100)
          }), 0)
        }
      }
    })
  </script><link rel="canonical" href="https://pozafly.github.io/tripllo/(5)login2-SpringBoot/" data-baseprotocol="https:" data-basehost="pozafly.github.io"/><title data-react-helmet="true">(5) 로그인2 -SpringBoot 구현</title><link data-react-helmet="true" rel="icon" href="/static/alien-652bde6f766dc3e52bdf32391ba54a09.png" type="image/x-icon"/><link rel="preconnect" href="https://www.googletagmanager.com"/><link rel="dns-prefetch" href="https://www.googletagmanager.com"/><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-SLQNH3ND3J"></script><script>
      
      function gaOptout(){document.cookie=disableStr+'=true; expires=Thu, 31 Dec 2099 23:59:59 UTC;path=/',window[disableStr]=!0}var gaProperty='G-SLQNH3ND3J',disableStr='ga-disable-'+gaProperty;document.cookie.indexOf(disableStr+'=true')>-1&&(window[disableStr]=!0);
      if(!(navigator.doNotTrack == "1" || window.doNotTrack == "1")) {
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-SLQNH3ND3J', {"anonymize_ip":true,"cookie_expires":0,"send_page_view":false});
      }
      </script></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><div class="post-template"><style data-emotion="css-global 63kgpx">html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,dl,dt,dd,ol,fieldset,form,label,legend,article,aside,canvas,details,embed,figure,figcaption,footer,header,hgroup,menu,nav,output,ruby,section,summary,time,mark,audio,video{margin:0;padding:0;border:0;font:inherit;font-size:16px;vertical-align:baseline;}html .copyright,body .copyright,div .copyright,span .copyright,applet .copyright,object .copyright,iframe .copyright,h1 .copyright,h2 .copyright,h3 .copyright,h4 .copyright,h5 .copyright,h6 .copyright,p .copyright,blockquote .copyright,pre .copyright,a .copyright,abbr .copyright,acronym .copyright,address .copyright,big .copyright,cite .copyright,code .copyright,del .copyright,dfn .copyright,em .copyright,img .copyright,ins .copyright,kbd .copyright,q .copyright,s .copyright,samp .copyright,small .copyright,strike .copyright,strong .copyright,sub .copyright,sup .copyright,tt .copyright,var .copyright,dl .copyright,dt .copyright,dd .copyright,ol .copyright,fieldset .copyright,form .copyright,label .copyright,legend .copyright,article .copyright,aside .copyright,canvas .copyright,details .copyright,embed .copyright,figure .copyright,figcaption .copyright,footer .copyright,header .copyright,hgroup .copyright,menu .copyright,nav .copyright,output .copyright,ruby .copyright,section .copyright,summary .copyright,time .copyright,mark .copyright,audio .copyright,video .copyright{font-size:1.4rem;}html .copyright a,body .copyright a,div .copyright a,span .copyright a,applet .copyright a,object .copyright a,iframe .copyright a,h1 .copyright a,h2 .copyright a,h3 .copyright a,h4 .copyright a,h5 .copyright a,h6 .copyright a,p .copyright a,blockquote .copyright a,pre .copyright a,a .copyright a,abbr .copyright a,acronym .copyright a,address .copyright a,big .copyright a,cite .copyright a,code .copyright a,del .copyright a,dfn .copyright a,em .copyright a,img .copyright a,ins .copyright a,kbd .copyright a,q .copyright a,s .copyright a,samp .copyright a,small .copyright a,strike .copyright a,strong .copyright a,sub .copyright a,sup .copyright a,tt .copyright a,var .copyright a,dl .copyright a,dt .copyright a,dd .copyright a,ol .copyright a,fieldset .copyright a,form .copyright a,label .copyright a,legend .copyright a,article .copyright a,aside .copyright a,canvas .copyright a,details .copyright a,embed .copyright a,figure .copyright a,figcaption .copyright a,footer .copyright a,header .copyright a,hgroup .copyright a,menu .copyright a,nav .copyright a,output .copyright a,ruby .copyright a,section .copyright a,summary .copyright a,time .copyright a,mark .copyright a,audio .copyright a,video .copyright a{font-size:inherit;}html .error-front-page,body .error-front-page,div .error-front-page,span .error-front-page,applet .error-front-page,object .error-front-page,iframe .error-front-page,h1 .error-front-page,h2 .error-front-page,h3 .error-front-page,h4 .error-front-page,h5 .error-front-page,h6 .error-front-page,p .error-front-page,blockquote .error-front-page,pre .error-front-page,a .error-front-page,abbr .error-front-page,acronym .error-front-page,address .error-front-page,big .error-front-page,cite .error-front-page,code .error-front-page,del .error-front-page,dfn .error-front-page,em .error-front-page,img .error-front-page,ins .error-front-page,kbd .error-front-page,q .error-front-page,s .error-front-page,samp .error-front-page,small .error-front-page,strike .error-front-page,strong .error-front-page,sub .error-front-page,sup .error-front-page,tt .error-front-page,var .error-front-page,dl .error-front-page,dt .error-front-page,dd .error-front-page,ol .error-front-page,fieldset .error-front-page,form .error-front-page,label .error-front-page,legend .error-front-page,article .error-front-page,aside .error-front-page,canvas .error-front-page,details .error-front-page,embed .error-front-page,figure .error-front-page,figcaption .error-front-page,footer .error-front-page,header .error-front-page,hgroup .error-front-page,menu .error-front-page,nav .error-front-page,output .error-front-page,ruby .error-front-page,section .error-front-page,summary .error-front-page,time .error-front-page,mark .error-front-page,audio .error-front-page,video .error-front-page{font-size:1.6rem;}body{line-height:1;word-break:keep-all;}ol,ul{list-style:none;}blockquote,q{quotes:none;}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none;}table{border-spacing:0;border-collapse:collapse;}img{max-width:100%;}html{box-sizing:border-box;font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%;}*,*:before,*:after{box-sizing:inherit;}a{background-color:transparent;}a:active,a:hover{outline:0;}b,strong{font-weight:500;}i,em,dfn{font-style:italic;}h1{margin:0.67em 0;font-size:2em;}small{font-size:80%;}sub,sup{position:relative;font-size:75%;line-height:0;vertical-align:baseline;}sup{top:-0.5em;}sub{bottom:-0.25em;}img{border:0;}svg:not(:root){overflow:hidden;}mark{background-color:#fdffb6;}code,kbd,pre,samp{font-family:monospace,monospace;font-size:1em;}button,input,optgroup,select,textarea{margin:0;color:inherit;font:inherit;}button{overflow:visible;border:none;}button,select{text-transform:none;}button,html input[type='button'],input[type='reset'],input[type='submit']{cursor:pointer;-webkit-appearance:button;}button[disabled],html input[disabled]{cursor:default;}button::-moz-focus-inner,input::-moz-focus-inner{padding:0;border:0;}input{line-height:normal;}input:focus{outline:none;}input[type='checkbox'],input[type='radio']{box-sizing:border-box;padding:0;}input[type='number']::-webkit-inner-spin-button,input[type='number']::-webkit-outer-spin-button{height:auto;}input[type='search']{box-sizing:content-box;-webkit-appearance:textfield;}input[type='search']::-webkit-search-cancel-button,input[type='search']::-webkit-search-decoration{-webkit-appearance:none;}legend{padding:0;border:0;}textarea{overflow:auto;}table{border-spacing:0;border-collapse:collapse;}td,th{padding:0;}html{overflow-x:hidden;overflow-y:scroll;font-size:62.5%;-webkit-tap-highlight-color:rgba(0, 0, 0, 0);}body{overflow-x:hidden;font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,'Noto Sans','Ubuntu','Droid Sans','Helvetica Neue',sans-serif;font-size:1.6rem;line-height:1.6em;font-weight:400;font-style:normal;letter-spacing:0;text-rendering:optimizeLegibility;background:#191b1f;color:rgba(255, 255, 255, 0.75);-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;-moz-font-feature-settings:'liga' on;}body::-webkit-scrollbar{background-color:transparent;width:6px;}body::-webkit-scrollbar-thumb{border-radius:8px;background-color:hsla(230, 5%, 35%, 1);}hr{position:relative;display:block;width:100%;margin:2.5em 0 3.5em;padding:0;height:1px;border:0;border-top:1px solid #2b2f36;}audio,canvas,iframe,img,svg,video{vertical-align:middle;}fieldset{margin:0;padding:0;border:0;}textarea{resize:vertical;}p,ul,ol,dl,blockquote{margin:0 0 1.5em 0;}ol,ul{padding-left:1.3em;}ol ol,ul ul,ul ol,ol ul{margin:0.5em 0 1em;}ul{list-style:disc;}ol{list-style:decimal;}ul,ol{max-width:100%;}li{margin:0.5em 0;padding-left:0.3em;line-height:1.6em;}dt{float:left;margin:0 20px 0 0;width:120px;color:#15171A;font-weight:500;text-align:right;}dd{margin:0 0 5px 0;text-align:left;}blockquote{margin:1.5em 0;padding:0 1.6em 0 1.6em;border-left:#e5eff5 0.5em solid;}blockquote p{margin:0.8em 0;font-size:1.2em;font-weight:400;}blockquote small{display:inline-block;margin:0.8em 0 0.8em 1.5em;font-size:0.9em;opacity:0.8;}blockquote cite{font-weight:bold;}blockquote cite a{font-weight:normal;}a{color:#90a2aa;-webkit-text-decoration:none;text-decoration:none;}a:hover{-webkit-text-decoration:underline;text-decoration:underline;}h1,h2,h3,h4,h5,h6{margin-top:0;line-height:1.15;font-weight:600;text-rendering:optimizeLegibility;}h1{margin:0 0 0.5em 0;font-size:5.5rem;font-weight:600;}@media (max-width: 500px){h1{font-size:2.2rem;}}h2{margin:1.5em 0 0.5em 0;font-size:2.2rem;}@media (max-width: 500px){h2{font-size:1.8rem;}}h3{margin:1.5em 0 0.5em 0;font-size:1.8rem;font-weight:500;}@media (max-width: 500px){h3{font-size:1.7rem;}}h4{margin:1.5em 0 0.5em 0;font-size:1.6rem;font-weight:500;}h5{margin:1.5em 0 0.5em 0;font-size:1.4rem;font-weight:500;}h6{margin:1.5em 0 0.5em 0;font-size:1.4rem;font-weight:500;}h1 a.auto-link svg,h2 a.auto-link svg,h3 a.auto-link svg,h4 a.auto-link svg,h5 a.auto-link svg,h6 a.auto-link svg{opacity:0;-webkit-transition:0.25s ease;transition:0.25s ease;}h1:hover a.auto-link svg,h2:hover a.auto-link svg,h3:hover a.auto-link svg,h4:hover a.auto-link svg,h5:hover a.auto-link svg,h6:hover a.auto-link svg{opacity:1;}a.auto-link{box-shadow:none!important;}a.auto-link:hover{box-shadow:none!important;}a.auto-link svg{fill:rgba(255, 255, 255, 0.9)!important;}.medium-zoom-overlay{-webkit-backdrop-filter:blur(8px);backdrop-filter:blur(8px);}.gatsby-resp-image-background-image{border-radius:6px;}.gatsby-resp-image-wrapper{width:80%;}@media (max-width: 800px){.gatsby-resp-image-wrapper{width:100%;}}.medium-zoom-image{box-shadow:none!important;}</style><style data-emotion="css apxg5d">.css-apxg5d .site-main{margin-top:64px;background:#191b1f;padding-bottom:4vw;}</style><style data-emotion="css 1qbxjgj">.css-1qbxjgj{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;min-height:100vh;}.css-1qbxjgj .site-main{margin-top:64px;background:#191b1f;padding-bottom:4vw;}</style><div class="css-1qbxjgj esvym2d0"><header class="site-header"><style data-emotion="css 1fd2b9r">.css-1fd2b9r{position:relative;padding:0 5vw;position:fixed;top:0;right:0;left:0;z-index:1000;-webkit-backdrop-filter:blur(8px);backdrop-filter:blur(8px);background:rgba(25, 27, 31, 0.4);}</style><div class="css-1fd2b9r"><style data-emotion="css y521qa">.css-y521qa{margin:0 auto;max-width:1040px;width:100%;}</style><div class="css-y521qa"><style data-emotion="css lcmrfl">.css-lcmrfl{position:relative;z-index:100;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between;-webkit-align-items:flex-start;-webkit-box-align:flex-start;-ms-flex-align:flex-start;align-items:flex-start;overflow-y:hidden;height:64px;font-size:1.3rem;}</style><nav class="css-lcmrfl"><style data-emotion="css axoi21">.css-axoi21{-webkit-flex:1 0 auto;-ms-flex:1 0 auto;flex:1 0 auto;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;overflow-x:auto;overflow-y:hidden;-webkit-overflow-scrolling:touch;margin-right:10px;padding:10px 0 80px;font-weight:500;letter-spacing:0.2px;text-transform:uppercase;white-space:nowrap;-ms-overflow-scrolling:touch;}@media (max-width: 700px){.css-axoi21{margin-right:0;}}</style><div class="site-nav-left  css-axoi21 e1sju8vj4"><style data-emotion="css vdmvgr">.css-vdmvgr{position:relative;z-index:100;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;display:inline-block;margin-right:32px;padding:12px 0;color:#fff;font-size:1.7rem;line-height:1.8rem;font-weight:bold;letter-spacing:-0.5px;text-transform:none;}@media (max-width: 700px){.css-vdmvgr{margin-right:18px;}}.css-vdmvgr:hover{-webkit-text-decoration:none;text-decoration:none;}.css-vdmvgr img{display:block;width:auto;height:21px;}</style><a class="site-nav-logo css-vdmvgr" href="/"><img src="/static/a62d45ddbe29cf42da820a576d9375e1/aef42/alien.png" alt="Pozafly Blog"/></a><style data-emotion="css 1xdepn">.css-1xdepn{position:relative;-webkit-align-self:flex-start;-ms-flex-item-align:flex-start;align-self:flex-start;}</style><div class="css-1xdepn e1sju8vj3"><style data-emotion="css 11wqzzh">.css-11wqzzh{position:absolute;z-index:1000;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;margin:0 0 0 -12px;padding:0;list-style:none;-webkit-transition:all 1s cubic-bezier(0.19, 1, 0.22, 1);transition:all 1s cubic-bezier(0.19, 1, 0.22, 1);}.css-11wqzzh li{display:block;margin:0;padding:0;}.css-11wqzzh li a{font-size:1.2rem;position:relative;display:block;padding:10px 12px;color:#fff;opacity:0.8;-webkit-transition:opacity 0.35s ease-in-out;transition:opacity 0.35s ease-in-out;}@media (max-width: 700px){.css-11wqzzh li a{padding:10px 8px;}}.css-11wqzzh li a:hover{-webkit-text-decoration:none;text-decoration:none;opacity:1;}.css-11wqzzh li a:before{content:'';position:absolute;right:100%;bottom:8px;left:12px;height:1px;background:#fff;opacity:0.25;-webkit-transition:all 0.35s ease-in-out;transition:all 0.35s ease-in-out;}.css-11wqzzh li a:hover:before{right:12px;opacity:0.5;}.css-11wqzzh li a.is-home{color:#fff;}.css-11wqzzh li a.is-home:before{background:#fff;}.css-11wqzzh .nav-current{opacity:1;}</style><ul role="menu" class="css-11wqzzh"><li role="menuitem"><a class="" href="/">Home</a></li><li role="menuitem"><a class="" href="/about/">About</a></li><li role="menuitem"><a class="" href="/tags/">Tags</a></li><li role="menuitem"><a class="" href="/tags/diary/">Diary</a></li></ul><style data-emotion="css 9wkh4a">.css-9wkh4a{visibility:hidden;position:absolute;top:9px;color:#fff;font-size:1.7rem;font-weight:400;text-transform:none;opacity:0;-webkit-transition:all 1s cubic-bezier(0.19, 1, 0.22, 1);transition:all 1s cubic-bezier(0.19, 1, 0.22, 1);-webkit-transform:translateY(175%);-moz-transform:translateY(175%);-ms-transform:translateY(175%);transform:translateY(175%);}@media (max-width: 700px){.css-9wkh4a{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;max-width:calc(100vw - 110px);}}.css-9wkh4a .dash{left:-25px;}.css-9wkh4a .dash:before{content:'– ';opacity:0.5;}</style><span class="nav-post-title css-9wkh4a e1sju8vj0">(5) 로그인2 -SpringBoot 구현</span></div></div><style data-emotion="css yofoym">.css-yofoym{-webkit-flex:0 1 auto;-ms-flex:0 1 auto;flex:0 1 auto;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:end;-ms-flex-pack:end;-webkit-justify-content:flex-end;justify-content:flex-end;padding:10px 0;height:64px;}</style><div class="css-yofoym e1sju8vj2"><style data-emotion="css 1txew8w">.css-1txew8w{-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}@media (max-width: 700px){.css-1txew8w .not-mobile{display:none;}}</style><div class="css-1txew8w e1sju8vj1"><style data-emotion="css vmtdfa">.css-vmtdfa{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;margin:0;padding:10px;opacity:0.8;-webkit-transition:opacity 0.35s ease;transition:opacity 0.35s ease;}.css-vmtdfa:hover{opacity:1;}.css-vmtdfa svg{height:1.8rem;fill:#fff;}.css-vmtdfa.is-home svg{fill:#fff;}.css-vmtdfa svg{height:1.6rem;}</style><a class=" not-mobile css-vmtdfa" href="https://www.instagram.com/pozafly_/" target="_blank" title="Instagram" rel="noopener noreferrer"><svg height="511pt" viewBox="0 0 511 511.9" width="13pt" xmlns="http://www.w3.org/2000/svg"><path d="m510.949219 150.5c-1.199219-27.199219-5.597657-45.898438-11.898438-62.101562-6.5-17.199219-16.5-32.597657-29.601562-45.398438-12.800781-13-28.300781-23.101562-45.300781-29.5-16.296876-6.300781-34.898438-10.699219-62.097657-11.898438-27.402343-1.300781-36.101562-1.601562-105.601562-1.601562s-78.199219.300781-105.5 1.5c-27.199219 1.199219-45.898438 5.601562-62.097657 11.898438-17.203124 6.5-32.601562 16.5-45.402343 29.601562-13 12.800781-23.097657 28.300781-29.5 45.300781-6.300781 16.300781-10.699219 34.898438-11.898438 62.097657-1.300781 27.402343-1.601562 36.101562-1.601562 105.601562s.300781 78.199219 1.5 105.5c1.199219 27.199219 5.601562 45.898438 11.902343 62.101562 6.5 17.199219 16.597657 32.597657 29.597657 45.398438 12.800781 13 28.300781 23.101562 45.300781 29.5 16.300781 6.300781 34.898438 10.699219 62.101562 11.898438 27.296876 1.203124 36 1.5 105.5 1.5s78.199219-.296876 105.5-1.5c27.199219-1.199219 45.898438-5.597657 62.097657-11.898438 34.402343-13.300781 61.601562-40.5 74.902343-74.898438 6.296876-16.300781 10.699219-34.902343 11.898438-62.101562 1.199219-27.300781 1.5-36 1.5-105.5s-.101562-78.199219-1.300781-105.5zm-46.097657 209c-1.101562 25-5.300781 38.5-8.800781 47.5-8.601562 22.300781-26.300781 40-48.601562 48.601562-9 3.5-22.597657 7.699219-47.5 8.796876-27 1.203124-35.097657 1.5-103.398438 1.5s-76.5-.296876-103.402343-1.5c-25-1.097657-38.5-5.296876-47.5-8.796876-11.097657-4.101562-21.199219-10.601562-29.398438-19.101562-8.5-8.300781-15-18.300781-19.101562-29.398438-3.5-9-7.699219-22.601562-8.796876-47.5-1.203124-27-1.5-35.101562-1.5-103.402343s.296876-76.5 1.5-103.398438c1.097657-25 5.296876-38.5 8.796876-47.5 4.101562-11.101562 10.601562-21.199219 19.203124-29.402343 8.296876-8.5 18.296876-15 29.398438-19.097657 9-3.5 22.601562-7.699219 47.5-8.800781 27-1.199219 35.101562-1.5 103.398438-1.5 68.402343 0 76.5.300781 103.402343 1.5 25 1.101562 38.5 5.300781 47.5 8.800781 11.097657 4.097657 21.199219 10.597657 29.398438 19.097657 8.5 8.300781 15 18.300781 19.101562 29.402343 3.5 9 7.699219 22.597657 8.800781 47.5 1.199219 27 1.5 35.097657 1.5 103.398438s-.300781 76.300781-1.5 103.300781zm0 0"></path><path d="m256.449219 124.5c-72.597657 0-131.5 58.898438-131.5 131.5s58.902343 131.5 131.5 131.5c72.601562 0 131.5-58.898438 131.5-131.5s-58.898438-131.5-131.5-131.5zm0 216.800781c-47.097657 0-85.300781-38.199219-85.300781-85.300781s38.203124-85.300781 85.300781-85.300781c47.101562 0 85.300781 38.199219 85.300781 85.300781s-38.199219 85.300781-85.300781 85.300781zm0 0"></path><path d="m423.851562 119.300781c0 16.953125-13.746093 30.699219-30.703124 30.699219-16.953126 0-30.699219-13.746094-30.699219-30.699219 0-16.957031 13.746093-30.699219 30.699219-30.699219 16.957031 0 30.703124 13.742188 30.703124 30.699219zm0 0"></path></svg></a><style data-emotion="css 1xo3nsb">.css-1xo3nsb{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;margin:0;padding:10px;opacity:0.8;-webkit-transition:opacity 0.35s ease;transition:opacity 0.35s ease;}.css-1xo3nsb:hover{opacity:1;}.css-1xo3nsb svg{height:1.8rem;fill:#fff;}.css-1xo3nsb.is-home svg{fill:#fff;}</style><a class=" not-mobile css-1xo3nsb" href="https://github.com/pozafly" title="Github" target="_blank" rel="noopener noreferrer"><svg width="21px" height="21px" viewBox="0 0 1024 1024" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M8 0C3.58 0 0 3.58 0 8C0 11.54 2.29 14.53 5.47 15.59C5.87 15.66 6.02 15.42 6.02 15.21C6.02 15.02 6.01 14.39 6.01 13.72C4 14.09 3.48 13.23 3.32 12.78C3.23 12.55 2.84 11.84 2.5 11.65C2.22 11.5 1.82 11.13 2.49 11.12C3.12 11.11 3.57 11.7 3.72 11.94C4.44 13.15 5.59 12.81 6.05 12.6C6.12 12.08 6.33 11.73 6.56 11.53C4.78 11.33 2.92 10.64 2.92 7.58C2.92 6.71 3.23 5.99 3.74 5.43C3.66 5.23 3.38 4.41 3.82 3.31C3.82 3.31 4.49 3.1 6.02 4.13C6.66 3.95 7.34 3.86 8.02 3.86C8.7 3.86 9.38 3.95 10.02 4.13C11.55 3.09 12.22 3.31 12.22 3.31C12.66 4.41 12.38 5.23 12.3 5.43C12.81 5.99 13.12 6.7 13.12 7.58C13.12 10.65 11.25 11.33 9.47 11.53C9.76 11.78 10.01 12.26 10.01 13.01C10.01 14.08 10 14.94 10 15.21C10 15.42 10.15 15.67 10.55 15.59C13.71 14.53 16 11.53 16 8C16 3.58 12.42 0 8 0Z" transform="scale(64)"></path></svg></a><style data-emotion="css 1c7fopu">.css-1c7fopu{padding:6px;border-radius:50%;overflow:hidden;background:transparent;}.css-1c7fopu #switch{position:relative;background:transparent;border:0;width:21px;height:21px;padding:0;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;overflow:hidden;}.css-1c7fopu .mode{position:relative;width:18px;height:18px;-webkit-transition:all 0.45s ease;transition:all 0.45s ease;border-radius:50%;background:#000;opacity:0.8;overflow:hidden;}.css-1c7fopu .mode::before{content:'';position:absolute;width:5px;height:5px;left:50%;top:50%;-webkit-transform:translateX(-50%) translateY(-50%);-moz-transform:translateX(-50%) translateY(-50%);-ms-transform:translateX(-50%) translateY(-50%);transform:translateX(-50%) translateY(-50%);border-radius:50%;background:inherit;z-index:-1;opacity:0;-webkit-transition:box-shadow 0.4s 0s ease;transition:box-shadow 0.4s 0s ease;}.css-1c7fopu .mode::after{content:'';position:absolute;width:90%;height:90%;top:-20%;left:30%;border-radius:50%;background:#fff;-webkit-backdrop-filter:blur(8px);backdrop-filter:blur(8px);background:rgba(255, 255, 255, 0.8);-webkit-transition:-webkit-transform 0.45s ease;transition:transform 0.45s ease;}.css-1c7fopu .mode:hover{opacity:1;}.css-1c7fopu.dark .mode{-webkit-transform:scale(0.5);-moz-transform:scale(0.5);-ms-transform:scale(0.5);transform:scale(0.5);background:white;opacity:1;opacity:0.8;overflow:initial;}.css-1c7fopu.dark .mode::before{opacity:1;box-shadow:0 -16px 0 0 white,0 16px 0 0 white,-16px 0 0 0 white,16px 0 0 0 white,12px 12px 0 0 white,12px -12px 0 0 white,-12px 12px 0 0 white,-12px -12px 0 0 white;}.css-1c7fopu.dark .mode::after{opacity:0;-webkit-transition:background 0.45s ease;transition:background 0.45s ease;-webkit-transform:translateX(50%) translateY(-50%);-moz-transform:translateX(50%) translateY(-50%);-ms-transform:translateX(50%) translateY(-50%);transform:translateX(50%) translateY(-50%);}.css-1c7fopu.is-home .mode{background:#fff;}.css-1c7fopu.is-home .mode::after{background:rgba(95, 131, 162);}.css-1c7fopu.is-home.dark .mode::before{box-shadow:0 -16px 0 0 white,0 16px 0 0 white,-16px 0 0 0 white,16px 0 0 0 white,12px 12px 0 0 white,12px -12px 0 0 white,-12px 12px 0 0 white,-12px -12px 0 0 white;}.css-1c7fopu.is-home.dark .mode::after{background:rgba(46, 64, 79);}</style><button class="dark  css-1c7fopu e12e1g7o0"><div id="switch"><div class="mode"></div></div></button></div></div></nav></div></div></header><style data-emotion="css yj56d4">.css-yj56d4{-webkit-box-flex:1;-webkit-flex-grow:1;-ms-flex-positive:1;flex-grow:1;background:#191b1f;position:relative;padding:0 5vw;}</style><main id="site-main" class="site-main css-yj56d4"><div class="css-y521qa"><style data-emotion="css 150a24d">.css-150a24d{position:relative;}</style><article class="css-150a24d"><style data-emotion="css 7tju5o">.css-7tju5o{position:relative;margin:0 auto;padding:70px 100px 50px;border-top-left-radius:3px;border-top-right-radius:3px;}@media (max-width: 1170px){.css-7tju5o{padding:60px 11vw 50px;}}@media (max-width: 800px){.css-7tju5o{padding-right:5vw;padding-left:5vw;}}@media (max-width: 500px){.css-7tju5o{padding:20px 0 35px;}}</style><header class="post-full-header css-7tju5o ewnyor56"><style data-emotion="css 1twueq0">.css-1twueq0{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:start;-ms-flex-pack:start;-webkit-justify-content:flex-start;justify-content:flex-start;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;color:#738a94;font-size:1.2rem;line-height:1.4em;font-weight:600;}.css-1twueq0 a{font-size:1.2rem;}</style><section class="post-full-tags css-1twueq0 ewnyor55"><a href="/tags/tripllo-제작기/">Tripllo 제작기</a>,  <a href="/tags/spring-security/">SpringSecurity</a>,  <a href="/tags/jwt/">JWT</a></section><style data-emotion="css 47vkz">.css-47vkz{margin:0 0 0.2em;color:rgba(255, 255, 255, 0.9);}@media (max-width: 500px){.css-47vkz{margin-top:0.2em;font-size:3.3rem;}}</style><h1 class="post-full-title css-47vkz ewnyor51">(5) 로그인2 -SpringBoot 구현</h1><style data-emotion="css 1yd41ut">.css-1yd41ut{margin:20px 0 0;color:#768086;font-size:2rem;line-height:1.4em;font-weight:360;}@media (max-width: 500px){.css-1yd41ut{font-size:1.9rem;line-height:1.5em;}}</style><p class="post-full-custom-excerpt css-1yd41ut ewnyor53">Spring Security와 JWT를 사용해서 로그인 기능을 구현했다. Spring Security의 구현된 소스와 login의 Service 단 내부 로직을 개념에 맞춰서 알아보자.</p><style data-emotion="css sjnigg">.css-sjnigg{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between;margin:35px 0 0;padding-top:15px;border-top:1px solid #3b4049;}.css-sjnigg .post-full-byline-content{-webkit-box-flex:1;-webkit-flex-grow:1;-ms-flex-positive:1;flex-grow:1;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:flex-start;-webkit-box-align:flex-start;-ms-flex-align:flex-start;align-items:flex-start;}.css-sjnigg .post-full-byline-content .author-list{-webkit-box-pack:start;-ms-flex-pack:start;-webkit-justify-content:flex-start;justify-content:flex-start;padding:0 12px 0 0;}.css-sjnigg .post-full-byline-meta{margin:2px 0 0;color:#768086;font-size:1.4rem;line-height:1.2em;letter-spacing:0.2px;}.css-sjnigg .post-full-byline-meta h4{margin:0 0 3px;font-size:1.4rem;line-height:1.3em;font-weight:500;}.css-sjnigg .post-full-byline-meta h4 a{font-size:13px;color:rgba(255, 255, 255, 0.75);}.css-sjnigg .post-full-byline-meta h4 a:hover{color:#fff;}.css-sjnigg .post-full-byline-meta .byline-reading-time,.css-sjnigg .post-full-byline-meta .byline-meta-date{font-size:13px;}.css-sjnigg .post-full-byline-meta .bull{display:inline-block;margin:0 4px;opacity:0.6;}</style><div class="post-full-byline css-sjnigg ewnyor52"><section class="post-full-byline-content"><style data-emotion="css 12fmpzj">.css-12fmpzj{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-flex-wrap:wrap;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;margin:0 0 0 4px;padding:0;list-style:none;}</style><ul class="author-list css-12fmpzj ewnyor54"><style data-emotion="css 1g82peq">.css-1g82peq{position:relative;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;margin:0;padding:0;}.css-1g82peq:hover .author-name-tooltip{opacity:1;-webkit-transform:translate(-10px, -2px);-moz-transform:translate(-10px, -2px);-ms-transform:translate(-10px, -2px);transform:translate(-10px, -2px);}</style><li class="author-list-item css-1g82peq e1tg0lak0"><style data-emotion="css 178mv5t">.css-178mv5t{display:block;overflow:hidden;margin:0 -4px;width:40px;height:40px;border:2px solid #1a1c20;border-radius:100%;}@media (max-width: 500px){.css-178mv5t{width:36px;height:36px;}}</style><a class="author-avatar css-178mv5t" href="/about/"><style data-emotion="css 1529p4g">.css-1529p4g{display:block;width:100%;height:100%;background:#e4eaed;border-radius:100%;object-fit:cover;background:#191b1f;}.css-1529p4g img{border-radius:100%;}</style><div data-gatsby-image-wrapper="" class="gatsby-image-wrapper author-profile-image css-1529p4g"><div aria-hidden="true" style="padding-top:100%"></div><div aria-hidden="true" data-placeholder-image="" style="opacity:1;transition:opacity 500ms linear;background-color:#6808f8;position:absolute;top:0;left:0;bottom:0;right:0"></div><picture><source type="image/webp" data-srcset="/static/8c061761f263c344f2c0416607c8adf1/e73fe/pozafly.webp 40w,/static/8c061761f263c344f2c0416607c8adf1/61ca6/pozafly.webp 80w,/static/8c061761f263c344f2c0416607c8adf1/507b0/pozafly.webp 120w" sizes="100vw"/><img data-gatsby-image-ssr="" data-main-image="" style="opacity:0" sizes="100vw" decoding="async" loading="lazy" data-src="/static/8c061761f263c344f2c0416607c8adf1/73bb6/pozafly.jpg" data-srcset="/static/8c061761f263c344f2c0416607c8adf1/2f28c/pozafly.jpg 40w,/static/8c061761f263c344f2c0416607c8adf1/499f6/pozafly.jpg 80w,/static/8c061761f263c344f2c0416607c8adf1/73bb6/pozafly.jpg 120w" alt="Pozafly"/></picture><noscript><picture><source type="image/webp" srcSet="/static/8c061761f263c344f2c0416607c8adf1/e73fe/pozafly.webp 40w,/static/8c061761f263c344f2c0416607c8adf1/61ca6/pozafly.webp 80w,/static/8c061761f263c344f2c0416607c8adf1/507b0/pozafly.webp 120w" sizes="100vw"/><img data-gatsby-image-ssr="" data-main-image="" style="opacity:0" sizes="100vw" decoding="async" loading="lazy" src="/static/8c061761f263c344f2c0416607c8adf1/73bb6/pozafly.jpg" srcSet="/static/8c061761f263c344f2c0416607c8adf1/2f28c/pozafly.jpg 40w,/static/8c061761f263c344f2c0416607c8adf1/499f6/pozafly.jpg 80w,/static/8c061761f263c344f2c0416607c8adf1/73bb6/pozafly.jpg 120w" alt="Pozafly"/></picture></noscript><script type="module">const t="undefined"!=typeof HTMLImageElement&&"loading"in HTMLImageElement.prototype;if(t){const t=document.querySelectorAll("img[data-main-image]");for(let e of t){e.dataset.src&&(e.setAttribute("src",e.dataset.src),e.removeAttribute("data-src")),e.dataset.srcset&&(e.setAttribute("srcset",e.dataset.srcset),e.removeAttribute("data-srcset"));const t=e.parentNode.querySelectorAll("source[data-srcset]");for(let e of t)e.setAttribute("srcset",e.dataset.srcset),e.removeAttribute("data-srcset");e.complete&&(e.style.opacity=1,e.parentNode.parentNode.querySelector("[data-placeholder-image]").style.opacity=0)}}</script></div></a></li></ul><section class="post-full-byline-meta"><h4 class="author-name"><a href="/about/">Pozafly</a></h4><div class="byline-meta-content"><time class="byline-meta-date" dateTime="2021-02-05">2021 02 05</time><span class="byline-reading-time"><span class="bull">•</span>11 min read</span></div></section></section></div></header><style data-emotion="css sowbdc">.css-sowbdc{margin:25px auto 50px;max-height:800px;-webkit-background-size:cover;background-size:cover;width:80%;border-radius:8px;border:1px solid hsl(230 6% 23%);}.css-sowbdc img{border-radius:8px;}@media (max-width: 1170px){.css-sowbdc img{max-width:1170px;}}@media (max-width: 800px){.css-sowbdc{width:100%;}}@media (max-width: 500px){.css-sowbdc{margin-bottom:4vw;}}</style><figure class="css-sowbdc ewnyor50"><div data-gatsby-image-wrapper="" style="height:100%" class="gatsby-image-wrapper"><div aria-hidden="true" style="padding-top:75%"></div><img aria-hidden="true" data-placeholder-image="" style="opacity:1;transition:opacity 500ms linear" decoding="async" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAAsTAAALEwEAmpwYAAAD2ElEQVQ4y31TS2wbVRS9YyeoTZxQyY1jYZIGBZFilQYhVBbZIKRAsyBCCmLPColFF0VILLqqIFkgFNEsQCJJUyBJa1LHsT0z/s3Yjj0z9ng8H3vs8Sf2NBWx01TBhdKiNqUPjasgJChHejpP912dd8+79wH8A4F0EcMZBQguf4ySanO0rC/RUn2BkuqLlFRfoGX9e0qsfeVP5i1+Jg9BvgT/grWvv82z86sQFirmEK8CzuasbirzrTehLPkSucveTeXKRlxe8jP5ZT+Tn3XTgiUk1IDkVHMoo5mCfNFkMMmpGFiP29qC8y4CSK4IzUcIEEIg6C34KZyC9WgWrlM8XI/w4KYFILgCnPvsIsxf80KILwIlViCSLUMkW4FAugBgsz/XCQCd05e+6w8L5bfddOasm+YnV/D4AACYl/2x11fJxPurZOLdZTw+5U3IbxrxrxdX7AQrT5CcMk5wyjjJKWf9SXkArH02w/PQzNziJCXVt0OZSj0i1lrehDJlVBoWqrNkSttf9sdrvmTuVrLY8AIANu/yTRCsivxM7gHOqn8QbAERrPoNfPjx+baVIF9uWzWSdx6iw735LkJApp6cHcaGhkdMp0Zf7aDlG4OX3ZGTnpg8vLROOQlO6wdXKN1JS/orOKOe9jPq6NyVtTcIrjDKlHad9xDCSK54JMiXvyS4woovobg9MfEtN51pi/O1VruAw4sajxDAWoR3sKXd+75EDnli4uONuHQQy22jVGVvdz2a7ceZvJlgC9M4oy4E0tpSWNgaY7QGkKkSBNLa+SBfbhFccYuW9GY8f/Md+GGDcqS3bv/OaM3H4Wz1gJb1h4J+B3HlWzvehGIPpEvgiYngCnHtDoeFCtxFyGRUNe8inDirToaF6jgt6xMRccsGq0TiebbUNARQVNZRVNFRurqHGK15D2eLDk9cgrVIemwFj3/qZ/KfuGn+BUNseMTZbTDOqhBTtmFT/RliuW2AawHWypaaPkbbCbGlZoDRGiSjNSKM1ry6HhOPezdl8CVzH10lk5J3U5Y8sexY4wAdNgkjU5qZlnRTPH/TFFV0gEz9DqjNB5DVW1DZ/xPUxn0gOQ248m1Yo0T40RfHcLYI730w1QUAxohZLsxcwoyf8p/o6j7S0W05etrS23XS0nPU2Wez2l8ccfYOv/Ryj2NwCPsNISxV3TPGapOW9BnjLQNpzeQK8fAUHOsEsJwB6D0D2LOvYVjPKQwzDWAYZscwrMPI2EcIImLtRDBTsW39iiCUqcL/4AszwEUHwOcnAKYHAS7Yn8Sf+Tuj8gsCSqy3l9GAqHzjqXJ/AaR/W/9Pzcd6AAAAAElFTkSuQmCC" alt=""/><picture><source type="image/avif" data-srcset="/static/cf052c2134f0abd114c107d149d0dd49/2b382/main.avif 750w,/static/cf052c2134f0abd114c107d149d0dd49/a6808/main.avif 820w" sizes="100vw"/><source type="image/webp" data-srcset="/static/cf052c2134f0abd114c107d149d0dd49/66907/main.webp 750w,/static/cf052c2134f0abd114c107d149d0dd49/898ce/main.webp 820w" sizes="100vw"/><img data-gatsby-image-ssr="" data-main-image="" style="opacity:0" sizes="100vw" decoding="async" loading="lazy" data-src="/static/cf052c2134f0abd114c107d149d0dd49/0022d/main.png" data-srcset="/static/cf052c2134f0abd114c107d149d0dd49/76a4f/main.png 750w,/static/cf052c2134f0abd114c107d149d0dd49/0022d/main.png 820w" alt="(5) 로그인2 -SpringBoot 구현"/></picture><noscript><picture><source type="image/avif" srcSet="/static/cf052c2134f0abd114c107d149d0dd49/2b382/main.avif 750w,/static/cf052c2134f0abd114c107d149d0dd49/a6808/main.avif 820w" sizes="100vw"/><source type="image/webp" srcSet="/static/cf052c2134f0abd114c107d149d0dd49/66907/main.webp 750w,/static/cf052c2134f0abd114c107d149d0dd49/898ce/main.webp 820w" sizes="100vw"/><img data-gatsby-image-ssr="" data-main-image="" style="opacity:0" sizes="100vw" decoding="async" loading="lazy" src="/static/cf052c2134f0abd114c107d149d0dd49/0022d/main.png" srcSet="/static/cf052c2134f0abd114c107d149d0dd49/76a4f/main.png 750w,/static/cf052c2134f0abd114c107d149d0dd49/0022d/main.png 820w" alt="(5) 로그인2 -SpringBoot 구현"/></picture></noscript><script type="module">const t="undefined"!=typeof HTMLImageElement&&"loading"in HTMLImageElement.prototype;if(t){const t=document.querySelectorAll("img[data-main-image]");for(let e of t){e.dataset.src&&(e.setAttribute("src",e.dataset.src),e.removeAttribute("data-src")),e.dataset.srcset&&(e.setAttribute("srcset",e.dataset.srcset),e.removeAttribute("data-srcset"));const t=e.parentNode.querySelectorAll("source[data-srcset]");for(let e of t)e.setAttribute("srcset",e.dataset.srcset),e.removeAttribute("data-srcset");e.complete&&(e.style.opacity=1,e.parentNode.parentNode.querySelector("[data-placeholder-image]").style.opacity=0)}}</script></div></figure><style data-emotion="css vz0k56">.css-vz0k56 *:not(pre)>code[class*='language-']{border-radius:0.3em;background:rgb(32 36 39);border:1px solid #515151;color:white;padding:0.15em 0.5em;white-space:normal;font-size:13px;}@media (max-width: 800px){.css-vz0k56 *:not(pre)>code[class*='language-']{display:inline;}}.css-vz0k56 .gatsby-highlight-code-line{display:block;margin-right:-1.3125rem;margin-left:-1.3125rem;padding-right:1em;padding-left:1.25em;background-color:rgb(0 0 0 / 40%);border-left:0.25em solid #818181;font-size:1.4rem;}.css-vz0k56 .gatsby-highlight{margin-bottom:1.75rem;margin-left:-1.3125rem;margin-right:-1.3125rem;border-radius:10px;background:rgb(32 36 39);border:1px solid none;-webkit-overflow-scrolling:touch;overflow:auto;}.css-vz0k56 .gatsby-highlight pre[class*='language-']{float:left;min-width:100%;font-size:1.4rem;line-height:24px;}.css-vz0k56 pre[class*='language-'],.css-vz0k56 code[class*='language-']{color:#c9d1d9;text-shadow:none;font-family:Consolas,Monaco,'Andale Mono','Ubuntu Mono',monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;}.css-vz0k56 pre[class*='language-']::-webkit-scrollbar,.css-vz0k56 code[class*='language-']::-webkit-scrollbar{background-color:transparent;height:4px;}.css-vz0k56 pre[class*='language-']::-webkit-scrollbar-thumb,.css-vz0k56 code[class*='language-']::-webkit-scrollbar-thumb{border-radius:8px;background-color:hsla(230, 5%, 35%, 1);}@media (max-width: 800px){.css-vz0k56 pre[class*='language-'],.css-vz0k56 code[class*='language-']{display:inline-block;}}.css-vz0k56 pre[class*='language-']{overflow:auto;}.css-vz0k56 .token{font-size:1.4rem;}.css-vz0k56 pre[data-line]{padding:1em 0 1em 3em;position:relative;}@media print{.css-vz0k56 pre[class*='language-'],.css-vz0k56 code[class*='language-']{text-shadow:none;}}.css-vz0k56 pre[class*='language-']{padding:1em;overflow:auto;margin:0;}.css-vz0k56:not(pre)>code[class*='language-']{padding:0.1em 0.3em;border-radius:0.3em;color:#c9d1d9;background:#343942;}.css-vz0k56 pre[data-line]{position:relative;}.css-vz0k56 pre[class*='language-']>code[class*='language-']{position:relative;z-index:1;}.css-vz0k56 .line-highlight{position:absolute;left:0;right:0;padding:inherit 0;margin-top:1em;background:#2f2a1e;box-shadow:inset 5px 0 0 #674c16;z-index:0;pointer-events:none;line-height:inherit;white-space:pre;}.css-vz0k56 .namespace{opacity:0.7;}.css-vz0k56 .token.comment,.css-vz0k56 .token.prolog,.css-vz0k56 .token.doctype,.css-vz0k56 .token.cdata{color:#8b949e;}.css-vz0k56 .token.punctuation{color:#c9d1d9;}.css-vz0k56 .token.property,.css-vz0k56 .token.tag,.css-vz0k56 .token.boolean,.css-vz0k56 .token.number,.css-vz0k56 .token.constant,.css-vz0k56 .token.symbol,.css-vz0k56 .token.deleted{color:#79c0ff;}.css-vz0k56 .token.selector,.css-vz0k56 .token.attr-name,.css-vz0k56 .token.string,.css-vz0k56 .token.char,.css-vz0k56 .token.builtin,.css-vz0k56 .token.inserted{color:#a5d6ff;}.css-vz0k56 .token.operator,.css-vz0k56 .token.entity,.css-vz0k56 .token.url,.css-vz0k56 .language-css .token.string,.css-vz0k56 .style .token.string{color:#a5d6ff;}.css-vz0k56 .token.atrule,.css-vz0k56 .token.attr-value,.css-vz0k56 .token.keyword{color:#a5d6ff;}.css-vz0k56 .token.function{color:#d2a8ff;}.css-vz0k56 .token.regex,.css-vz0k56 .token.important,.css-vz0k56 .token.variable{color:#a8daff;}.css-vz0k56 .token.important,.css-vz0k56 .token.bold{font-weight:bold;}.css-vz0k56 .token.italic{font-style:italic;}.css-vz0k56 .token.entity{cursor:help;}</style><style data-emotion="css ycutun">.css-ycutun{position:relative;margin:0 auto;padding:0 100px 6vw;min-height:230px;font-size:2rem;line-height:1.6em;background:#191b1f;border-radius:6px;}@media (max-width: 1170px){.css-ycutun{padding:0 11vw;}}@media (max-width: 800px){.css-ycutun{padding:0 5vw;font-size:1.8rem;}}@media (max-width: 500px){.css-ycutun{padding:0;}}@media (max-width: 500px){.css-ycutun .post-full-custom-excerpt{font-size:1.9rem;line-height:1.5em;}}.css-ycutun .no-image{padding-top:0;}.css-ycutun h1,.css-ycutun h2,.css-ycutun h3,.css-ycutun h4,.css-ycutun h5,.css-ycutun h6,.css-ycutun p,.css-ycutun ul,.css-ycutun ol,.css-ycutun dl,.css-ycutun pre,.css-ycutun blockquote,.css-ycutun .post-full-comments,.css-ycutun .footnotes{margin:0 0 1.5em 0;min-width:100%;}@media (max-width: 500px){.css-ycutun p,.css-ycutun ul,.css-ycutun ol,.css-ycutun dl,.css-ycutun pre,.css-ycutun .post-full-comments,.css-ycutun .footnotes{margin-bottom:1.28em;}}.css-ycutun li{word-break:break-word;}.css-ycutun li p{margin:0;}.css-ycutun a{color:#0a84ff;}.css-ycutun a[class*='image'],.css-ycutun a[class*='image']:hover{box-shadow:none;}.css-ycutun a[class*='image'] span[class*='image'],.css-ycutun a[class*='image']:hover span[class*='image']{border-radius:6px;}.css-ycutun strong,.css-ycutun em{color:#fff;}.css-ycutun small{display:inline-block;line-height:1.6em;}.css-ycutun img,.css-ycutun video{display:block;margin:2em auto;max-width:840px;height:auto;border-radius:6px;border:1px solid hsl(230 6% 23%);}@media (max-width: 1040px){.css-ycutun img,.css-ycutun video{width:100%;}}.css-ycutun img[src$='#full']{max-width:none;width:100vw;}.css-ycutun img+br+small{display:block;margin-top:-3em;margin-bottom:1.5em;text-align:center;}.css-ycutun iframe{margin:10px auto 20px;}.css-ycutun blockquote{margin:0 0 1.5em;padding:0 1.5em;border-left:hsl(230 6% 23%) 3px solid;}@media (max-width: 500px){.css-ycutun blockquote{padding:0 1.3em;}}.css-ycutun blockquote p{margin:0 0 1em 0;color:inherit;font-size:inherit;line-height:inherit;font-style:italic;}.css-ycutun blockquote p:last-child{margin-bottom:0;}.css-ycutun code{padding:0 5px 2px;font-size:0.8em;line-height:1em;font-weight:400!important;background:#fff;border-radius:3px;color:#fff;font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,'Noto Sans','Ubuntu','Droid Sans','Helvetica Neue',sans-serif;}.css-ycutun p code{word-break:keep-all;}.css-ycutun pre{overflow-x:auto;padding:20px;max-width:100%;color:#e5eff5;font-size:1.4rem;line-height:1.5em;border-radius:5px;}.css-ycutun pre code{padding:0;font-size:inherit;line-height:inherit;background:transparent;}.css-ycutun pre code :not(span){color:inherit;}.css-ycutun .fluid-width-video-wrapper{margin:1.5em 0 3em;}.css-ycutun hr{margin:2em 0;}.css-ycutun hr+p{margin-top:1.2em;}.css-ycutun h1,.css-ycutun h2,.css-ycutun h3,.css-ycutun h4,.css-ycutun h5,.css-ycutun h6{color:rgba(255, 255, 255, 0.9);font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,'Noto Sans','Ubuntu','Droid Sans','Helvetica Neue',sans-serif;}.css-ycutun h1{margin:0.5em 0 0.4em;font-size:4.2rem;line-height:1.25em;font-weight:600;}.css-ycutun p+h1{margin-top:0.8em;}@media (max-width: 800px){.css-ycutun h1{font-size:3.2rem;line-height:1.25em;}}.css-ycutun h2{margin:0.5em 0 0.4em;font-size:3.2rem;line-height:1.25em;font-weight:600;}.css-ycutun p+h2{margin-top:0.8em;}@media (max-width: 800px){.css-ycutun h2{margin-bottom:0.3em;font-size:2.8rem;line-height:1.25em;}}.css-ycutun h3{margin:0.5em 0 0.2em;font-size:2.5rem;line-height:1.3em;font-weight:600;}.css-ycutun h2+h3{margin-top:0.7em;}@media (max-width: 800px){.css-ycutun h3{margin-bottom:0.3em;font-size:2.4rem;line-height:1.3em;}}.css-ycutun h4{margin:0.5em 0 0.2em;font-size:1.8rem;font-weight:600;}.css-ycutun h2+h4{margin-top:0.7em;}.css-ycutun h3+h4{margin-top:0;}@media (max-width: 800px){.css-ycutun h4{margin-bottom:0.3em;font-size:1.8rem;line-height:1.3em;}}.css-ycutun h5{display:block;margin:0.5em 0;padding:0.4em 1em 0.9em;border:0;color:#3eb0ef;font-size:3.2rem;line-height:1.35em;text-align:center;}@media (min-width: 1180px){.css-ycutun h5{max-width:1060px;}}@media (max-width: 800px){.css-ycutun h5{margin-bottom:1em;margin-left:1.3em;padding:0 0 0.5em;font-size:2.4rem;text-align:initial;}}.css-ycutun h6{margin:0.5em 0 0.2em 0;font-size:2rem;font-weight:700;}@media (max-width: 800px){.css-ycutun h6{font-size:1.8rem;line-height:1.4em;}}.css-ycutun table{display:inline-block;overflow-x:auto;margin:0.5em 0 2.5em;max-width:100%;width:auto;border-spacing:0;border-collapse:collapse;font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,'Noto Sans','Ubuntu','Droid Sans','Helvetica Neue',sans-serif;font-size:1.6rem;white-space:nowrap;vertical-align:top;}.css-ycutun table{-webkit-overflow-scrolling:touch;background:radial-gradient(
          ellipse at left,
          rgba(0, 0, 0, 0.2) 0%,
          rgba(0, 0, 0, 0) 75%
        ) 0 center,radial-gradient(
          ellipse at right,
          rgba(0, 0, 0, 0.2) 0%,
          rgba(0, 0, 0, 0) 75%
        ) 100% center;background-attachment:scroll,scroll;-webkit-background-size:10px 100%,10px 100%;background-size:10px 100%,10px 100%;background-repeat:no-repeat;}.css-ycutun table td:first-of-type{background-image:linear-gradient(
        to right,
        #191b1f 50%,
        #191b1f 100%
      );-webkit-background-size:20px 100%;background-size:20px 100%;background-repeat:no-repeat;}.css-ycutun table td:last-child{background-image:linear-gradient(
        270deg,
        #191b1f 50%,
        rgba(25, 27, 31, 0)
      );-webkit-background-position:100% 0;background-position:100% 0;-webkit-background-size:20px 100%;background-size:20px 100%;background-repeat:no-repeat;}.css-ycutun table th{color:rgba(255, 255, 255, 0.85);font-size:1.2rem;font-weight:700;letter-spacing:0.2px;text-align:left;text-transform:uppercase;background-color:#2b2f36;}.css-ycutun table th,.css-ycutun table td{padding:6px 12px;border:#2b2f36 1px solid;}.css-ycutun figcaption{color:rgba(255, 255, 255, 0.6);}.css-ycutun *:not(pre)>code[class*='language-']{border-radius:0.3em;background:rgb(32 36 39);border:1px solid #515151;color:white;padding:0.15em 0.5em;white-space:normal;font-size:13px;}@media (max-width: 800px){.css-ycutun *:not(pre)>code[class*='language-']{display:inline;}}.css-ycutun .gatsby-highlight-code-line{display:block;margin-right:-1.3125rem;margin-left:-1.3125rem;padding-right:1em;padding-left:1.25em;background-color:rgb(0 0 0 / 40%);border-left:0.25em solid #818181;font-size:1.4rem;}.css-ycutun .gatsby-highlight{margin-bottom:1.75rem;margin-left:-1.3125rem;margin-right:-1.3125rem;border-radius:10px;background:rgb(32 36 39);border:1px solid none;-webkit-overflow-scrolling:touch;overflow:auto;}.css-ycutun .gatsby-highlight pre[class*='language-']{float:left;min-width:100%;font-size:1.4rem;line-height:24px;}.css-ycutun pre[class*='language-'],.css-ycutun code[class*='language-']{color:#c9d1d9;text-shadow:none;font-family:Consolas,Monaco,'Andale Mono','Ubuntu Mono',monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;}.css-ycutun pre[class*='language-']::-webkit-scrollbar,.css-ycutun code[class*='language-']::-webkit-scrollbar{background-color:transparent;height:4px;}.css-ycutun pre[class*='language-']::-webkit-scrollbar-thumb,.css-ycutun code[class*='language-']::-webkit-scrollbar-thumb{border-radius:8px;background-color:hsla(230, 5%, 35%, 1);}@media (max-width: 800px){.css-ycutun pre[class*='language-'],.css-ycutun code[class*='language-']{display:inline-block;}}.css-ycutun pre[class*='language-']{overflow:auto;}.css-ycutun .token{font-size:1.4rem;}.css-ycutun pre[data-line]{padding:1em 0 1em 3em;position:relative;}@media print{.css-ycutun pre[class*='language-'],.css-ycutun code[class*='language-']{text-shadow:none;}}.css-ycutun pre[class*='language-']{padding:1em;overflow:auto;margin:0;}.css-ycutun:not(pre)>code[class*='language-']{padding:0.1em 0.3em;border-radius:0.3em;color:#c9d1d9;background:#343942;}.css-ycutun pre[data-line]{position:relative;}.css-ycutun pre[class*='language-']>code[class*='language-']{position:relative;z-index:1;}.css-ycutun .line-highlight{position:absolute;left:0;right:0;padding:inherit 0;margin-top:1em;background:#2f2a1e;box-shadow:inset 5px 0 0 #674c16;z-index:0;pointer-events:none;line-height:inherit;white-space:pre;}.css-ycutun .namespace{opacity:0.7;}.css-ycutun .token.comment,.css-ycutun .token.prolog,.css-ycutun .token.doctype,.css-ycutun .token.cdata{color:#8b949e;}.css-ycutun .token.punctuation{color:#c9d1d9;}.css-ycutun .token.property,.css-ycutun .token.tag,.css-ycutun .token.boolean,.css-ycutun .token.number,.css-ycutun .token.constant,.css-ycutun .token.symbol,.css-ycutun .token.deleted{color:#79c0ff;}.css-ycutun .token.selector,.css-ycutun .token.attr-name,.css-ycutun .token.string,.css-ycutun .token.char,.css-ycutun .token.builtin,.css-ycutun .token.inserted{color:#a5d6ff;}.css-ycutun .token.operator,.css-ycutun .token.entity,.css-ycutun .token.url,.css-ycutun .language-css .token.string,.css-ycutun .style .token.string{color:#a5d6ff;}.css-ycutun .token.atrule,.css-ycutun .token.attr-value,.css-ycutun .token.keyword{color:#a5d6ff;}.css-ycutun .token.function{color:#d2a8ff;}.css-ycutun .token.regex,.css-ycutun .token.important,.css-ycutun .token.variable{color:#a8daff;}.css-ycutun .token.important,.css-ycutun .token.bold{font-weight:bold;}.css-ycutun .token.italic{font-style:italic;}.css-ycutun .token.entity{cursor:help;}</style><section class="post-full-content css-ycutun e14ijd7g0"><div><blockquote>
<p>Spring Security와 JWT를 사용해서 로그인 기능을 구현했다. Spring Security의 구현된 소스와 login의 Service 단 내부 로직을 개념에 맞춰서 알아보자.</p>
</blockquote>
<br/>
<p>이제 실제적으로 SpringBoot부터 구현하자.</p>
<h2 id="Dependency-등록" style="position:relative">Dependency 등록<a href="#Dependency-%EB%93%B1%EB%A1%9D" aria-label="Dependency 등록 permalink" class="auto-link after"><svg viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a></h2>
<p>첫번째로, build.gradle에 dependencies를 추가해주자.</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">implementation &#x27;org.springframework.boot:spring-boot-starter-security&#x27;
implementation &#x27;io.jsonwebtoken:jjwt:0.9.1&#x27;</code></pre></div>
<br/>
<h2 id="Common-세팅" style="position:relative">Common 세팅<a href="#Common-%EC%84%B8%ED%8C%85" aria-label="Common 세팅 permalink" class="auto-link after"><svg viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a></h2>
<p>common이란 패키지 밑에 security 패키지를 만들었다. 이곳에 이제 Security 관련 class들이   들어갈 예정이다. 그 밑에 UserService 관련 객체가 들어갈 securityUser 패키지를 만들고 Spring Security의 전체 구조 사진의 5,6,7 번에 해당하는 UserDetailsService, UserDetail을 구현한 클래스를 만들었다.</p>
<h3 id="SecurityUser" style="position:relative">SecurityUser<a href="#SecurityUser" aria-label="SecurityUser permalink" class="auto-link after"><svg viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a></h3>
<div class="gatsby-highlight" data-language="java"><pre class="language-java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>pozafly<span class="token punctuation">.</span>tripllo<span class="token punctuation">.</span>common<span class="token punctuation">.</span>security<span class="token punctuation">.</span>securityUser</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>pozafly<span class="token punctuation">.</span>tripllo<span class="token punctuation">.</span>user<span class="token punctuation">.</span>model<span class="token punctuation">.</span></span><span class="token class-name">User</span></span><span class="token punctuation">;</span>   <span class="token comment">// security 외에 Tripllo에서 직접 사용하는 User class</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>security<span class="token punctuation">.</span>core<span class="token punctuation">.</span></span><span class="token class-name">GrantedAuthority</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>security<span class="token punctuation">.</span>core<span class="token punctuation">.</span>userdetails<span class="token punctuation">.</span></span><span class="token class-name">UserDetails</span></span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">Collection</span></span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SecurityUser</span> <span class="token keyword">implements</span> <span class="token class-name">UserDetails</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token class-name">Collection</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span> <span class="token keyword">extends</span> <span class="token class-name">GrantedAuthority</span><span class="token punctuation">&gt;</span></span> authorities<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">User</span> user<span class="token punctuation">;</span>   <span class="token comment">// 이곳에 Tripllo의 User 객체를 넣어준다.</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">Collection</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span> <span class="token keyword">extends</span> <span class="token class-name">GrantedAuthority</span><span class="token punctuation">&gt;</span></span> <span class="token function">getAuthorities</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> authorities<span class="token punctuation">;</span> <span class="token punctuation">}</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getPassword</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> user<span class="token punctuation">.</span><span class="token function">getPassword</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>     <span class="token comment">// 패스워드를 들고오는 부분</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getUsername</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> user<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>   <span class="token comment">// id를 들고오는 부분</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">isAccountNonExpired</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">isAccountNonLocked</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">isCredentialsNonExpired</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">isEnabled</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div>
<p>UserDetails를 구현한 class이다. UserDetails는 SpringSecurity의 인터페이스이고, 우리 프로젝트에서 만든 인터페이스가 아니다. Tripllo에서 사용하  는 객체는 User 하나다. 제일 위 사진을 보면 6번에 해당하는 UserDetails 를 구현체로 한 구현 class가 해당 class이며 이는 Tripllo에서 실제로 사용하는 User 객체의 id, pw를 사용하는 모습을 볼 수 있다.</p>
<br/>
<h3 id="UserDetailsService" style="position:relative">UserDetailsService<a href="#UserDetailsService" aria-label="UserDetailsService permalink" class="auto-link after"><svg viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a></h3>
<div class="gatsby-highlight" data-language="java"><pre class="language-java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>pozafly<span class="token punctuation">.</span>tripllo<span class="token punctuation">.</span>common<span class="token punctuation">.</span>security<span class="token punctuation">.</span>securityUser</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>security<span class="token punctuation">.</span>core<span class="token punctuation">.</span>userdetails<span class="token punctuation">.</span></span><span class="token class-name">UserDetails</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>security<span class="token punctuation">.</span>core<span class="token punctuation">.</span>userdetails<span class="token punctuation">.</span></span><span class="token class-name">UsernameNotFoundException</span></span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">UserDetailsService</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token class-name">UserDetails</span> <span class="token function">loadUserByUsername</span><span class="token punctuation">(</span><span class="token class-name">String</span> username<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">UsernameNotFoundException</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre></div>
<p>다음으로 볼 것은 위 그림에 5,6,7 번이 모두 물려있는 UserDetailService다. 이 인터페이스는 구현체인 UserDetailServiceImpl에서 이어지는데 하나의 메서드만 가지고 있다. <code class="language-text">loadUserByUsername()</code>. 이 메서드 또한 SpringSecurity에서 자체적으로 제공하는 메서드인데 매개변수로 String username이 들어간다. 이름에서 알 수 있듯, username이라는 구분 값으로 DB에 접속해서 user의 정보를 가져오는 메서드.</p>
<br/>
<h3 id="UserDetailServiceImpl" style="position:relative">UserDetailServiceImpl<a href="#UserDetailServiceImpl" aria-label="UserDetailServiceImpl permalink" class="auto-link after"><svg viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a></h3>
<div class="gatsby-highlight" data-language="java"><pre class="language-java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>pozafly<span class="token punctuation">.</span>tripllo<span class="token punctuation">.</span>common<span class="token punctuation">.</span>security<span class="token punctuation">.</span>securityUser</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>pozafly<span class="token punctuation">.</span>tripllo<span class="token punctuation">.</span>user<span class="token punctuation">.</span>dao<span class="token punctuation">.</span></span><span class="token class-name">UserDao</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>pozafly<span class="token punctuation">.</span>tripllo<span class="token punctuation">.</span>user<span class="token punctuation">.</span>model<span class="token punctuation">.</span></span><span class="token class-name">User</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">lombok<span class="token punctuation">.</span>extern<span class="token punctuation">.</span>log4j<span class="token punctuation">.</span></span><span class="token class-name">Log4j2</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>beans<span class="token punctuation">.</span>factory<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Autowired</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>security<span class="token punctuation">.</span>core<span class="token punctuation">.</span></span><span class="token class-name">GrantedAuthority</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>security<span class="token punctuation">.</span>core<span class="token punctuation">.</span>authority<span class="token punctuation">.</span></span><span class="token class-name">SimpleGrantedAuthority</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>security<span class="token punctuation">.</span>core<span class="token punctuation">.</span>userdetails<span class="token punctuation">.</span></span><span class="token class-name">UserDetails</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>security<span class="token punctuation">.</span>core<span class="token punctuation">.</span>userdetails<span class="token punctuation">.</span></span><span class="token class-name">UserDetailsService</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>security<span class="token punctuation">.</span>core<span class="token punctuation">.</span>userdetails<span class="token punctuation">.</span></span><span class="token class-name">UsernameNotFoundException</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>stereotype<span class="token punctuation">.</span></span><span class="token class-name">Service</span></span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">ArrayList</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">Collection</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">List</span></span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@Log4j2</span>
<span class="token annotation punctuation">@Service</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">UserDetailsServiceImpl</span> <span class="token keyword">implements</span> <span class="token class-name">UserDetailsService</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">private</span> <span class="token class-name">UserDao</span> userDao<span class="token punctuation">;</span>   <span class="token comment">// Tripllo 유저 조회하기 위해 DI</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">UserDetails</span> <span class="token function">loadUserByUsername</span><span class="token punctuation">(</span><span class="token class-name">String</span> username<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">UsernameNotFoundException</span> <span class="token punctuation">{</span>
        <span class="token comment">// 로그인 시도하려는 유저정보 조회</span>
        log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;security loadUserByUsername에서 유저 조회&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">User</span> user <span class="token operator">=</span> userDao<span class="token punctuation">.</span><span class="token function">readUser</span><span class="token punctuation">(</span>username<span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">// tripllo에서 사용하는 User 조회 메서드</span>

        <span class="token comment">// 조회가 되지않는 User는 에러발생.</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>user <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">UsernameNotFoundException</span><span class="token punctuation">(</span>username<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>

        <span class="token comment">// 조회한 정보를 userCustom에 담는다.</span>
        <span class="token comment">// 만약 파라미터를 추가해야한다면 UserCustom 을 먼저 수정한다.</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">SecurityUser</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token annotation punctuation">@Override</span>
            <span class="token keyword">public</span> <span class="token class-name">Collection</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span> <span class="token keyword">extends</span> <span class="token class-name">GrantedAuthority</span><span class="token punctuation">&gt;</span></span> <span class="token function">getAuthorities</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">GrantedAuthority</span><span class="token punctuation">&gt;</span></span> authorities <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">GrantedAuthority</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                authorities<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">SimpleGrantedAuthority</span><span class="token punctuation">(</span>user<span class="token punctuation">.</span><span class="token function">getRole</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// Role을 위해</span>
                <span class="token keyword">return</span> authorities<span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token annotation punctuation">@Override</span>
            <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getPassword</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> user<span class="token punctuation">.</span><span class="token function">getPassword</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
            <span class="token annotation punctuation">@Override</span>
            <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getUsername</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> user<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
            <span class="token annotation punctuation">@Override</span>
            <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">isAccountNonExpired</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
            <span class="token annotation punctuation">@Override</span>
            <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">isAccountNonLocked</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
            <span class="token annotation punctuation">@Override</span>
            <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">isCredentialsNonExpired</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
            <span class="token annotation punctuation">@Override</span>
            <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">isEnabled</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre></div>
<p>구현체인 UserServiceImpl 에서는 <code class="language-text">loadUserByUsername()</code>를 정의해준다. Tripllo에서 사용하 는 user를 조회하는 Dao를 DI해서 MyBatis로 연결되어 유저 정보를 조회해서 가져오고, username에는 user.getId(), password에는 user.getId()를 사용해서 넣어주었다. Role에 대해서는 밑에서 설명 예정.</p>
<br/>
<h3 id="JwtTokenProvider" style="position:relative">JwtTokenProvider<a href="#JwtTokenProvider" aria-label="JwtTokenProvider permalink" class="auto-link after"><svg viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a></h3>
<div class="gatsby-highlight" data-language="java"><pre class="language-java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>pozafly<span class="token punctuation">.</span>tripllo<span class="token punctuation">.</span>common<span class="token punctuation">.</span>security</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">io<span class="token punctuation">.</span>jsonwebtoken<span class="token punctuation">.</span></span><span class="token class-name">Claims</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">io<span class="token punctuation">.</span>jsonwebtoken<span class="token punctuation">.</span></span><span class="token class-name">Jws</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">io<span class="token punctuation">.</span>jsonwebtoken<span class="token punctuation">.</span></span><span class="token class-name">Jwts</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">io<span class="token punctuation">.</span>jsonwebtoken<span class="token punctuation">.</span></span><span class="token class-name">SignatureAlgorithm</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">lombok<span class="token punctuation">.</span></span><span class="token class-name">RequiredArgsConstructor</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>security<span class="token punctuation">.</span>authentication<span class="token punctuation">.</span></span><span class="token class-name">UsernamePasswordAuthenticationToken</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>security<span class="token punctuation">.</span>core<span class="token punctuation">.</span></span><span class="token class-name">Authentication</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>security<span class="token punctuation">.</span>core<span class="token punctuation">.</span>userdetails<span class="token punctuation">.</span></span><span class="token class-name">UserDetails</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>security<span class="token punctuation">.</span>core<span class="token punctuation">.</span>userdetails<span class="token punctuation">.</span></span><span class="token class-name">UserDetailsService</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>stereotype<span class="token punctuation">.</span></span><span class="token class-name">Component</span></span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">javax<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">PostConstruct</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>http<span class="token punctuation">.</span></span><span class="token class-name">HttpServletRequest</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">Base64</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">Date</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">List</span></span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@RequiredArgsConstructor</span>
<span class="token annotation punctuation">@Component</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">JwtTokenProvider</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">String</span> secretKey <span class="token operator">=</span> <span class="token string">&quot;triplloApplication&quot;</span><span class="token punctuation">;</span>

    <span class="token comment">// 토큰 유효시간 60분 * 24 = 24시간</span>
    <span class="token keyword">private</span> <span class="token keyword">long</span> tokenValidTime <span class="token operator">=</span> <span class="token number">60</span> <span class="token operator">*</span> <span class="token number">60</span> <span class="token operator">*</span> <span class="token number">24</span> <span class="token operator">*</span> <span class="token number">1000L</span><span class="token punctuation">;</span>

    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">UserDetailsService</span> userDetailsService<span class="token punctuation">;</span>

    <span class="token comment">// 객체 초기화, secretKey를 Base64로 인코딩한다.</span>
    <span class="token annotation punctuation">@PostConstruct</span>
    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        secretKey <span class="token operator">=</span> <span class="token class-name">Base64</span><span class="token punctuation">.</span><span class="token function">getEncoder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">encodeToString</span><span class="token punctuation">(</span>secretKey<span class="token punctuation">.</span><span class="token function">getBytes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// JWT 토큰 생성</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">createToken</span><span class="token punctuation">(</span><span class="token class-name">String</span> userPk<span class="token punctuation">,</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> roles<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Claims</span> claims <span class="token operator">=</span> <span class="token class-name">Jwts</span><span class="token punctuation">.</span><span class="token function">claims</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setSubject</span><span class="token punctuation">(</span>userPk<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// JWT payload 에 저장되는 정보단위</span>
        claims<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;roles&quot;</span><span class="token punctuation">,</span> roles<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 정보는 key / value 쌍으로 저장된다.</span>
        <span class="token class-name">Date</span> now <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token class-name">Jwts</span><span class="token punctuation">.</span><span class="token function">builder</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">setClaims</span><span class="token punctuation">(</span>claims<span class="token punctuation">)</span> <span class="token comment">// 정보 저장</span>
                <span class="token punctuation">.</span><span class="token function">setIssuedAt</span><span class="token punctuation">(</span>now<span class="token punctuation">)</span> <span class="token comment">// 토큰 발행 시간 정보</span>
                <span class="token punctuation">.</span><span class="token function">setExpiration</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span>now<span class="token punctuation">.</span><span class="token function">getTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> tokenValidTime<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// set Expire Time</span>
                <span class="token punctuation">.</span><span class="token function">signWith</span><span class="token punctuation">(</span><span class="token class-name">SignatureAlgorithm</span><span class="token punctuation">.</span><span class="token constant">HS256</span><span class="token punctuation">,</span> secretKey<span class="token punctuation">)</span>  <span class="token comment">// 사용할 암호화 알고리즘, signature 에 들어갈 secret값 세팅</span>
                <span class="token punctuation">.</span><span class="token function">compact</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// JWT 토큰에서 인증 정보 조회</span>
    <span class="token keyword">public</span> <span class="token class-name">Authentication</span> <span class="token function">getAuthentication</span><span class="token punctuation">(</span><span class="token class-name">String</span> token<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">UserDetails</span> userDetails <span class="token operator">=</span> userDetailsService<span class="token punctuation">.</span><span class="token function">loadUserByUsername</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getUserPk</span><span class="token punctuation">(</span>token<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">UsernamePasswordAuthenticationToken</span><span class="token punctuation">(</span>userDetails<span class="token punctuation">,</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span> userDetails<span class="token punctuation">.</span><span class="token function">getAuthorities</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// 토큰에서 회원 정보 추출</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getUserPk</span><span class="token punctuation">(</span><span class="token class-name">String</span> token<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token class-name">Jwts</span><span class="token punctuation">.</span><span class="token function">parser</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setSigningKey</span><span class="token punctuation">(</span>secretKey<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">parseClaimsJws</span><span class="token punctuation">(</span>token<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getBody</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getSubject</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// Request의 Header에서 token 값을 가져옴. &quot;Authorization&quot; : &quot;TOKEN값&#x27;</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">resolveToken</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> request<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> request<span class="token punctuation">.</span><span class="token function">getHeader</span><span class="token punctuation">(</span><span class="token string">&quot;Authorization&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// 토큰의 유효성 + 만료일자 확인</span>
    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">validateToken</span><span class="token punctuation">(</span><span class="token class-name">String</span> jwtToken<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token class-name">Jws</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Claims</span><span class="token punctuation">&gt;</span></span> claims <span class="token operator">=</span> <span class="token class-name">Jwts</span><span class="token punctuation">.</span><span class="token function">parser</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setSigningKey</span><span class="token punctuation">(</span>secretKey<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">parseClaimsJws</span><span class="token punctuation">(</span>jwtToken<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token operator">!</span>claims<span class="token punctuation">.</span><span class="token function">getBody</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getExpiration</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">before</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre></div>
<p>위의 사진에 4,5,7,8번이 물려있는 AuthenticationProviders의 하나인 JwtTokenProvider를 만들어주었다.</p>
<ul>
<li>
<p>init() : 상단의 secretKey 상수에 물려있는 String 값을 기반으로 Base64 로 인코딩해서 토큰을 생성한다. 물론 이 부분은 application.properties나 application.yml로 빼서 @Value 로 받아와 사용하는것이 좋겠다.</p>
</li>
<li>
<p>createToken() : userPK(가령 id)와 role list를 매개변수로 받아 Claims를 생성하고, role을 Claims에 집어넣난다. Builder 패턴으로 정보, 토큰 발행시간, 토큰 유효시간, 그리고 사용할 알고리즘을 세팅한다.</p>
</li>
<li>
<p>getAuthentication() : 위에서 생성했던 loadUserByUsername() 메서드를 여기서 사용한다. 클라이언트로부터 받은 token을 파싱해서 이름을 추출하고 userDetails를 가져온다. return 객체는 사진 2번에 물려있는 <code class="language-text">UsernamePasswordAuthenticationToken</code>이다. 이 녀석이 핵심!</p>
</li>
<li>
<p>getUserPk() : 토큰에서 회원 정보 추출.</p>
</li>
<li>
<p>validateToken() : 토큰의 유효성 검사.</p>
</li>
<li>
<p>resolveToken() : 이녀석을 유의해서 봐야하는데 이녀석 때문에 몇시간을 헤멘지 모르겠다. 중요한 것은</p>
</li>
</ul>
<div class="gatsby-highlight" data-language="java"><pre class="language-java"><code class="language-java"><span class="token keyword">return</span> request<span class="token punctuation">.</span><span class="token function">getHeader</span><span class="token punctuation">(</span><span class="token string">&quot;Authorization&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<p>이 부분이다. vue에서 axios로 api를 날릴때 token 이름을 “Token …” 이런식으로 주었더니 토큰을 가져오지 못하는 경우가 발생했다.</p>
<p><span class="gatsby-resp-image-wrapper" style="position:relative;display:block;margin-left:auto;margin-right:auto;max-width:2000px">
      <span class="gatsby-resp-image-background-image" style="padding-bottom:94%;position:relative;bottom:0;left:0;background-image:url(&#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAATCAYAAACQjC21AAAACXBIWXMAABYlAAAWJQFJUiTwAAAD0UlEQVQ4y5WSS2wbRRjHRwguHBESiAuHwIE274QDjlLCUg4kIkhw4YIErUQVIlQkIi5wBKS+oibQRLlw45UHSG7WTuy8VHqJkVAvIQSVuI3X3l3vene99q693pn5o504ISEVgk/6739mZ+anb+b7yPnulx5947XegVMvdLzc2tYldXT3SL29PcK7e3qkMwMDUl//i5J09hWpr/+MdLqtXWpt75TaOrukzq5u6XRbh/RcW8fZzu6e2KnW9kfIZ+9/8PxaMs5WV1JILaeQSCRxM5mGnEggvpjEcnoVqXQa6xsbQsupFNIrK1hZW8PG+jpSy2meWllFPB5X37tw4Wky8cXnfZqS55Wyi3q9zl3X5XnN5IZpck3TecmyuWVZ3LYd7rqVprtiHK2VXZdRSlEoqMWRkZFnyPiNGzFV11m5XOaVapX5fo3XfJ97kTyPe57Pq5E3506lyt2qJ/5VqlVerXqsVqtDVVX93LnzLeTS9fGY49icUwpKKQ/DEI0gAA0DcNo4JkYDVAIPlIYAp/tiIQM4HLukX7z4YQu5duVq7I+7f3LTslG2Lb5bcDCxbOCyXMTVhIHL8YLQlZuq0LhcxFdpG5MpG18KWWwy7eLrVFa/9PHbLeTaxEQsu73NLcNAybK4Y5exdWcbm7c2sbO1iz2zjr2ih5zh457uIWfWUKxwFF0mpLuUlXxgJ6vqb74+2EKuT07GyobBw0YD9SDgYVCHsbuDwtYdeJoC368CLLpygOhqJ4Oz6GsWNf3VwaEWMj09HasFAT9cZQy6YUJRNRglC5qmoVKpotEIQSkTSMY5GOPCaXQAEEUZGhpqIVNTUzHf9wWQcy7cNE0oSg5aBDVM2I4j3K1UEFW0yUDzjJhomvY3sFarHQOqqgpN0+GUXVi2A9t2BIgyFnUCmtuE/yegoihQ8nmRUUgpHhRHoP8OjDZaliWyqnqegPq12tGM/qlD4ODg4IMzjAqxl8shny+gaJgCfBQIzk+8oa5p+vDw8MmicMZgGAZyuRxs24bn+ceueSB24M0KWZalj46OHgLD/W7gURdQJZ+n2WyWmqZJi4ZBnXKZBkEg1qKI9gEQzhkLBdB2VAGcmZnpD4Lg2INb93aR//03lO5nYd7Pws7twVFyKOcjKfCLGupGEY2SidAugTkWzN277keffPosGRsba5Vl+bYsy78synJmSV7MJGe/z8S//Saz+MN3meT8bCb100JmaWEuszS/r+TcbGb5x/nMz0k5cyuxuHk7Kf+6sjC3+NY77z5FCCEPE0IeJ4Q8SQh5oun/RwdnHiOEPPQX+kO8tZZqyUEAAAAASUVORK5CYII=&#x27;);background-size:cover;display:block"></span>
  <img class="gatsby-resp-image-image" alt="devtool-status-code" title="devtool-status-code" src="/static/d3be07e0e33f9ea3884c3022ee04a557/f97d7/devtool-status-code.png" srcSet="/static/d3be07e0e33f9ea3884c3022ee04a557/0eb09/devtool-status-code.png 500w /static/d3be07e0e33f9ea3884c3022ee04a557/1263b/devtool-status-code.png 1000w /static/d3be07e0e33f9ea3884c3022ee04a557/f97d7/devtool-status-code.png 2000w /static/d3be07e0e33f9ea3884c3022ee04a557/5f15a/devtool-status-code.png 2076w" sizes="(max-width: 2000px) 100vw, 2000px" style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0" loading="lazy" decoding="async"/>
    </span></p>
<p>개발자 도구에 Network 탭에서 확인해보자. 만약 위 코드를</p>
<div class="gatsby-highlight" data-language="java"><pre class="language-java"><code class="language-java"><span class="token keyword">return</span> request<span class="token punctuation">.</span><span class="token function">getHeader</span><span class="token punctuation">(</span><span class="token string">&quot;Token&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<p>이라고 했다고 하자. 그럼 클라이언트 단에서 <strong>Authorization</strong> 이라는 header 명으로 axios에서 요청을 보냈다. 그러자 Spring Security에서 인증되지 않아 403 인증 오류를 뱉는다. 즉, resolveToken() 메서드의 getHeader(“Authorization”) 이렇게 이름을 맞춰주거나, axios 로 http call을 날릴 때 헤더명을 “Token” 으로 맞춰주거나 해야 한다.</p>
<br/>
<h3 id="JwtAuthenticationFilter" style="position:relative">JwtAuthenticationFilter<a href="#JwtAuthenticationFilter" aria-label="JwtAuthenticationFilter permalink" class="auto-link after"><svg viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a></h3>
<div class="gatsby-highlight" data-language="java"><pre class="language-java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>pozafly<span class="token punctuation">.</span>tripllo<span class="token punctuation">.</span>common<span class="token punctuation">.</span>security</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">lombok<span class="token punctuation">.</span></span><span class="token class-name">RequiredArgsConstructor</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>security<span class="token punctuation">.</span>core<span class="token punctuation">.</span></span><span class="token class-name">Authentication</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>security<span class="token punctuation">.</span>core<span class="token punctuation">.</span>context<span class="token punctuation">.</span></span><span class="token class-name">SecurityContextHolder</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>filter<span class="token punctuation">.</span></span><span class="token class-name">GenericFilterBean</span></span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span></span><span class="token class-name">FilterChain</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span></span><span class="token class-name">ServletException</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span></span><span class="token class-name">ServletRequest</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span></span><span class="token class-name">ServletResponse</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>http<span class="token punctuation">.</span></span><span class="token class-name">HttpServletRequest</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">IOException</span></span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@RequiredArgsConstructor</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">JwtAuthenticationFilter</span> <span class="token keyword">extends</span> <span class="token class-name">GenericFilterBean</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">JwtTokenProvider</span> jwtTokenProvider<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">doFilter</span><span class="token punctuation">(</span><span class="token class-name">ServletRequest</span> request<span class="token punctuation">,</span> <span class="token class-name">ServletResponse</span> response<span class="token punctuation">,</span> <span class="token class-name">FilterChain</span> chain<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span><span class="token punctuation">,</span> <span class="token class-name">ServletException</span> <span class="token punctuation">{</span>
        <span class="token comment">// 헤더에서 JWT 를 받아옴.</span>
        <span class="token class-name">String</span> token <span class="token operator">=</span> jwtTokenProvider<span class="token punctuation">.</span><span class="token function">resolveToken</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span><span class="token punctuation">)</span> request<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 유효한 토큰인지 확인함.</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>token <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> jwtTokenProvider<span class="token punctuation">.</span><span class="token function">validateToken</span><span class="token punctuation">(</span>token<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// 토큰이 유효하면 토큰으로부터 유저 정보를 받아옴.</span>
            <span class="token class-name">Authentication</span> authentication <span class="token operator">=</span> jwtTokenProvider<span class="token punctuation">.</span><span class="token function">getAuthentication</span><span class="token punctuation">(</span>token<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// SecurityContext 에 Authentication 객체를 저장함.</span>
            <span class="token class-name">SecurityContextHolder</span><span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setAuthentication</span><span class="token punctuation">(</span>authentication<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        chain<span class="token punctuation">.</span><span class="token function">doFilter</span><span class="token punctuation">(</span>request<span class="token punctuation">,</span> response<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre></div>
<p>이번엔 클라이언트에서 가장 먼저 접근했을 때 들어오는 Filter인, <code class="language-text">JwtAuthenticationFilter</code> 를 살펴보자. 모든 filter는 요청이 들어왔을 때 doFilter() 메서드가 실행되며, 마칠 때 다른 filter 가 있다면 chain을 걸어주어야 한다. Provider에서 토큰을 받아오고, 다시 Provider에서 검증하는 과정을 거친다. 이제 마지막 부분인 config 부분을 보자. 이때까지 setting 이었다면, 이번에는 실질적으로 이 config 파일에서 모든 설정을 해줄 수 있다.</p>
<div class="gatsby-highlight" data-language="java"><pre class="language-java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>pozafly<span class="token punctuation">.</span>tripllo<span class="token punctuation">.</span>common<span class="token punctuation">.</span>security</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>google<span class="token punctuation">.</span>common<span class="token punctuation">.</span>collect<span class="token punctuation">.</span></span><span class="token class-name">ImmutableList</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">lombok<span class="token punctuation">.</span></span><span class="token class-name">RequiredArgsConstructor</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>context<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Bean</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>context<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Configuration</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>http<span class="token punctuation">.</span></span><span class="token class-name">HttpMethod</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>security<span class="token punctuation">.</span>authentication<span class="token punctuation">.</span></span><span class="token class-name">AuthenticationManager</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>security<span class="token punctuation">.</span>config<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span>web<span class="token punctuation">.</span>builders<span class="token punctuation">.</span></span><span class="token class-name">HttpSecurity</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>security<span class="token punctuation">.</span>config<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span>web<span class="token punctuation">.</span>configuration<span class="token punctuation">.</span></span><span class="token class-name">EnableWebSecurity</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>security<span class="token punctuation">.</span>config<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span>web<span class="token punctuation">.</span>configuration<span class="token punctuation">.</span></span><span class="token class-name">WebSecurityConfigurerAdapter</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>security<span class="token punctuation">.</span>config<span class="token punctuation">.</span>http<span class="token punctuation">.</span></span><span class="token class-name">SessionCreationPolicy</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>security<span class="token punctuation">.</span>crypto<span class="token punctuation">.</span>bcrypt<span class="token punctuation">.</span></span><span class="token class-name">BCryptPasswordEncoder</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>security<span class="token punctuation">.</span>crypto<span class="token punctuation">.</span>factory<span class="token punctuation">.</span></span><span class="token class-name">PasswordEncoderFactories</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>security<span class="token punctuation">.</span>crypto<span class="token punctuation">.</span>password<span class="token punctuation">.</span></span><span class="token class-name">PasswordEncoder</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>security<span class="token punctuation">.</span>web<span class="token punctuation">.</span>authentication<span class="token punctuation">.</span></span><span class="token class-name">UsernamePasswordAuthenticationFilter</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>cors<span class="token punctuation">.</span></span><span class="token class-name">CorsConfiguration</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>cors<span class="token punctuation">.</span></span><span class="token class-name">CorsConfigurationSource</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>cors<span class="token punctuation">.</span></span><span class="token class-name">UrlBasedCorsConfigurationSource</span></span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@Configuration</span>
<span class="token annotation punctuation">@RequiredArgsConstructor</span>
<span class="token annotation punctuation">@EnableWebSecurity</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">WebSecurityConfig</span> <span class="token keyword">extends</span> <span class="token class-name">WebSecurityConfigurerAdapter</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">JwtTokenProvider</span> jwtTokenProvider<span class="token punctuation">;</span>

    <span class="token comment">// 암호화에 필요한 PasswordEncoder를 Bean으로 등록함.</span>
    <span class="token annotation punctuation">@Bean</span>
    <span class="token keyword">public</span> <span class="token class-name">PasswordEncoder</span> <span class="token function">passwordEncoder</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">BCryptPasswordEncoder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// authenticationManager를 Bean 등록함.</span>
    <span class="token annotation punctuation">@Bean</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">AuthenticationManager</span> <span class="token function">authenticationManagerBean</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">authenticationManagerBean</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// 여기는 CORS 설정임.</span>
    <span class="token annotation punctuation">@Bean</span>
    <span class="token keyword">public</span> <span class="token class-name">CorsConfigurationSource</span> <span class="token function">corsConfigurationSource</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">final</span> <span class="token class-name">CorsConfiguration</span> configuration <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">CorsConfiguration</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      configuration<span class="token punctuation">.</span><span class="token function">setAllowedOrigins</span><span class="token punctuation">(</span><span class="token class-name">ImmutableList</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span><span class="token string">&quot;http://localhost:8080&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;http://tripllo.tech.s3-website.ap-northeast-2.amazonaws.com&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;http://tripllo.tech&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;https://tripllo.tech&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      configuration<span class="token punctuation">.</span><span class="token function">setAllowedMethods</span><span class="token punctuation">(</span><span class="token class-name">ImmutableList</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span><span class="token string">&quot;HEAD&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;GET&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;POST&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;PUT&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;DELETE&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;PATCH&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;OPTIONS&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      configuration<span class="token punctuation">.</span><span class="token function">setAllowCredentials</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token comment">// 토큰을 Authorization 이라는 이름으로 받겠다.</span>
      configuration<span class="token punctuation">.</span><span class="token function">setAllowedHeaders</span><span class="token punctuation">(</span><span class="token class-name">ImmutableList</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span><span class="token string">&quot;Authorization&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Cache-Control&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Content-Type&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">final</span> <span class="token class-name">UrlBasedCorsConfigurationSource</span> source <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">UrlBasedCorsConfigurationSource</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      source<span class="token punctuation">.</span><span class="token function">registerCorsConfiguration</span><span class="token punctuation">(</span><span class="token string">&quot;/**&quot;</span><span class="token punctuation">,</span> configuration<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span> source<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">configure</span><span class="token punctuation">(</span><span class="token class-name">HttpSecurity</span> http<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        http
          <span class="token punctuation">.</span><span class="token function">httpBasic</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">disable</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// rest api 만을 고려하여 기본 설정은 해제.</span>
          <span class="token punctuation">.</span><span class="token function">csrf</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">disable</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// csrf 보안 토큰 disable처리.</span>
          <span class="token punctuation">.</span><span class="token function">formLogin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">disable</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">//기본 로그인 페이지 없애기</span>
          <span class="token punctuation">.</span><span class="token function">sessionManagement</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">sessionCreationPolicy</span><span class="token punctuation">(</span><span class="token class-name">SessionCreationPolicy</span><span class="token punctuation">.</span><span class="token constant">STATELESS</span><span class="token punctuation">)</span> <span class="token comment">// 토큰 기반 인증이므로 세션 역시 사용하지 않음.</span>
          <span class="token punctuation">.</span><span class="token function">and</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">authorizeRequests</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 요청에 대한 사용권한 체크</span>
            <span class="token comment">//                .antMatchers(&quot;/admin/**&quot;).hasRole(&quot;ADMIN&quot;)</span>
            <span class="token punctuation">.</span><span class="token function">antMatchers</span><span class="token punctuation">(</span><span class="token string">&quot;/profile&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">permitAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">antMatchers</span><span class="token punctuation">(</span><span class="token string">&quot;/websocket/**&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">permitAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token comment">// post 방식의 user create(회원가입)은 허용한다.</span>
            <span class="token punctuation">.</span><span class="token function">antMatchers</span><span class="token punctuation">(</span><span class="token class-name">HttpMethod</span><span class="token punctuation">.</span><span class="token constant">POST</span><span class="token punctuation">,</span> <span class="token string">&quot;/api/user&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">permitAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token comment">// 회원가입 전 사용하고 싶은 회원 id를 validation 해볼 수 있는 api도 open</span>
            <span class="token punctuation">.</span><span class="token function">antMatchers</span><span class="token punctuation">(</span><span class="token string">&quot;/api/user/valid/**&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">permitAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token comment">// 로그인 오픈</span>
            <span class="token punctuation">.</span><span class="token function">antMatchers</span><span class="token punctuation">(</span><span class="token string">&quot;/api/login/**&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">permitAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">antMatchers</span><span class="token punctuation">(</span><span class="token string">&quot;/api/logout&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">permitAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">antMatchers</span><span class="token punctuation">(</span><span class="token string">&quot;/api/email/**&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">permitAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

            <span class="token comment">// 인증된 사용자만 가능하다(즉, 헤더에 토큰을 준 사람만이 가능한 것임.)</span>
            <span class="token punctuation">.</span><span class="token function">antMatchers</span><span class="token punctuation">(</span><span class="token string">&quot;/api/**&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">authenticated</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token comment">// role이 ROLE_USER 인 역할만 통과</span>
            <span class="token punctuation">.</span><span class="token function">antMatchers</span><span class="token punctuation">(</span><span class="token string">&quot;/api/**&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">hasRole</span><span class="token punctuation">(</span><span class="token string">&quot;USER&quot;</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">anyRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">authenticated</span><span class="token punctuation">(</span><span class="token punctuation">)</span>   <span class="token comment">// 그외 나머지 요청은 인증 가능 해야한다.</span>
          <span class="token punctuation">.</span><span class="token function">and</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	          <span class="token punctuation">.</span><span class="token function">cors</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
          <span class="token punctuation">.</span><span class="token function">and</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token comment">// JwtAuthenticationFilter를 UsernamePasswordAuthenticationFilter 전에 넣는다</span>
          	<span class="token punctuation">.</span><span class="token function">addFilterBefore</span><span class="token punctuation">(</span>
                <span class="token keyword">new</span> <span class="token class-name">JwtAuthenticationFilter</span><span class="token punctuation">(</span>jwtTokenProvider<span class="token punctuation">)</span><span class="token punctuation">,</span>
                <span class="token class-name">UsernamePasswordAuthenticationFilter</span><span class="token punctuation">.</span><span class="token keyword">class</span>
            <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre></div>
<p>하나씩 천천히 들여다보자.</p>
<ul>
<li>
<p>JwtTokenProvider를 마찬가지로 DI 받아서 사용한다.</p>
</li>
<li>
<p>Spring Security라이브러리에서 제공하는 BCryptPasswordEncoder를 사용한다.</p>
</li>
<li>
<p>사진의 3,4,8,9에 물려있는 AuthenticationManager를 Bean으로 등록해준 다.</p>
</li>
<li>
<p>corsConfigurationSource 는 cors 설정이다. cors는 제작기를 따로 만들어서 다룰 예정이지만 가볍게 짚고 넘어가보자. cors란, 서로 다른 도메인 간 api response를 막는걸 말한다. 쉽게 말해 vue는 <strong>8080</strong> 포트를 사용하고, SpringBoot는 <strong>3000</strong>포트를 사용하는데 포트가 다르기 때문에 리소스를 막아주는 역할을 한다.</p>
<p>SpringSecurity를 도입하기 전에는 WebMvcConfigurer를 상속받은 CorsConfig class를 따로 만들어서 해결했지만, 여기서 cors 설정을 해주면 CorsConfig 가 무시되므로 여기서 보면된다.</p>
<ul>
<li>setAllowedOrigins() : url에 해당하는 출처를 허가하겠다라는 뜻이다. ImmutableList.of() 안에 허용하고 싶은 도메인들을 String 형식으로 적어주면 된다.</li>
<li>setAllowedMethods() : 허용하고 싶은 http 메서드를 마찬가지로 적어준다. 가령 “GET”, “POST”, “PUT”, “DELETE”, “OPTIONS” 같은 메서드들.</li>
<li>setAllowCredentials() : true일 때, header가 없는 응답들은 거르겠다는 뜻이다. header가 있어야 함을 의미.</li>
<li>addAllowedHeaders() : 어떤 이름으로 된 헤더들을 허용하겠느냐? ※addAllowedHeader(”*”) 로 모든 헤더 허용 가능.</li>
<li>그리고 모든 설정한 configuration을 등록해준다.</li>
</ul>
</li>
<li>
<p>configure 메서드에서 SpringSecurity 설정을 해줄 수 있다.</p>
<ul>
<li>
<p>httpBasic().disable() : rest api 이므로 기본설정 사용안함. 기본설정은 비인증시 로그인폼 화면으로 리다이렉트 됨.(vue를 사용할 것이므로.)</p>
</li>
<li>
<p>.csrf().disable() : 마찬가지로 rest api이므로 csrf 보안이 필요없으므로 disable처리.</p>
</li>
<li>
<p>STATELESS 란 무상태성, 비보존한다는 뜻이다. 마찬가지로, 우리는 토큰 기반으로 인증을 계속 할것이기 때문에 세션이 필요없으므로 STATELESS를 사용한다.</p>
<blockquote>
<p>★위 3가지가 중요하다. react 나 vue 같이 서버단에서 화면을 보여주는것이 아니라 따로 존재하는 프론트 단에서는 위 설정이 필요없기 때문이다.</p>
</blockquote>
</li>
<li>
<p>antMatchers() 는 http 메서드와 url을 적어줄 수 있는데 controller에서 접근하는 url을 말한다. 뒤에 따라오는 .permitAll()은 모두 허용하겠다는 뜻이된다.</p>
</li>
<li>
<p>.antMatchers(“/api/**“).authenticated() 이 부분은 헤더에 토큰은 준 user만 허락한다는 뜻이 된다.</p>
</li>
<li>
<p>.antMatchers(“/api/**“).hasRole(“USER”) : 이부분은 role에 대한 부분이다. role이 밑에서 설명하겠다.</p>
</li>
<li>
<p>그리고 마지막으로 우리가 만들어준 JwtAuthenticationFilter 와 사용하는 UsernamePasswordAuthenticationFilter 를 등록하고 마친다.</p>
</li>
</ul>
</li>
</ul>
<p>참고자료 : <a href="https://dongdd.tistory.com/175" target="_blank" rel="nofollow">https://dongdd.tistory.com/175</a>, <a href="https://postitforhooney.tistory.com/entry/SpringSecurity-%EC%B4%88%EB%B3%B4%EC%9E%90%EA%B0%80-%EC%9D%B4%ED%95%B4%ED%95%98%EB%8A%94-Spring-Security-%ED%8D%BC%EC%98%B4" target="_blank" rel="nofollow">https://postitforhooney.tistory.com/entry/SpringSecurity-%EC%B4%88%EB%B3%B4%EC%9E%90%EA%B0%80-%EC%9D%B4%ED%95%B4%ED%95%98%EB%8A%94-Spring-Security-%ED%8D%BC%EC%98%B4</a>, <a href="https://velog.io/@tlatldms/Spring-boot-Spring-security-JWT-Redis-mySQL-2%ED%8E%B8" target="_blank" rel="nofollow">https://velog.io/@tlatldms/Spring-boot-Spring-security-JWT-Redis-mySQL-2%ED%8E%B8</a></p>
<h4 id="Role에-대해서" style="position:relative">Role에 대해서<a href="#Role%EC%97%90-%EB%8C%80%ED%95%B4%EC%84%9C" aria-label="Role에 대해서 permalink" class="auto-link after"><svg viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a></h4>
<p>role이란, <code class="language-text">역할</code>을 말한다. Workbench의 user 테이블을 보자.</p>
<p><span class="gatsby-resp-image-wrapper" style="position:relative;display:block;margin-left:auto;margin-right:auto;max-width:188px">
      <span class="gatsby-resp-image-background-image" style="padding-bottom:198.93617021276594%;position:relative;bottom:0;left:0;background-image:url(&#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAoCAYAAAD+MdrbAAAACXBIWXMAABYlAAAWJQFJUiTwAAAFwUlEQVRIx62WB1MbSRCF9/9jYzBgHA4RjcGHwQSREdHknJFIEjlKSEhCEtBX37NGF8p356q7qera2dnpnu5+3W/Wu7i4sP9TvI2NDdvc3JQwd+/r6+v2x28/I+z37u/v7ebmRpJMJo33WCxm6XTa7u7uLBqN/quw//r62hKJhHlDQ0PW0dFhJycnxhzp7Ow0v99v5+fndnt7Wzjwn4S9s7Oz5qGMwXA4bH19fdbc3GyfP3+29+/f2+npqTxAAcM/EvcNg729veZdXV0VEorr7sn6X70grB95xzp66HiXl5eGsMCT046Pj7XRHXR2dmZuH0p443R4Z86aUH5+fjYGXhEqMjw8bAMDAzLc2Nho2WzWjo6ObH9/XykhtKamJqWorq5OYDCWlpbMs/zgpMnJye8GAwFra2sTQC0tLQopFArJEGB9+fLFGhoa7Nu3b9bT06OoGMy9XC4nDzKZjLNt8Xhcz1QqpXUHDvOnpyc90UEYj4+PKjPWvXgiYffJpPLwtb3dunt6bHhkxMYnJixydKQKuIvH7TActv2DA/N3d1tgeNi6/H4bCgTs15YWu7q+Vg0vLS+bl0gm7SGTkXJrW5uVlZdbb1+fVVdXy3BNba0U2IwR1ll7+/at9fT2WpXPJ1285bs8RKKxmGWyWXlzcHhol1dXtr2zI2B4Hh0fy8Ob21s7OT2VEQ7CGXQB5uDgwDziR3B5YWGh0JeHh4fKC8g9PDzYbTSqPcsrKxYMBm1tbU375ufn9R0sKJ0CytQQyL169cq6urqsqqrKxsfHraysTIYxQinRQT6fz4qLi621tVXfqQIGeoU6TCWTygPlQ81RzHt7e0I4EonoSR3yPRIOS6J5rx36tK/YBqFUtra3pbgTDCqHrG9vbxf6lmogTxzIYaHdXXnOvsT9vSrFY5J+eFCSQazoxQsVKPP5hQX7papKm8nd6OiovamstJqaGj3bvn61l8XFAgwv+wcGfq/D84sLoTs7N2eTU1M2NT0tAwieg/To2JjNzc8rt4ODg7a6tqZv6KbSadWuR8LpCISwOYly4InnIs+bG5FtNpdTebhSi93dKVxQduRcQBl2qa2ttQ8fPqjp6ddQMKh3Ek4ZUSogTH+z3t7ebhUVFTqUARcUDJL0ra0thTI1NSViGBsb07tDPBAI2MTEhPX396tEVlZWxNJ4zxgZGTGP0HAZcQQRy28gRFJBjlDCU9akk8koTNYo6mQqpbIrgIIXHxsbJX144PerLD41NSlfwVDI1jc29N7R2Sk+hChoAAcKkRXKBugHBgetuqZGBhs/fdI7T3p3ZXXVOru6rKm5WWvk0vGlyiab1QEyKOTicXt6flZI9CReQwz0MPnDC4qdFLCGoEOfOdR1BZAD2g+jJB0WpuFXV1elwBo5cpcWiYdEAAxAAIjSw47Y5o/kAO1TBt3d3eoGjEEGHLazs6N17hC+vX79WtcBoTtygIzlIQLKDBBkA0XKIXgJObgbj5Dd3wKeMYgAIQKP08kjm2i3tfV1W1xcFMKQ6fT0tAj04vJSHbO4tCS06XPm6LiOUcgY0xUQiVhtXZ0VFRWJ2ukEehpygMW5Amj+yspKEUfFmzfW3tFhJaWlIhZQ1q0Xz3tIOPQwnqG8sblp0zMzYuzNrS2tAxbURodAErvw5dmZ9KiKhcXFfKdkMsoNP0y0IE9yR+XDj8zx0tG8+31hjkERSTqtfX+66EGstLRUaNbX19vy8rJVlJfrztnb3VU+3717p6sClCGQkpKSwkVPoRcM0qt4RjgYIlRCnJmZEUPDNsxhHFoMTuRvwjE2Y25u7jsf0th6JpNCDOOuxyl698489/iojlK5MM+XHEZJiVAmP/Qz6DZ8/CgUQffFy5fqU3Ls9v2dgPIMP5z8OXA6SmIPn09S39CgkoAYOCyev4h+JOjDATJ4n6duPhDuZb5n6RaKXd9/QtQg/GOTC+Uml7P/Mpz+b402NW27sjBFAAAAAElFTkSuQmCC&#x27;);background-size:cover;display:block"></span>
  <img class="gatsby-resp-image-image" alt="user-table" title="user-table" src="/static/44914e3d5955a2775e6b441ca2c1c66a/f5101/user-table.png" srcSet="/static/44914e3d5955a2775e6b441ca2c1c66a/f5101/user-table.png 188w" sizes="(max-width: 188px) 100vw, 188px" style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0" loading="lazy" decoding="async"/>
    </span></p>
<p>이렇게 role이라는 column이 있고 ROLE<em>USER라는 값이 String으로 들어있다. spring security의 config 파일에 보면 .antMatchers(“/api/**“).hasRole(“USER”) 이렇게 되어있다. role을 config에 등록해서, 어떤 api 호출이 가능한지 분기를 태울 수 있다는 말이된다. 그리고 hasRole에 USER 라는 값이 있으면 prefix 로 자동으로 앞에 **ROLE</em>** 이라는 값을 붙여서 검증한다. 즉, 일반 유저라는 뜻이 되는 것이고, 만약 user 테이블에 ROLE_ADMIN 의 값을 주고 .antMatchers(“/api/**“).hasRole(“ADMIN”) 이렇게 하면 api에 해당하는 모든 자원을 허용하겠다는 뜻이 된다.</p>
<p>이렇게 Spring Security 와 JWT의 설정을 끝냈다. 이제 UserServiceImpl, LoginServiceImpl의 비지니스 로직에서 password를 어떻게 암호화할 수 있는지 알아보자.</p>
<hr/>
<h2 id="서비스-로직" style="position:relative">서비스 로직<a href="#%EC%84%9C%EB%B9%84%EC%8A%A4-%EB%A1%9C%EC%A7%81" aria-label="서비스 로직 permalink" class="auto-link after"><svg viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a></h2>
<h3 id="회원가입-프로세스" style="position:relative">회원가입 프로세스<a href="#%ED%9A%8C%EC%9B%90%EA%B0%80%EC%9E%85-%ED%94%84%EB%A1%9C%EC%84%B8%EC%8A%A4" aria-label="회원가입 프로세스 permalink" class="auto-link after"><svg viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a></h3>
<p><span class="gatsby-resp-image-wrapper" style="position:relative;display:block;margin-left:auto;margin-right:auto;max-width:1920px">
      <span class="gatsby-resp-image-background-image" style="padding-bottom:56.199999999999996%;position:relative;bottom:0;left:0;background-image:url(&#x27;data:image/jpeg;base64,/9j/2wBDAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQH/2wBDAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQH/wgARCAALABQDASIAAhEBAxEB/8QAGAAAAgMAAAAAAAAAAAAAAAAAAAcDBgn/xAAUAQEAAAAAAAAAAAAAAAAAAAAB/9oADAMBAAIQAxAAAAHdmOzgr0YQn//EABoQAAICAwAAAAAAAAAAAAAAAAIDBAUGEBH/2gAIAQEAAQUCNsgWFYdRi8y8n0G//8QAGhEBAAEFAAAAAAAAAAAAAAAAATEQEZGhwf/aAAgBAwEBPwG8bjgOVp//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/AT//xAAeEAACAgMBAAMAAAAAAAAAAAABAgMEERITBQAGIP/aAAgBAQAGPwKBXLR7u4KwRd4tehEZaVlVoyY9C41wrlgCyrk2JIVLGPpHH0RljewnRAhZNzr2j0dwuE+eZa+x0qfn+7JXB9WjQnNmnWt7NtFXsMz9U00O27jJIDtjP4//xAAZEAADAQEBAAAAAAAAAAAAAAABESEAIEH/2gAIAQEAAT8hNTGEfn2XID5qiv5+GYc2akuYYPwfgEEOGt44P//aAAwDAQACAAMAAAAQDA//xAAZEQEBAQADAAAAAAAAAAAAAAABESEAMUH/2gAIAQMBAT8QQgCIIk31JEk2lfQo8//EABsRAAEEAwAAAAAAAAAAAAAAAAEQITGREXHB/9oACAECAQE/EMS876SKAa0//8QAGxABAQACAwEAAAAAAAAAAAAAAREA8BAxQZH/2gAIAQEAAT8QQl9kK0+EMgU0hjSF3zhhoYCiVj5VkI2pEAqbXJvv3vj/2Q==&#x27;);background-size:cover;display:block"></span>
  <img class="gatsby-resp-image-image" alt="signin-process" title="signin-process" src="/static/bec6044475ad064c6e1d56d33530e5cb/aaf92/signin-process.jpg" srcSet="/static/bec6044475ad064c6e1d56d33530e5cb/953fe/signin-process.jpg 500w /static/bec6044475ad064c6e1d56d33530e5cb/0a251/signin-process.jpg 1000w /static/bec6044475ad064c6e1d56d33530e5cb/aaf92/signin-process.jpg 1920w" sizes="(max-width: 1920px) 100vw, 1920px" style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0" loading="lazy" decoding="async"/>
    </span></p>
<ol>
<li>front에서 회원가입 시 이미 회원가입이 된 ID인지 검사하는 Http Call을 날린다. MySQL에서 회원 ID를 SELECT, 가입 가능한지 판별하여 return. 보면 Spring Security config 파일에 .antMatchers(“/api/user/valid/**“).permitAll() 로 프론트에서 header를 가지고 들어오지 않아도 리소스를 요청할 수 있도록 풀어주었기 때문에 가능하다.</li>
<li>가입 가능하다면 나머지 정보를 입력해서 Create Http Call을 날림. 여기도 마찬가지로 permitAll()로 풀어둔 상태다.</li>
<li>Spring Security에서 제공하는 PasswordEncoder를 통해 <code class="language-text">.encode()</code>메서드로 BCrypt 방식으로 인코딩 후 INSERT</li>
</ol>
<h3 id="로그인-프로세스" style="position:relative">로그인 프로세스<a href="#%EB%A1%9C%EA%B7%B8%EC%9D%B8-%ED%94%84%EB%A1%9C%EC%84%B8%EC%8A%A4" aria-label="로그인 프로세스 permalink" class="auto-link after"><svg viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a></h3>
<p><span class="gatsby-resp-image-wrapper" style="position:relative;display:block;margin-left:auto;margin-right:auto;max-width:1920px">
      <span class="gatsby-resp-image-background-image" style="padding-bottom:56.199999999999996%;position:relative;bottom:0;left:0;background-image:url(&#x27;data:image/jpeg;base64,/9j/2wBDAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQH/2wBDAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQH/wgARCAALABQDASIAAhEBAxEB/8QAGAAAAwEBAAAAAAAAAAAAAAAAAAQGBwn/xAAUAQEAAAAAAAAAAAAAAAAAAAAB/9oADAMBAAIQAxAAAAHu6vTrjDmgCf/EABwQAAEEAwEAAAAAAAAAAAAAAAMABAUSAQIGE//aAAgBAQABBQI+jjCG4s956LlIoK8x2X//xAAYEQACAwAAAAAAAAAAAAAAAAAQkRGhsf/aAAgBAwEBPwGaS0f/xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/AT//xAAiEAABBAIBBAMAAAAAAAAAAAACAQMREgQFEwAQITEjQ1H/2gAIAQEABj8CJRN40V5CEGuMFAKCKtzA2CwqckpHLipNBGHG+YkRBAOIiYqjkCa1+wi80L2iVX0vWyb2u+yN+5mbvabLDeyMZrFXXa7Ne5MPTNiyRI6zrW/hbfKDdTyQj67WoFpm1Umf2Yme3//EABwQAQEAAgIDAAAAAAAAAAAAAAERACEQMUGh8P/aAAgBAQABPyEhTHIUAVWT84LFv8NhgZXHfZoup60h3b58r/qgZ8UHe0W8f//aAAwDAQACAAMAAAAQiA//xAAZEQEBAQADAAAAAAAAAAAAAAABETEQIUH/2gAIAQMBAT8QUgdzBVGVFQVF8NwCcf/EABoRAQACAwEAAAAAAAAAAAAAAAEhURARMXH/2gAIAQIBAT8Q0S314vqUQVj/xAAaEAEAAwADAAAAAAAAAAAAAAABABARUcHw/9oACAEBAAE/ENpv4bVLTEahdTK5hvCyiyDpDj9eBYiA6ZyvTdT1/gTmv//Z&#x27;);background-size:cover;display:block"></span>
  <img class="gatsby-resp-image-image" alt="login-process" title="login-process" src="/static/577ed8793034aa26cd3ace9f8c8bece9/aaf92/login-process.jpg" srcSet="/static/577ed8793034aa26cd3ace9f8c8bece9/953fe/login-process.jpg 500w /static/577ed8793034aa26cd3ace9f8c8bece9/0a251/login-process.jpg 1000w /static/577ed8793034aa26cd3ace9f8c8bece9/aaf92/login-process.jpg 1920w" sizes="(max-width: 1920px) 100vw, 1920px" style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0" loading="lazy" decoding="async"/>
    </span></p>
<ol>
<li>로그인 시 ID, Password는 GET 방식으로 날릴 시 url 파라미터에 노출되므로 POST 방식으로 접근.</li>
<li>Payload에 담긴 ID로 유저 정보 조회</li>
<li>회원가입 시 사용했던 SpringSecurity의 PasswoardEncoder에서 <code class="language-text">.matches()</code> 메서드로 유저가 보낸 password와 DB에 BCrypt 방식으로 인코딩된 password를 가져와서 비교함.</li>
<li>통과 된다면, JwtTokenProvider의 createToken으로 token 생성.</li>
<li>토큰과 유저정보를 가지고 리턴.</li>
</ol>
<p>핵심은 PasswordEncoder다.</p>
<br/>
<h4 id="PasswordEncoderBCrypt" style="position:relative">PasswordEncoder(BCrypt)<a href="#PasswordEncoderBCrypt" aria-label="PasswordEncoderBCrypt permalink" class="auto-link after"><svg viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a></h4>
<p>2가지 메서드를 사용했다.</p>
<ul>
<li>
<p>.encode(String password) : BCrypt 방식으로 String password를 인코딩해준다.</p>
</li>
<li>
<p>.matches(String requestPassword, String DBSavedPassword) : 파라미터로 유저가 요청한 password를 첫번째로 넣어주고, DB에서 조회해온 BCrypt 방식으로 가져온 password와 같은지 내부적으로 판단해 boolean 값으로 리턴해준다. <code class="language-text">순서가 중요</code>하다. 첫번째 파라미터와 두번째 파라미터를 반대로 적으면 체크가 제대로 되지 않는다.</p>
</li>
</ul>
<p><span class="gatsby-resp-image-wrapper" style="position:relative;display:block;margin-left:auto;margin-right:auto;max-width:816px">
      <span class="gatsby-resp-image-background-image" style="padding-bottom:20.8%;position:relative;bottom:0;left:0;background-image:url(&#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAYAAACOXx+WAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAuElEQVQY0zVQuw6DQAzj/3+LgR7cg3ugMjIijgMkVMTmyikdrESxY0epUkoI3mOaJmzbhnVdsSyL1JyzgPNSCrZSsOYsPTHPs/DHvuM8TxzHgaptW3RdB601eu9hrUXTNFBKgRxhnftpjBGePRFihPceMUYJuO8bVfuYvZRCpzWcc2LGGQ3MAxoZa8Xgz4UQZFbXtYR+rgtV3/dymXkEfIFc6pwkp2GQymvIU09THwLe4yh6gvt82xcK/hkTFeaTHAAAAABJRU5ErkJggg==&#x27;);background-size:cover;display:block"></span>
  <img class="gatsby-resp-image-image" alt="password-encoding" title="password-encoding" src="/static/a417adc57e1b1fe7c9ce87eb1aabeebe/07e4e/password-encoding.png" srcSet="/static/a417adc57e1b1fe7c9ce87eb1aabeebe/0eb09/password-encoding.png 500w /static/a417adc57e1b1fe7c9ce87eb1aabeebe/07e4e/password-encoding.png 816w" sizes="(max-width: 816px) 100vw, 816px" style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0" loading="lazy" decoding="async"/>
    </span></p>
<p>DB에 접속해서 select 해보면 이런 값이 들어가있는 것을 확인할 수 있다. 지금 위의 값은 내가 임의로 만든 사용자인데 모두 <em>같은 비밀번호</em>를 입력했음에도 불구하고 서로 다른 값이 들어가있는 것을 볼 수 있다. 이는 DBA도 유저가 <strong>어떤 패스워드를 사용했는지 모르게</strong> 한다.</p>
<p>내부 소스를 보자. Service 단 소스다.</p>
<h3 id="회원가입" style="position:relative">회원가입<a href="#%ED%9A%8C%EC%9B%90%EA%B0%80%EC%9E%85" aria-label="회원가입 permalink" class="auto-link after"><svg viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a></h3>
<div class="gatsby-highlight" data-language="java"><pre class="language-java"><code class="language-java"><span class="token annotation punctuation">@Transactional</span>
<span class="token annotation punctuation">@Override</span>
<span class="token keyword">public</span> <span class="token class-name">ResponseEntity</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Message</span><span class="token punctuation">&gt;</span></span> <span class="token function">createUser</span><span class="token punctuation">(</span><span class="token class-name">UserApiRequest</span> request<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">userIdValid</span><span class="token punctuation">(</span>request<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

        <span class="token comment">// 소셜 로그인 패스워드 만들기</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token class-name">StringUtils</span><span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span>request<span class="token punctuation">.</span><span class="token function">getSocial</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">PasswordUtil</span> pw <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PasswordUtil</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">String</span> newPw <span class="token operator">=</span> pw<span class="token punctuation">.</span><span class="token function">encryptSHA256</span><span class="token punctuation">(</span>request<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            request<span class="token punctuation">.</span><span class="token function">setPassword</span><span class="token punctuation">(</span>newPw<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token class-name">String</span> encodePassword <span class="token operator">=</span> passwordEncoder<span class="token punctuation">.</span><span class="token function">encode</span><span class="token punctuation">(</span>request<span class="token punctuation">.</span><span class="token function">getPassword</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 이곳</span>
        request<span class="token punctuation">.</span><span class="token function">setPassword</span><span class="token punctuation">(</span>encodePassword<span class="token punctuation">)</span><span class="token punctuation">;</span>

        userDao<span class="token punctuation">.</span><span class="token function">createUser</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">;</span>

        headers<span class="token punctuation">.</span><span class="token function">setContentType</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">MediaType</span><span class="token punctuation">(</span><span class="token string">&quot;application&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;json&quot;</span><span class="token punctuation">,</span> <span class="token class-name">Charset</span><span class="token punctuation">.</span><span class="token function">forName</span><span class="token punctuation">(</span><span class="token string">&quot;UTF-8&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        message<span class="token punctuation">.</span><span class="token function">setStatus</span><span class="token punctuation">(</span><span class="token class-name">StatusEnum</span><span class="token punctuation">.</span><span class="token constant">OK</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        message<span class="token punctuation">.</span><span class="token function">setMessage</span><span class="token punctuation">(</span><span class="token class-name">ResponseMessage</span><span class="token punctuation">.</span><span class="token constant">CREATED_USER</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        message<span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">ResponseEntity</span> <span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">(</span>message<span class="token punctuation">,</span> headers<span class="token punctuation">,</span> <span class="token class-name">HttpStatus</span><span class="token punctuation">.</span><span class="token constant">OK</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        message<span class="token punctuation">.</span><span class="token function">setStatus</span><span class="token punctuation">(</span><span class="token class-name">StatusEnum</span><span class="token punctuation">.</span><span class="token constant">BAD_REQUEST</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        message<span class="token punctuation">.</span><span class="token function">setMessage</span><span class="token punctuation">(</span><span class="token class-name">ResponseMessage</span><span class="token punctuation">.</span><span class="token constant">ALREADY_USE</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">ResponseEntity</span> <span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">(</span>message<span class="token punctuation">,</span> headers<span class="token punctuation">,</span> <span class="token class-name">HttpStatus</span><span class="token punctuation">.</span><span class="token constant">NOT_FOUND</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre></div>
<h3 id="로그인" style="position:relative">로그인<a href="#%EB%A1%9C%EA%B7%B8%EC%9D%B8" aria-label="로그인 permalink" class="auto-link after"><svg viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a></h3>
<div class="gatsby-highlight" data-language="java"><pre class="language-java"><code class="language-java"><span class="token annotation punctuation">@Override</span>
<span class="token keyword">public</span> <span class="token class-name">ResponseEntity</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Message</span><span class="token punctuation">&gt;</span></span> <span class="token function">login</span><span class="token punctuation">(</span><span class="token class-name">LoginApiRequest</span> request<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">User</span> user <span class="token operator">=</span> userDao<span class="token punctuation">.</span><span class="token function">readUser</span><span class="token punctuation">(</span>request<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token class-name">ObjectUtils</span><span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

        <span class="token keyword">boolean</span> check <span class="token operator">=</span> passwordEncoder<span class="token punctuation">.</span><span class="token function">matches</span><span class="token punctuation">(</span>request<span class="token punctuation">.</span><span class="token function">getPassword</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> user<span class="token punctuation">.</span><span class="token function">getPassword</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>check<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// 유저가 보유한 패스워드와 입력받은 패스워드가 일치하는 지 확인한다.</span>
            log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;로그인 성공&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token class-name">List</span> <span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> roles <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span> <span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            roles<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">&quot;ROLE_USER&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token class-name">String</span> token <span class="token operator">=</span> jwtTokenProvider<span class="token punctuation">.</span><span class="token function">createToken</span><span class="token punctuation">(</span>user<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> roles<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// id, role 정보만 가지고 token을 만든다.</span>
            <span class="token class-name">LoginApiResponse</span> response <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">LoginApiResponse</span><span class="token punctuation">(</span>
                token<span class="token punctuation">,</span> user<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> user<span class="token punctuation">.</span><span class="token function">getEmail</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> user<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> user<span class="token punctuation">.</span><span class="token function">getPicture</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> user<span class="token punctuation">.</span><span class="token function">getBio</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> user<span class="token punctuation">.</span><span class="token function">getRecentBoard</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> user<span class="token punctuation">.</span><span class="token function">getInvitedBoard</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                user<span class="token punctuation">.</span><span class="token function">getCreatedAt</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> user<span class="token punctuation">.</span><span class="token function">getCreatedBy</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> user<span class="token punctuation">.</span><span class="token function">getUpdatedAt</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> user<span class="token punctuation">.</span><span class="token function">getUpdatedBy</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token punctuation">)</span><span class="token punctuation">;</span>

            headers<span class="token punctuation">.</span><span class="token function">setContentType</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">MediaType</span><span class="token punctuation">(</span><span class="token string">&quot;application&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;json&quot;</span><span class="token punctuation">,</span> <span class="token class-name">Charset</span><span class="token punctuation">.</span><span class="token function">forName</span><span class="token punctuation">(</span><span class="token string">&quot;UTF-8&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            message<span class="token punctuation">.</span><span class="token function">setStatus</span><span class="token punctuation">(</span><span class="token class-name">StatusEnum</span><span class="token punctuation">.</span><span class="token constant">OK</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            message<span class="token punctuation">.</span><span class="token function">setMessage</span><span class="token punctuation">(</span><span class="token class-name">ResponseMessage</span><span class="token punctuation">.</span><span class="token constant">LOGIN_SUCCESS</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            message<span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span>response<span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">ResponseEntity</span> <span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">(</span>message<span class="token punctuation">,</span> headers<span class="token punctuation">,</span> <span class="token class-name">HttpStatus</span><span class="token punctuation">.</span><span class="token constant">OK</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;비번이 틀립니다&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            message<span class="token punctuation">.</span><span class="token function">setStatus</span><span class="token punctuation">(</span><span class="token class-name">StatusEnum</span><span class="token punctuation">.</span><span class="token constant">NOT_FOUND</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            message<span class="token punctuation">.</span><span class="token function">setMessage</span><span class="token punctuation">(</span><span class="token class-name">ResponseMessage</span><span class="token punctuation">.</span><span class="token constant">PASSWORD_WRONG</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">ResponseEntity</span> <span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">(</span>message<span class="token punctuation">,</span> headers<span class="token punctuation">,</span> <span class="token class-name">HttpStatus</span><span class="token punctuation">.</span><span class="token constant">FORBIDDEN</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 403</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;해당 id가 없습니다.&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        message<span class="token punctuation">.</span><span class="token function">setStatus</span><span class="token punctuation">(</span><span class="token class-name">StatusEnum</span><span class="token punctuation">.</span><span class="token constant">NOT_FOUND</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        message<span class="token punctuation">.</span><span class="token function">setMessage</span><span class="token punctuation">(</span><span class="token class-name">ResponseMessage</span><span class="token punctuation">.</span><span class="token constant">NOT_FOUND_USER</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">ResponseEntity</span> <span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">(</span>message<span class="token punctuation">,</span> headers<span class="token punctuation">,</span> <span class="token class-name">HttpStatus</span><span class="token punctuation">.</span><span class="token constant">FORBIDDEN</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 403</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre></div>
<p>참고자료 : <a href="https://mia-dahae.tistory.com/120" target="_blank" rel="nofollow">https://mia-dahae.tistory.com/120</a></p>
<br/>
<p>여기까지가 SpringBoot의 내부 처리 로직이다. 회원가입과 로그인 로직이 완성되었으므로 vue에서 어떻게 이것을 표현할지 다음 포스팅에서 알아보자. 소셜 로그인까지 같이.</p>
<hr/>
<blockquote>
<p>프로젝트 구경하기 -&gt; <a href="https://tripllo.tech" target="_blank" rel="nofollow">Tripllo_메인</a>, <a href="https://github.com/pozafly/tripllo_vue" target="_blank" rel="nofollow">Vue_Github</a>, <a href="https://github.com/pozafly/tripllo_springBoot" target="_blank" rel="nofollow">SpringBoot_Github</a></p>
</blockquote></div></section></article><style data-emotion="css 17876f4">.css-17876f4{position:relative;box-sizing:border-box;width:100%;max-width:760px;margin-left:auto;margin-right:auto;}</style><div class="css-17876f4"><div></div></div></div></main><style data-emotion="css dcfhc9">.css-dcfhc9{position:relative;padding:0 5vw;}</style><style data-emotion="css 10px0y6">.css-10px0y6{background:#0a0b0c;position:relative;padding:0 5vw;}.css-10px0y6 .post-card{padding-bottom:0;border-bottom:none;}.css-10px0y6 .post-card:after{display:none;}.css-10px0y6 .post-card-primary-tag{color:#fff;opacity:0.6;}.css-10px0y6 .post-card-title{color:#fff;opacity:0.8;-webkit-transition:all 0.2s ease-in-out;transition:all 0.2s ease-in-out;}.css-10px0y6 .post-card:hover .post-card-image{opacity:1;}.css-10px0y6 .post-card-excerpt{color:rgba(255, 255, 255, 0.6);}.css-10px0y6 .static-avatar{border-color:#000;}.css-10px0y6 .post-card-byline-content{color:rgba(255, 255, 255, 0.6);}.css-10px0y6 .post-card-byline-content a{color:rgba(255, 255, 255, 0.8);}.css-10px0y6 .author-avatar{border-color:#0a0b0c;}.css-10px0y6 .author-profile-image{background:#0a0b0c;}@media (max-width: 650px){.css-10px0y6 .post-card{-webkit-flex:1 1 auto;-ms-flex:1 1 auto;flex:1 1 auto;margin:25px;padding:25px 0 0;}}</style><aside class="read-next css-10px0y6 eu5ixib1"><div class="css-y521qa"><style data-emotion="css 1ehfk3g">.css-1ehfk3g{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-flex-wrap:wrap;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;margin:0 -25px;padding:60px 0 0 0;}</style><div class="read-next-feed css-1ehfk3g eu5ixib0"><style data-emotion="css vzb0i">.css-vzb0i{position:relative;-webkit-flex:0 1 326px;-ms-flex:0 1 326px;flex:0 1 326px;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;overflow:hidden;margin:0 25px 50px;padding:25px;background:linear-gradient(
    #1a1c20,
    #0a0b0c
  );border-radius:3px;}.css-vzb0i a{-webkit-transition:all 0.2s ease-in-out;transition:all 0.2s ease-in-out;}.css-vzb0i a:hover{-webkit-text-decoration:none;text-decoration:none;}@media (max-width: 1170px){.css-vzb0i{-webkit-flex:1 1 261px;-ms-flex:1 1 261px;flex:1 1 261px;margin-bottom:5vw;}}@media (max-width: 650px){.css-vzb0i{display:none;-webkit-flex:1 1 auto;-ms-flex:1 1 auto;flex:1 1 auto;margin:0 25px;padding:0;background:none;}}</style><article class="read-next-card css-vzb0i em2u7rs4"><header class="read-next-card-header"><style data-emotion="css ibfl7h">.css-ibfl7h{margin:0;color:rgba(255, 255, 255, 0.6);font-size:1.3rem;line-height:1em;font-weight:300;letter-spacing:0.4px;}.css-ibfl7h span,.css-ibfl7h a{font-size:inherit;}.css-ibfl7h a{color:#fff;font-weight:500;-webkit-text-decoration:none;text-decoration:none;opacity:0.8;}.css-ibfl7h a:hover{opacity:1;}</style><h3 class="css-ibfl7h em2u7rs3"><span>More in</span> <a href="/tags/tripllo-제작기/">Tripllo 제작기</a></h3></header><style data-emotion="css 5xlusk">.css-5xlusk{font-size:1.3rem;}.css-5xlusk ul{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;margin:0;padding:0;list-style:none;}.css-5xlusk li{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-align-items:flex-start;-webkit-box-align:flex-start;-ms-flex-align:flex-start;align-items:flex-start;margin:0;padding:20px 0;border-bottom:rgba(255, 255, 255, 0.1);}.css-5xlusk li:last-of-type{padding-bottom:5px;border:none;}.css-5xlusk h4{margin:0;font-size:1.3rem;line-height:1.6em;font-weight:600;}.css-5xlusk li a{font-size:inherit;display:block;color:#fff;opacity:0.8;}.css-5xlusk li a:hover{opacity:1;}</style><div class="read-next-card-content css-5xlusk em2u7rs2"><ul><li><h4><a href="/tripllo/tripllo-delete/">Tripllo 삭제 및 일상 회고</a></h4><style data-emotion="css k1z8vy">.css-k1z8vy{margin-top:2px;font-size:1.2rem;line-height:1.4em;font-weight:400;}.css-k1z8vy p{font-size:inherit;margin:0;color:rgba(255, 255, 255, 0.6);}.css-k1z8vy p time{font-size:inherit;}</style><div class="read-next-card-meta css-k1z8vy em2u7rs1"><p><time dateTime="2021-12-05">2021 12 05</time> -<!-- --> <!-- -->3 min read</p></div></li><li><h4><a href="/tripllo/(14)Closure-Currying/">(14) Closure &amp; Currying 적용기</a></h4><div class="read-next-card-meta css-k1z8vy em2u7rs1"><p><time dateTime="2021-05-01">2021 05 01</time> -<!-- --> <!-- -->4 min read</p></div></li><li><h4><a href="/tripllo/(13)Vuex-and-eventBus/">(13) Vuex-store와 EventBus에 대한 고찰</a></h4><div class="read-next-card-meta css-k1z8vy em2u7rs1"><p><time dateTime="2021-04-17">2021 04 17</time> -<!-- --> <!-- -->6 min read</p></div></li></ul></div><style data-emotion="css qqvtec">.css-qqvtec{position:relative;margin:40px 0 5px;}.css-qqvtec a{padding:7px 12px 8px 14px;border:1px solid rgba(255, 255, 255, 0.6);color:rgba(255, 255, 255, 0.6);font-size:1.3rem;border-radius:999px;-webkit-transition:all 0.35s ease-in-out;transition:all 0.35s ease-in-out;}.css-qqvtec a:hover{border-color:#fecd35;color:#fecd35;-webkit-text-decoration:none;text-decoration:none;}</style><footer class="read-next-card-footer css-qqvtec em2u7rs0"><a href="/tags/tripllo-제작기/">See all 16 posts<!-- --> →</a></footer></article><style data-emotion="css vxrpic">.css-vxrpic{position:relative;-webkit-flex:1 1 301px;-ms-flex:1 1 301px;flex:1 1 301px;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;overflow:hidden;margin:0 20px 60px;min-height:220px;-webkit-background-size:cover;background-size:cover;-webkit-transition:0.4s ease;transition:0.4s ease;}.css-vxrpic:hover{-webkit-transform:translateY(-2px);-moz-transform:translateY(-2px);-ms-transform:translateY(-2px);transform:translateY(-2px);}</style><article class="post-card   css-vxrpic"><style data-emotion="css 16xcmry">.css-16xcmry{position:relative;display:block;overflow:hidden;border-radius:12px;}</style><a class="post-card-image-link css-16xcmry" href="/tripllo/(6)login3-vue/"><style data-emotion="css 1j45wjp">.css-1j45wjp{width:auto;height:200px;-webkit-background-size:cover;background-size:cover;border-radius:12px;border:1px solid hsl(230 6% 23%);background:#191b1f;}.css-1j45wjp img{border-radius:12px;}.css-1j45wjp.is-next{border:1px solid hsl(230deg 6% 23%);}</style><div class="post-card-image is-next css-1j45wjp e1qfhan16"><div data-gatsby-image-wrapper="" style="height:100%" class="gatsby-image-wrapper"><div aria-hidden="true" style="padding-top:134.65346534653463%"></div><img aria-hidden="true" data-placeholder-image="" style="opacity:1;transition:opacity 500ms linear" decoding="async" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAbCAYAAAB836/YAAAACXBIWXMAAAsTAAALEwEAmpwYAAADEklEQVRIx5WVy04UQRSGeShXPo1LE4lRdiYYdeFKJCZsVIK8gVtfQBYEwmYgSCIRoWf6Pj19q3v1b051TztAj0gnX6aq5tRf/6muOr0ilYGQ+hZKGXw5irF7FMPLOCguyAUupxzWDM+hmJV5Yw71tTZIK4kH26d4uPMDX49TbHz3sfbtEpt7PhpjW5GFeVK1oiutyO0VudD4lTJcpAxWG4wmFU7DGrNagQ+4I43eIRcSTEgXuIgxxsGorTWMUpAUxyXYDbhQrUNqkF00DazgsJy1CA7DGAznsKyG1Rq2adAMQI+UyomuMCagaOBgD+naI2RvniN7uYrsxWNkr54iW3+CbH0V2etnaJRyk9GJtM0lgvrsGPnWW5Q7H1B8fo/i4zsU25soPm207G45l00nstwhpSwV7vM0vcMhQU57qNo9NKbDAtZiPIkQhimiaIokyeD5McJ42osOO5wLDjyzWYG8KFGUFTgXrl1VbDBW/BWU0Fojqy3OvRRnFwEuwxxxoZBWuicp6dcgLTWiXPYEM4lZbaCUApnrBaPCYPRzjKOTcyeclAZBJhDMbhPOZM9kKhDldLsWBJXSMNYiryUqrpFXAmleoaglSqbuxFrrtq1PmTrWNkjTFGEYwg8CBEEALoS717TgchSMsYsvpXVIq9DGLkJXkqCbRBOGoDjnUA44DKMYEz+AN570RFEMpQ0EiQ5AgnTfBxw2fRD1KVVtzJ0pUzydxUGHUZzA9wOMJz6qmnX1UQ06+w+H7T5QesR8f+QdLN/DpkGcpG4f/SAE4wLa2H6BZVAWg2+ZbJdlhaIsURQlasbAOAdj3LVdn/HrdP+7lBfPIR3qJEmwv7+Pw8NDx8HBgYPaJyfHGI1GOOzGFqE50+nUZUNa3dUzYIzh6srDeDx2eAv4vo+J718b7+M8D5xzl2V39ZZXm/s8g+WLjg4VTa4MzhOOi6nAJRWIQsKbSfzOBCa5dGNS27aG/qsezoulsQ1KYVBLg0oaMGVRS4taWXBt3dhc6FaBnX9Gefd5dAgJJSXkEKL9vRlP0Gf0Dxz6HIqb0rgiAAAAAElFTkSuQmCC" alt=""/><picture><source type="image/webp" data-srcset="/static/091b93c48a5a6d44022278f6ff3b1035/1988c/main.webp 505w" sizes="100vw"/><img data-gatsby-image-ssr="" data-main-image="" style="opacity:0" sizes="100vw" decoding="async" loading="lazy" data-src="/static/091b93c48a5a6d44022278f6ff3b1035/4ba33/main.png" data-srcset="/static/091b93c48a5a6d44022278f6ff3b1035/4ba33/main.png 505w" alt="(6) 로그인3 -vue 구현 cover image"/></picture><noscript><picture><source type="image/webp" srcSet="/static/091b93c48a5a6d44022278f6ff3b1035/1988c/main.webp 505w" sizes="100vw"/><img data-gatsby-image-ssr="" data-main-image="" style="opacity:0" sizes="100vw" decoding="async" loading="lazy" src="/static/091b93c48a5a6d44022278f6ff3b1035/4ba33/main.png" srcSet="/static/091b93c48a5a6d44022278f6ff3b1035/4ba33/main.png 505w" alt="(6) 로그인3 -vue 구현 cover image"/></picture></noscript><script type="module">const t="undefined"!=typeof HTMLImageElement&&"loading"in HTMLImageElement.prototype;if(t){const t=document.querySelectorAll("img[data-main-image]");for(let e of t){e.dataset.src&&(e.setAttribute("src",e.dataset.src),e.removeAttribute("data-src")),e.dataset.srcset&&(e.setAttribute("srcset",e.dataset.srcset),e.removeAttribute("data-srcset"));const t=e.parentNode.querySelectorAll("source[data-srcset]");for(let e of t)e.setAttribute("srcset",e.dataset.srcset),e.removeAttribute("data-srcset");e.complete&&(e.style.opacity=1,e.parentNode.parentNode.querySelector("[data-placeholder-image]").style.opacity=0)}}</script></div></div></a><style data-emotion="css 1lh7kdz">.css-1lh7kdz{-webkit-box-flex:1;-webkit-flex-grow:1;-ms-flex-positive:1;flex-grow:1;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;}</style><div class="post-card-content css-1lh7kdz e1qfhan15"><style data-emotion="css 1193uzk">.css-1193uzk{margin:15px 0 0.2em;color:#90a2aa;font-size:1.2rem;font-weight:500;letter-spacing:0.2px;}.css-1193uzk a{font-size:1.2rem;}</style><div class="post-card-primary-tag css-1193uzk e1qfhan14"><a href="/tags/tripllo-제작기/">Tripllo 제작기</a>,  <a href="/tags/vue-js/">Vue.js</a></div><style data-emotion="css 1fjrpmt">.css-1fjrpmt{position:relative;display:block;color:#15171A;}.css-1fjrpmt:hover{-webkit-text-decoration:none;text-decoration:none;}</style><a class="post-card-content-link css-1fjrpmt" href="/tripllo/(6)login3-vue/"><header><style data-emotion="css u8vwqt">.css-u8vwqt{margin:0 0 0.4em;line-height:1.15em;-webkit-transition:color 0.2s ease-in-out;transition:color 0.2s ease-in-out;color:rgba(255, 255, 255, 0.85);}</style><h2 class="post-card-title css-u8vwqt e1qfhan13">(6) 로그인3 -vue 구현</h2></header><style data-emotion="css lt86vd">.css-lt86vd{font-size:1.6rem;color:#768086;}.css-lt86vd p{width:100%;overflow:hidden;text-overflow:ellipsis;display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;margin-bottom:0.4em;font-size:1.4rem;}</style><section class="post-card-excerpt css-lt86vd e1qfhan12"><p>SpringBoot 쪽 서비스 로직이 만들어졌으므로 이번엔 vue에서 화면을 만들고 회원가입과 로그인을 진행해보자. 우리는 vue의 기능을 최대한 살려서 뼈대가 되는 페이지 하나에 login과 signup 2개의 컴포넌트를 붙이고 watch를 활용해 데이터를 검증할 것이다.</p></section></a><style data-emotion="css 143c7df">.css-143c7df{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:flex-start;-webkit-box-align:flex-start;-ms-flex-align:flex-start;align-items:flex-start;padding:0;}</style><footer class="post-card-meta css-143c7df e1qfhan11"><style data-emotion="css 1rhvx80">.css-1rhvx80{-webkit-flex:1 1 50%;-ms-flex:1 1 50%;flex:1 1 50%;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;color:#90a2aa;line-height:1.4em;font-weight:400;letter-spacing:0.2px;}.css-1rhvx80 time{font-size:1.3rem;}.css-1rhvx80 span{margin:0;font-size:1.3rem;}.css-1rhvx80 a{color:rgba(255, 255, 255, 0.75);font-weight:600;}</style><div class="post-card-byline-content css-1rhvx80 e1qfhan10"><span class="post-card-byline-date"><time dateTime="2021-02-05">2021 02 05</time> <span class="bull">•</span> <span>6 min read</span></span></div></footer></div></article><article class="post-card   css-vxrpic"><a class="post-card-image-link css-16xcmry" href="/tripllo/(4)spring-security-jwt/"><div class="post-card-image is-next css-1j45wjp e1qfhan16"><div data-gatsby-image-wrapper="" style="height:100%" class="gatsby-image-wrapper"><div aria-hidden="true" style="padding-top:43.527918781725894%"></div><img aria-hidden="true" data-placeholder-image="" style="opacity:1;transition:opacity 500ms linear" decoding="async" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAIAAAC9o5sfAAAACXBIWXMAAAsTAAALEwEAmpwYAAABeklEQVQoz5WQy07CYBCFeSrXPoQb486NOza6My7UGDcsFKMxAQ0QAaOiKCCEchFRLoJcCxTaQNECUq4Vyq30/40pWogrTyaZyWS+M8mRwFkBCL5L0M882QNxLxxLhNbq0Q32Q3SYFcXgfY6ddhfhbO11y7W06VxMVLzsiLHmVLGyx05oEUIXLT8Y08dP5K0d15owRboa9JJGU0ZRaKYncLTsPgqsKkLr/jdLu1/TJ2QXyT1rVo3XYxvIgpc02nKafZ80Q4d2Pcv+oiVEIe785QSmGEJqnl+5mSMacXb0eZ891UR31JFtJ6E3Y0qKwcMlhymjqLNlM6Y0oAeHgbUwhXzDQh7hkvO5eAchHPPcgOvR3fcM/TIaDwDgxzzH8aMxz0EI+1zXjp+ZMGV3yIiBTUcl2DV6FQMqt+U01qzKU7i+SsrP4zILduLAdbacptIhRRgAHgD+N08IYWfYjpRcaTqYqvrzTRSt+uOVR7TqI5upfBPtDFt/P/9PX4zv38RNe7B1AAAAAElFTkSuQmCC" alt=""/><picture><source type="image/webp" data-srcset="/static/f0634ae38a1872124e048bd0df954052/1cb46/main.webp 750w,/static/f0634ae38a1872124e048bd0df954052/0c535/main.webp 788w" sizes="100vw"/><img data-gatsby-image-ssr="" data-main-image="" style="opacity:0" sizes="100vw" decoding="async" loading="lazy" data-src="/static/f0634ae38a1872124e048bd0df954052/f6dfe/main.png" data-srcset="/static/f0634ae38a1872124e048bd0df954052/21457/main.png 750w,/static/f0634ae38a1872124e048bd0df954052/f6dfe/main.png 788w" alt="(4) 로그인1 -SpringSecurity &amp; JWT 개념 cover image"/></picture><noscript><picture><source type="image/webp" srcSet="/static/f0634ae38a1872124e048bd0df954052/1cb46/main.webp 750w,/static/f0634ae38a1872124e048bd0df954052/0c535/main.webp 788w" sizes="100vw"/><img data-gatsby-image-ssr="" data-main-image="" style="opacity:0" sizes="100vw" decoding="async" loading="lazy" src="/static/f0634ae38a1872124e048bd0df954052/f6dfe/main.png" srcSet="/static/f0634ae38a1872124e048bd0df954052/21457/main.png 750w,/static/f0634ae38a1872124e048bd0df954052/f6dfe/main.png 788w" alt="(4) 로그인1 -SpringSecurity &amp; JWT 개념 cover image"/></picture></noscript><script type="module">const t="undefined"!=typeof HTMLImageElement&&"loading"in HTMLImageElement.prototype;if(t){const t=document.querySelectorAll("img[data-main-image]");for(let e of t){e.dataset.src&&(e.setAttribute("src",e.dataset.src),e.removeAttribute("data-src")),e.dataset.srcset&&(e.setAttribute("srcset",e.dataset.srcset),e.removeAttribute("data-srcset"));const t=e.parentNode.querySelectorAll("source[data-srcset]");for(let e of t)e.setAttribute("srcset",e.dataset.srcset),e.removeAttribute("data-srcset");e.complete&&(e.style.opacity=1,e.parentNode.parentNode.querySelector("[data-placeholder-image]").style.opacity=0)}}</script></div></div></a><div class="post-card-content css-1lh7kdz e1qfhan15"><div class="post-card-primary-tag css-1193uzk e1qfhan14"><a href="/tags/tripllo-제작기/">Tripllo 제작기</a>,  <a href="/tags/spring-security/">Spring Security</a>,  <a href="/tags/jwt/">JWT</a></div><a class="post-card-content-link css-1fjrpmt" href="/tripllo/(4)spring-security-jwt/"><header><h2 class="post-card-title css-u8vwqt e1qfhan13">(4) 로그인1 -SpringSecurity &amp; JWT 개념</h2></header><section class="post-card-excerpt css-lt86vd e1qfhan12"><p>Spring Security와 JWT를 사용해서 로그인 기능을 구현했다. Spring Security와 JWT의 개념을 알아보자.</p></section></a><footer class="post-card-meta css-143c7df e1qfhan11"><div class="post-card-byline-content css-1rhvx80 e1qfhan10"><span class="post-card-byline-date"><time dateTime="2021-02-04">2021 02 04</time> <span class="bull">•</span> <span>6 min read</span></span></div></footer></div></article></div></div></aside><style data-emotion="css d4eprp">.css-d4eprp{position:relative;padding:0 5vw;position:relative;padding-top:20px;padding-bottom:22px;color:#fff;background:#000;}</style><footer class="css-d4eprp"><style data-emotion="css 1d3gyi8">.css-1d3gyi8{margin:0 auto;max-width:1040px;width:100%;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-flex-wrap:wrap;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;color:rgba(255, 255, 255, 0.7);font-size:1.3rem;}.css-1d3gyi8 a{color:rgba(255, 255, 255, 0.7);}.css-1d3gyi8 a:hover{color:rgba(255, 255, 255, 1);-webkit-text-decoration:none;text-decoration:none;}@media (max-width: 650px){.css-1d3gyi8{-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;}}</style><div class="css-1d3gyi8"><section class="copyright">© <!-- -->2023<!-- --> <span>|  </span><a href="https://www.gatsbyjs.com/" target="_blank" rel="nofollow">Pozafly Blog<!-- --> <!-- -->is based on Gatsby Casper</a></section><style data-emotion="css 13qgqyf">.css-13qgqyf{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;}.css-13qgqyf a{position:relative;margin-left:20px;font-size:1.3rem;}.css-13qgqyf a:before{content:'';position:absolute;top:11px;left:-11px;display:block;width:2px;height:2px;background:#fff;border-radius:100%;}.css-13qgqyf a:first-of-type:before{display:none;}@media (max-width: 650px){.css-13qgqyf a:first-of-type{margin-left:0;}}</style><nav class="css-13qgqyf e1me3zb40"><a href="/">Latest Posts</a><a href="https://www.instagram.com/pozafly_/" target="_blank" rel="noopener noreferrer">Instagram</a><a href="https://github.com/pozafly" target="_blank" rel="noopener noreferrer">Github</a><a href="/rss.xml">RSS</a></nav></div></footer></div></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/tripllo/(5)login2-SpringBoot/";/*]]>*/</script><!-- slice-start id="_gatsby-scripts-1" -->
          <script
            id="gatsby-chunk-mapping"
          >
            window.___chunkMapping="{\"app\":[\"/app-29c1094f253e764da37a.js\"],\"component---src-pages-404-tsx\":[\"/component---src-pages-404-tsx-b5d754adf7108f556fc8.js\"],\"component---src-pages-about-tsx\":[\"/component---src-pages-about-tsx-d51bca4f2a99c165e640.js\"],\"component---src-pages-tags-tsx\":[\"/component---src-pages-tags-tsx-8413b93c167a7f08fda7.js\"],\"component---src-templates-index-tsx\":[\"/component---src-templates-index-tsx-95441e2e5714a7eb3bd1.js\"],\"component---src-templates-post-tsx\":[],\"component---src-templates-tags-tsx\":[\"/component---src-templates-tags-tsx-618ff87ad0c9a3f5fded.js\"]}";
          </script>
        <script>window.___webpackCompilationHash="f913f3e30f623e82b306";</script><script src="/webpack-runtime-add6b6a12985019a4c74.js" async></script><script src="/framework-5332a90d114fef29dbe7.js" async></script><script src="/app-29c1094f253e764da37a.js" async></script><!-- slice-end id="_gatsby-scripts-1" --></body></html>