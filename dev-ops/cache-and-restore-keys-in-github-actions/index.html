<!DOCTYPE html><html lang="ko"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><meta name="generator" content="Gatsby 5.5.0"/><meta data-react-helmet="true" name="description" content="restore-keys는 의존성 파일이 변경되었음에도 불구하고 기존 캐시를 불러오는 기능이다. 그렇다면, 무효화 되지 않은 캐시를 가져오게 되는 것일까?"/><meta data-react-helmet="true" property="og:site_name" content="Pozafly Blog"/><meta data-react-helmet="true" property="og:type" content="article"/><meta data-react-helmet="true" property="og:title" content="GitHub Actions의 캐시 조금 더 다뤄보기 (feat. restore-keys)"/><meta data-react-helmet="true" property="og:description" content="restore-keys는 의존성 파일이 변경되었음에도 불구하고 기존 캐시를 불러오는 기능이다. 그렇다면, 무효화 되지 않은 캐시를 가져오게 되는 것일까?"/><meta data-react-helmet="true" property="og:url" content="https://pozafly.github.io/dev-ops/cache-and-restore-keys-in-github-actions/"/><meta data-react-helmet="true" property="og:image" content="https://pozafly.github.io/static/365cb7658cd8164573e7796d96f879bc/34dc0/main.webp"/><meta data-react-helmet="true" property="article:published_time" content="2023-08-22"/><meta data-react-helmet="true" property="article:tag" content="DevOps"/><meta data-react-helmet="true" property="article:publisher" content="https://www.instagram.com/pozafly_/"/><meta data-react-helmet="true" property="article:author" content="https://www.instagram.com/pozafly_/"/><meta data-react-helmet="true" name="github:card" content="summary_large_image"/><meta data-react-helmet="true" name="github:title" content="GitHub Actions의 캐시 조금 더 다뤄보기 (feat. restore-keys)"/><meta data-react-helmet="true" name="github:description" content="restore-keys는 의존성 파일이 변경되었음에도 불구하고 기존 캐시를 불러오는 기능이다. 그렇다면, 무효화 되지 않은 캐시를 가져오게 되는 것일까?"/><meta data-react-helmet="true" name="github:url" content="https://pozafly.github.io/dev-ops/cache-and-restore-keys-in-github-actions/"/><meta data-react-helmet="true" name="github:image" content="https://pozafly.github.io/static/365cb7658cd8164573e7796d96f879bc/34dc0/main.webp"/><meta data-react-helmet="true" name="github:label1" content="Written by"/><meta data-react-helmet="true" name="github:data1" content="Pozafly"/><meta data-react-helmet="true" name="github:label2" content="Filed under"/><meta data-react-helmet="true" name="github:data2" content="DevOps"/><meta data-react-helmet="true" name="github:site" content="@pozafly"/><meta data-react-helmet="true" name="github:creator" content="@pozafly"/><meta data-react-helmet="true" property="og:image:width" content="1"/><meta data-react-helmet="true" property="og:image:height" content="0.5208333333333334"/><link rel="sitemap" type="application/xml" href="/sitemap-index.xml"/><style>.gatsby-image-wrapper{position:relative;overflow:hidden}.gatsby-image-wrapper picture.object-fit-polyfill{position:static!important}.gatsby-image-wrapper img{bottom:0;height:100%;left:0;margin:0;max-width:none;padding:0;position:absolute;right:0;top:0;width:100%;object-fit:cover}.gatsby-image-wrapper [data-main-image]{opacity:0;transform:translateZ(0);transition:opacity .25s linear;will-change:opacity}.gatsby-image-wrapper-constrained{display:inline-block;vertical-align:top}</style><noscript><style>.gatsby-image-wrapper noscript [data-main-image]{opacity:1!important}.gatsby-image-wrapper [data-placeholder-image]{opacity:0!important}</style></noscript><script type="module">const e="undefined"!=typeof HTMLImageElement&&"loading"in HTMLImageElement.prototype;e&&document.body.addEventListener("load",(function(e){const t=e.target;if(void 0===t.dataset.mainImage)return;if(void 0===t.dataset.gatsbyImageSsr)return;let a=null,n=t;for(;null===a&&n;)void 0!==n.parentNode.dataset.gatsbyImageWrapper&&(a=n.parentNode),n=n.parentNode;const o=a.querySelector("[data-placeholder-image]"),r=new Image;r.src=t.currentSrc,r.decode().catch((()=>{})).then((()=>{t.style.opacity=1,o&&(o.style.opacity=0,o.style.transition="opacity 500ms linear")}))}),!0);</script><style type="text/css">
    .auto-link.before {
      position: absolute;
      top: 0;
      left: 0;
      transform: translateX(-100%);
      padding-right: 4px;
    }
    .auto-link.after {
      display: inline-block;
      padding-left: 4px;
    }
    h1 .auto-link svg,
    h2 .auto-link svg,
    h3 .auto-link svg,
    h4 .auto-link svg,
    h5 .auto-link svg,
    h6 .auto-link svg {
      visibility: hidden;
    }
    h1:hover .auto-link svg,
    h2:hover .auto-link svg,
    h3:hover .auto-link svg,
    h4:hover .auto-link svg,
    h5:hover .auto-link svg,
    h6:hover .auto-link svg,
    h1 .auto-link:focus svg,
    h2 .auto-link:focus svg,
    h3 .auto-link:focus svg,
    h4 .auto-link:focus svg,
    h5 .auto-link:focus svg,
    h6 .auto-link:focus svg {
      visibility: visible;
    }
  </style><script>
    document.addEventListener("DOMContentLoaded", function(event) {
      var hash = window.decodeURI(location.hash.replace('#', ''))
      if (hash !== '') {
        var element = document.getElementById(hash)
        if (element) {
          var scrollTop = window.pageYOffset || document.documentElement.scrollTop || document.body.scrollTop
          var clientTop = document.documentElement.clientTop || document.body.clientTop || 0
          var offset = element.getBoundingClientRect().top + scrollTop - clientTop
          // Wait for the browser to finish rendering before scrolling.
          setTimeout((function() {
            window.scrollTo(0, offset - 100)
          }), 0)
        }
      }
    })
  </script><link rel="canonical" href="https://pozafly.github.io/dev-ops/cache-and-restore-keys-in-github-actions/" data-baseprotocol="https:" data-basehost="pozafly.github.io"/><title data-react-helmet="true">GitHub Actions의 캐시 조금 더 다뤄보기 (feat. restore-keys)</title><link data-react-helmet="true" rel="icon" href="/static/alien-652bde6f766dc3e52bdf32391ba54a09.png" type="image/x-icon"/><link rel="preconnect" href="https://www.googletagmanager.com"/><link rel="dns-prefetch" href="https://www.googletagmanager.com"/><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-SLQNH3ND3J"></script><script>
      
      function gaOptout(){document.cookie=disableStr+'=true; expires=Thu, 31 Dec 2099 23:59:59 UTC;path=/',window[disableStr]=!0}var gaProperty='G-SLQNH3ND3J',disableStr='ga-disable-'+gaProperty;document.cookie.indexOf(disableStr+'=true')>-1&&(window[disableStr]=!0);
      if(!(navigator.doNotTrack == "1" || window.doNotTrack == "1")) {
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-SLQNH3ND3J', {"anonymize_ip":true,"cookie_expires":0,"send_page_view":false});
      }
      </script></head><body class="light"><script>
            (function() {
              window.__onThemeChange = function() {}; // 컴포넌트에서 정의할 테마 변경 콜백

              let preferredTheme; // 초기화에 사용할 테마
              try {
                const saved = localStorage.getItem('theme') // 로컬 스토리지에 있는 것 사용
                if (saved) {
                  preferredTheme = saved.toLowerCase()
                }
              } catch (err) { }

              // 테마 설정 함수
              window.__setPreferredTheme = function(newTheme) {
                window.__theme = newTheme; // 테마는 전역 변수에 저장
                preferredTheme = newTheme;
                document.body.className = newTheme; // 바디에 클래스 추가
                window.__onThemeChange(newTheme); // 콜백 실행

                try {
                  localStorage.setItem('theme', newTheme);
                } catch (err) {}
              }

              // 컬러모드 미디어 쿼리 객체를 가져온다
              const darkQuery = window.matchMedia('(prefers-color-scheme: dark)');

              // 컬러모드 변경 탐지 이벤트 리스터 추가
              darkQuery.addListener(function(e) {
                window.__setPreferredTheme(e.matches ? 'dark' : 'light')
              });

              // 테마 설정. 저장된 테마가 없으면 시스템 설정을 사용한다.
              window.__setPreferredTheme(preferredTheme || (darkQuery.matches ? 'dark' : 'light'));
            })();
            </script><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><div class="post-template"><style data-emotion="css-global 7yxv5y">html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,dl,dt,dd,ol,fieldset,form,label,legend,article,aside,canvas,details,embed,figure,figcaption,footer,header,hgroup,menu,nav,output,ruby,section,summary,time,mark,audio,video{margin:0;padding:0;border:0;font:inherit;font-size:16px;vertical-align:baseline;}html .copyright,body .copyright,div .copyright,span .copyright,applet .copyright,object .copyright,iframe .copyright,h1 .copyright,h2 .copyright,h3 .copyright,h4 .copyright,h5 .copyright,h6 .copyright,p .copyright,blockquote .copyright,pre .copyright,a .copyright,abbr .copyright,acronym .copyright,address .copyright,big .copyright,cite .copyright,code .copyright,del .copyright,dfn .copyright,em .copyright,img .copyright,ins .copyright,kbd .copyright,q .copyright,s .copyright,samp .copyright,small .copyright,strike .copyright,strong .copyright,sub .copyright,sup .copyright,tt .copyright,var .copyright,dl .copyright,dt .copyright,dd .copyright,ol .copyright,fieldset .copyright,form .copyright,label .copyright,legend .copyright,article .copyright,aside .copyright,canvas .copyright,details .copyright,embed .copyright,figure .copyright,figcaption .copyright,footer .copyright,header .copyright,hgroup .copyright,menu .copyright,nav .copyright,output .copyright,ruby .copyright,section .copyright,summary .copyright,time .copyright,mark .copyright,audio .copyright,video .copyright{font-size:1.4rem;}html .copyright a,body .copyright a,div .copyright a,span .copyright a,applet .copyright a,object .copyright a,iframe .copyright a,h1 .copyright a,h2 .copyright a,h3 .copyright a,h4 .copyright a,h5 .copyright a,h6 .copyright a,p .copyright a,blockquote .copyright a,pre .copyright a,a .copyright a,abbr .copyright a,acronym .copyright a,address .copyright a,big .copyright a,cite .copyright a,code .copyright a,del .copyright a,dfn .copyright a,em .copyright a,img .copyright a,ins .copyright a,kbd .copyright a,q .copyright a,s .copyright a,samp .copyright a,small .copyright a,strike .copyright a,strong .copyright a,sub .copyright a,sup .copyright a,tt .copyright a,var .copyright a,dl .copyright a,dt .copyright a,dd .copyright a,ol .copyright a,fieldset .copyright a,form .copyright a,label .copyright a,legend .copyright a,article .copyright a,aside .copyright a,canvas .copyright a,details .copyright a,embed .copyright a,figure .copyright a,figcaption .copyright a,footer .copyright a,header .copyright a,hgroup .copyright a,menu .copyright a,nav .copyright a,output .copyright a,ruby .copyright a,section .copyright a,summary .copyright a,time .copyright a,mark .copyright a,audio .copyright a,video .copyright a{font-size:inherit;}html .error-front-page,body .error-front-page,div .error-front-page,span .error-front-page,applet .error-front-page,object .error-front-page,iframe .error-front-page,h1 .error-front-page,h2 .error-front-page,h3 .error-front-page,h4 .error-front-page,h5 .error-front-page,h6 .error-front-page,p .error-front-page,blockquote .error-front-page,pre .error-front-page,a .error-front-page,abbr .error-front-page,acronym .error-front-page,address .error-front-page,big .error-front-page,cite .error-front-page,code .error-front-page,del .error-front-page,dfn .error-front-page,em .error-front-page,img .error-front-page,ins .error-front-page,kbd .error-front-page,q .error-front-page,s .error-front-page,samp .error-front-page,small .error-front-page,strike .error-front-page,strong .error-front-page,sub .error-front-page,sup .error-front-page,tt .error-front-page,var .error-front-page,dl .error-front-page,dt .error-front-page,dd .error-front-page,ol .error-front-page,fieldset .error-front-page,form .error-front-page,label .error-front-page,legend .error-front-page,article .error-front-page,aside .error-front-page,canvas .error-front-page,details .error-front-page,embed .error-front-page,figure .error-front-page,figcaption .error-front-page,footer .error-front-page,header .error-front-page,hgroup .error-front-page,menu .error-front-page,nav .error-front-page,output .error-front-page,ruby .error-front-page,section .error-front-page,summary .error-front-page,time .error-front-page,mark .error-front-page,audio .error-front-page,video .error-front-page{font-size:1.6rem;}body{line-height:1;word-break:keep-all;}body.light{--body-color:#303a3e;--background-color:#fff;--main-color:#000;--link-color:#0a0b0c;--border-top-color:#e4eaed;--nav-background:rgba(255, 255, 255, 0.4);--header-color:var(--background-color);--header-after:var(--background-color);--header-before:rgba(0, 0, 0, 0.18);--author-border:#fff;--home-header-color:#15171A;--home-header-border-bottom:#eaeff1;--header-author-link:#15171A;--no-image-border:#eaeff1;--strong-font-weight:600;--anchor-color:#768086;--loader-color:hsla(230, 40%, 10%, 0.8);--loader-color2:hsla(230, 40%, 10%, 0.2);--image-border-color:hsl(230, 25%, 94%);--post-card-title:rgb(21, 23, 26);--post-card-description:rgb(48, 58, 62);--post-card-by-line:#434952;--strong-color:#0a0b0c;--figcaption-color:#000;--table-first-of-type:linear-gradient(
              to right,
              rgba(255, 255, 255, 1) 50%,
              rgba(255, 255, 255, 0) 100%
            );--table-last-of-type:linear-gradient(
              to left,
              rgba(255, 255, 255, 1) 50%,
              rgba(255, 255, 255, 0) 100%
            );--table-th-background:#f4f8fb;--table-th-border:#e1edf4;--tag-boxshadow:hsla(218, 53%, 10%, 12%);--tag-background:#f5f5f5;--post-full-border:#e4eaed;--post-full-meta-link:#2c3036;--post-full-meta-link-hover:#15171A;--post-full-title:#0b0c0e;--highlight-background:#fafafa;--highlight-border:#d1d1d1;--pre-code-color:#000;--little-code-border:#d1d1d1;--prism-background:hsl(0, 0%, 90.66%);--prism-border-left:hsl(0, 0%, 82.88%);}body.dark{--body-color:rgba(255, 255, 255, 0.75);--background-color:#191b1f;--main-color:#fff;--link-color:rgba(255, 255, 255, 0.9);--border-top-color:#2b2f36;--nav-background:rgba(25, 27, 31, 0.4);--header-color:#0a0b0c;--header-after:#191b1f;--header-before:rgba(0, 0, 0, 0.6);--author-border:#1a1c20;--home-header-color:rgba(255, 255, 255, 0.9);--home-header-border-bottom:#272a30;--header-author-link:rgba(255, 255, 255, 0.75);--no-image-border:#3b4049;--strong-font-weight:500;--anchor-color:#90a2aa;--loader-color:hsla(230, 40%, 90%, 0.8);--loader-color2:hsla(230, 40%, 90%, 0.2);--image-border-color:hsl(230, 6%, 23%);--post-card-title:rgba(255, 255, 255, 0.85);--post-card-description:#768086;--post-card-by-line:rgba(255, 255, 255, 0.75);--strong-color:#f2f2f2;--figcaption-color:rgba(255, 255, 255, 0.6);--table-first-of-type:linear-gradient(
              to right,
              #191b1f 50%,
              #191b1f 100%
            );--table-last-of-type:linear-gradient(
              270deg,
              #191b1f 50%,
              rgba(25, 27, 31, 0)
            );--table-th-background:#2b2f36;--table-th-border:var(--table-th-background);--tag-boxshadow:#090f1a;--tag-background:#282b31;--post-full-border:#3b4049;--post-full-meta-link:rgba(255, 255, 255, 0.75);--post-full-meta-link-hover:#fff;--post-full-title:rgba(255, 255, 255, 0.9);--highlight-background:rgb(32 36 39);--highlight-border:none;--pre-code-color:#c9d1d9;--little-code-border:#515151;--prism-background:rgb(0 0 0 / 40%);--prism-border-left:#818181;}ol,ul{list-style:none;}blockquote,q{quotes:none;}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none;}table{border-spacing:0;border-collapse:collapse;}img{max-width:100%;}html{box-sizing:border-box;font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%;}*,*:before,*:after{box-sizing:inherit;}a{background-color:transparent;}a:active,a:hover{outline:0;}b,strong{font-weight:var(--strong-font-weight);}i,em,dfn{font-style:italic;}h1{margin:0.67em 0;font-size:2em;}small{font-size:80%;}sub,sup{position:relative;font-size:75%;line-height:0;vertical-align:baseline;}sup{top:-0.5em;}sub{bottom:-0.25em;}img{border:0;}svg:not(:root){overflow:hidden;}mark{background-color:#fdffb6;}code,kbd,pre,samp{font-family:monospace,monospace;font-size:1em;}button,input,optgroup,select,textarea{margin:0;color:inherit;font:inherit;}button{overflow:visible;border:none;}button,select{text-transform:none;}button,html input[type='button'],input[type='reset'],input[type='submit']{cursor:pointer;-webkit-appearance:button;}button[disabled],html input[disabled]{cursor:default;}button::-moz-focus-inner,input::-moz-focus-inner{padding:0;border:0;}input{line-height:normal;}input:focus{outline:none;}input[type='checkbox'],input[type='radio']{box-sizing:border-box;padding:0;}input[type='number']::-webkit-inner-spin-button,input[type='number']::-webkit-outer-spin-button{height:auto;}input[type='search']{box-sizing:content-box;-webkit-appearance:textfield;}input[type='search']::-webkit-search-cancel-button,input[type='search']::-webkit-search-decoration{-webkit-appearance:none;}legend{padding:0;border:0;}textarea{overflow:auto;}table{border-spacing:0;border-collapse:collapse;}td,th{padding:0;}html{overflow-x:hidden;overflow-y:scroll;font-size:62.5%;-webkit-tap-highlight-color:rgba(0, 0, 0, 0);}body{overflow-x:hidden;font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,'Noto Sans','Ubuntu','Droid Sans','Helvetica Neue',sans-serif;font-size:1.6rem;line-height:1.6em;font-weight:400;font-style:normal;letter-spacing:0;text-rendering:optimizeLegibility;background:var(--background-color);color:var(--body-color);-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;-moz-font-feature-settings:'liga' on;}body::-webkit-scrollbar{background-color:transparent;width:6px;}body::-webkit-scrollbar-thumb{border-radius:8px;background-color:hsla(230, 5%, 35%, 1);}hr{position:relative;display:block;width:100%;margin:2.5em 0 3.5em;padding:0;height:1px;border:0;border-top:1px solid var(--border-top-color);}audio,canvas,iframe,img,svg,video{vertical-align:middle;}fieldset{margin:0;padding:0;border:0;}textarea{resize:vertical;}p,ul,ol,dl,blockquote{margin:0 0 1.5em 0;}ol,ul{padding-left:1.3em;}ol ol,ul ul,ul ol,ol ul{margin:0.5em 0 1em;}ul{list-style:disc;}ol{list-style:decimal;}ul,ol{max-width:100%;}li{margin:0.5em 0;padding-left:0.3em;line-height:1.6em;}dt{float:left;margin:0 20px 0 0;width:120px;color:#15171A;font-weight:500;text-align:right;}dd{margin:0 0 5px 0;text-align:left;}blockquote{margin:1.5em 0;padding:0 1.6em 0 1.6em;border-left:#e5eff5 0.5em solid;}blockquote p{margin:0.8em 0;font-size:1.2em;font-weight:400;}blockquote small{display:inline-block;margin:0.8em 0 0.8em 1.5em;font-size:0.9em;opacity:0.8;}blockquote cite{font-weight:bold;}blockquote cite a{font-weight:normal;}a{color:var(--anchor-color);-webkit-text-decoration:none;text-decoration:none;}a:hover{-webkit-text-decoration:underline;text-decoration:underline;}h1,h2,h3,h4,h5,h6{margin-top:0;line-height:1.15;font-weight:600;text-rendering:optimizeLegibility;}h1{margin:0 0 0.5em 0;font-size:5.5rem;font-weight:600;}@media (max-width: 500px){h1{font-size:2.2rem;}}h2{margin:1.5em 0 0.5em 0;font-size:2.2rem;}@media (max-width: 500px){h2{font-size:1.8rem;}}h3{margin:1.5em 0 0.5em 0;font-size:1.8rem;font-weight:500;}@media (max-width: 500px){h3{font-size:1.7rem;}}h4{margin:1.5em 0 0.5em 0;font-size:1.6rem;font-weight:500;}h5{margin:1.5em 0 0.5em 0;font-size:1.4rem;font-weight:500;}h6{margin:1.5em 0 0.5em 0;font-size:1.4rem;font-weight:500;}h1 a.auto-link svg,h2 a.auto-link svg,h3 a.auto-link svg,h4 a.auto-link svg,h5 a.auto-link svg,h6 a.auto-link svg{opacity:0;-webkit-transition:0.25s ease;transition:0.25s ease;}h1:hover a.auto-link svg,h2:hover a.auto-link svg,h3:hover a.auto-link svg,h4:hover a.auto-link svg,h5:hover a.auto-link svg,h6:hover a.auto-link svg{opacity:1;}a.auto-link{box-shadow:none!important;}a.auto-link:hover{box-shadow:none!important;}a.auto-link svg{fill:var(--link-color)!important;}.medium-zoom-overlay{-webkit-backdrop-filter:blur(8px);backdrop-filter:blur(8px);}.gatsby-resp-image-background-image{border-radius:6px;}.gatsby-resp-image-wrapper{width:80%;}@media (max-width: 800px){.gatsby-resp-image-wrapper{width:100%;}}.medium-zoom-image{box-shadow:none!important;}</style><style data-emotion="css 1e7pk1s">.css-1e7pk1s .site-main{margin-top:64px;background:var(--background-color);padding-bottom:4vw;}</style><style data-emotion="css 1cb3qir">.css-1cb3qir{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;min-height:100vh;}.css-1cb3qir .site-main{margin-top:64px;background:var(--background-color);padding-bottom:4vw;}</style><div class="css-1cb3qir esvym2d0"><header class="site-header"><style data-emotion="css pfaci7">.css-pfaci7{position:relative;padding:0 5vw;position:fixed;top:0;right:0;left:0;z-index:1000;-webkit-backdrop-filter:blur(8px);backdrop-filter:blur(8px);background:var(--nav-background);}</style><div class="css-pfaci7"><style data-emotion="css y521qa">.css-y521qa{margin:0 auto;max-width:1040px;width:100%;}</style><div class="css-y521qa"><style data-emotion="css lcmrfl">.css-lcmrfl{position:relative;z-index:100;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between;-webkit-align-items:flex-start;-webkit-box-align:flex-start;-ms-flex-align:flex-start;align-items:flex-start;overflow-y:hidden;height:64px;font-size:1.3rem;}</style><nav class="css-lcmrfl"><style data-emotion="css axoi21">.css-axoi21{-webkit-flex:1 0 auto;-ms-flex:1 0 auto;flex:1 0 auto;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;overflow-x:auto;overflow-y:hidden;-webkit-overflow-scrolling:touch;margin-right:10px;padding:10px 0 80px;font-weight:500;letter-spacing:0.2px;text-transform:uppercase;white-space:nowrap;-ms-overflow-scrolling:touch;}@media (max-width: 700px){.css-axoi21{margin-right:0;}}</style><div class="site-nav-left  css-axoi21 e1sju8vj4"><style data-emotion="css vdmvgr">.css-vdmvgr{position:relative;z-index:100;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;display:inline-block;margin-right:32px;padding:12px 0;color:#fff;font-size:1.7rem;line-height:1.8rem;font-weight:bold;letter-spacing:-0.5px;text-transform:none;}@media (max-width: 700px){.css-vdmvgr{margin-right:18px;}}.css-vdmvgr:hover{-webkit-text-decoration:none;text-decoration:none;}.css-vdmvgr img{display:block;width:auto;height:21px;}</style><a class="site-nav-logo css-vdmvgr" href="/"><img src="/static/a62d45ddbe29cf42da820a576d9375e1/aef42/alien.png" alt="Pozafly Blog"/></a><style data-emotion="css 1xdepn">.css-1xdepn{position:relative;-webkit-align-self:flex-start;-ms-flex-item-align:flex-start;align-self:flex-start;}</style><div class="css-1xdepn e1sju8vj3"><style data-emotion="css 123fa3n">.css-123fa3n{position:absolute;z-index:1000;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;margin:0 0 0 -12px;padding:0;list-style:none;-webkit-transition:all 1s cubic-bezier(0.19, 1, 0.22, 1);transition:all 1s cubic-bezier(0.19, 1, 0.22, 1);}.css-123fa3n li{display:block;margin:0;padding:0;}.css-123fa3n li a{font-size:1.2rem;position:relative;display:block;padding:10px 12px;color:var(--main-color);opacity:0.8;-webkit-transition:opacity 0.35s ease-in-out;transition:opacity 0.35s ease-in-out;}@media (max-width: 700px){.css-123fa3n li a{padding:10px 8px;}}.css-123fa3n li a:hover{-webkit-text-decoration:none;text-decoration:none;opacity:1;}.css-123fa3n li a:before{content:'';position:absolute;right:100%;bottom:8px;left:12px;height:1px;background:var(--main-color);opacity:0.25;-webkit-transition:all 0.35s ease-in-out;transition:all 0.35s ease-in-out;}.css-123fa3n li a:hover:before{right:12px;opacity:0.5;}.css-123fa3n li a.is-home{color:#fff;}.css-123fa3n li a.is-home:before{background:#fff;}.css-123fa3n .nav-current{opacity:1;}</style><ul role="menu" class="css-123fa3n"><li role="menuitem"><a class="" href="/">Home</a></li><li role="menuitem"><a class="" href="/about/">About</a></li><li role="menuitem"><a class="" href="/tags/">Tags</a></li><li role="menuitem"><a class="" href="/tags/diary/">Diary</a></li></ul><style data-emotion="css 1uyot5q">.css-1uyot5q{visibility:hidden;position:absolute;top:9px;color:var(--main-color);font-size:1.7rem;font-weight:400;text-transform:none;opacity:0;-webkit-transition:all 1s cubic-bezier(0.19, 1, 0.22, 1);transition:all 1s cubic-bezier(0.19, 1, 0.22, 1);-webkit-transform:translateY(175%);-moz-transform:translateY(175%);-ms-transform:translateY(175%);transform:translateY(175%);}@media (max-width: 700px){.css-1uyot5q{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;max-width:calc(100vw - 126px);}}.css-1uyot5q .dash{left:-25px;}.css-1uyot5q .dash:before{content:'– ';opacity:0.5;}</style><span class="nav-post-title css-1uyot5q e1sju8vj0">GitHub Actions의 캐시 조금 더 다뤄보기 (feat. restore-keys)</span></div></div><style data-emotion="css yofoym">.css-yofoym{-webkit-flex:0 1 auto;-ms-flex:0 1 auto;flex:0 1 auto;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:end;-ms-flex-pack:end;-webkit-justify-content:flex-end;justify-content:flex-end;padding:10px 0;height:64px;}</style><div class="css-yofoym e1sju8vj2"><style data-emotion="css 1txew8w">.css-1txew8w{-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}@media (max-width: 700px){.css-1txew8w .not-mobile{display:none;}}</style><div class="css-1txew8w e1sju8vj1"><style data-emotion="css 2jp3yt">.css-2jp3yt{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;margin:0;padding:10px;opacity:0.8;-webkit-transition:opacity 0.35s ease;transition:opacity 0.35s ease;}.css-2jp3yt:hover{opacity:1;}.css-2jp3yt svg{height:1.8rem;fill:var(--main-color);}.css-2jp3yt.is-home svg{fill:#fff;}.css-2jp3yt svg{height:1.6rem;}</style><a class=" not-mobile css-2jp3yt" href="https://www.instagram.com/pozafly_/" target="_blank" title="Instagram" rel="noopener noreferrer"><svg height="511pt" viewBox="0 0 511 511.9" width="13pt" xmlns="http://www.w3.org/2000/svg"><path d="m510.949219 150.5c-1.199219-27.199219-5.597657-45.898438-11.898438-62.101562-6.5-17.199219-16.5-32.597657-29.601562-45.398438-12.800781-13-28.300781-23.101562-45.300781-29.5-16.296876-6.300781-34.898438-10.699219-62.097657-11.898438-27.402343-1.300781-36.101562-1.601562-105.601562-1.601562s-78.199219.300781-105.5 1.5c-27.199219 1.199219-45.898438 5.601562-62.097657 11.898438-17.203124 6.5-32.601562 16.5-45.402343 29.601562-13 12.800781-23.097657 28.300781-29.5 45.300781-6.300781 16.300781-10.699219 34.898438-11.898438 62.097657-1.300781 27.402343-1.601562 36.101562-1.601562 105.601562s.300781 78.199219 1.5 105.5c1.199219 27.199219 5.601562 45.898438 11.902343 62.101562 6.5 17.199219 16.597657 32.597657 29.597657 45.398438 12.800781 13 28.300781 23.101562 45.300781 29.5 16.300781 6.300781 34.898438 10.699219 62.101562 11.898438 27.296876 1.203124 36 1.5 105.5 1.5s78.199219-.296876 105.5-1.5c27.199219-1.199219 45.898438-5.597657 62.097657-11.898438 34.402343-13.300781 61.601562-40.5 74.902343-74.898438 6.296876-16.300781 10.699219-34.902343 11.898438-62.101562 1.199219-27.300781 1.5-36 1.5-105.5s-.101562-78.199219-1.300781-105.5zm-46.097657 209c-1.101562 25-5.300781 38.5-8.800781 47.5-8.601562 22.300781-26.300781 40-48.601562 48.601562-9 3.5-22.597657 7.699219-47.5 8.796876-27 1.203124-35.097657 1.5-103.398438 1.5s-76.5-.296876-103.402343-1.5c-25-1.097657-38.5-5.296876-47.5-8.796876-11.097657-4.101562-21.199219-10.601562-29.398438-19.101562-8.5-8.300781-15-18.300781-19.101562-29.398438-3.5-9-7.699219-22.601562-8.796876-47.5-1.203124-27-1.5-35.101562-1.5-103.402343s.296876-76.5 1.5-103.398438c1.097657-25 5.296876-38.5 8.796876-47.5 4.101562-11.101562 10.601562-21.199219 19.203124-29.402343 8.296876-8.5 18.296876-15 29.398438-19.097657 9-3.5 22.601562-7.699219 47.5-8.800781 27-1.199219 35.101562-1.5 103.398438-1.5 68.402343 0 76.5.300781 103.402343 1.5 25 1.101562 38.5 5.300781 47.5 8.800781 11.097657 4.097657 21.199219 10.597657 29.398438 19.097657 8.5 8.300781 15 18.300781 19.101562 29.402343 3.5 9 7.699219 22.597657 8.800781 47.5 1.199219 27 1.5 35.097657 1.5 103.398438s-.300781 76.300781-1.5 103.300781zm0 0"></path><path d="m256.449219 124.5c-72.597657 0-131.5 58.898438-131.5 131.5s58.902343 131.5 131.5 131.5c72.601562 0 131.5-58.898438 131.5-131.5s-58.898438-131.5-131.5-131.5zm0 216.800781c-47.097657 0-85.300781-38.199219-85.300781-85.300781s38.203124-85.300781 85.300781-85.300781c47.101562 0 85.300781 38.199219 85.300781 85.300781s-38.199219 85.300781-85.300781 85.300781zm0 0"></path><path d="m423.851562 119.300781c0 16.953125-13.746093 30.699219-30.703124 30.699219-16.953126 0-30.699219-13.746094-30.699219-30.699219 0-16.957031 13.746093-30.699219 30.699219-30.699219 16.957031 0 30.703124 13.742188 30.703124 30.699219zm0 0"></path></svg></a><style data-emotion="css oaqssz">.css-oaqssz{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;margin:0;padding:10px;opacity:0.8;-webkit-transition:opacity 0.35s ease;transition:opacity 0.35s ease;}.css-oaqssz:hover{opacity:1;}.css-oaqssz svg{height:1.8rem;fill:var(--main-color);}.css-oaqssz.is-home svg{fill:#fff;}</style><a class=" not-mobile css-oaqssz" href="https://github.com/pozafly" title="Github" target="_blank" rel="noopener noreferrer"><svg width="21px" height="21px" viewBox="0 0 1024 1024" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M8 0C3.58 0 0 3.58 0 8C0 11.54 2.29 14.53 5.47 15.59C5.87 15.66 6.02 15.42 6.02 15.21C6.02 15.02 6.01 14.39 6.01 13.72C4 14.09 3.48 13.23 3.32 12.78C3.23 12.55 2.84 11.84 2.5 11.65C2.22 11.5 1.82 11.13 2.49 11.12C3.12 11.11 3.57 11.7 3.72 11.94C4.44 13.15 5.59 12.81 6.05 12.6C6.12 12.08 6.33 11.73 6.56 11.53C4.78 11.33 2.92 10.64 2.92 7.58C2.92 6.71 3.23 5.99 3.74 5.43C3.66 5.23 3.38 4.41 3.82 3.31C3.82 3.31 4.49 3.1 6.02 4.13C6.66 3.95 7.34 3.86 8.02 3.86C8.7 3.86 9.38 3.95 10.02 4.13C11.55 3.09 12.22 3.31 12.22 3.31C12.66 4.41 12.38 5.23 12.3 5.43C12.81 5.99 13.12 6.7 13.12 7.58C13.12 10.65 11.25 11.33 9.47 11.53C9.76 11.78 10.01 12.26 10.01 13.01C10.01 14.08 10 14.94 10 15.21C10 15.42 10.15 15.67 10.55 15.59C13.71 14.53 16 11.53 16 8C16 3.58 12.42 0 8 0Z" transform="scale(64)"></path></svg></a><style data-emotion="css 1tj4rlb">.css-1tj4rlb{margin:6px;padding:2px;border-radius:50%;overflow:hidden;background:transparent;background:rgba(215, 215, 215, 0.6);-webkit-transition:all 0.3s ease;transition:all 0.3s ease;}.css-1tj4rlb #switch{position:relative;background:transparent;border:0;width:21px;height:21px;padding:0;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;overflow:hidden;}.css-1tj4rlb .mode{position:relative;width:18px;height:18px;-webkit-transition:all 0.45s ease;transition:all 0.45s ease;border-radius:50%;background:#000;opacity:0.8;overflow:hidden;}.css-1tj4rlb .mode::before{content:'';position:absolute;width:5px;height:5px;left:50%;top:50%;-webkit-transform:translateX(-50%) translateY(-50%);-moz-transform:translateX(-50%) translateY(-50%);-ms-transform:translateX(-50%) translateY(-50%);transform:translateX(-50%) translateY(-50%);border-radius:50%;background:inherit;z-index:-1;opacity:0;-webkit-transition:box-shadow 0.4s 0s ease;transition:box-shadow 0.4s 0s ease;}.css-1tj4rlb .mode::after{content:'';position:absolute;width:90%;height:90%;top:-20%;left:30%;border-radius:50%;background:rgba(255, 255, 255, 0.9);-webkit-transition:-webkit-transform 0.45s ease;transition:transform 0.45s ease;}.css-1tj4rlb .mode:hover{opacity:1;}.css-1tj4rlb:hover{background:rgba(215, 215, 215, 0.9);}.css-1tj4rlb.dark{background:transparent;}.css-1tj4rlb.dark:hover{background:rgba(255, 255, 255, 0.1);}.css-1tj4rlb.dark .mode{-webkit-transform:scale(0.5);-moz-transform:scale(0.5);-ms-transform:scale(0.5);transform:scale(0.5);background:white;opacity:1;opacity:0.8;overflow:initial;}.css-1tj4rlb.dark .mode::before{opacity:1;box-shadow:0 -16px 0 0 white,0 16px 0 0 white,-16px 0 0 0 white,16px 0 0 0 white,12px 12px 0 0 white,12px -12px 0 0 white,-12px 12px 0 0 white,-12px -12px 0 0 white;}.css-1tj4rlb.dark .mode::after{opacity:0;-webkit-transition:background 0.45s ease;transition:background 0.45s ease;-webkit-transform:translateX(50%) translateY(-50%);-moz-transform:translateX(50%) translateY(-50%);-ms-transform:translateX(50%) translateY(-50%);transform:translateX(50%) translateY(-50%);}.css-1tj4rlb.is-home .mode{background:#fff;}.css-1tj4rlb.is-home .mode::after{background:rgba(95, 131, 162);}.css-1tj4rlb.is-home.dark .mode::before{box-shadow:0 -16px 0 0 white,0 16px 0 0 white,-16px 0 0 0 white,16px 0 0 0 white,12px 12px 0 0 white,12px -12px 0 0 white,-12px 12px 0 0 white,-12px -12px 0 0 white;}.css-1tj4rlb.is-home.dark .mode::after{background:rgba(46, 64, 79);}</style><button class="dark  css-1tj4rlb e12e1g7o0"><div id="switch"><div class="mode"></div></div></button></div></div></nav></div></div></header><style data-emotion="css h4hvhw">.css-h4hvhw{-webkit-box-flex:1;-webkit-flex-grow:1;-ms-flex-positive:1;flex-grow:1;background:var(--background-color);position:relative;padding:0 5vw;}</style><main id="site-main" class="site-main css-h4hvhw"><div class="css-y521qa"><style data-emotion="css 150a24d">.css-150a24d{position:relative;}</style><article class="css-150a24d"><style data-emotion="css 7tju5o">.css-7tju5o{position:relative;margin:0 auto;padding:70px 100px 50px;border-top-left-radius:3px;border-top-right-radius:3px;}@media (max-width: 1170px){.css-7tju5o{padding:60px 11vw 50px;}}@media (max-width: 800px){.css-7tju5o{padding-right:5vw;padding-left:5vw;}}@media (max-width: 500px){.css-7tju5o{padding:20px 0 35px;}}</style><header class="post-full-header css-7tju5o ewnyor56"><style data-emotion="css 1twueq0">.css-1twueq0{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:start;-ms-flex-pack:start;-webkit-justify-content:flex-start;justify-content:flex-start;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;color:#738a94;font-size:1.2rem;line-height:1.4em;font-weight:600;}.css-1twueq0 a{font-size:1.2rem;}</style><section class="post-full-tags css-1twueq0 ewnyor55"><a href="/tags/dev-ops/">DevOps</a>,  <a href="/tags/github-actions/">Github Actions</a>,  <a href="/tags/automation/">Automation</a></section><style data-emotion="css yk3ogg">.css-yk3ogg{margin:0 0 0.2em;color:var(--post-full-title);}@media (max-width: 500px){.css-yk3ogg{margin-top:0.2em;font-size:3.3rem;}}</style><h1 class="post-full-title css-yk3ogg ewnyor51">GitHub Actions의 캐시 조금 더 다뤄보기 (feat. restore-keys)</h1><style data-emotion="css 1nhmmda">.css-1nhmmda{margin:20px 0 0;color:var(--post-card-description);font-size:2rem;line-height:1.4em;font-weight:360;}@media (max-width: 500px){.css-1nhmmda{font-size:1.9rem;line-height:1.5em;}}</style><p class="post-full-custom-excerpt css-1nhmmda ewnyor53">restore-keys는 의존성 파일이 변경되었음에도 불구하고 기존 캐시를 불러오는 기능이다. 그렇다면, 무효화 되지 않은 캐시를 가져오게 되는 것일까?</p><style data-emotion="css 17weg7m">.css-17weg7m{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between;margin:35px 0 0;padding-top:15px;border-top:1px solid var(--post-full-border);}.css-17weg7m .post-full-byline-content{-webkit-box-flex:1;-webkit-flex-grow:1;-ms-flex-positive:1;flex-grow:1;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:flex-start;-webkit-box-align:flex-start;-ms-flex-align:flex-start;align-items:flex-start;}.css-17weg7m .post-full-byline-content .author-list{-webkit-box-pack:start;-ms-flex-pack:start;-webkit-justify-content:flex-start;justify-content:flex-start;padding:0 12px 0 0;}.css-17weg7m .post-full-byline-meta{margin:2px 0 0;color:#768086;font-size:1.4rem;line-height:1.2em;letter-spacing:0.2px;}.css-17weg7m .post-full-byline-meta h4{margin:0 0 3px;font-size:1.4rem;line-height:1.3em;font-weight:500;}.css-17weg7m .post-full-byline-meta h4 a{font-size:13px;color:var(--post-full-meta-link);}.css-17weg7m .post-full-byline-meta h4 a:hover{color:var(--post-full-meta-link-hover);}.css-17weg7m .post-full-byline-meta .byline-reading-time,.css-17weg7m .post-full-byline-meta .byline-meta-date{font-size:13px;}.css-17weg7m .post-full-byline-meta .bull{display:inline-block;margin:0 4px;opacity:0.6;}</style><div class="post-full-byline css-17weg7m ewnyor52"><section class="post-full-byline-content"><style data-emotion="css 12fmpzj">.css-12fmpzj{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-flex-wrap:wrap;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;margin:0 0 0 4px;padding:0;list-style:none;}</style><ul class="author-list css-12fmpzj ewnyor54"><style data-emotion="css 1g82peq">.css-1g82peq{position:relative;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;margin:0;padding:0;}.css-1g82peq:hover .author-name-tooltip{opacity:1;-webkit-transform:translate(-10px, -2px);-moz-transform:translate(-10px, -2px);-ms-transform:translate(-10px, -2px);transform:translate(-10px, -2px);}</style><li class="author-list-item css-1g82peq e1tg0lak0"><style data-emotion="css uxz87t">.css-uxz87t{display:block;overflow:hidden;margin:0 -4px;width:40px;height:40px;border:2px solid var(--author-border);border-radius:100%;}@media (max-width: 500px){.css-uxz87t{width:36px;height:36px;}}</style><a class="author-avatar css-uxz87t" href="/about/"><style data-emotion="css rfg33m">.css-rfg33m{display:block;width:100%;height:100%;background:#e4eaed;border-radius:100%;object-fit:cover;background:var(--background-color);}.css-rfg33m img{border-radius:100%;}</style><div data-gatsby-image-wrapper="" class="gatsby-image-wrapper author-profile-image css-rfg33m"><div aria-hidden="true" style="padding-top:100%"></div><div aria-hidden="true" data-placeholder-image="" style="opacity:1;transition:opacity 500ms linear;background-color:#6808f8;position:absolute;top:0;left:0;bottom:0;right:0"></div><picture><source type="image/webp" data-srcset="/static/8c061761f263c344f2c0416607c8adf1/e73fe/pozafly.webp 40w,/static/8c061761f263c344f2c0416607c8adf1/61ca6/pozafly.webp 80w,/static/8c061761f263c344f2c0416607c8adf1/507b0/pozafly.webp 120w" sizes="100vw"/><img data-gatsby-image-ssr="" data-main-image="" style="opacity:0" sizes="100vw" decoding="async" loading="lazy" data-src="/static/8c061761f263c344f2c0416607c8adf1/73bb6/pozafly.jpg" data-srcset="/static/8c061761f263c344f2c0416607c8adf1/2f28c/pozafly.jpg 40w,/static/8c061761f263c344f2c0416607c8adf1/499f6/pozafly.jpg 80w,/static/8c061761f263c344f2c0416607c8adf1/73bb6/pozafly.jpg 120w" alt="Pozafly"/></picture><noscript><picture><source type="image/webp" srcSet="/static/8c061761f263c344f2c0416607c8adf1/e73fe/pozafly.webp 40w,/static/8c061761f263c344f2c0416607c8adf1/61ca6/pozafly.webp 80w,/static/8c061761f263c344f2c0416607c8adf1/507b0/pozafly.webp 120w" sizes="100vw"/><img data-gatsby-image-ssr="" data-main-image="" style="opacity:0" sizes="100vw" decoding="async" loading="lazy" src="/static/8c061761f263c344f2c0416607c8adf1/73bb6/pozafly.jpg" srcSet="/static/8c061761f263c344f2c0416607c8adf1/2f28c/pozafly.jpg 40w,/static/8c061761f263c344f2c0416607c8adf1/499f6/pozafly.jpg 80w,/static/8c061761f263c344f2c0416607c8adf1/73bb6/pozafly.jpg 120w" alt="Pozafly"/></picture></noscript><script type="module">const t="undefined"!=typeof HTMLImageElement&&"loading"in HTMLImageElement.prototype;if(t){const t=document.querySelectorAll("img[data-main-image]");for(let e of t){e.dataset.src&&(e.setAttribute("src",e.dataset.src),e.removeAttribute("data-src")),e.dataset.srcset&&(e.setAttribute("srcset",e.dataset.srcset),e.removeAttribute("data-srcset"));const t=e.parentNode.querySelectorAll("source[data-srcset]");for(let e of t)e.setAttribute("srcset",e.dataset.srcset),e.removeAttribute("data-srcset");e.complete&&(e.style.opacity=1,e.parentNode.parentNode.querySelector("[data-placeholder-image]").style.opacity=0)}}</script></div></a></li></ul><section class="post-full-byline-meta"><h4 class="author-name"><a href="/about/">Pozafly</a></h4><div class="byline-meta-content"><time class="byline-meta-date" dateTime="2023-08-22">2023-08-22</time><span class="byline-reading-time"><span class="bull">•</span>16 min read</span></div></section></section></div></header><style data-emotion="css q0dqst">.css-q0dqst{margin:25px auto 50px;max-height:800px;-webkit-background-size:cover;background-size:cover;width:80%;border-radius:8px;border:1px solid var(--image-border-color);}.css-q0dqst img{border-radius:8px;}@media (max-width: 1170px){.css-q0dqst img{max-width:1170px;}}@media (max-width: 800px){.css-q0dqst{width:100%;}}@media (max-width: 500px){.css-q0dqst{margin-bottom:4vw;}}</style><figure class="css-q0dqst ewnyor50"><div data-gatsby-image-wrapper="" style="height:100%" class="gatsby-image-wrapper"><div aria-hidden="true" style="padding-top:52.083333333333336%"></div><img aria-hidden="true" data-placeholder-image="" style="opacity:1;transition:opacity 500ms linear" decoding="async" src="data:image/webp;base64,UklGRtoAAABXRUJQVlA4IM4AAADQAgCdASoUAAoAAAAAJYgCdL1CScCMIDOJauZFWWvwAP7+fCRqJ1HSVO9tIR999fXyP/P57rC8REMKD1//0ioeS1//ZcuF7B+ofR9C21V2uWjaFEHZ/V9j/+YjqrWQX/oM//3/Xef38974//DpwZKlrsnStauDGxKwCIg6sCCzNEAE1v/+tZbF+e3c/dp8J2s0//xoH+/2b/MdD0ufroUYn//1ag//2gH//Wsf0DSlimwf/X6RG3r/0P/tmbftAf4hf79ZmYcMFl0JnQAAAA==" alt=""/><picture><source type="image/avif" data-srcset="/static/365cb7658cd8164573e7796d96f879bc/8eada/main.avif 750w,/static/365cb7658cd8164573e7796d96f879bc/7c608/main.avif 1080w,/static/365cb7658cd8164573e7796d96f879bc/a357f/main.avif 1366w,/static/365cb7658cd8164573e7796d96f879bc/c62e1/main.avif 1920w" sizes="100vw"/><img data-gatsby-image-ssr="" data-main-image="" style="opacity:0" sizes="100vw" decoding="async" loading="lazy" data-src="/static/365cb7658cd8164573e7796d96f879bc/34dc0/main.webp" data-srcset="/static/365cb7658cd8164573e7796d96f879bc/3fe34/main.webp 750w,/static/365cb7658cd8164573e7796d96f879bc/da172/main.webp 1080w,/static/365cb7658cd8164573e7796d96f879bc/b3e28/main.webp 1366w,/static/365cb7658cd8164573e7796d96f879bc/34dc0/main.webp 1920w" alt="GitHub Actions의 캐시 조금 더 다뤄보기 (feat. restore-keys)"/></picture><noscript><picture><source type="image/avif" srcSet="/static/365cb7658cd8164573e7796d96f879bc/8eada/main.avif 750w,/static/365cb7658cd8164573e7796d96f879bc/7c608/main.avif 1080w,/static/365cb7658cd8164573e7796d96f879bc/a357f/main.avif 1366w,/static/365cb7658cd8164573e7796d96f879bc/c62e1/main.avif 1920w" sizes="100vw"/><img data-gatsby-image-ssr="" data-main-image="" style="opacity:0" sizes="100vw" decoding="async" loading="lazy" src="/static/365cb7658cd8164573e7796d96f879bc/34dc0/main.webp" srcSet="/static/365cb7658cd8164573e7796d96f879bc/3fe34/main.webp 750w,/static/365cb7658cd8164573e7796d96f879bc/da172/main.webp 1080w,/static/365cb7658cd8164573e7796d96f879bc/b3e28/main.webp 1366w,/static/365cb7658cd8164573e7796d96f879bc/34dc0/main.webp 1920w" alt="GitHub Actions의 캐시 조금 더 다뤄보기 (feat. restore-keys)"/></picture></noscript><script type="module">const t="undefined"!=typeof HTMLImageElement&&"loading"in HTMLImageElement.prototype;if(t){const t=document.querySelectorAll("img[data-main-image]");for(let e of t){e.dataset.src&&(e.setAttribute("src",e.dataset.src),e.removeAttribute("data-src")),e.dataset.srcset&&(e.setAttribute("srcset",e.dataset.srcset),e.removeAttribute("data-srcset"));const t=e.parentNode.querySelectorAll("source[data-srcset]");for(let e of t)e.setAttribute("srcset",e.dataset.srcset),e.removeAttribute("data-srcset");e.complete&&(e.style.opacity=1,e.parentNode.parentNode.querySelector("[data-placeholder-image]").style.opacity=0)}}</script></div></figure><style data-emotion="css fogea0">.css-fogea0 *:not(pre)>code[class*='language-']{border-radius:0.3em;background:var(--highlight-background);border:1px solid var(--little-code-border);color:var(--main-color);padding:0.15em 0.5em;white-space:normal;font-size:13px;}@media (max-width: 800px){.css-fogea0 *:not(pre)>code[class*='language-']{display:inline;}}.css-fogea0 .gatsby-highlight-code-line{display:block;margin-right:-1.3125rem;margin-left:-1.3125rem;padding-right:1em;padding-left:1.25em;background-color:var(--prism-background);border-left:0.25em solid var(--prism-border-left);font-size:1.4rem;}.css-fogea0 .gatsby-highlight{margin-bottom:1.75rem;margin-left:-1.3125rem;margin-right:-1.3125rem;border-radius:10px;background:var(--highlight-background);box-shadow:inset 0 0 0 1px var(--highlight-border);-webkit-overflow-scrolling:touch;overflow:auto;}.css-fogea0 .gatsby-highlight pre[class*='language-']{float:left;min-width:100%;font-size:1.4rem;line-height:24px;}.css-fogea0 pre[class*='language-'],.css-fogea0 code[class*='language-']{color:var(--pre-code-color);text-shadow:none;font-family:Consolas,Monaco,'Andale Mono','Ubuntu Mono',monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;}.css-fogea0 pre[class*='language-']::-webkit-scrollbar,.css-fogea0 code[class*='language-']::-webkit-scrollbar{background-color:transparent;height:4px;}.css-fogea0 pre[class*='language-']::-webkit-scrollbar-thumb,.css-fogea0 code[class*='language-']::-webkit-scrollbar-thumb{border-radius:8px;background-color:hsla(230, 5%, 35%, 1);}@media (max-width: 800px){.css-fogea0 pre[class*='language-'],.css-fogea0 code[class*='language-']{display:inline-block;}}.css-fogea0 pre[class*='language-']{overflow:auto;}.css-fogea0 .token{font-size:1.4rem;}.css-fogea0 pre[data-line]{padding:1em 0 1em 3em;position:relative;}@media print{.css-fogea0 pre[class*='language-'],.css-fogea0 code[class*='language-']{text-shadow:none;}}.css-fogea0 pre[class*='language-']{padding:1em;overflow:auto;margin:0;}.css-fogea0:not(pre)>code[class*='language-']{padding:0.1em 0.3em;border-radius:0.3em;color:#c9d1d9;background:#343942;}.css-fogea0 pre[data-line]{position:relative;}.css-fogea0 pre[class*='language-']>code[class*='language-']{position:relative;z-index:1;}.css-fogea0 .line-highlight{position:absolute;left:0;right:0;padding:inherit 0;margin-top:1em;background:#2f2a1e;box-shadow:inset 5px 0 0 #674c16;z-index:0;pointer-events:none;line-height:inherit;white-space:pre;}.css-fogea0 .namespace{opacity:0.7;}.css-fogea0 .token.comment,.css-fogea0 .token.prolog,.css-fogea0 .token.doctype,.css-fogea0 .token.cdata{color:#8b949e;}.css-fogea0 .token.punctuation{color:#c9d1d9;}.css-fogea0 .token.property,.css-fogea0 .token.tag,.css-fogea0 .token.boolean,.css-fogea0 .token.number,.css-fogea0 .token.constant,.css-fogea0 .token.symbol,.css-fogea0 .token.deleted{color:#79c0ff;}.css-fogea0 .token.selector,.css-fogea0 .token.attr-name,.css-fogea0 .token.string,.css-fogea0 .token.char,.css-fogea0 .token.builtin,.css-fogea0 .token.inserted{color:#a5d6ff;}.css-fogea0 .token.operator,.css-fogea0 .token.entity,.css-fogea0 .token.url,.css-fogea0 .language-css .token.string,.css-fogea0 .style .token.string{color:#a5d6ff;}.css-fogea0 .token.atrule,.css-fogea0 .token.attr-value,.css-fogea0 .token.keyword{color:#a5d6ff;}.css-fogea0 .token.function{color:#d2a8ff;}.css-fogea0 .token.regex,.css-fogea0 .token.important,.css-fogea0 .token.variable{color:#a8daff;}.css-fogea0 .token.important,.css-fogea0 .token.bold{font-weight:bold;}.css-fogea0 .token.italic{font-style:italic;}.css-fogea0 .token.entity{cursor:help;}</style><style data-emotion="css 1matud9">.css-1matud9{position:relative;margin:0 auto;padding:0 100px 6vw;min-height:230px;font-size:2rem;line-height:1.6em;background:var(--background-color);border-radius:6px;}@media (max-width: 1170px){.css-1matud9{padding:0 11vw;}}@media (max-width: 800px){.css-1matud9{padding:0 5vw;font-size:1.8rem;}}@media (max-width: 500px){.css-1matud9{padding:0;}}@media (max-width: 500px){.css-1matud9 .post-full-custom-excerpt{font-size:1.9rem;line-height:1.5em;}}.css-1matud9 .no-image{padding-top:0;}.css-1matud9 h1,.css-1matud9 h2,.css-1matud9 h3,.css-1matud9 h4,.css-1matud9 h5,.css-1matud9 h6,.css-1matud9 p,.css-1matud9 ul,.css-1matud9 ol,.css-1matud9 dl,.css-1matud9 pre,.css-1matud9 blockquote,.css-1matud9 .post-full-comments,.css-1matud9 .footnotes{margin:0 0 1.5em 0;min-width:100%;}@media (max-width: 500px){.css-1matud9 p,.css-1matud9 ul,.css-1matud9 ol,.css-1matud9 dl,.css-1matud9 pre,.css-1matud9 .post-full-comments,.css-1matud9 .footnotes{margin-bottom:1.28em;}}.css-1matud9 li{word-break:break-word;}.css-1matud9 li p{margin:0;}.css-1matud9 a{color:#0a84ff;}.css-1matud9 a[class*='image'],.css-1matud9 a[class*='image']:hover{box-shadow:none;}.css-1matud9 a[class*='image'] span[class*='image'],.css-1matud9 a[class*='image']:hover span[class*='image']{border-radius:6px;}.css-1matud9 strong,.css-1matud9 em{color:var(--strong-color);}.css-1matud9 small{display:inline-block;line-height:1.6em;}.css-1matud9 img,.css-1matud9 video{display:block;margin:2em auto;max-width:840px;height:auto;border-radius:6px;border:1px solid var(--image-border-color);}@media (max-width: 1040px){.css-1matud9 img,.css-1matud9 video{width:100%;}}.css-1matud9 img[src$='#full']{max-width:none;width:100vw;}.css-1matud9 img+br+small{display:block;margin-top:-3em;margin-bottom:1.5em;text-align:center;}.css-1matud9 iframe{margin:10px auto 20px;}.css-1matud9 blockquote{margin:0 0 1.5em;padding:0 1.5em;border-left:3px solid var(--image-border-color);}@media (max-width: 500px){.css-1matud9 blockquote{padding:0 1.3em;}}.css-1matud9 blockquote p{margin:0 0 1em 0;color:inherit;font-size:inherit;line-height:inherit;font-style:italic;}.css-1matud9 blockquote p:last-child{margin-bottom:0;}.css-1matud9 code{padding:0 5px 2px;font-size:0.8em;line-height:1em;font-weight:400!important;border-radius:3px;font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,'Noto Sans','Ubuntu','Droid Sans','Helvetica Neue',sans-serif;}.css-1matud9 p code{word-break:keep-all;}.css-1matud9 pre{overflow-x:auto;padding:20px;max-width:100%;color:#e5eff5;font-size:1.4rem;line-height:1.5em;border-radius:5px;}.css-1matud9 pre code{padding:0;font-size:inherit;line-height:inherit;background:transparent;}.css-1matud9 pre code :not(span){color:inherit;}.css-1matud9 .fluid-width-video-wrapper{margin:1.5em 0 3em;}.css-1matud9 hr{margin:2em 0;}.css-1matud9 hr+p{margin-top:1.2em;}.css-1matud9 h1,.css-1matud9 h2,.css-1matud9 h3,.css-1matud9 h4,.css-1matud9 h5,.css-1matud9 h6{color:var(--home-header-color);font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,'Noto Sans','Ubuntu','Droid Sans','Helvetica Neue',sans-serif;}.css-1matud9 h1{margin:0.5em 0 0.4em;font-size:4.2rem;line-height:1.25em;font-weight:600;}.css-1matud9 p+h1{margin-top:0.8em;}@media (max-width: 800px){.css-1matud9 h1{font-size:3.2rem;line-height:1.25em;}}.css-1matud9 h2{margin:0.5em 0 0.4em;font-size:3.2rem;line-height:1.25em;font-weight:600;}.css-1matud9 p+h2{margin-top:0.8em;}@media (max-width: 800px){.css-1matud9 h2{margin-bottom:0.3em;font-size:2.8rem;line-height:1.25em;}}.css-1matud9 h3{margin:0.5em 0 0.2em;font-size:2.5rem;line-height:1.3em;font-weight:600;}.css-1matud9 h2+h3{margin-top:0.7em;}@media (max-width: 800px){.css-1matud9 h3{margin-bottom:0.3em;font-size:2.4rem;line-height:1.3em;}}.css-1matud9 h4{margin:0.5em 0 0.2em;font-size:1.8rem;font-weight:600;}.css-1matud9 h2+h4{margin-top:0.7em;}.css-1matud9 h3+h4{margin-top:0;}@media (max-width: 800px){.css-1matud9 h4{margin-bottom:0.3em;font-size:1.8rem;line-height:1.3em;}}.css-1matud9 h5{display:block;margin:0.5em 0;padding:0.4em 1em 0.9em;border:0;color:#3eb0ef;font-size:3.2rem;line-height:1.35em;text-align:center;}@media (min-width: 1180px){.css-1matud9 h5{max-width:1060px;}}@media (max-width: 800px){.css-1matud9 h5{margin-bottom:1em;margin-left:1.3em;padding:0 0 0.5em;font-size:2.4rem;text-align:initial;}}.css-1matud9 h6{margin:0.5em 0 0.2em 0;font-size:2rem;font-weight:700;}@media (max-width: 800px){.css-1matud9 h6{font-size:1.8rem;line-height:1.4em;}}.css-1matud9 table{display:inline-block;overflow-x:auto;margin:0.5em 0 2.5em;max-width:100%;width:auto;border-spacing:0;border-collapse:collapse;font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,'Noto Sans','Ubuntu','Droid Sans','Helvetica Neue',sans-serif;font-size:1.6rem;white-space:nowrap;vertical-align:top;}.css-1matud9 table{-webkit-overflow-scrolling:touch;background:radial-gradient(
          ellipse at left,
          rgba(0, 0, 0, 0.2) 0%,
          rgba(0, 0, 0, 0) 75%
        ) 0 center,radial-gradient(
          ellipse at right,
          rgba(0, 0, 0, 0.2) 0%,
          rgba(0, 0, 0, 0) 75%
        ) 100% center;background-attachment:scroll,scroll;-webkit-background-size:10px 100%,10px 100%;background-size:10px 100%,10px 100%;background-repeat:no-repeat;}.css-1matud9 table td:first-of-type{background-image:var(--table-first-of-type);-webkit-background-size:20px 100%;background-size:20px 100%;background-repeat:no-repeat;}.css-1matud9 table td:last-child{background-image:var(--table-last-of-type);-webkit-background-position:100% 0;background-position:100% 0;-webkit-background-size:20px 100%;background-size:20px 100%;background-repeat:no-repeat;}.css-1matud9 table th{color:var(--home-header-color);font-size:1.2rem;font-weight:700;letter-spacing:0.2px;text-align:left;text-transform:uppercase;background-color:var(--table-th-background);}.css-1matud9 table th,.css-1matud9 table td{padding:6px 12px;border:var(--table-th-border) 1px solid;}.css-1matud9 figcaption{color:var(--figcaption-color);}.css-1matud9 *:not(pre)>code[class*='language-']{border-radius:0.3em;background:var(--highlight-background);border:1px solid var(--little-code-border);color:var(--main-color);padding:0.15em 0.5em;white-space:normal;font-size:13px;}@media (max-width: 800px){.css-1matud9 *:not(pre)>code[class*='language-']{display:inline;}}.css-1matud9 .gatsby-highlight-code-line{display:block;margin-right:-1.3125rem;margin-left:-1.3125rem;padding-right:1em;padding-left:1.25em;background-color:var(--prism-background);border-left:0.25em solid var(--prism-border-left);font-size:1.4rem;}.css-1matud9 .gatsby-highlight{margin-bottom:1.75rem;margin-left:-1.3125rem;margin-right:-1.3125rem;border-radius:10px;background:var(--highlight-background);box-shadow:inset 0 0 0 1px var(--highlight-border);-webkit-overflow-scrolling:touch;overflow:auto;}.css-1matud9 .gatsby-highlight pre[class*='language-']{float:left;min-width:100%;font-size:1.4rem;line-height:24px;}.css-1matud9 pre[class*='language-'],.css-1matud9 code[class*='language-']{color:var(--pre-code-color);text-shadow:none;font-family:Consolas,Monaco,'Andale Mono','Ubuntu Mono',monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;}.css-1matud9 pre[class*='language-']::-webkit-scrollbar,.css-1matud9 code[class*='language-']::-webkit-scrollbar{background-color:transparent;height:4px;}.css-1matud9 pre[class*='language-']::-webkit-scrollbar-thumb,.css-1matud9 code[class*='language-']::-webkit-scrollbar-thumb{border-radius:8px;background-color:hsla(230, 5%, 35%, 1);}@media (max-width: 800px){.css-1matud9 pre[class*='language-'],.css-1matud9 code[class*='language-']{display:inline-block;}}.css-1matud9 pre[class*='language-']{overflow:auto;}.css-1matud9 .token{font-size:1.4rem;}.css-1matud9 pre[data-line]{padding:1em 0 1em 3em;position:relative;}@media print{.css-1matud9 pre[class*='language-'],.css-1matud9 code[class*='language-']{text-shadow:none;}}.css-1matud9 pre[class*='language-']{padding:1em;overflow:auto;margin:0;}.css-1matud9:not(pre)>code[class*='language-']{padding:0.1em 0.3em;border-radius:0.3em;color:#c9d1d9;background:#343942;}.css-1matud9 pre[data-line]{position:relative;}.css-1matud9 pre[class*='language-']>code[class*='language-']{position:relative;z-index:1;}.css-1matud9 .line-highlight{position:absolute;left:0;right:0;padding:inherit 0;margin-top:1em;background:#2f2a1e;box-shadow:inset 5px 0 0 #674c16;z-index:0;pointer-events:none;line-height:inherit;white-space:pre;}.css-1matud9 .namespace{opacity:0.7;}.css-1matud9 .token.comment,.css-1matud9 .token.prolog,.css-1matud9 .token.doctype,.css-1matud9 .token.cdata{color:#8b949e;}.css-1matud9 .token.punctuation{color:#c9d1d9;}.css-1matud9 .token.property,.css-1matud9 .token.tag,.css-1matud9 .token.boolean,.css-1matud9 .token.number,.css-1matud9 .token.constant,.css-1matud9 .token.symbol,.css-1matud9 .token.deleted{color:#79c0ff;}.css-1matud9 .token.selector,.css-1matud9 .token.attr-name,.css-1matud9 .token.string,.css-1matud9 .token.char,.css-1matud9 .token.builtin,.css-1matud9 .token.inserted{color:#a5d6ff;}.css-1matud9 .token.operator,.css-1matud9 .token.entity,.css-1matud9 .token.url,.css-1matud9 .language-css .token.string,.css-1matud9 .style .token.string{color:#a5d6ff;}.css-1matud9 .token.atrule,.css-1matud9 .token.attr-value,.css-1matud9 .token.keyword{color:#a5d6ff;}.css-1matud9 .token.function{color:#d2a8ff;}.css-1matud9 .token.regex,.css-1matud9 .token.important,.css-1matud9 .token.variable{color:#a8daff;}.css-1matud9 .token.important,.css-1matud9 .token.bold{font-weight:bold;}.css-1matud9 .token.italic{font-style:italic;}.css-1matud9 .token.entity{cursor:help;}</style><section class="post-full-content css-1matud9 e14ijd7g0"><div><p>컴퓨터는 캐시를 활용해 가까운 곳에서 데이터를 전달받거나, 이미 생산된 데이터를 만들기 위해 똑같은 작업을 반복하지 않아도 만들어둔 데이터를 캐시에서 꺼내 쓸 수 있다. 캐시에 저장된 데이터를 사용해 반복 작업으로부터 벗어나면 그만큼 기다려야 하는 시간을 벌 수 있다.</p>
<p>캐시란, <strong>데이터나 값을 미리 복사해 놓는 임시 장소</strong>를 가리킨다. 캐시는 로컬 컴퓨터에도 물리적으로 있고, 네트워크상에도 CDN과 같은 플랫폼에 존재한다. CI 환경에서도 캐시를 지원하고 있고. 또, 캐시라는 단어는 임시 장소를 가리키기도 하지만, 장소에 저장된 데이터 자체를 말하기도 한다.</p>
<p>예전에 Travis CI를 사용해 보면서 가상 환경에서 프로젝트를 빌드하고 서빙하는 과정을 겪어본 적이 있다. CI 환경에서 캐시란, 주로 프로젝트에 필요한 의존성 파일을 캐시에 저장 후, 빌드할 때 꺼내쓰는 것을 말한다. 이번에 GitHub Actions로 CI 환경을 만들어 보면서, 캐시 설정 중 <code class="language-text">restore-keys</code> 라는 옵션이 있는데, 이 옵션이 존재하는 이유가 궁금했다.</p>
<p>캐시에서 가장 중요하게 생각되는 부분은 무효화(invalidate)다. 캐시 무효화가 되지 않아 개인정보가 노출되는 사건이 있을 수 있고, 배포가 제대로 반영되지 않는 현상도 있을 수 있기 때문이다. <code class="language-text">restore-keys</code> 는 복원 키라고도 말하는데, 의존성 파일이 변경되었음에도 불구하고 restore-keys 옵션을 통해 기존 캐시를 불러오는 기능이다. 그렇다면, restore-keys를 사용하면, 무효화 되지 않은 캐시를 가져오게 되는 것일까?</p>
<p>이번 글은, GitHub Actions에서 의존성과 관련된 캐시를 어떻게 다루고 있  고, 이를 어떻게 더 성능이 좋게 관리할 수 있는지에 대한 이야기다. 패키지 매니저는 npm을 기준으로 설명한다. GitHub Actions의 기본적인 문법은 자세하게 이야기하지 않는다.</p>
<hr/>
<h2 id="알아야-할-배경" style="position:relative">알아야 할 배경<a href="#%EC%95%8C%EC%95%84%EC%95%BC-%ED%95%A0-%EB%B0%B0%EA%B2%BD" aria-label="알아야 할 배경 permalink" class="auto-link after"><svg viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a></h2>
<p>우선 GitHub Actions에서 돌아가는 워크플로우(Workflow)는 가상 환경임을 알아야 한다. 이 환경을 러너(Runner)라고 한다. 러너는 몇 가지 OS를 선택할 수 있으며 주로 CI 환경에 적합한 것은 Linux다. GitHub Actions는 yml 파일로 이루어진 명령어 조합으로 동작하며, 워크플로우 안에 있는 Job(작업) 단위로 러너가 각각 만들어지고, 각 러너에서 새롭게 시작한다. 따라서, 의존성 파일은 Job 별로 새로 만들어져야 한다.</p>
<p>npm 패키지 설치 시 생성되는 <strong>npm 캐시</strong>는 Linux 기준으로 <code class="language-text">~/.npm</code> 디렉토리에 전역으로 존재하며, GitHub Actions의 캐시와는 다른 npm 만의 캐시다. 이 캐시는 <code class="language-text">npm install, npm ci</code> 등의 명령어로 패키지를 설치 할 때 속도를 더 빠르게 해준다. 이 npm 캐시 자체를 GitHub Actions 환경의 캐시로도 저장할 수 있다.</p>
<br/>
<h2 id="GitHub-Actions-Cache" style="position:relative">GitHub Actions Cache<a href="#GitHub-Actions-Cache" aria-label="GitHub Actions Cache permalink" class="auto-link after"><svg viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a></h2>
<p>GitHub Actions에서 캐시를 사용하려면, GitHub에서 만들어 둔 <a href="actions/cache">actions/cache</a> 액션을 사용하면 간편하게 사용할 수 있다.</p>
<div class="gatsby-highlight" data-language="yml"><pre class="language-yml"><code class="language-yml"><span class="token key atrule">steps</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> <span class="token key atrule">uses</span><span class="token punctuation">:</span> actions/cache@v3
    <span class="token key atrule">with</span><span class="token punctuation">:</span>
      <span class="token key atrule">path</span><span class="token punctuation">:</span> ~/.something
      <span class="token key atrule">key</span><span class="token punctuation">:</span> something</code></pre></div>
<p>steps에서 <code class="language-text">uses</code> 키워드를 사용해 액션을 가져오고, 액션에 필요한 인자를 <code class="language-text">with</code> 키워드로 넘겨줄 수 있다.</p>
<p>npm의 <code class="language-text">node_modules</code> 의존성 파일을 캐시 해두고 CI 환경에서 다시 설치하지 않고 빠르게 사용하는 것이 GitHub Actions 캐시 사용의 목적이다. 이 캐시는 저장될 때, key가 생성되고, 다시 Github Actions가 동작하면 이전 워크플로우가 돌 때 설치되었던 node_modules가 캐시가 되어있다면 그것을 사용한다. 따라서 key는 매우 중요한 역할이라고 볼 수 있다.</p>
<br/>
<h2 id="캐시-적 용" style="position:relative">캐시 적용<a href="#%EC%BA%90%EC%8B%9C-%EC%A0%81%EC%9A%A9" aria-label="캐시 적용 permalink" class="auto-link after"><svg viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a></h2>
<p>우선에는 테스트하고자 하는 디렉토리에서 CRA를 사용해 react를 설치하고 <code class="language-text">.github/workflow</code> 디렉토리에 <code class="language-text">cache-test.yml</code> 파일을 생성했다.</p>
<ul>
<li>local 파일에 react 패키지 설치</li>
<li>캐싱 경로는 <code class="language-text">~/.npm</code></li>
<li>key는 <code class="language-text">package-lock.json</code> 파일 기준으로 생성</li>
<li>npm ci 설치</li>
<li>build</li>
</ul>
<div class="gatsby-highlight" data-language="yaml"><pre class="language-yaml"><code class="language-yaml"><span class="token key atrule">name</span><span class="token punctuation">:</span> Cache Test
<span class="token key atrule">on</span><span class="token punctuation">:</span> push
<span class="token key atrule">jobs</span><span class="token punctuation">:</span>
  <span class="token key atrule">cache</span><span class="token punctuation">:</span>
    <span class="token key atrule">runs-on</span><span class="token punctuation">:</span> ubuntu<span class="token punctuation">-</span>latest
    <span class="token key atrule">steps</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token key atrule">uses</span><span class="token punctuation">:</span> actions/checkout@v3 <span class="token comment"># repository에서 소스 파일을 러너의 디렉토리에 가져  온다.</span>
      <span class="token punctuation">-</span> <span class="token key atrule">uses</span><span class="token punctuation">:</span> actions/setup<span class="token punctuation">-</span>node@v3 <span class="token comment"># 버전에 맞게 node.js 설치</span>
        <span class="token key atrule">with</span><span class="token punctuation">:</span>
          <span class="token key atrule">node-version-file</span><span class="token punctuation">:</span> <span class="token string">&#x27;.nvmrc&#x27;</span> <span class="token comment"># .nvmrc 파일을 기준으로 삼는다.</span>
          <span class="token key atrule">cache</span><span class="token punctuation">:</span> npm
      <span class="token punctuation">-</span> <span class="token key atrule">uses</span><span class="token punctuation">:</span> actions/cache@v3
        <span class="token key atrule">with</span><span class="token punctuation">:</span> <span class="token comment"># actions/cache에 넘겨줄 변수 사용 키워드</span>
          <span class="token key atrule">path</span><span class="token punctuation">:</span> ~/.npm <span class="token comment"># 경로에 있는 파일이 캐시가 된다</span>
          <span class="token key atrule">key</span><span class="token punctuation">:</span> $<span class="token punctuation">{</span><span class="token punctuation">{</span> runner.os <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">-</span>node<span class="token punctuation">-</span>$<span class="token punctuation">{</span><span class="token punctuation">{</span> hashFiles(&#x27;<span class="token important">**/package-lock.json&#x27;)</span> <span class="token punctuation">}</span><span class="token punctuation">}</span> <span class="token comment"># 캐시 키 이름</span>
      <span class="token punctuation">-</span> <span class="token key atrule">run</span><span class="token punctuation">:</span> npm ci <span class="token comment"># node clean install</span>
      <span class="token punctuation">-</span> <span class="token key atrule">run</span><span class="token punctuation">:</span> npm run build</code></pre></div>
<p>actions/cache 액션에서 알아야 할 키워드는 <code class="language-text">path</code> 다. <a href="https://docs.github.com/en/actions/using-workflows/caching-dependencies-to-speed-up-workflows#example-using-the-cache-action" target="_blank" rel="nofollow">GitHub Actions의 공식 문서</a>에서는 위 코드와 같이 <code class="language-text">path: ~/.npm</code> 이라고 예시에 명시되어 있다. 이 의미가 처음에는 node.js의 의존성인 node_modules 디렉토리가, 러너의 <code class="language-text">~/.npm</code> 경로에 캐싱이 되는 줄 알았다. 하지만 그렇지 않다. <strong>path에 명시되어 있는 경로에 있는 파일</strong>이 캐싱이 되고, 캐싱된 파일을 재사용할 경우 path에 명시되어 있는 경로에 다시 옮겨져 실행된다.</p>
<p>그도 그럴 것이 사용하는 도구가 npm이기 때문에 node_modules를 알고 있는 것이지, java 개발자가 gradle 같은 빌드 툴을 이용한다면 node_modules와는 상관없을 것이기 때문에 당연한 것이다.</p>
<p>어쨌든, node_modules 자체가 캐싱이 되는 것이 아닌, path에 명시한 경로에 해당하는 파일이 캐시에 저장된다는 사실을 기억하자.</p>
<p><span class="gatsby-resp-image-wrapper" style="position:relative;display:block;margin-left:auto;margin-right:auto;max-width:2000px">
      <span class="gatsby-resp-image-background-image" style="padding-bottom:32.800000000000004%;position:relative;bottom:0;left:0;background-image:url(&#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAABYlAAAWJQFJUiTwAAABEElEQVQoz23K107DQBRF0esk4zZ2priMC46jFCTg/79vo9gGEeBhaZ+HI9P1nenyxun2gW0nCt9TVj2l79e99T+Pn6mHVdXjw4ScfcO1arjVLbP1jEXJVBpOxnG2ntm4lXU/tufiPK0ukUPGTuWLvcoRU3ryrETtk0V8SBeJykhUvvW3nDTOUYcUiWJklywNaYbUwxnXvmCbEW1bEu0W8R/2j8cvLTbacbQNMpzuDPMr43yn7k5o06JNs3XdhQ0UtnuibXiSm0DhOiTSgV05siuGpZHukCwgelwlFaKOSGwRZbcaJHFE3yxR6hFVIHM7cO5emB/CyOAaOlvTu4ZgqrVHR2e++KWZSpF9QrRZd8onO+akRf79qwkAAAAASUVORK5CYII=&#x27;);background-size:cover;display:block"></span>
  <img class="gatsby-resp-image-image" alt="first-github-action-result" title="first-github-action-result" src="/static/2d1a39a608748c3d95792ef732398e84/f97d7/first-github-action-result.png" srcSet="/static/2d1a39a608748c3d95792ef732398e84/0eb09/first-github-action-result.png 500w /static/2d1a39a608748c3d95792ef732398e84/1263b/first-github-action-result.png 1000w /static/2d1a39a608748c3d95792ef732398e84/f97d7/first-github-action-result.png 2000w /static/2d1a39a608748c3d95792ef732398e84/e058c/first-github-action-result.png 2166w" sizes="(max-width: 2000px) 100vw, 2000px" style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0" loading="lazy" decoding="async"/>
    </span></p>
<p>의존성 설치에 16s가 소요 되었다. Post cache actions step은, GitHub Actions의 step이 종료되면 <code class="language-text">actions/cache</code> 패키지가 워크플로우를 종료하면서 추가로 마무리하는 action이다. 이 step에서, 캐시가 저장되었음을 캐시 key와 함께 알려주고 있다. 그러면 캐시가 실제로 GitHub에 저장되어 있는지 확인해 보자. GitHub Repository의 Actions -&gt; Caches 탭을 통해 캐시 저장소로 들어가 본다.</p>
<p><span class="gatsby-resp-image-wrapper" style="position:relative;display:block;margin-left:auto;margin-right:auto;max-width:830px">
      <span class="gatsby-resp-image-background-image" style="padding-bottom:85.6%;position:relative;bottom:0;left:0;background-image:url(&#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAARCAYAAADdRIy+AAAACXBIWXMAABYlAAAWJQFJUiTwAAACqElEQVQ4y42T61PTQBTFM44CTdu832lImldftJQ+oFRAURnQUb+o//+f8nN22wjjIOOHM5u9u/fsuefeKG+Ouuh2QFYMOVR1Wh0LwwlJ8wGa6SHONcvHj1LitCTJKsK0wmy1GVk2RZSwGp9w2i/IVBXloKXT1h2CXp+jjsmBqtMxXKKkQDN9Xh91ZdywA5wgIUxyrOAYQ9U49102xwm3g5qPVUmhaSiHksTg1UGHo65N2/BoaQ4HbVOuYi9jXVueH3as3T3Tx/cifNvHMV1c06Vreig3n77w8P0n999+kJZjVN2lawV0BExfkg2nKy5v7lhdvufqw2dO11eYXo/Drk2vGLG9vWd+cc32/R1KnFUESUGc1ZLgjWr8UdXAi/skxYg4G9DrD4nSCs0O6ZiezC3Hc8rRnKw6QfHLFfP1htlqy/nVLcvLG6Kswuv18ZNcwo0z7PAYJ0px9uuO0KdrhdJTO0ylaiUsl4xnCyZnF0wXG04WG8K0lEmCSEAoFA88RUOo2ZG0qKlG6ZjuH3YBEdy9vPPwJYg7uhMxW27ZXH/i6vYBxfQSqayenDE6XWMHx9LHpuPCp789bZuPjxpuTJpPyOsZxfAURQQqYep4TlpN5LcoW+ybLj+nrr0nFKXrUYTuR9hBuiMshjOJfn1CVk3kt+jkv8iah6SPmo//rqR+u+DL118oosTx/Jx8MJVlT5eX0oJefyAHu0l+Do1CMbtulNGvp6IpuwQRbC4K3/63KVLlPl/8XYrmxKTlRA5sko+wwhT1hVKflixmUJA6YSaHfnFxjTL0AlZZziovWZc1syDEMlxUmej9s9ynhGJS8uGMD/ffUc7CkPN6xHY653qxZhn38AyH1p7wZYWPHspuOzGKYbjEhk0koFt45l6dVOH/F+FTv38D1Hm4h/MiwowAAAAASUVORK5CYII=&#x27;);background-size:cover;display:block"></span>
  <img class="gatsby-resp-image-image" alt="github-actions-tab" title="github-actions-tab" src="/static/d03fedc6626c277b814e953996be2b7a/026af/github-actions-tab.png" srcSet="/static/d03fedc6626c277b814e953996be2b7a/0eb09/github-actions-tab.png 500w /static/d03fedc6626c277b814e953996be2b7a/026af/github-actions-tab.png 830w" sizes="(max-width: 830px) 100vw, 830px" style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0" loading="lazy" decoding="async"/>
    </span></p>
<p>그러면 방금 설치한 의존성 파일이 캐시 된 것을 확인할 수 있다.</p>
<p><span class="gatsby-resp-image-wrapper" style="position:relative;display:block;margin-left:auto;margin-right:auto;max-width:2000px">
      <span class="gatsby-resp-image-background-image" style="padding-bottom:16.799999999999997%;position:relative;bottom:0;left:0;background-image:url(&#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAYAAACTWi8uAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAh0lEQVQI132OywrCMBBFszeWpLF5mQchsdLiQrpx5f9/1pVMRRDBxeHOzOLOYT7PcKlB6oDRpL8o+8ZlKJtxokwwoRKTL2BtvWN7PFHmG0K5IrcVqS5f9FtuC6SO4CqASwMuLWUX6fR5UA7MxIrd8kIfPhY/RAzK74VCU8FBaIjpTPT9ODq8ACoMTgQPRf4IAAAAAElFTkSuQmCC&#x27;);background-size:cover;display:block"></span>
  <img class="gatsby-resp-image-image" alt="cache-ui" title="cache-ui" src="/static/8d35330702837546ad6fdbd0d57f6504/f97d7/cache-ui.png" srcSet="/static/8d35330702837546ad6fdbd0d57f6504/0eb09/cache-ui.png 500w /static/8d35330702837546ad6fdbd0d57f6504/1263b/cache-ui.png 1000w /static/8d35330702837546ad6fdbd0d57f6504/f97d7/cache-ui.png 2000w /static/8d35330702837546ad6fdbd0d57f6504/d5be6/cache-ui.png 2242w" sizes="(max-width: 2000px) 100vw, 2000px" style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0" loading="lazy" decoding="async"/>
    </span></p>
<p>workflow에서 생성된 캐시 key와 동일한 네이밍을 가지고 있는 것을 볼 수 있다. 그리고 오른쪽에 휴지통 아이콘이  있는 것으로 봤을 때 직접 UI에서 캐시를 삭제해 줄 수 있다는 것을 알 수 있다. (물론 CLI로 삭제도 가능하다)</p>
<p>이번에는 저장된 캐시가 잘 동작하는지 보기 위해 <code class="language-text">src</code> 파일 내부의 소스 코드를 하나 수정하고 push 한다. yml 파일은 수정하지 않았다.</p>
<p><span class="gatsby-resp-image-wrapper" style="position:relative;display:block;margin-left:auto;margin-right:auto;max-width:2000px">
      <span class="gatsby-resp-image-background-image" style="padding-bottom:46.4%;position:relative;bottom:0;left:0;background-image:url(&#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAABYlAAAWJQFJUiTwAAABTklEQVQoz5WS267bIBBFie2Yi8EYg93EcW7qUVr1//9vVeAk5+EcVerD0oYxsz0zIHw8cro9WC4frLdf5L3pE52fvvCK22H+Qo7nXCFqhTQDnU8oG9grV2ike68/6anbDlFLct637BpNIy1+PBDSggszpo/FoNWeVvdvpPHl7K5W5LzvKIbSjqXcYTrhxgPKRWrpaJRDNAaxaxGV3CiV6DfFJJs9fyKqRjMMC2H6SUg30uFBHy50fTa/48IV6890dqazE8ZEtPJ0JlLrRG0StY5FhQyIPJNzSFzCxDpETn5kcUPR85BYfSzx1QfWPmyav7meqlFbdQWFbjUiz8b4xN54dnuDqNrPAb/arP5xCW8ks+4Q8ceZ68cfluuD9f6babnR5Wfwn5j8bKY1t2w5DpF7nLmMqbS7OM/R+qKnZ4ubbrxi63M8+ezReZS0/AWJTM79oiVlRAAAAABJRU5ErkJggg==&#x27;);background-size:cover;display:block"></span>
  <img class="gatsby-resp-image-image" alt="apply-cache" title="apply-cache" src="/static/61b44358d59a1293160eddc6d0831f5c/f97d7/apply-cache.png" srcSet="/static/61b44358d59a1293160eddc6d0831f5c/0eb09/apply-cache.png 500w /static/61b44358d59a1293160eddc6d0831f5c/1263b/apply-cache.png 1000w /static/61b44358d59a1293160eddc6d0831f5c/f97d7/apply-cache.png 2000w /static/61b44358d59a1293160eddc6d0831f5c/5f4ca/apply-cache.png 2178w" sizes="(max-width: 2000px) 100vw, 2000px" style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0" loading="lazy" decoding="async"/>
    </span></p>
<p>상단의 Run actions/cache@v3에 따르면 캐시가 정상적으로 복원되었다고 명시되어 있다. 이유는, 첫 번째 GitHub Actions가 동작 할 때 만들어 둔 캐시가 있기 때문이고, 그를 복원시켰기 때문이다.</p>
<p>하지만 캐시가 존재하지만, 다시 <code class="language-text">Run npm ci</code> step이 실행되었다. 총 17s가 소요되었다. 캐시를 적용하든 하지 않든 거의 동일한 결과라고 볼 수 있다. 이유는 캐시가 있다고 해도 <code class="language-text">run</code> 명령어가 조건 없이 실행되도록 yml 파일에 설정되어 있기 때문이다. 그러면, 조건에 따라 npm ci를 건너뛰어도 되지 않을까? 그러면, step에 <code class="language-text">if</code>를 사용해 캐시가 존재하면 패키지를 설치하지 않도록 해보자.</p>
<div class="gatsby-highlight" data-language="yml"><pre class="language-yml"><code class="language-yml"><span class="token punctuation">-</span> <span class="token key atrule">uses</span><span class="token punctuation">:</span> actions/cache@v3
  <span class="token key atrule">id</span><span class="token punctuation">:</span> npm<span class="token punctuation">-</span>cache
  <span class="token key atrule">with</span><span class="token punctuation">:</span>
    <span class="token key atrule">path</span><span class="token punctuation">:</span> ~/.npm
    <span class="token key atrule">key</span><span class="token punctuation">:</span> $<span class="token punctuation">{</span><span class="token punctuation">{</span> runner.os <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">-</span>node<span class="token punctuation">-</span>$<span class="token punctuation">{</span><span class="token punctuation">{</span> hashFiles(&#x27;<span class="token important">**/package-lock.json&#x27;)</span> <span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">-</span> <span class="token key atrule">if</span><span class="token punctuation">:</span> $<span class="token punctuation">{</span><span class="token punctuation">{</span> steps.npm<span class="token punctuation">-</span>cache.outputs.cache<span class="token punctuation">-</span>hit <span class="token tag">!=</span> &#x27;true&#x27; <span class="token punctuation">}</span><span class="token punctuation">}</span>
  <span class="token key atrule">run</span><span class="token punctuation">:</span> npm ci
<span class="token punctuation">-</span> <span class="token key atrule">run</span><span class="token punctuation">:</span> npm run build</code></pre></div>
<p>if 문을 사용하기 위해 9번째 라인에는 <code class="language-text">id</code>를 명시 해주었다. id는 if 문에 <code class="language-text">steps.npm-cache</code>로 사용되며, step의 결과물로 cache-hit를 얻기 위해 사용되었다.</p>
<p>그리고, if 문으로 <code class="language-text">cache-hit</code> 이 false일 경우에만, <code class="language-text">npm ci</code>를 실행하도록 변경했다.</p>
<p><span class="gatsby-resp-image-wrapper" style="position:relative;display:block;margin-left:auto;margin-right:auto;max-width:2000px">
      <span class="gatsby-resp-image-background-image" style="padding-bottom:26.400000000000002%;position:relative;bottom:0;left:0;background-image:url(&#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAlElEQVQY053PQQ6CMBSE4QpoaV+hr0CLiUoMifH+J/wNXEBx8WUWM5sx3gr3mLh1Eec6TOMwdXtcZanOgsmp8F5W1ueLcl3wMRO0ENJMl+Y9v9l3WhjmB6a+CK4b8VqQmGklcfGRxgZqG/b81bY3p8ZhfUT6EYkTVnQv/7q9aa0wBWXoBwbNJM1oP9IHRdqAs4I/4ANaVG/OSZF/ggAAAABJRU5ErkJggg==&#x27;);background-size:cover;display:block"></span>
  <img class="gatsby-resp-image-image" alt="fail-workflow" title="fail-workflow" src="/static/05e2001fb46dc9e34908648bf8ad90b0/f97d7/fail-workflow.png" srcSet="/static/05e2001fb46dc9e34908648bf8ad90b0/0eb09/fail-workflow.png 500w /static/05e2001fb46dc9e34908648bf8ad90b0/1263b/fail-workflow.png 1000w /static/05e2001fb46dc9e34908648bf8ad90b0/f97d7/fail-workflow.png 2000w /static/05e2001fb46dc9e34908648bf8ad90b0/38915/fail-workflow.png 2182w" sizes="(max-width: 2000px) 100vw, 2000px" style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0" loading="lazy" decoding="async"/>
    </span></p>
<p>워크플로우가 실패했다. 패키지를 설치하지 않도록 if 문을 사용한 부분은 의도대로 되었지만, build 부분에서 실패한 것이다. 이유는, <code class="language-text">node_modules</code>가 없기 때문이다. GitHub Actions 러너는 Job이 실행될 때마다 새로운 러너 환경을 가진다. 즉, 컴퓨터가 새롭게 세팅되는 것이다.</p>
<p>위에서 살펴봤던 <code class="language-text">path</code> 옵션을 떠올려 보자. <code class="language-text">path</code> 옵션은, node_modules가 저장될 경로를 명시하는 것이 아니라, 캐시 할 파일의 경로를 주는 옵션이다. 지금 path는 <code class="language-text">~/.npm</code> 이다. <code class="language-text">~/.npm</code> 경로에는 무엇이 있을까?</p>
<br/>
<h2 id="npm" style="position:relative">~/.npm<a href="#npm" aria-label="npm permalink" class="auto-link after"><svg viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a></h2>
<p>로컬 컴퓨터의 <code class="language-text">~/.npm</code> 디렉토리에 들어가보았다.</p>
<p><span class="gatsby-resp-image-wrapper" style="position:relative;display:block;margin-left:auto;margin-right:auto;max-width:1280px">
      <span class="gatsby-resp-image-background-image" style="padding-bottom:34.800000000000004%;position:relative;bottom:0;left:0;background-image:url(&#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAABYlAAAWJQFJUiTwAAABbklEQVQoz0WQyXLiQBBE9TVetDAgodaC1taOkAAJA7bn4PBhDvP/9zdB47EPGVkRGfWisrRlVGIEBY/mmidLoC88dMvnwRA8WS7Pi5sExsrj+ZatYnQnx1hLTLfAEoVyU9ylhWmF7acKZtk+lh3waN2XFWDpY6589GWAYSdfy+U3yBI/sNusNbsjWbVjKRK8KGc/X/DjirwecIKMvO4Js5aoPJB3L4TtGfn7L6KaMJwc6wt+c/MOnEjLHY6f4Uclh9OVWDYU7R4vklT9kaydFawersS7V5LTJ6Yrv0E/KtDSslcX/VrHrERC2Y0ESUEsO9abiqSeCIs9cT2RdzOb7QXRXVmEraqsO1L98/9ftU3WqMtsL8INM7rxRJA2ZM0RJ+rYFAdV9waW3QtJe2J7/iQfXonrWWUqb2Z8OaLJZiQtt9hegtiUHC4fxNVEPb7hZQNFf0Zu76qGK/Xpg+7tD/n+HZH0BHLETXsFs/yKf/+58mBeiBUcAAAAAElFTkSuQmCC&#x27;);background-size:cover;display:block"></span>
  <img class="gatsby-resp-image-image" alt="npm-path" title="npm-path" src="/static/6163f2c8829ea6b7d7f0afa2e7d3acf6/bbbf7/npm-path.png" srcSet="/static/6163f2c8829ea6b7d7f0afa2e7d3acf6/0eb09/npm-path.png 500w /static/6163f2c8829ea6b7d7f0afa2e7d3acf6/1263b/npm-path.png 1000w /static/6163f2c8829ea6b7d7f0afa2e7d3acf6/bbbf7/npm-path.png 1280w" sizes="(max-width: 1280px) 100vw, 1280px" style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0" loading="lazy" decoding="async"/>
    </span></p>
<p><a href="https://docs.npmjs.com/cli/v9/commands/npm-cache" target="_blank" rel="nofollow">npm-cache</a>에 설명 되어 있듯, <code class="language-text">~/.npm</code> 에는 npm 자체에서 사용하는 캐시 파일이 들어있다. 이는 <code class="language-text">npm install</code> 혹은 <code class="language-text">npm ci</code> 명령어를 사용해 패키지를 설치할 때 사용할 캐시 된 파일이 들어있는 곳이다. npm 패키지를 설치할 때 해당 경로에 있는 캐시를 가져와 설치를 돕는다. 단, <code class="language-text">~/.npm</code> 경로는 OS 별로 저장 경로가 다르다.</p>
<p>그러면 GitHub Actions의 공식 문서에서 권장하는 것처럼 <code class="language-text">key: ${{ runner.os }}</code> 부분에 <code class="language-text">runner.os</code> 가 명시되어 있는 이유도, 러너를 다른 환경에서 돌리게 된다면 key가 무효 화 되어야 하기 때문임을 알 수 있다. <a href="https://github.com/actions/cache/blob/main/examples.md#node---npm" target="_blank" rel="nofollow">참고</a></p>
<p>결론적으로 <code class="language-text">~/.npm</code> 경로에는 node_modules가 존재하는 것이 아니라 패키지 설치 시 더 빠르게 도와주는 npm의 캐시 된 파일이 캐시되어 있었다. <a href="https://docs.github.com/en/actions/using-workflows/caching-dependencies-to-speed-up-workflows#example-using-the-cache-action" target="_blank" rel="nofollow">공식 문서</a>에서도 아래 코드와 같이 예제가 존재한다.</p>
<div class="gatsby-highlight" data-language="yml"><pre class="language-yml"><code class="language-yml"><span class="token punctuation">-</span> <span class="token key atrule">if</span><span class="token punctuation">:</span> $<span class="token punctuation">{</span><span class="token punctuation">{</span> steps.cache<span class="token punctuation">-</span>npm.outputs.cache<span class="token punctuation">-</span>hit <span class="token tag">!=</span> &#x27;true&#x27; <span class="token punctuation">}</span><span class="token punctuation">}</span>
  <span class="token key atrule">name</span><span class="token punctuation">:</span> List the state of node modules
  <span class="token key atrule">continue-on-error</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
  <span class="token key atrule">run</span><span class="token punctuation">:</span> npm list

<span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Install dependencies
  <span class="token key atrule">run</span><span class="token punctuation">:</span> npm install

<span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Build
  <span class="token key atrule">run</span><span class="token punctuation">:</span> npm run build</code></pre></div>
<p><code class="language-text">npm install</code> 명령어는 캐시 히트와 상관 없이 실행된다. 새롭게 node_modules가 존재해야만 build를 할 수 있기 때문이다.</p>
<p>캐시를 적용하기 위해 다시 if 문을 제거하고 반드시 패키지를 설치하도록 해봤다. 정상적으로 빌드까지 완료되었다. 하지만, 패키지를 설치하는 과정이 포함되어 있기 때문에 캐시를 사용하지 않고 워크플로우를 사용하는 시간과 거의 동일한 시간이 걸리는 것을 볼 수 있다. 따라서 캐시를 사용하는 이유가 없어 보인다.</p>
<p>그러면, path에 명시된 <code class="language-text">~/.npm</code> 파일 말고, <code class="language-text">node_modules</code> 자체를 캐시 하면 어떨까? Gtihub Actions에 cache 탭에 들어가서 휴지통 아이콘을 클릭하고 캐시를 지웠다. 그리고 아래와 같이 yml 파일을 수정하고 적용했다.</p>
<div class="gatsby-highlight" data-language="yml"><pre class="language-yml"><code class="language-yml"><span class="token punctuation">-</span> <span class="token key atrule">uses</span><span class="token punctuation">:</span> actions/cache@v3
  <span class="token key atrule">id</span><span class="token punctuation">:</span> npm<span class="token punctuation">-</span>cache
  <span class="token key atrule">with</span><span class="token punctuation">:</span>
    <span class="token key atrule">path</span><span class="token punctuation">:</span> <span class="token string">&#x27;**/node_modules&#x27;</span>
    <span class="token key atrule">key</span><span class="token punctuation">:</span> $<span class="token punctuation">{</span><span class="token punctuation">{</span> runner.os <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">-</span>node<span class="token punctuation">-</span>$<span class="token punctuation">{</span><span class="token punctuation">{</span> hashFiles(&#x27;<span class="token important">**/package-lock.json&#x27;)</span> <span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">-</span> <span class="token key atrule">if</span><span class="token punctuation">:</span> $<span class="token punctuation">{</span><span class="token punctuation">{</span> steps.npm<span class="token punctuation">-</span>cache.outputs.cache<span class="token punctuation">-</span>hit <span class="token tag">!=</span> &#x27;true&#x27; <span class="token punctuation">}</span><span class="token punctuation">}</span>
  <span class="token key atrule">run</span><span class="token punctuation">:</span> npm ci
<span class="token punctuation">-</span> <span class="token key atrule">run</span><span class="token punctuation">:</span> npm run build</code></pre></div>
<p><code class="language-text">path</code>를 node_modules로 변경했고, if 문을 추가 했다. push 해서 캐시를 만들고, 한 번 더 push해서 캐시가 잘 사용되는지 확인했다. 즉, node_modules가 복원되어 설치 하지 않는지 확인하기 위해 src 아래의 코드를 수정하고 push를 한 번 더 했다.</p>
<p><span class="gatsby-resp-image-wrapper" style="position:relative;display:block;margin-left:auto;margin-right:auto;max-width:2000px">
      <span class="gatsby-resp-image-background-image" style="padding-bottom:46.6%;position:relative;bottom:0;left:0;background-image:url(&#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAABYlAAAWJQFJUiTwAAABQklEQVQoz42S227CMBBEDQmJ73cScmkKglJUqar6/x83lR0aqsIDD8e7Wo1XY42JjT2G1zP66YRxf4b2O3AdIcz2jt+5tM0daW5CB0IKippbCBMzTHqUtcps6H80ikqAFDXSvYesSo6yljBhB78dYEMHrkJeUDGDiumFmpusXRUUq5I9hKSjlh4m9hnpWlDpUVCFkiqQLKpA1vVMdsKupMU3d3nhesNh3QC3PcHFPeLuHdpNEGaE8gdIO0GaEUK2Gc4DGDW5FjzOsLkS6pJDil47DDai0w6dcmiFRqcseuPzrNcenTILvbbohLy5vsKS25SOa0aktFMo6blMhafhV1K/Dw1IN53w9vGNw/kTx8sXxsMFvp0Q2inXZ5i1L2jGI8i6EmDKQ9r0z8KSbPoiqa+FBRVuqVTYP73LmqTdMI2Uxw+ewtDhMv0BUAAAAABJRU5ErkJggg==&#x27;);background-size:cover;display:block"></span>
  <img class="gatsby-resp-image-image" alt="not-execute-ci" title="not-execute-ci" src="/static/29de0aeb143b0105140392eb90c61a4d/f97d7/not-execute-ci.png" srcSet="/static/29de0aeb143b0105140392eb90c61a4d/0eb09/not-execute-ci.png 500w /static/29de0aeb143b0105140392eb90c61a4d/1263b/not-execute-ci.png 1000w /static/29de0aeb143b0105140392eb90c61a4d/f97d7/not-execute-ci.png 2000w /static/29de0aeb143b0105140392eb90c61a4d/9a26f/not-execute-ci.png 2176w" sizes="(max-width: 2000px) 100vw, 2000px" style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0" loading="lazy" decoding="async"/>
    </span></p>
<p>정상적으로 <code class="language-text">node_modules</code>가 패키지 내로 들어왔으며 cache-hit이 true가 되면서 npm ci가 실행되지않았다. 캐시 덕분에 시간을 아낄 수 있었다.</p>
<br/>
<h2 id="restore-keys" style="position:relative">restore-keys<a href="#restore-keys" aria-label="restore keys permalink" class="auto-link after"><svg viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a></h2>
<p>드디어 restore-keys 옵션이다. restore-keys 옵션은 기본 키와 일치하는 캐시를 찾을 수 없는 경우, restore-key를 사용해 최근에 생성된 가장 가까운 일치하는 캐시를 다운로드할 수 있다. 이렇게 하면 빌드/설치 단계에서 최신 의존성 몇 개만 추가로 가져오면 되므로 빌드 시간을 절약할 수 있는 기능이다.</p>
<div class="gatsby-highlight" data-language="yml"><pre class="language-yml"><code class="language-yml"><span class="token key atrule">restore-keys</span><span class="token punctuation">:</span> <span class="token punctuation">|</span><span class="token scalar string">
  npm-feature-${{ hashFiles(&#x27;package-lock.json&#x27;) }}
  npm-feature-
  npm-</span></code></pre></div>
<ol>
<li>캐시 미스가 발생하면 restore-keys에 해당하는 캐시를 찾는다. 정확히 일치하는 항목이 있으면 이 작업은 캐시에 있는 파일을 path 디렉터리로 가져온다. 정확히 일치하는 항목이 없으면 작업은 복원 키의 부분 일치 항목을 검색한다.
작업이 부분적으로 일치하는 항목을 찾으면 가장 최근 캐시가 경로 디렉터리에 복원된다.</li>
<li>캐시 작업이 완료되고 작업의 다음 단계가 실행된다.</li>
<li>작업이 완료되면 이 작업은 경로 디렉토리의 내용으로 새 캐시를 자동으로 생성한다.</li>
</ol>
<hr/>
<p>일반적으로 생각할 때 캐시 미스가 발생하면 기존의 캐시는 버리고 새로 의존성을 다운받아 새로운 캐시로 설정하는 것을 생각하기 쉽다. 위에서 작업했던 결과물은 key가 일치하지 않으면 새로운 의존성를 다운받고 다운받은 의존성을 캐시에 저장했다. 이것이 일반적으로 생각하는 캐시 형태다. 그렇다면 restore-keys 속성은 도대체 어떨 때 사용하는 것일까? 테스트해 보자.</p>
<h3 id="캐시-무효화" style="position:relative">캐시 무효화<a href="#%EC%BA%90%EC%8B%9C-%EB%AC%B4%ED%9A%A8%ED%99%94" aria-label="캐시 무효화 permalink" class="auto-link after"><svg viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a></h3>
<p>캐시 무효화는 중요하다. 의존성을 새로 설치하면 캐시에 저장된 기존 의존성을 무시하고 다시 설치해야 한다. <code class="language-text">key</code> 라는 설정으로 이미 캐시 무효화 설정이 되어 있다.</p>
<p>이제, 하나의 모듈을 설치해서 다시 액션을 실행시켜 보자. 나는 <code class="language-text">lodash</code> 패키지를 그냥 하나 설치하고 push 했다.</p>
<p><span class="gatsby-resp-image-wrapper" style="position:relative;display:block;margin-left:auto;margin-right:auto;max-width:2000px">
      <span class="gatsby-resp-image-background-image" style="padding-bottom:75.2%;position:relative;bottom:0;left:0;background-image:url(&#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAABYlAAAWJQFJUiTwAAAB3UlEQVQ4y42T6XabMBCFZWSzCaGFfYnBzknj93/B286ggNPjk/bH5xlhdJlVtOOKef3EvP7Ccn/AVgNK1/2Dnq0m6zfIt80EEecGS93ho+3x3nRYXIVZG1yNw2I9n1dXY3XV7l+t53OnLWRS4BxI0gKiGRYs908M0w3W93DVcFATI/wXzXT49cjvFLZltG3x3vQQQqbIy4rDzXWFvKyZTHtk4ZwWjolzi1SR7/lM/1+yEpdUc4RCJhCncwbje/TzHVX3hnZY0U03pumvbOm5CbVKleXLMlbM+Sll0mJB7Vr4dt5D1yENVdYobLMXnkSzwiPOyh2KjqKkXtAHBP1QeoVp2FLaWeG4DARFRCKMJjGzRSLT11CoX4KK61ch1z6kphFdcogoOQgXSfQVLEjhZqHQJMihPwm8vPj0/JtPgtQ5FlRbFxNlObUkN3ux/xcRXRQXl9ImARI9Xsh/rtffUEbURVNtq0R+Erol4zAa+1ioH5GJ4sx4U+bbA9P64J2uhwXaDdC0n/6wZTVBP+PH71QjXDNDUJgyqxGbGRc9QaoeMm8R5T2iYmQrEgcRG4jY4pRY9slGqUOU+mAdxFltNaShdbSn7Rt/ZZvFYw332dQuzKWDjMM4yYPTnzr+BoIfWD1V3zoXAAAAAElFTkSuQmCC&#x27;);background-size:cover;display:block"></span>
  <img class="gatsby-resp-image-image" alt="not-found-cache" title="not-found-cache" src="/static/6aad3accc0fe45bc3c8beffa0a925b0b/f97d7/not-found-cache.png" srcSet="/static/6aad3accc0fe45bc3c8beffa0a925b0b/0eb09/not-found-cache.png 500w /static/6aad3accc0fe45bc3c8beffa0a925b0b/1263b/not-found-cache.png 1000w /static/6aad3accc0fe45bc3c8beffa0a925b0b/f97d7/not-found-cache.png 2000w /static/6aad3accc0fe45bc3c8beffa0a925b0b/93333/not-found-cache.png 2174w" sizes="(max-width: 2000px) 100vw, 2000px" style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0" loading="lazy" decoding="async"/>
    </span></p>
<p>결과를 보면, 로컬에 있는 package-lock.json이 npm 패키지를 설치하면서 변경되었고, 캐시 key가 변경되었기 때문에 GitHub Actions에서는 캐시 키를 찾을 수 없다는 것을 말해주고 있다. 마찬가지로 GitHub 러너에서 npm 패키지를 새롭게 다운받는다. 총 20s가 소요된 것을 볼 수 있다.</p>
<p>이마저도 조금 더 빠르게 만들 수 없을까? restore-keys 옵션을 사용해 보자.</p>
<h3 id="restore-keys-적용" style="position:relative">restore-keys 적용<a href="#restore-keys-%EC%A0%81%EC%9A%A9" aria-label="restore keys 적용 permalink" class="auto-link after"><svg viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a></h3>
<div class="gatsby-highlight" data-language="yaml"><pre class="language-yaml"><code class="language-yaml"><span class="token punctuation">-</span> <span class="token key atrule">uses</span><span class="token punctuation">:</span> actions/cache@v3
  <span class="token key atrule">id</span><span class="token punctuation">:</span> npm<span class="token punctuation">-</span>cache
  <span class="token key atrule">with</span><span class="token punctuation">:</span>
    <span class="token key atrule">path</span><span class="token punctuation">:</span> <span class="token string">&#x27;**/node_modules&#x27;</span>
    <span class="token key atrule">key</span><span class="token punctuation">:</span> $<span class="token punctuation">{</span><span class="token punctuation">{</span> runner.os <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">-</span>node<span class="token punctuation">-</span>$<span class="token punctuation">{</span><span class="token punctuation">{</span> hashFiles(&#x27;<span class="token important">**/package-lock.json&#x27;)</span> <span class="token punctuation">}</span><span class="token punctuation">}</span>
    <span class="token key atrule">restore-keys</span><span class="token punctuation">:</span> <span class="token punctuation">|</span><span class="token scalar string">
      ${{ runner.os }}-node-
      ${{ runner.os }}</span>
<span class="token punctuation">-</span> <span class="token key atrule">if</span><span class="token punctuation">:</span> $<span class="token punctuation">{</span><span class="token punctuation">{</span> steps.npm<span class="token punctuation">-</span>cache.outputs.cache<span class="token punctuation">-</span>hit <span class="token tag">!=</span> &#x27;true&#x27; <span class="token punctuation">}</span><span class="token punctuation">}</span>
  <span class="token key atrule">run</span><span class="token punctuation">:</span> npm ci</code></pre></div>
<p>restore-keys 옵션은, list 형식으로 여러 prefix를 붙여줄 수 있다. 그러면 prefix 기준으로 단계별로 cache에 저장된 key의 prefix를 포함하는 단어가 있는지 찾고, 이 단어 기준 포함하는 key가 있다면 가장 최근의 해당 캐시를 가져온다.</p>
<p>restore-keys 옵션을 사용하기 위해, key를 새롭게 생성해주어야 하기 때문에 npm 패키지를 아무거나 새로 설치해 준다.</p>
<ul>
<li>emotion npm 패키지 설치</li>
<li>yml 파일에 restore-keys 추가</li>
</ul>
<p><span class="gatsby-resp-image-wrapper" style="position:relative;display:block;margin-left:auto;margin-right:auto;max-width:2000px">
      <span class="gatsby-resp-image-background-image" style="padding-bottom:103.60000000000001%;position:relative;bottom:0;left:0;background-image:url(&#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAVCAYAAABG1c6oAAAACXBIWXMAABYlAAAWJQFJUiTwAAAC9ElEQVQ4y52UW4/bNhCFaVsiKd4pibraa2s3SJDXAEGBti/9/z/qFDNaYw1n04c+fOAF5JkheThiWG44b9+w3r4yvp1h0wCXx98S2gkhT/BP0Lw4Sgsfe+Q8MMZEKOWgtYNWD2jH8ydpIU4NRLVzeELQZDIBb/2ArSt47QecQ8TZR6yEC8ziAjYf8NVZxFoj1BrHSkOcnjjWBpX20DZDmgjZxD3SQUIcFMRRvS/UqE8andTopUaRGtUnWYqTdGhsQjusyGWBTwXaJtTaQzUBR1p4Uow4qYdM7uNHNARl57sVob9wm8YrbF6g/IAmTTjqCFEHCBkhZICoPURtcZABR0XEj1Z6CLoHHxeE7obUXRG7DSYssPEMm29w7ZUxrsD4gsa0aEzmlgOoxOIHClg5iLas+P6y4du84m2Y8VZGvJYRW5nwcxzw91Tw51jw19hz+8dY8M9U8KN0eA0R15hhQsfMqYNwacCwbkhlhTQJ0mYom1GbhMYkWLvjXGasa+F8C+87xNjD2ARlEpRNSD5D0GvGdsIw3/hh+ullZ7ygHc7ophfEboZvJ5jYczDaLN9F6A2quz/poeipU7+wCG2kfjeckcvKfRKlloKGdkTjWnYAiex4Fq112EVJMHYTC7hY4NMAGwvoKmhsQ4+QR/g8sKjxLW9mIfUhTEHI04IG2mU0vmVz0zGovY/34zxidwMf1dMvuftQORjfcUaUDUHGps0f7v/1ix0++ce8lgTplShLyojE9wLw+033IJ8Las/3Qj7aj0k2iHx0CkQB/0v4F8FjbfmSqSjwfSm338//pcxXrNcvmM4bJjJ4N7E1OOsHmifMJ5AbBFkjTxva+QvyeINtV+gwoUkzmrSiiTN0oEKxcJ/naS4tkHGGigsUzy9oQoGgNLUfodMZDZEvqG3ByY6o3ITKTlxJDtJxNSEO0qOWDlFaBHIJWal275W8NrjmDq9th7eu4JZbXHzA2XtcQuD+hSs49SP3iUE3KFJheKeqdh/+Cz4J4AmdqXJhAAAAAElFTkSuQmCC&#x27;);background-size:cover;display:block"></span>
  <img class="gatsby-resp-image-image" alt="restore-test" title="restore-test" src="/static/d2f937ea762d48e1dda730f638431bcc/f97d7/restore-test.png" srcSet="/static/d2f937ea762d48e1dda730f638431bcc/0eb09/restore-test.png 500w /static/d2f937ea762d48e1dda730f638431bcc/1263b/restore-test.png 1000w /static/d2f937ea762d48e1dda730f638431bcc/f97d7/restore-test.png 2000w /static/d2f937ea762d48e1dda730f638431bcc/38915/restore-test.png 2182w" sizes="(max-width: 2000px) 100vw, 2000px" style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0" loading="lazy" decoding="async"/>
    </span></p>
<p>재미있는 현상이 발생한다.</p>
<p><strong>cache action step</strong></p>
<ul>
<li>package-lock.json 파일이 수정되었기 때문에 새로운 key가 생성됨. 따라서 캐시 <strong>미스</strong> 상태.</li>
<li>restore-keys에 따라 기존 GitHub Actions를 통해 생성했던 캐시를 prefix 기준, 가장 최신 캐시를 복원(restore)한다. 즉, node_modules를 복원한다.</li>
</ul>
<p><strong>Run npm ci step</strong></p>
<ul>
<li>패키지를 설치한다. -&gt; package.json.lock 파일이 변경 되었고 새로운 패키지가 설치되어야 하기 때문이다.</li>
<li>25s가 소요 되었다. (생각보다 오래 걸림)</li>
</ul>
<p><strong>Post cache actions step</strong></p>
<ul>
<li>기존 cache size는 42MB로, 이번에 npm 패키지를 추가하면서 43MB로 변경되었다.</li>
<li>새로 만든 key로 캐시를 저장한다.</li>
</ul>
<p>캐시에서 node_modules를 복원했지만, 패키지를 다시 설치하면서 25s가 소요 되었다. 우리가 원한 것은, 캐시에서 node_modules를 가져왔고, <code class="language-text">npm install</code> 명령어로 패키지를 설치하면 빠르게 설치 될 것을 예상했지만, 그렇지 않았다. 이유는 <code class="language-text">npm ci</code> 때문이다.</p>
<h3 id="npm-ci---npm-install" style="position:relative">npm ci -&gt; npm install<a href="#npm-ci---npm-install" aria-label="npm ci   npm install permalink" class="auto-link after"><svg viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a></h3>
<p><a href="https://docs.npmjs.com/cli/v9/commands/npm-ci" target="_blank" rel="nofollow">npm ci</a>는 clean 설치로, <code class="language-text">node_modules</code> 디렉토리를 삭제한 뒤 <code class="language-text">package-lock.json</code> 파일 기준으로 모든 의존성을 새롭게 설치한다. npm 공식 문서에 따르면 npm ci를 사용하는 이유는 2가지다. ( <code class="language-text">npm ci</code>는 Continuous Integration이 아닌, clean install 줄임말임)</p>
<blockquote>
<p><strong>속도</strong></p>
<p><code class="language-text">npm install</code> 명령어와 비슷하지만, npm install 보다 2배 정도 빠르며 이를 통해 CI / CD에서 유용하게 사용된다. 하지만, 공식 문서 예전 버전 <code class="language-text">npm ci</code> 설명에서 속도와 관련한 이야기가 존재했지만, 최근 버전에서는 그 말이 사라졌다. 즉, <code class="language-text">npm install</code> 또한 마찬가지로 <code class="language-text">npm ci</code>에 비해 큰 차이를 보이지는 않는다.</p>
<p><strong>안정성</strong></p>
<p><code class="language-text">npm install</code> 명령은, 시맨틱 버전에 따라 package.json 파일에 명시된 버전 범위에 따라 <a href="https://docs.npmjs.com/downloading-and-installing-packages-locally#installing-an-unscoped-package" target="_blank" rel="nofollow">다른 버전이 설치</a>된다. 물론 버저닝 기호에 따라 큰 범위를 벗어나지는 않지만, 레지스트리에 업로드된 npm 패키지가 업데이트 된 경우 GitHub Actions 러너에 다른 버전이 깔릴 가능성이 있다. 하지만, npm ci는 package-lock.json 파일을 바라보고 있기 때문에 정확한 버전을 설치해 준다. 또한, node_modules 디렉토리가 기존에 존재하면 지우고 새롭게 다운받아 주기 때문에 안정성이 높다.</p>
</blockquote>
<p>마지막 결과에서 보듯 복원된 캐시인 node_modules가 디렉토리에 존재해도, 오랜 시간만큼 걸리기 때문에 여전히 우리가 원하는 결과를 가져오지 못했다. 그렇다면, <code class="language-text">npm install</code> 명령어로 바꿔보자. 그래야 restore-keys를 사용해 기존 캐시를 가져오고, npm install로 node_modules를 제거하지 않으면서 이번에 추가된 패키지만을 추가로 설치할 수 있을 것 같다.</p>
<p>이번에도 다른 패키지를 설치한 다음 push 해보자.</p>
<div class="gatsby-highlight" data-language="yml"><pre class="language-yml"><code class="language-yml"><span class="token punctuation">-</span> <span class="token key atrule">uses</span><span class="token punctuation">:</span> actions/cache@v3
  <span class="token key atrule">id</span><span class="token punctuation">:</span> npm<span class="token punctuation">-</span>cache
  <span class="token key atrule">with</span><span class="token punctuation">:</span>
    <span class="token key atrule">path</span><span class="token punctuation">:</span> <span class="token string">&#x27;**/node_modules&#x27;</span>
    <span class="token key atrule">key</span><span class="token punctuation">:</span> $<span class="token punctuation">{</span><span class="token punctuation">{</span> runner.os <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">-</span>node<span class="token punctuation">-</span>$<span class="token punctuation">{</span><span class="token punctuation">{</span> hashFiles(&#x27;<span class="token important">**/package-lock.json&#x27;)</span> <span class="token punctuation">}</span><span class="token punctuation">}</span>
    <span class="token key atrule">restore-keys</span><span class="token punctuation">:</span> <span class="token punctuation">|</span><span class="token scalar string">
      ${{ runner.os }}-node-
      ${{ runner.os }}</span>
<span class="token punctuation">-</span> <span class="token key atrule">if</span><span class="token punctuation">:</span> $<span class="token punctuation">{</span><span class="token punctuation">{</span> steps.npm<span class="token punctuation">-</span>cache.outputs.cache<span class="token punctuation">-</span>hit <span class="token tag">!=</span> &#x27;true&#x27; <span class="token punctuation">}</span><span class="token punctuation">}</span>
  <span class="token key atrule">run</span><span class="token punctuation">:</span> npm install
<span class="token punctuation">-</span> <span class="token key atrule">run</span><span class="token punctuation">:</span> npm run build</code></pre></div>
<p><span class="gatsby-resp-image-wrapper" style="position:relative;display:block;margin-left:auto;margin-right:auto;max-width:2000px">
      <span class="gatsby-resp-image-background-image" style="padding-bottom:42.6%;position:relative;bottom:0;left:0;background-image:url(&#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAABYlAAAWJQFJUiTwAAABUUlEQVQoz33S6Y7bIBSGYfDKYsA23hNPZjRTqe39399b4SxNNFV/POIcW0KcD8Tl8zfb5Qf7x0+68YTrZny/PoS4EeL6Xz6utMOG7xdEN2zE6cS47LhuRDctyrYoE6i0Iys0eWW/yZLyzjy+C93tmOEL3V/w6y9M/KBwJ8r2nTK8kfudTI9IFZGqR1T+kKlIpnsyHcnUdZXpnw0zTbdh2wXTLtRNpG4GlJswYUb7CeUiqulfFLVDlgZZ2kM6aV4ahPHxGPFoZInMFbJ4cvT6G5HXiKx6yPOaSWnE9vZFP50P6UJU091O0f2j7lD2b61vUm1cjwsjIt3wfP5kTRvPO9qPmCSkkW91O2OfpCheTdfI0oalW6jbnSqcqcJO0axIPZHZ7SBURJQBUb2SdfekPVaRa0R6O+n93d+b9QPGRYwfsGG89reR7lLmKdsjxycp8z9sGc8GxJbn/QAAAABJRU5ErkJggg==&#x27;);background-size:cover;display:block"></span>
  <img class="gatsby-resp-image-image" alt="npm-install-test" title="npm-install-test" src="/static/0aa849b19fcfaf8195ba83961f1af8ea/f97d7/npm-install-test.png" srcSet="/static/0aa849b19fcfaf8195ba83961f1af8ea/0eb09/npm-install-test.png 500w /static/0aa849b19fcfaf8195ba83961f1af8ea/1263b/npm-install-test.png 1000w /static/0aa849b19fcfaf8195ba83961f1af8ea/f97d7/npm-install-test.png 2000w /static/0aa849b19fcfaf8195ba83961f1af8ea/38915/npm-install-test.png 2182w" sizes="(max-width: 2000px) 100vw, 2000px" style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0" loading="lazy" decoding="async"/>
    </span></p>
<p>패키지 설치가 17s로 약간은 줄긴 했지만, 큰 효과는 아니다. local에서 node_modules 디렉토리가 있는 상태로 패키지를 따로 추가하지 않고 npm install을 하면 2s 밖에 걸리지 않는다. 왜냐하면 새로 설치할 패키지가 없기 때문이다. 그 정도 효과를 기대했지만, 측정 값은 그렇지 않다.</p>
<br/>
<h2 id="path-2개" style="position:relative">path 2개<a href="#path-2%EA%B0%9C" aria-label="path 2개 permalink" class="auto-link after"><svg viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a></h2>
<p>마지막으로 <code class="language-text">~/.npm</code> 캐시와 <code class="language-text">**/node_modules</code> 모두를 캐시 해서 사용하면 어떻게 될까?</p>
<div class="gatsby-highlight" data-language="yml"><pre class="language-yml"><code class="language-yml"><span class="token punctuation">-</span> <span class="token key atrule">uses</span><span class="token punctuation">:</span> actions/cache@v3
  <span class="token key atrule">id</span><span class="token punctuation">:</span> npm<span class="token punctuation">-</span>cache
  <span class="token key atrule">with</span><span class="token punctuation">:</span>
    <span class="token key atrule">path</span><span class="token punctuation">:</span> <span class="token punctuation">|</span><span class="token scalar string">
      &#x27;**/node_modules&#x27;
      ~/.npm</span>
    <span class="token key atrule">key</span><span class="token punctuation">:</span> $<span class="token punctuation">{</span><span class="token punctuation">{</span> runner.os <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">-</span>node<span class="token punctuation">-</span>$<span class="token punctuation">{</span><span class="token punctuation">{</span> hashFiles(&#x27;<span class="token important">**/package-lock.json&#x27;)</span> <span class="token punctuation">}</span><span class="token punctuation">}</span>
    <span class="token key atrule">restore-keys</span><span class="token punctuation">:</span> <span class="token punctuation">|</span><span class="token scalar string">
      ${{ runner.os }}-node-
      ${{ runner.os }}</span>
<span class="token punctuation">-</span> <span class="token key atrule">if</span><span class="token punctuation">:</span> $<span class="token punctuation">{</span><span class="token punctuation">{</span> steps.npm<span class="token punctuation">-</span>cache.outputs.cache<span class="token punctuation">-</span>hit <span class="token tag">!=</span> &#x27;true&#x27; <span class="token punctuation">}</span><span class="token punctuation">}</span>
  <span class="token key atrule">run</span><span class="token punctuation">:</span> npm install
<span class="token punctuation">-</span> <span class="token key atrule">run</span><span class="token punctuation">:</span> npm run build</code></pre></div>
<p>path에 node_modules와 npm 캐시 두 경로 모두 포함시켰다.</p>
<p><span class="gatsby-resp-image-wrapper" style="position:relative;display:block;margin-left:auto;margin-right:auto;max-width:2000px">
      <span class="gatsby-resp-image-background-image" style="padding-bottom:64.4%;position:relative;bottom:0;left:0;background-image:url(&#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAABYlAAAWJQFJUiTwAAABpklEQVQ4y5XT7ZKbIBgFYEBBvhQEP6JJzO5MM+393+Dp8GrSnd1sO/3xDIK+CnJg0/qG6/svnG93EvKCLp3+W6lr+xmsbjxCLoMz2n6C1C14bSCkBX9B/ANjlYYyHZG6tOGvBeVjpeZb5YHGBpg2wfgEH0ZoF2mM2gcbqV8pR4Wl7hUmpKOZuW6AaTMV0g2uwETzchbfvWyfvfJwXcYwX5DGFSHN0C6gMS2U9uUBsKoBf9KkjH2l901phw1+uMHnK/rlDpeu0PECkzZUboawI4QZIEwGbyK4aiF0QmWKfFxncNWVJVuYsMCmDT5vsP0Vqp2hwwrTX6lv4orGZ6JJgjQRXDpw6f+oLZiygZZsfI9aOfBaE/GZNIdjt8vyhHqqhcKgLVgcFozLDf24Uha171E+8oV52KNVxpqDOhLh2wSWpjMubz+xbHcs2w/E8QwbJrhYzHBhb31/enJF/KjcX2C7AaxEQ/oZsjsTFS7gZgC3Jwi3gpsJTAYw2YGpAKYi9WlzPmHVkcNwnMU4rHQuSx5dN9LPNz5T4I3bg/0gKHMf49TQv/8N6tIkTL3kYRUAAAAASUVORK5CYII=&#x27;);background-size:cover;display:block"></span>
  <img class="gatsby-resp-image-image" alt="2path" title="2path" src="/static/80dd66177e34a7d79c25180e9906a1bb/f97d7/2path.png" srcSet="/static/80dd66177e34a7d79c25180e9906a1bb/0eb09/2path.png 500w /static/80dd66177e34a7d79c25180e9906a1bb/1263b/2path.png 1000w /static/80dd66177e34a7d79c25180e9906a1bb/f97d7/2path.png 2000w /static/80dd66177e34a7d79c25180e9906a1bb/8077d/2path.png 2190w" sizes="(max-width: 2000px) 100vw, 2000px" style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0" loading="lazy" decoding="async"/>
    </span></p>
<p>가장 효과가 좋았다. 패키지 설치가 10s만 소요되었다. GitHub Actions 공식 예제에서 <code class="language-text">~/.npm</code> path만 캐시에 저장한 것을 미루어 봤을 때, npm install 및 npm ci 명령어는 <code class="language-text">~/.npm</code> 캐시를 참조하고 있음을 알 수 있으며, node_modules가 존재하면 npm install 명령어는 node_modules에 존재하지 않는 새로운 패키지만 추가로 설치한다는 가설이 검증되었다.</p>
<blockquote>
<p>※ <a href="https://github.com/actions/cache/blob/main/examples.md#node---npm" target="_blank" rel="nofollow">actions/cache</a>에 따르면 node_modules를 캐시하는 것은 권장되지 않는다고 한다. 노드 버전에 따라 중단될 수 있고, <code class="language-text">npm ci</code> 에서 동작하지 않기 때문이라고 한다. (npm ci는 node_modules를 제거하고 다시 설치하기 때문)</p>
</blockquote>
<p>결론적으로 새로운 패키지를 설치하고 GitHub Actions의 워크플로우를 실행시켰을 때,</p>
<ul>
<li><code class="language-text">node_modules</code> 디렉토리와, <code class="language-text">~/.npm</code> 디렉토리 모두를 캐시</li>
<li><code class="language-text">npm install</code> 명령어로 패키지 설치</li>
</ul>
<p>조건을 만족했을 경우 패키지 설치 속도가 가장 빨랐다. 따라서, restore-keys 옵  션을 사용할 때, restore-keys로 복원된 캐시 데이터는 그 캐시 데이터만으로 작업하는 것이 아니라, 캐시 기반 추가적인 작업이 존재해야 원하는 효과를 얻을 수 있다.</p>
<p>하지만, 이렇게 설정할 경우에도 주의점(단점)은 존재한다.</p>
<br/>
<h2 id="주의점" style="position:relative">주의점<a href="#%EC%A3%BC%EC%9D%98%EC%A0%90" aria-label="주의점 permalink" class="auto-link after"><svg viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a></h2>
<h3 id="안정성" style="position:relative">안정성<a href="#%EC%95%88%EC%A0%95%EC%84%B1" aria-label="안정성 permalink" class="auto-link after"><svg viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a></h3>
<p><code class="language-text">npm install</code> 명령어를 사용했기 때문에 네트워크를 통해 npm 레지스트리의 버전이 변경되었을 경우, 원하지 않는 버전이 설치되어 오류가 발생할 가능성이 있다. 이 부분은 npm 버저닝을 틸트(~) 및 캐럿(^)을 사용하지 않도록 함으로 예방할 수 있다. 그렇지 않더라도 주로 캐럿을 사용할 것이고, 이는 하위 호환성이 보장되기 때문에 크게 걱정할 필요는 없다.</p>
<h3 id="권장-방식-아님" style="position:relative">권장 방식 아님<a href="#%EA%B6%8C%EC%9E%A5-%EB%B0%A9%EC%8B%9D-%EC%95%84%EB%8B%98" aria-label="권장 방식 아님 permalink" class="auto-link after"><svg viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a></h3>
<p>위에서 봤듯이 <code class="language-text">node_modules</code> 캐싱은 actions/cache 액션을 만든 메인테이너가 권장하는 방식은 아니다.</p>
<h3 id="스노우-볼" style="position:relative">스노우 볼<a href="#%EC%8A%A4%EB%85%B8%EC%9A%B0-%EB%B3%BC" aria-label="스노우 볼 permalink" class="auto-link after"><svg viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a></h3>
<p>캐시 설정을 할 때, 가장 주의해야 하는 경우이다. <code class="language-text">~/.npm</code> 경로에 있는 npm 캐시는, 패키지를 삭제해도 용량이 줄지 않는다. 즉, <code class="language-text">npm uninstall [패키지명]</code> 명령어로 패키지를 삭제해도 <code class="language-text">~/.npm</code> 캐시의 용량은 줄어들지 않고 누적된다. 이는 npm이 캐시를 다루는 방식이기 때문이다. <a href="https://glebbahmutov.com/blog/do-not-let-npm-cache-snowball/" target="_blank" rel="nofollow">링크</a></p>
<p>따라서, GitHub Actions 워크플로우가 실행될 때마다 큰 용량의 <code class="language-text">~/.npm</code> 캐시를 다시 러너로 가져온다. 프로젝트가 노후화될수록 빌드 시간이 늘어날 상황이 생길 수 있다.</p>
<p>만약, 스노우 볼을 방지하기 위해서는 <code class="language-text">restore-keys</code> 옵션을 사용하지 않는다면 해결할 수 있다. 캐싱은 <code class="language-text">key</code>로 하되 <code class="language-text">key</code>에 맞지 않는다면, restore-keys로 복원하지 않고 마음 편안하게 <code class="language-text">npm ci</code> 로 clean 설치해 주면 그만이기 때문이다.</p>
<hr/>
<p>위와 같은 주의점이 있을 수 있지만, 나는 문제가 발생하기 전까지는 <code class="language-text">~/.npm</code>, <code class="language-text">node_modules</code> 를 캐시에 저장하고, <code class="language-text">npm install</code> 명령어로 패키지를 설치하는 방법을 선택할 것 같다.</p>
<br/>
<h2 id="정리" style="position:relative">정리<a href="#%EC%A0%95%EB%A6%AC" aria-label="정리 permalink" class="auto-link after"><svg viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a></h2>
<div class="gatsby-highlight" data-language="yml"><pre class="language-yml"><code class="language-yml"><span class="token key atrule">name</span><span class="token punctuation">:</span> Cache Test
<span class="token key atrule">on</span><span class="token punctuation">:</span> push
<span class="token key atrule">jobs</span><span class="token punctuation">:</span>
  <span class="token key atrule">cache</span><span class="token punctuation">:</span>
    <span class="token key atrule">runs-on</span><span class="token punctuation">:</span> ubuntu<span class="token punctuation">-</span>latest
    <span class="token key atrule">steps</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token key atrule">uses</span><span class="token punctuation">:</span> actions/checkout@v3
      <span class="token punctuation">-</span> <span class="token key atrule">uses</span><span class="token punctuation">:</span> actions/cache@v3
        <span class="token key atrule">id</span><span class="token punctuation">:</span> npm<span class="token punctuation">-</span>cache
        <span class="token key atrule">with</span><span class="token punctuation">:</span>
          <span class="token key atrule">path</span><span class="token punctuation">:</span> <span class="token punctuation">|</span><span class="token scalar string">
            &#x27;**/node_modules&#x27;
            ~/.npm</span>
          <span class="token key atrule">key</span><span class="token punctuation">:</span> $<span class="token punctuation">{</span><span class="token punctuation">{</span> runner.os <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">-</span>node<span class="token punctuation">-</span>$<span class="token punctuation">{</span><span class="token punctuation">{</span> hashFiles(&#x27;<span class="token important">**/package-lock.json&#x27;)</span> <span class="token punctuation">}</span><span class="token punctuation">}</span>
          <span class="token key atrule">restore-keys</span><span class="token punctuation">:</span> <span class="token punctuation">|</span><span class="token scalar string">
            ${{ runner.os }}-node-
            ${{ runner.os }}</span>
      <span class="token punctuation">-</span> <span class="token key atrule">if</span><span class="token punctuation">:</span> $<span class="token punctuation">{</span><span class="token punctuation">{</span> steps.npm<span class="token punctuation">-</span>cache.outputs.cache<span class="token punctuation">-</span>hit <span class="token tag">!=</span> &#x27;true&#x27; <span class="token punctuation">}</span><span class="token punctuation">}</span>
        <span class="token key atrule">run</span><span class="token punctuation">:</span> npm install
      <span class="token punctuation">-</span> <span class="token key atrule">run</span><span class="token punctuation">:</span> npm run build</code></pre></div>
<ul>
<li><code class="language-text">~/.npm</code> 데이터와, <code class="language-text">node_modules</code> 데이터 모두를 GitHub Actions에 캐시 한다.</li>
<li>워크플로우가 트리거 되면 두 데이터 모두 러너 환경에 복원된다.</li>
<li>만약 의존성이 변경되었다면 <code class="language-text">npm install</code> 명령어로 의존성 설치가 시작된다.</li>
<li>node_modules가 러너 환경에 존재하기 때문에 <code class="language-text">npm ci</code> 명령어보다 <code class="language-text">npm install</code> 명령어가 빠르게 패키지를 설치한다.</li>
<li>추가로 <code class="language-text">~/.npm</code> 데이터가 있기 때문에 <code class="language-text">npm install</code> 로 의존성을 설치하면 npm 캐시로 인해 더 빠르게 패키지를 설치한다.</li>
</ul>
<p>결과: CRA와 가벼운 몇몇 패키지 설치 시 27s에서 10s로 줄임. <strong>62%</strong> 가량의 효율성 확보.</p>
<br/>
<h3 id="번외---GitHub-Actions의-캐시-매커니즘" style="position:relative">번외 - GitHub Actions의 캐시 매커니즘<a href="#%EB%B2%88%EC%99%B8---GitHub-Actions%EC%9D%98-%EC%BA%90%EC%8B%9C-%EB%A7%A4%EC%BB%A4%EB%8B%88%EC%A6%98" aria-label="번외   GitHub Actions의 캐시 매커니즘 permalink" class="auto-link after"><svg viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a></h3>
<p>GitHub에서 워크플로우가 실행될 때 사진의 파란색 부분은 러너에서 실제로 CLI로 실행되는 명령어의 log를 나타내고 있다. 마지막 Post cache actions step의 명령어를 보자.</p>
<p>첫 번째 step인 cache action이 실행될 때 restore-keys에 명시된 캐시를 찾았을 때 <code class="language-text">unzstd</code> 명령어를 통해 압축된 파일을 푼다. 그리고 마지막 Post cache action step에서는 <code class="language-text">zstdmt</code> 라는 명령어를 통해 다시 압축한다.</p>
<p>두 명령어 모두 Zstandard라는 압축 프로그램이다. Facebook에서 개발한 고속 압축 알고리즘으로, 다양한 응용 분야에서 데이터 압축을 효율적으로 수행할 수 있도록 설계되었다. 따라서, 캐시를 사용할 때, node_modules 디렉토리를 직접 캐싱하는 것이 아니라, 위 명령어로 압축한 파일을 풀고 다시 저장한다.</p>
<br/>
<blockquote>
<p>참고</p>
<ul>
<li><a href="https://docs.travis-ci.com/user/caching/" target="_blank" rel="nofollow">https://docs.travis-ci.com/user/caching/</a></li>
<li><a href="https://github.com/orgs/community/discussions/25027" target="_blank" rel="nofollow">https://github.com/orgs/community/discussions/25027</a></li>
<li><a href="https://glebbahmutov.com/blog/do-not-let-npm-cache-snowball/" target="_blank" rel="nofollow">https://glebbahmutov.com/blog/do-not-let-npm-cache-snowball/</a></li>
<li><a href="https://fe-developers.kakaoent.com/2022/220106-github-actions/" target="_blank" rel="nofollow">https://fe-developers.kakaoent.com/2022/220106-github-actions/</a></li>
<li><a href="https://blog.banksalad.com/tech/github-action-npm-cache/" target="_blank" rel="nofollow">https://blog.banksalad.com/tech/github-action-npm-cache/</a></li>
</ul>
</blockquote></div></section></article><style data-emotion="css 17876f4">.css-17876f4{position:relative;box-sizing:border-box;width:100%;max-width:760px;margin-left:auto;margin-right:auto;}</style><div class="css-17876f4"><div></div></div></div></main><style data-emotion="css dcfhc9">.css-dcfhc9{position:relative;padding:0 5vw;}</style><style data-emotion="css 10px0y6">.css-10px0y6{background:#0a0b0c;position:relative;padding:0 5vw;}.css-10px0y6 .post-card{padding-bottom:0;border-bottom:none;}.css-10px0y6 .post-card:after{display:none;}.css-10px0y6 .post-card-primary-tag{color:#fff;opacity:0.6;}.css-10px0y6 .post-card-title{color:#fff;opacity:0.8;-webkit-transition:all 0.2s ease-in-out;transition:all 0.2s ease-in-out;}.css-10px0y6 .post-card:hover .post-card-image{opacity:1;}.css-10px0y6 .post-card-excerpt{color:rgba(255, 255, 255, 0.6);}.css-10px0y6 .static-avatar{border-color:#000;}.css-10px0y6 .post-card-byline-content{color:rgba(255, 255, 255, 0.6);}.css-10px0y6 .post-card-byline-content a{color:rgba(255, 255, 255, 0.8);}.css-10px0y6 .author-avatar{border-color:#0a0b0c;}.css-10px0y6 .author-profile-image{background:#0a0b0c;}@media (max-width: 650px){.css-10px0y6 .post-card{-webkit-flex:1 1 auto;-ms-flex:1 1 auto;flex:1 1 auto;margin:25px;padding:25px 0 0;}}</style><aside class="read-next css-10px0y6 eu5ixib1"><div class="css-y521qa"><style data-emotion="css 1ehfk3g">.css-1ehfk3g{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-flex-wrap:wrap;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;margin:0 -25px;padding:60px 0 0 0;}</style><div class="read-next-feed css-1ehfk3g eu5ixib0"><style data-emotion="css 1un2iyf">.css-1un2iyf{position:relative;-webkit-flex:1 1 301px;-ms-flex:1 1 301px;flex:1 1 301px;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;overflow:hidden;margin:0 20px 60px;min-height:220px;-webkit-background-size:cover;background-size:cover;-webkit-transition:0.4s ease;transition:0.4s ease;}.css-1un2iyf img{-webkit-transform:scale(1)!important;-moz-transform:scale(1)!important;-ms-transform:scale(1)!important;transform:scale(1)!important;-webkit-transition:opacity 1s ease-out 0s,-webkit-transform 0.5s ease 0s!important;transition:opacity 1s ease-out 0s,transform 0.5s ease 0s!important;}.css-1un2iyf:hover .post-card-image:after{opacity:1;}.css-1un2iyf:hover img{-webkit-transform:scale(1.03)!important;-moz-transform:scale(1.03)!important;-ms-transform:scale(1.03)!important;transform:scale(1.03)!important;}</style><article class="post-card   css-1un2iyf"><style data-emotion="css 1k9qipi">.css-1k9qipi{position:relative;display:block;overflow:hidden;border-radius:12px;overflow:hidden;}</style><a class="post-card-image-link css-1k9qipi" href="/nextjs/about-modularizing-api-routes-code-in-nextjs/"><style data-emotion="css 3tmwau">.css-3tmwau{width:auto;height:200px;-webkit-background-size:cover;background-size:cover;border-radius:12px;overflow:hidden;border:1px solid var(--image-border-color);background:var(--background-color);}.css-3tmwau:after{content:'';display:block;position:absolute;top:0px;left:0px;width:100%;height:100%;opacity:0;background-color:rgba(0, 0, 0, 0.1);-webkit-transition:all 0.3s ease 0s;transition:all 0.3s ease 0s;}.css-3tmwau img{border-radius:12px;}.css-3tmwau.is-next{border:1px solid hsl(230deg 6% 23%);}</style><div class="post-card-image is-next css-3tmwau e1qfhan16"><div data-gatsby-image-wrapper="" style="height:100%" class="gatsby-image-wrapper"><div aria-hidden="true" style="padding-top:52.34375%"></div><img aria-hidden="true" data-placeholder-image="" style="opacity:1;transition:opacity 500ms linear" decoding="async" src="data:image/webp;base64,UklGRlABAABXRUJQVlA4IEQBAAAQBgCdASoUAAoAAAAAJQBOmUI4G2AKEr3kT9TfSAd8bMV4y7BHP9V/MDjAP1APvhp9S1P4WAaWWwAA/v//FO+/uU2wVgdvo3t7+/esHdVnt/ADvJNu//kKsryq7K4/kH6dQSpGZH/Wmy5Hn/aiP/iWMNYE/L04/fxOh6w6LNfMVCO2e4bk1w+gWtpgjXx8dPwxbP/af/3X+0eo//xh3vW8bP8x/59L+P+uAb/nTz0WLfd1P3vPtBSZEyy/3T0wbRrtQDgzQWJR+Ionuv+3z/+oMGf/VUBr79zfpXfp+qM/6uI1nkf8xYssVf+Jam3g3/89o/+0Ec/+2AL9tBfn9QixAvY/zPVrT+ICoP+ly+1C7/DtZUF9PQRI4d13mrIY7dR2bGTX2cQVs9OgNCzOMwQy1nvlPj56aTR9Kl6iaLrR7askCAA=" alt=""/><img data-gatsby-image-ssr="" data-main-image="" style="opacity:0" sizes="100vw" decoding="async" loading="lazy" data-src="/static/6763177ee50addd67c4dc57952797f69/231da/main.webp" data-srcset="/static/6763177ee50addd67c4dc57952797f69/7513b/main.webp 750w,/static/6763177ee50addd67c4dc57952797f69/317ed/main.webp 1080w,/static/6763177ee50addd67c4dc57952797f69/b5c49/main.webp 1366w,/static/6763177ee50addd67c4dc57952797f69/231da/main.webp 1920w" alt="Next.js의 API Routes 코드 모듈화에 대해서 cover image"/><noscript><img data-gatsby-image-ssr="" data-main-image="" style="opacity:0" sizes="100vw" decoding="async" loading="lazy" src="/static/6763177ee50addd67c4dc57952797f69/231da/main.webp" srcSet="/static/6763177ee50addd67c4dc57952797f69/7513b/main.webp 750w,/static/6763177ee50addd67c4dc57952797f69/317ed/main.webp 1080w,/static/6763177ee50addd67c4dc57952797f69/b5c49/main.webp 1366w,/static/6763177ee50addd67c4dc57952797f69/231da/main.webp 1920w" alt="Next.js의 API Routes 코드 모듈화에 대해서 cover image"/></noscript><script type="module">const t="undefined"!=typeof HTMLImageElement&&"loading"in HTMLImageElement.prototype;if(t){const t=document.querySelectorAll("img[data-main-image]");for(let e of t){e.dataset.src&&(e.setAttribute("src",e.dataset.src),e.removeAttribute("data-src")),e.dataset.srcset&&(e.setAttribute("srcset",e.dataset.srcset),e.removeAttribute("data-srcset"));const t=e.parentNode.querySelectorAll("source[data-srcset]");for(let e of t)e.setAttribute("srcset",e.dataset.srcset),e.removeAttribute("data-srcset");e.complete&&(e.style.opacity=1,e.parentNode.parentNode.querySelector("[data-placeholder-image]").style.opacity=0)}}</script></div></div></a><style data-emotion="css 1lh7kdz">.css-1lh7kdz{-webkit-box-flex:1;-webkit-flex-grow:1;-ms-flex-positive:1;flex-grow:1;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;}</style><div class="post-card-content css-1lh7kdz e1qfhan15"><style data-emotion="css 1193uzk">.css-1193uzk{margin:15px 0 0.2em;color:#90a2aa;font-size:1.2rem;font-weight:500;letter-spacing:0.2px;}.css-1193uzk a{font-size:1.2rem;}</style><div class="post-card-primary-tag css-1193uzk e1qfhan14"><a href="/tags/next-js/">Next.js</a></div><style data-emotion="css 1fjrpmt">.css-1fjrpmt{position:relative;display:block;color:#15171A;}.css-1fjrpmt:hover{-webkit-text-decoration:none;text-decoration:none;}</style><a class="post-card-content-link css-1fjrpmt" href="/nextjs/about-modularizing-api-routes-code-in-nextjs/"><header><style data-emotion="css 1ynvt8d">.css-1ynvt8d{margin:0 0 0.4em;line-height:1.15em;color:var(--post-card-title);}</style><h2 class="post-card-title css-1ynvt8d e1qfhan13">Next.js의 API Routes 코드 모듈화에 대해서</h2></header><style data-emotion="css 1mnbv2f">.css-1mnbv2f{font-size:1.6rem;color:var(--post-card-description);}.css-1mnbv2f p{width:100%;overflow:hidden;text-overflow:ellipsis;display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;margin-bottom:0.4em;font-size:1.4rem;}</style><section class="post-card-excerpt css-1mnbv2f e1qfhan12"><p>API Routes를 사용하면 코드가 매우 지저분해진다. API Routes를 사용하면서 어떻게 하면 코드를 보기 좋은 형태로 남길 수 있을지 고민한 흔적.</p></section></a><style data-emotion="css 143c7df">.css-143c7df{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:flex-start;-webkit-box-align:flex-start;-ms-flex-align:flex-start;align-items:flex-start;padding:0;}</style><footer class="post-card-meta css-143c7df e1qfhan11"><style data-emotion="css 1m00hb7">.css-1m00hb7{-webkit-flex:1 1 50%;-ms-flex:1 1 50%;flex:1 1 50%;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;color:#90a2aa;line-height:1.4em;font-weight:400;letter-spacing:0.2px;}.css-1m00hb7 time{font-size:1.3rem;}.css-1m00hb7 span{margin:0;font-size:1.3rem;}.css-1m00hb7 a{color:var(--post-card-by-line);font-weight:600;}</style><div class="post-card-byline-content css-1m00hb7 e1qfhan10"><span class="post-card-byline-date"><time dateTime="2023-07-26">2023-07-26</time> <span class="bull">•</span> <span>11 min read</span></span></div></footer></div></article></div></div></aside><style data-emotion="css d4eprp">.css-d4eprp{position:relative;padding:0 5vw;position:relative;padding-top:20px;padding-bottom:22px;color:#fff;background:#000;}</style><footer class="css-d4eprp"><style data-emotion="css 1d3gyi8">.css-1d3gyi8{margin:0 auto;max-width:1040px;width:100%;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-flex-wrap:wrap;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;color:rgba(255, 255, 255, 0.7);font-size:1.3rem;}.css-1d3gyi8 a{color:rgba(255, 255, 255, 0.7);}.css-1d3gyi8 a:hover{color:rgba(255, 255, 255, 1);-webkit-text-decoration:none;text-decoration:none;}@media (max-width: 650px){.css-1d3gyi8{-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;}}</style><div class="css-1d3gyi8"><section class="copyright">© <!-- -->2023<!-- --> <span>|  </span><a href="https://www.gatsbyjs.com/" target="_blank" rel="nofollow">Pozafly Blog<!-- --> <!-- -->is based on Gatsby</a></section><style data-emotion="css 13qgqyf">.css-13qgqyf{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;}.css-13qgqyf a{position:relative;margin-left:20px;font-size:1.3rem;}.css-13qgqyf a:before{content:'';position:absolute;top:11px;left:-11px;display:block;width:2px;height:2px;background:#fff;border-radius:100%;}.css-13qgqyf a:first-of-type:before{display:none;}@media (max-width: 650px){.css-13qgqyf a:first-of-type{margin-left:0;}}</style><nav class="css-13qgqyf e1me3zb40"><a href="/">Latest Posts</a><a href="https://www.instagram.com/pozafly_/" target="_blank" rel="noopener noreferrer">Instagram</a><a href="https://github.com/pozafly" target="_blank" rel="noopener noreferrer">Github</a><a href="/rss.xml">RSS</a></nav></div></footer></div></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/dev-ops/cache-and-restore-keys-in-github-actions/";/*]]>*/</script><!-- slice-start id="_gatsby-scripts-1" -->
          <script
            id="gatsby-chunk-mapping"
          >
            window.___chunkMapping="{\"app\":[\"/app-0a3805017c2c0ea7a466.js\"],\"component---src-pages-404-tsx\":[\"/component---src-pages-404-tsx-e6ff7ea58158b6abbdd8.js\"],\"component---src-pages-about-tsx\":[\"/component---src-pages-about-tsx-c74d448e7f9fcf20a428.js\"],\"component---src-pages-tags-tsx\":[\"/component---src-pages-tags-tsx-e18dfbfe659a147f70f2.js\"],\"component---src-templates-index-tsx\":[\"/component---src-templates-index-tsx-c7070cb34d89300bec40.js\"],\"component---src-templates-post-tsx\":[],\"component---src-templates-tags-tsx\":[\"/component---src-templates-tags-tsx-cb2f8f779b3cf2c2ad52.js\"]}";
          </script>
        <script>window.___webpackCompilationHash="99e2dafba52db3ef5e07";</script><script src="/webpack-runtime-33500020e8d66cb62f1f.js" async></script><script src="/framework-52661bed68a218a99879.js" async></script><script src="/app-0a3805017c2c0ea7a466.js" async></script><!-- slice-end id="_gatsby-scripts-1" --></body></html>